"use strict";(self.webpackChunkclickhouse=self.webpackChunkclickhouse||[]).push([[41876],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return d}});var o=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=o.createContext({}),u=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},c=function(e){var t=u(e.components);return o.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,l=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),m=u(n),d=r,h=m["".concat(l,".").concat(d)]||m[d]||p[d]||a;return n?o.createElement(h,s(s({ref:t},c),{},{components:n})):o.createElement(h,s({ref:t},c))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,s=new Array(a);s[0]=m;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:r,s[1]=i;for(var u=2;u<a;u++)s[u]=n[u];return o.createElement.apply(null,s)}return o.createElement.apply(null,n)}m.displayName="MDXCreateElement"},32064:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return l},default:function(){return d},frontMatter:function(){return i},metadata:function(){return u},toc:function(){return p}});var o=n(87462),r=n(63366),a=(n(67294),n(3905)),s=["components"],i={sidebar_position:58,sidebar_label:"Usage Recommendations"},l="Usage Recommendations",u={unversionedId:"en/operations/tips",id:"en/operations/tips",title:"Usage Recommendations",description:"usage-recommendations}",source:"@site/docs/en/operations/tips.md",sourceDirName:"en/operations",slug:"/en/operations/tips",permalink:"/docs/staging4/docs/en/operations/tips",tags:[],version:"current",sidebarPosition:58,frontMatter:{sidebar_position:58,sidebar_label:"Usage Recommendations"},sidebar:"tutorialSidebar",previous:{title:"clickhouse-odbc-bridge",permalink:"/docs/staging4/docs/en/operations/utilities/odbc-bridge"},next:{title:"OpenTelemetry Support",permalink:"/docs/staging4/docs/en/operations/opentelemetry"}},c={},p=[{value:"CPU Scaling Governor",id:"cpu-scaling-governor",level:2},{value:"CPU Limitations",id:"cpu-limitations",level:2},{value:"RAM",id:"ram",level:2},{value:"Storage Subsystem",id:"storage-subsystem",level:2},{value:"RAID",id:"raid",level:2},{value:"File System",id:"file-system",level:2},{value:"Linux Kernel",id:"linux-kernel",level:2},{value:"Network",id:"network",level:2},{value:"Huge Pages",id:"huge-pages",level:2},{value:"Hypervisor configuration",id:"hypervisor-configuration",level:2},{value:"ZooKeeper",id:"zookeeper",level:2},{value:"Antivirus software",id:"antivirus-software",level:2}],m={toc:p};function d(e){var t=e.components,n=(0,r.Z)(e,s);return(0,a.kt)("wrapper",(0,o.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"usage-recommendations"},"Usage Recommendations"),(0,a.kt)("h2",{id:"cpu-scaling-governor"},"CPU Scaling Governor"),(0,a.kt)("p",null,"Always use the ",(0,a.kt)("inlineCode",{parentName:"p"},"performance")," scaling governor. The ",(0,a.kt)("inlineCode",{parentName:"p"},"on-demand")," scaling governor works much worse with constantly high demand."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"$ echo 'performance' | sudo tee /sys/devices/system/cpu/cpu*/cpufreq/scaling_governor\n")),(0,a.kt)("h2",{id:"cpu-limitations"},"CPU Limitations"),(0,a.kt)("p",null,"Processors can overheat. Use ",(0,a.kt)("inlineCode",{parentName:"p"},"dmesg")," to see if the CPU\u2019s clock rate was limited due to overheating.\nThe restriction can also be set externally at the datacenter level. You can use ",(0,a.kt)("inlineCode",{parentName:"p"},"turbostat")," to monitor it under a load."),(0,a.kt)("h2",{id:"ram"},"RAM"),(0,a.kt)("p",null,"For small amounts of data (up to ~200 GB compressed), it is best to use as much memory as the volume of data.\nFor large amounts of data and when processing interactive (online) queries, you should use a reasonable amount of RAM (128 GB or more) so the hot data subset will fit in the cache of pages.\nEven for data volumes of ~50 TB per server, using 128 GB of RAM significantly improves query performance compared to 64 GB."),(0,a.kt)("p",null,"Do not disable overcommit. The value ",(0,a.kt)("inlineCode",{parentName:"p"},"cat /proc/sys/vm/overcommit_memory")," should be 0 or 1. Run"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"$ echo 0 | sudo tee /proc/sys/vm/overcommit_memory\n")),(0,a.kt)("p",null,"Use ",(0,a.kt)("inlineCode",{parentName:"p"},"perf top")," to watch the time spent in the kernel for memory management.\nPermanent huge pages also do not need to be allocated."),(0,a.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"If your system has less than 16 GB of RAM, you may experience various memory exceptions because default settings do not match this amount of memory. The recommended amount of RAM is 32 GB or more. You can use ClickHouse in a system with a small amount of RAM, even with 2 GB of RAM, but it requires additional tuning and can ingest at a low rate."))),(0,a.kt)("h2",{id:"storage-subsystem"},"Storage Subsystem"),(0,a.kt)("p",null,"If your budget allows you to use SSD, use SSD.\nIf not, use HDD. SATA HDDs 7200 RPM will do."),(0,a.kt)("p",null,"Give preference to a lot of servers with local hard drives over a smaller number of servers with attached disk shelves.\nBut for storing archives with rare queries, shelves will work."),(0,a.kt)("h2",{id:"raid"},"RAID"),(0,a.kt)("p",null,"When using HDD, you can combine their RAID-10, RAID-5, RAID-6 or RAID-50.\nFor Linux, software RAID is better (with ",(0,a.kt)("inlineCode",{parentName:"p"},"mdadm"),"). We do not recommend using LVM.\nWhen creating RAID-10, select the ",(0,a.kt)("inlineCode",{parentName:"p"},"far")," layout.\nIf your budget allows, choose RAID-10."),(0,a.kt)("p",null,"If you have more than 4 disks, use RAID-6 (preferred) or RAID-50, instead of RAID-5.\nWhen using RAID-5, RAID-6 or RAID-50, always increase stripe_cache_size, since the default value is usually not the best choice."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"$ echo 4096 | sudo tee /sys/block/md2/md/stripe_cache_size\n")),(0,a.kt)("p",null,"Calculate the exact number from the number of devices and the block size, using the formula: ",(0,a.kt)("inlineCode",{parentName:"p"},"2 * num_devices * chunk_size_in_bytes / 4096"),"."),(0,a.kt)("p",null,"A block size of 64 KB is sufficient for most RAID configurations. The average clickhouse-server write size is approximately 1 MB (1024 KB), and thus the recommended stripe size is also 1 MB. The block size can be optimized if needed when set to 1 MB divided by the number of non-parity disks in the RAID array, such that each write is parallelized across all available non-parity disks.\nNever set the block size too small or too large."),(0,a.kt)("p",null,"You can use RAID-0 on SSD.\nRegardless of RAID use, always use replication for data security."),(0,a.kt)("p",null,"Enable NCQ with a long queue. For HDD, choose the CFQ scheduler, and for SSD, choose noop. Don\u2019t reduce the \u2018readahead\u2019 setting.\nFor HDD, enable the write cache."),(0,a.kt)("p",null,"Make sure that ",(0,a.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Trim_(computing)"},"fstrim")," is enabled for NVME and SSD disks in your OS (usually it's implemented using a cronjob or systemd service)."),(0,a.kt)("h2",{id:"file-system"},"File System"),(0,a.kt)("p",null,"Ext4 is the most reliable option. Set the mount options ",(0,a.kt)("inlineCode",{parentName:"p"},"noatime"),".\nXFS should be avoided. It works mostly fine but there are some reports about lower performance.\nMost other file systems should also work fine."),(0,a.kt)("p",null,"Do not use compressed filesystems, because ClickHouse does compression on its own and better.\nIt's not recommended to use encrypted filesystems, because you can use builtin encryption in ClickHouse, which is better."),(0,a.kt)("h2",{id:"linux-kernel"},"Linux Kernel"),(0,a.kt)("p",null,"Don\u2019t use an outdated Linux kernel."),(0,a.kt)("h2",{id:"network"},"Network"),(0,a.kt)("p",null,"If you are using IPv6, increase the size of the route cache.\nThe Linux kernel prior to 3.2 had a multitude of problems with IPv6 implementation."),(0,a.kt)("p",null,"Use at least a 10 GB network, if possible. 1 Gb will also work, but it will be much worse for patching replicas with tens of terabytes of data, or for processing distributed queries with a large amount of intermediate data."),(0,a.kt)("h2",{id:"huge-pages"},"Huge Pages"),(0,a.kt)("p",null,"If you are using old Linux kernel, disable transparent huge pages. It interferes with memory allocators, which leads to significant performance degradation.\nOn newer Linux kernels transparent huge pages are alright."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"$ echo 'madvise' | sudo tee /sys/kernel/mm/transparent_hugepage/enabled\n")),(0,a.kt)("h2",{id:"hypervisor-configuration"},"Hypervisor configuration"),(0,a.kt)("p",null,"If you are using OpenStack, set"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"cpu_mode=host-passthrough\n")),(0,a.kt)("p",null,"in nova.conf."),(0,a.kt)("p",null,"If you are using libvirt, set"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"<cpu mode='host-passthrough'/>\n")),(0,a.kt)("p",null,"in XML configuration."),(0,a.kt)("p",null,"This is important for ClickHouse to be able to get correct information with ",(0,a.kt)("inlineCode",{parentName:"p"},"cpuid")," instruction.\nOtherwise you may get ",(0,a.kt)("inlineCode",{parentName:"p"},"Illegal instruction")," crashes when hypervisor is run on old CPU models."),(0,a.kt)("h2",{id:"zookeeper"},"ZooKeeper"),(0,a.kt)("p",null,"You are probably already using ZooKeeper for other purposes. You can use the same installation of ZooKeeper, if it isn\u2019t already overloaded."),(0,a.kt)("p",null,"It\u2019s best to use a fresh version of ZooKeeper \u2013 3.4.9 or later. The version in stable Linux distributions may be outdated."),(0,a.kt)("p",null,"You should never use manually written scripts to transfer data between different ZooKeeper clusters, because the result will be incorrect for sequential nodes. Never use the \u201czkcopy\u201d utility for the same reason: ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/ksprojects/zkcopy/issues/15"},"https://github.com/ksprojects/zkcopy/issues/15")),(0,a.kt)("p",null,"If you want to divide an existing ZooKeeper cluster into two, the correct way is to increase the number of its replicas and then reconfigure it as two independent clusters."),(0,a.kt)("p",null,"Do not run ZooKeeper on the same servers as ClickHouse. Because ZooKeeper is very sensitive for latency and ClickHouse may utilize all available system resources."),(0,a.kt)("p",null,"You can have ZooKeeper observers in an ensemble but ClickHouse servers should not interact with observers."),(0,a.kt)("p",null,"Do not change ",(0,a.kt)("inlineCode",{parentName:"p"},"minSessionTimeout")," setting, large values may affect ClickHouse restart stability."),(0,a.kt)("p",null,"With the default settings, ZooKeeper is a time bomb:"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"The ZooKeeper server won\u2019t delete files from old snapshots and logs when using the default configuration (see autopurge), and this is the responsibility of the operator.")),(0,a.kt)("p",null,"This bomb must be defused."),(0,a.kt)("p",null,"The ZooKeeper (3.5.1) configuration below is used in a large production environment:"),(0,a.kt)("p",null,"zoo.cfg:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"# http://hadoop.apache.org/zookeeper/docs/current/zookeeperAdmin.html\n\n# The number of milliseconds of each tick\ntickTime=2000\n# The number of ticks that the initial\n# synchronization phase can take\n# This value is not quite motivated\ninitLimit=300\n# The number of ticks that can pass between\n# sending a request and getting an acknowledgement\nsyncLimit=10\n\nmaxClientCnxns=2000\n\n# It is the maximum value that client may request and the server will accept.\n# It is Ok to have high maxSessionTimeout on server to allow clients to work with high session timeout if they want.\n# But we request session timeout of 30 seconds by default (you can change it with session_timeout_ms in ClickHouse config).\nmaxSessionTimeout=60000000\n# the directory where the snapshot is stored.\ndataDir=/opt/zookeeper/{{ '{{' }} cluster['name'] {{ '}}' }}/data\n# Place the dataLogDir to a separate physical disc for better performance\ndataLogDir=/opt/zookeeper/{{ '{{' }} cluster['name'] {{ '}}' }}/logs\n\nautopurge.snapRetainCount=10\nautopurge.purgeInterval=1\n\n\n# To avoid seeks ZooKeeper allocates space in the transaction log file in\n# blocks of preAllocSize kilobytes. The default block size is 64M. One reason\n# for changing the size of the blocks is to reduce the block size if snapshots\n# are taken more often. (Also, see snapCount).\npreAllocSize=131072\n\n# Clients can submit requests faster than ZooKeeper can process them,\n# especially if there are a lot of clients. To prevent ZooKeeper from running\n# out of memory due to queued requests, ZooKeeper will throttle clients so that\n# there is no more than globalOutstandingLimit outstanding requests in the\n# system. The default limit is 1,000.ZooKeeper logs transactions to a\n# transaction log. After snapCount transactions are written to a log file a\n# snapshot is started and a new transaction log file is started. The default\n# snapCount is 10,000.\nsnapCount=3000000\n\n# If this option is defined, requests will be will logged to a trace file named\n# traceFile.year.month.day.\n#traceFile=\n\n# Leader accepts client connections. Default value is \"yes\". The leader machine\n# coordinates updates. For higher update throughput at thes slight expense of\n# read throughput the leader can be configured to not accept clients and focus\n# on coordination.\nleaderServes=yes\n\nstandaloneEnabled=false\ndynamicConfigFile=/etc/zookeeper-{{ '{{' }} cluster['name'] {{ '}}' }}/conf/zoo.cfg.dynamic\n")),(0,a.kt)("p",null,"Java version:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},"openjdk 11.0.5-shenandoah 2019-10-15\nOpenJDK Runtime Environment (build 11.0.5-shenandoah+10-adhoc.heretic.src)\nOpenJDK 64-Bit Server VM (build 11.0.5-shenandoah+10-adhoc.heretic.src, mixed mode)\n")),(0,a.kt)("p",null,"JVM parameters:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"NAME=zookeeper-{{ '{{' }} cluster['name'] {{ '}}' }}\nZOOCFGDIR=/etc/$NAME/conf\n\n# TODO this is really ugly\n# How to find out, which jars are needed?\n# seems, that log4j requires the log4j.properties file to be in the classpath\nCLASSPATH=\"$ZOOCFGDIR:/usr/build/classes:/usr/build/lib/*.jar:/usr/share/zookeeper-3.6.2/lib/audience-annotations-0.5.0.jar:/usr/share/zookeeper-3.6.2/lib/commons-cli-1.2.jar:/usr/share/zookeeper-3.6.2/lib/commons-lang-2.6.jar:/usr/share/zookeeper-3.6.2/lib/jackson-annotations-2.10.3.jar:/usr/share/zookeeper-3.6.2/lib/jackson-core-2.10.3.jar:/usr/share/zookeeper-3.6.2/lib/jackson-databind-2.10.3.jar:/usr/share/zookeeper-3.6.2/lib/javax.servlet-api-3.1.0.jar:/usr/share/zookeeper-3.6.2/lib/jetty-http-9.4.24.v20191120.jar:/usr/share/zookeeper-3.6.2/lib/jetty-io-9.4.24.v20191120.jar:/usr/share/zookeeper-3.6.2/lib/jetty-security-9.4.24.v20191120.jar:/usr/share/zookeeper-3.6.2/lib/jetty-server-9.4.24.v20191120.jar:/usr/share/zookeeper-3.6.2/lib/jetty-servlet-9.4.24.v20191120.jar:/usr/share/zookeeper-3.6.2/lib/jetty-util-9.4.24.v20191120.jar:/usr/share/zookeeper-3.6.2/lib/jline-2.14.6.jar:/usr/share/zookeeper-3.6.2/lib/json-simple-1.1.1.jar:/usr/share/zookeeper-3.6.2/lib/log4j-1.2.17.jar:/usr/share/zookeeper-3.6.2/lib/metrics-core-3.2.5.jar:/usr/share/zookeeper-3.6.2/lib/netty-buffer-4.1.50.Final.jar:/usr/share/zookeeper-3.6.2/lib/netty-codec-4.1.50.Final.jar:/usr/share/zookeeper-3.6.2/lib/netty-common-4.1.50.Final.jar:/usr/share/zookeeper-3.6.2/lib/netty-handler-4.1.50.Final.jar:/usr/share/zookeeper-3.6.2/lib/netty-resolver-4.1.50.Final.jar:/usr/share/zookeeper-3.6.2/lib/netty-transport-4.1.50.Final.jar:/usr/share/zookeeper-3.6.2/lib/netty-transport-native-epoll-4.1.50.Final.jar:/usr/share/zookeeper-3.6.2/lib/netty-transport-native-unix-common-4.1.50.Final.jar:/usr/share/zookeeper-3.6.2/lib/simpleclient-0.6.0.jar:/usr/share/zookeeper-3.6.2/lib/simpleclient_common-0.6.0.jar:/usr/share/zookeeper-3.6.2/lib/simpleclient_hotspot-0.6.0.jar:/usr/share/zookeeper-3.6.2/lib/simpleclient_servlet-0.6.0.jar:/usr/share/zookeeper-3.6.2/lib/slf4j-api-1.7.25.jar:/usr/share/zookeeper-3.6.2/lib/slf4j-log4j12-1.7.25.jar:/usr/share/zookeeper-3.6.2/lib/snappy-java-1.1.7.jar:/usr/share/zookeeper-3.6.2/lib/zookeeper-3.6.2.jar:/usr/share/zookeeper-3.6.2/lib/zookeeper-jute-3.6.2.jar:/usr/share/zookeeper-3.6.2/lib/zookeeper-prometheus-metrics-3.6.2.jar:/usr/share/zookeeper-3.6.2/etc\"\n\nZOOCFG=\"$ZOOCFGDIR/zoo.cfg\"\nZOO_LOG_DIR=/var/log/$NAME\nUSER=zookeeper\nGROUP=zookeeper\nPIDDIR=/var/run/$NAME\nPIDFILE=$PIDDIR/$NAME.pid\nSCRIPTNAME=/etc/init.d/$NAME\nJAVA=/usr/local/jdk-11/bin/java\nZOOMAIN=\"org.apache.zookeeper.server.quorum.QuorumPeerMain\"\nZOO_LOG4J_PROP=\"INFO,ROLLINGFILE\"\nJMXLOCALONLY=false\nJAVA_OPTS=\"-Xms{{ '{{' }} cluster.get('xms','128M') {{ '}}' }} \\\n    -Xmx{{ '{{' }} cluster.get('xmx','1G') {{ '}}' }} \\\n    -Xlog:safepoint,gc*=info,age*=debug:file=/var/log/$NAME/zookeeper-gc.log:time,level,tags:filecount=16,filesize=16M\n    -verbose:gc \\\n    -XX:+UseG1GC \\\n    -Djute.maxbuffer=8388608 \\\n    -XX:MaxGCPauseMillis=50\"\n")),(0,a.kt)("p",null,"Salt init:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},"description \"zookeeper-{{ '{{' }} cluster['name'] {{ '}}' }} centralized coordination service\"\n\nstart on runlevel [2345]\nstop on runlevel [!2345]\n\nrespawn\n\nlimit nofile 8192 8192\n\npre-start script\n    [ -r \"/etc/zookeeper-{{ '{{' }} cluster['name'] {{ '}}' }}/conf/environment\" ] || exit 0\n    . /etc/zookeeper-{{ '{{' }} cluster['name'] {{ '}}' }}/conf/environment\n    [ -d $ZOO_LOG_DIR ] || mkdir -p $ZOO_LOG_DIR\n    chown $USER:$GROUP $ZOO_LOG_DIR\nend script\n\nscript\n    . /etc/zookeeper-{{ '{{' }} cluster['name'] {{ '}}' }}/conf/environment\n    [ -r /etc/default/zookeeper ] && . /etc/default/zookeeper\n    if [ -z \"$JMXDISABLE\" ]; then\n        JAVA_OPTS=\"$JAVA_OPTS -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.local.only=$JMXLOCALONLY\"\n    fi\n    exec start-stop-daemon --start -c $USER --exec $JAVA --name zookeeper-{{ '{{' }} cluster['name'] {{ '}}' }} \\\n        -- -cp $CLASSPATH $JAVA_OPTS -Dzookeeper.log.dir=${ZOO_LOG_DIR} \\\n        -Dzookeeper.root.logger=${ZOO_LOG4J_PROP} $ZOOMAIN $ZOOCFG\nend script\n")),(0,a.kt)("h2",{id:"antivirus-software"},"Antivirus software"),(0,a.kt)("p",null,"If you use antivirus software configure it to skip folders with Clickhouse datafiles (",(0,a.kt)("inlineCode",{parentName:"p"},"/var/lib/clickhouse"),") otherwise performance may be reduced and you may experience unexpected errors during data ingestion and background merges."),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://clickhouse.com/docs/en/operations/tips/"},"Original article")))}d.isMDXComponent=!0}}]);