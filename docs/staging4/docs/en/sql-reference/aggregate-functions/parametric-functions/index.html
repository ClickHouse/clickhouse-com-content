<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-en/sql-reference/aggregate-functions/parametric-functions">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<title data-rh="true">Parametric Aggregate Functions | ClickHouse Docs</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://clickhouse.com//docs/staging4/docs/en/sql-reference/aggregate-functions/parametric-functions"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Parametric Aggregate Functions | ClickHouse Docs"><meta data-rh="true" name="description" content="aggregatefunctionsparametric}"><meta data-rh="true" property="og:description" content="aggregatefunctionsparametric}"><link data-rh="true" rel="icon" href="/docs/staging4/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://clickhouse.com//docs/staging4/docs/en/sql-reference/aggregate-functions/parametric-functions"><link data-rh="true" rel="alternate" href="https://clickhouse.com//docs/staging4/docs/en/sql-reference/aggregate-functions/parametric-functions" hreflang="en"><link data-rh="true" rel="alternate" href="https://clickhouse.com//docs/staging4/docs/en/sql-reference/aggregate-functions/parametric-functions" hreflang="x-default"><link rel="stylesheet" href="/docs/staging4/assets/css/styles.83a0a88b.css">
<link rel="preload" href="/docs/staging4/assets/js/runtime~main.1ca91862.js" as="script">
<link rel="preload" href="/docs/staging4/assets/js/main.a46ac117.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_ObN2"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/staging4/docs/"><div class="navbar__logo"><img src="/docs/staging4/img/clickhouse.svg" alt="ClickHouse" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/docs/staging4/img/clickhouse.svg" alt="ClickHouse" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">ClickHouse</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/staging4/docs/intro">Docs</a></div><div class="navbar__items navbar__items--right"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_RiAD sidebarWithHideableNavbar_d0QC"><a tabindex="-1" class="sidebarLogo_YUvz" href="/docs/staging4/docs/"><img src="/docs/staging4/img/clickhouse.svg" alt="ClickHouse" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/docs/staging4/img/clickhouse.svg" alt="ClickHouse" class="themedImage_W2Cr themedImage--dark_oUvU"><b>ClickHouse</b></a><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/staging4/docs/intro">What is ClickHouse?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/staging4/docs/quick-start">Quick Start</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/staging4/docs/tutorial">Tutorial</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/staging4/docs/connect-a-ui">Connect a UI</a><button aria-label="Toggle the collapsible sidebar category &#x27;Connect a UI&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/staging4/docs/integrations">Integrations</a><button aria-label="Toggle the collapsible sidebar category &#x27;Integrations&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/staging4/docs/guides">User Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;User Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/staging4/docs/en">Reference Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;Reference Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/staging4/docs/en/getting-started/install">Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/staging4/docs/en/getting-started/playground">Playground</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/staging4/docs/en/example-datasets">Example Datasets</a><button aria-label="Toggle the collapsible sidebar category &#x27;Example Datasets&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/staging4/docs/en/sql-reference/">SQL Reference</a><button aria-label="Toggle the collapsible sidebar category &#x27;SQL Reference&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/staging4/docs/en/sql-reference/statements/">Statements</a><button aria-label="Toggle the collapsible sidebar category &#x27;Statements&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/staging4/docs/en/sql-reference/syntax">Syntax</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/staging4/docs/en/sql-reference/distributed-ddl">Distributed DDL</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/staging4/docs/en/sql-reference/functions/">Functions</a><button aria-label="Toggle the collapsible sidebar category &#x27;Functions&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/staging4/docs/en/sql-reference/aggregate-functions/">Aggregate Functions</a><button aria-label="Toggle the collapsible sidebar category &#x27;Aggregate Functions&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/staging4/docs/en/sql-reference/aggregate-functions/reference/">List of Aggregate Functions</a><button aria-label="Toggle the collapsible sidebar category &#x27;List of Aggregate Functions&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/staging4/docs/en/sql-reference/aggregate-functions/combinators">Combinators</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/staging4/docs/en/sql-reference/aggregate-functions/parametric-functions">Parametric</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/staging4/docs/en/sql-reference/table-functions/">Table Functions</a><button aria-label="Toggle the collapsible sidebar category &#x27;Table Functions&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/staging4/docs/en/sql-reference/dictionaries/">Dictionaries</a><button aria-label="Toggle the collapsible sidebar category &#x27;Dictionaries&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/staging4/docs/en/sql-reference/data-types/">Data Types</a><button aria-label="Toggle the collapsible sidebar category &#x27;Data Types&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/staging4/docs/en/sql-reference/operators/">Operators</a><button aria-label="Toggle the collapsible sidebar category &#x27;Operators&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/staging4/docs/en/sql-reference/ansi">ANSI Compatibility</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/staging4/docs/en/sql-reference/window-functions/">Window Functions</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/staging4/docs/en/table-engines">Database &amp; Table Engines</a><button aria-label="Toggle the collapsible sidebar category &#x27;Database &amp; Table Engines&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/staging4/docs/en/interfaces/">Interfaces</a><button aria-label="Toggle the collapsible sidebar category &#x27;Interfaces&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/staging4/docs/en/operations/">Operations</a><button aria-label="Toggle the collapsible sidebar category &#x27;Operations&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/staging4/docs/category/building-clickhouse">Building ClickHouse</a><button aria-label="Toggle the collapsible sidebar category &#x27;Building ClickHouse&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/staging4/docs/en/whats-new/">What&#x27;s New</a><button aria-label="Toggle the collapsible sidebar category &#x27;What&#x27;s New&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/staging4/docs/faq/">FAQ</a><button aria-label="Toggle the collapsible sidebar category &#x27;FAQ&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/staging4/docs/about-us">About Us</a><button aria-label="Toggle the collapsible sidebar category &#x27;About Us&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/staging4/docs/en"><span itemprop="name">Reference Guides</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/staging4/docs/en/sql-reference/"><span itemprop="name">SQL Reference</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/staging4/docs/en/sql-reference/aggregate-functions/"><span itemprop="name">Aggregate Functions</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="item name">Parametric</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Parametric Aggregate Functions</h1><p>Some aggregate functions can accept not only argument columns (used for compression), but a set of parameters – constants for initialization. The syntax is two pairs of brackets instead of one. The first is for parameters, and the second is for arguments.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="histogram">histogram<a class="hash-link" href="#histogram" title="Direct link to heading">​</a></h2><p>Calculates an adaptive histogram. It does not guarantee precise results.</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">histogram</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">number_of_bins</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">values</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>The functions uses <a href="http://jmlr.org/papers/volume11/ben-haim10a/ben-haim10a.pdf" target="_blank" rel="noopener noreferrer">A Streaming Parallel Decision Tree Algorithm</a>. The borders of histogram bins are adjusted as new data enters a function. In common case, the widths of bins are not equal.</p><p><strong>Arguments</strong></p><p><code>values</code> — <a href="/docs/staging4/docs/en/sql-reference/syntax#syntax-expressions">Expression</a> resulting in input values.</p><p><strong>Parameters</strong></p><p><code>number_of_bins</code> — Upper limit for the number of bins in the histogram. The function automatically calculates the number of bins. It tries to reach the specified number of bins, but if it fails, it uses fewer bins.</p><p><strong>Returned values</strong></p><ul><li><p><a href="/docs/staging4/docs/en/sql-reference/data-types/array">Array</a> of <a href="/docs/staging4/docs/en/sql-reference/data-types/tuple">Tuples</a> of the following format:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">```</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">[(lower_1, upper_1, height_1), ... (lower_N, upper_N, height_N)]</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">```</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">- `lower` — Lower bound of the bin.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">- `upper` — Upper bound of the bin.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">- `height` — Calculated height of the bin.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li></ul><p><strong>Example</strong></p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> histogram</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">number </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> system</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">numbers</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">┌─histogram(5)(plus(number, 1))───────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ [(1,4.5,4),(4.5,8.5,4),(8.5,12.75,4.125),(12.75,17,4.625),(17,20,3.25)] │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─────────────────────────────────────────────────────────────────────────┘</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>You can visualize a histogram with the <a href="/docs/staging4/docs/en/sql-reference/functions/other-functions#function-bar">bar</a> function, for example:</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">WITH</span><span class="token plain"> histogram</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">rand</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">%</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> hist</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    arrayJoin</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">hist</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token number" style="color:rgb(9, 134, 88)">.3</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> height</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    bar</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">height</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> bar</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> system</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">numbers</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">┌─height─┬─bar───┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  2.125 │ █▋    │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│   3.25 │ ██▌   │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  5.625 │ ████▏ │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  5.625 │ ████▏ │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  3.375 │ ██▌   │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└────────┴───────┘</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>In this case, you should remember that you do not know the histogram bin borders.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="function-sequencematch">sequenceMatch(pattern)(timestamp, cond1, cond2, …)<a class="hash-link" href="#function-sequencematch" title="Direct link to heading">​</a></h2><p>Checks whether the sequence contains an event chain that matches the pattern.</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">sequenceMatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">pattern</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">timestamp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> cond1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> cond2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>Events that occur at the same second may lay in the sequence in an undefined order affecting the result.</p></div></div><p><strong>Arguments</strong></p><ul><li><p><code>timestamp</code> — Column considered to contain time data. Typical data types are <code>Date</code> and <code>DateTime</code>. You can also use any of the supported <a href="/docs/staging4/docs/en/sql-reference/data-types/int-uint">UInt</a> data types.</p></li><li><p><code>cond1</code>, <code>cond2</code> — Conditions that describe the chain of events. Data type: <code>UInt8</code>. You can pass up to 32 condition arguments. The function takes only the events described in these conditions into account. If the sequence contains data that isn’t described in a condition, the function skips them.</p></li></ul><p><strong>Parameters</strong></p><ul><li><code>pattern</code> — Pattern string. See <a href="#sequence-function-pattern-syntax">Pattern syntax</a>.</li></ul><p><strong>Returned values</strong></p><ul><li>1, if the pattern is matched.</li><li>0, if the pattern isn’t matched.</li></ul><p>Type: <code>UInt8</code>.</p><a name="sequence-function-pattern-syntax"></a>**Pattern syntax**<ul><li><p><code>(?N)</code> — Matches the condition argument at position <code>N</code>. Conditions are numbered in the <code>[1, 32]</code> range. For example, <code>(?1)</code> matches the argument passed to the <code>cond1</code> parameter.</p></li><li><p><code>.*</code> — Matches any number of events. You do not need conditional arguments to match this element of the pattern.</p></li><li><p><code>(?t operator value)</code> — Sets the time in seconds that should separate two events. For example, pattern <code>(?1)(?t&gt;1800)(?2)</code> matches events that occur more than 1800 seconds from each other. An arbitrary number of any events can lay between these events. You can use the <code>&gt;=</code>, <code>&gt;</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>==</code> operators.</p></li></ul><p><strong>Examples</strong></p><p>Consider data in the <code>t</code> table:</p><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">┌─time─┬─number─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│    1 │      1 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│    2 │      3 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│    3 │      2 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└──────┴────────┘</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Perform the query:</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> sequenceMatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;(?1)(?2)&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> number </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> number </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> t</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">┌─sequenceMatch(&#x27;(?1)(?2)&#x27;)(time, equals(number, 1), equals(number, 2))─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                                                                     1 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└───────────────────────────────────────────────────────────────────────┘</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>The function found the event chain where number 2 follows number 1. It skipped number 3 between them, because the number is not described as an event. If we want to take this number into account when searching for the event chain given in the example, we should make a condition for it.</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> sequenceMatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;(?1)(?2)&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> number </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> number </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> number </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> t</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">┌─sequenceMatch(&#x27;(?1)(?2)&#x27;)(time, equals(number, 1), equals(number, 2), equals(number, 3))─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                                                                                        0 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└──────────────────────────────────────────────────────────────────────────────────────────┘</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>In this case, the function couldn’t find the event chain matching the pattern, because the event for number 3 occurred between 1 and 2. If in the same case we checked the condition for number 4, the sequence would match the pattern.</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> sequenceMatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;(?1)(?2)&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> number </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> number </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> number </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> t</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">┌─sequenceMatch(&#x27;(?1)(?2)&#x27;)(time, equals(number, 1), equals(number, 2), equals(number, 4))─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                                                                                        1 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└──────────────────────────────────────────────────────────────────────────────────────────┘</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><strong>See Also</strong></p><ul><li><a href="#function-sequencecount">sequenceCount</a></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="function-sequencecount">sequenceCount(pattern)(time, cond1, cond2, …)<a class="hash-link" href="#function-sequencecount" title="Direct link to heading">​</a></h2><p>Counts the number of event chains that matched the pattern. The function searches event chains that do not overlap. It starts to search for the next chain after the current chain is matched.</p><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>Events that occur at the same second may lay in the sequence in an undefined order affecting the result.</p></div></div><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">sequenceCount</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">pattern</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">timestamp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> cond1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> cond2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><strong>Arguments</strong></p><ul><li><p><code>timestamp</code> — Column considered to contain time data. Typical data types are <code>Date</code> and <code>DateTime</code>. You can also use any of the supported <a href="/docs/staging4/docs/en/sql-reference/data-types/int-uint">UInt</a> data types.</p></li><li><p><code>cond1</code>, <code>cond2</code> — Conditions that describe the chain of events. Data type: <code>UInt8</code>. You can pass up to 32 condition arguments. The function takes only the events described in these conditions into account. If the sequence contains data that isn’t described in a condition, the function skips them.</p></li></ul><p><strong>Parameters</strong></p><ul><li><code>pattern</code> — Pattern string. See <a href="#sequence-function-pattern-syntax">Pattern syntax</a>.</li></ul><p><strong>Returned values</strong></p><ul><li>Number of non-overlapping event chains that are matched.</li></ul><p>Type: <code>UInt64</code>.</p><p><strong>Example</strong></p><p>Consider data in the <code>t</code> table:</p><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">┌─time─┬─number─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│    1 │      1 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│    2 │      3 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│    3 │      2 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│    4 │      1 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│    5 │      3 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│    6 │      2 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└──────┴────────┘</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Count how many times the number 2 occurs after the number 1 with any amount of other numbers between them:</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> sequenceCount</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;(?1).*(?2)&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> number </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> number </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> t</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">┌─sequenceCount(&#x27;(?1).*(?2)&#x27;)(time, equals(number, 1), equals(number, 2))─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                                                                       2 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─────────────────────────────────────────────────────────────────────────┘</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><strong>See Also</strong></p><ul><li><a href="#function-sequencematch">sequenceMatch</a></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="windowfunnel">windowFunnel<a class="hash-link" href="#windowfunnel" title="Direct link to heading">​</a></h2><p>Searches for event chains in a sliding time window and calculates the maximum number of events that occurred from the chain.</p><p>The function works according to the algorithm:</p><ul><li><p>The function searches for data that triggers the first condition in the chain and sets the event counter to 1. This is the moment when the sliding window starts.</p></li><li><p>If events from the chain occur sequentially within the window, the counter is incremented. If the sequence of events is disrupted, the counter isn’t incremented.</p></li><li><p>If the data has multiple event chains at varying points of completion, the function will only output the size of the longest chain.</p></li></ul><p><strong>Syntax</strong></p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">windowFunnel</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token keyword" style="color:rgb(0, 0, 255)">mode</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token keyword" style="color:rgb(0, 0, 255)">mode</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">timestamp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> cond1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> cond2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> condN</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><strong>Arguments</strong></p><ul><li><code>timestamp</code> — Name of the column containing the timestamp. Data types supported: <a href="/docs/staging4/docs/en/sql-reference/data-types/date">Date</a>, <a href="/docs/staging4/docs/en/sql-reference/data-types/datetime#data_type-datetime">DateTime</a> and other unsigned integer types (note that even though timestamp supports the <code>UInt64</code> type, it’s value can’t exceed the Int64 maximum, which is 2^63 - 1).</li><li><code>cond</code> — Conditions or data describing the chain of events. <a href="/docs/staging4/docs/en/sql-reference/data-types/int-uint">UInt8</a>.</li></ul><p><strong>Parameters</strong></p><ul><li><code>window</code> — Length of the sliding window, it is the time interval between the first and the last condition. The unit of <code>window</code> depends on the <code>timestamp</code> itself and varies. Determined using the expression <code>timestamp of cond1 &lt;= timestamp of cond2 &lt;= ... &lt;= timestamp of condN &lt;= timestamp of cond1 + window</code>.</li><li><code>mode</code> — It is an optional argument. One or more modes can be set.<ul><li><code>&#x27;strict_deduplication&#x27;</code> — If the same condition holds for the sequence of events, then such repeating event interrupts further processing.</li><li><code>&#x27;strict_order&#x27;</code> — Don&#x27;t allow interventions of other events. E.g. in the case of <code>A-&gt;B-&gt;D-&gt;C</code>, it stops finding <code>A-&gt;B-&gt;C</code> at the <code>D</code> and the max event level is 2.</li><li><code>&#x27;strict_increase&#x27;</code> — Apply conditions only to events with strictly increasing timestamps.</li></ul></li></ul><p><strong>Returned value</strong></p><p>The maximum number of consecutive triggered conditions from the chain within the sliding time window.
All the chains in the selection are analyzed.</p><p>Type: <code>Integer</code>.</p><p><strong>Example</strong></p><p>Determine if a set period of time is enough for the user to select a phone and purchase it twice in the online store.</p><p>Set the following chain of events:</p><ol><li>The user logged in to their account on the store (<code>eventID = 1003</code>).</li><li>The user searches for a phone (<code>eventID = 1007, product = &#x27;phone&#x27;</code>).</li><li>The user placed an order (<code>eventID = 1009</code>).</li><li>The user made the order again (<code>eventID = 1010</code>).</li></ol><p>Input table:</p><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">┌─event_date─┬─user_id─┬───────────timestamp─┬─eventID─┬─product─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2019-01-28 │       1 │ 2019-01-29 10:00:00 │    1003 │ phone   │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└────────────┴─────────┴─────────────────────┴─────────┴─────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─event_date─┬─user_id─┬───────────timestamp─┬─eventID─┬─product─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2019-01-31 │       1 │ 2019-01-31 09:00:00 │    1007 │ phone   │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└────────────┴─────────┴─────────────────────┴─────────┴─────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─event_date─┬─user_id─┬───────────timestamp─┬─eventID─┬─product─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2019-01-30 │       1 │ 2019-01-30 08:00:00 │    1009 │ phone   │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└────────────┴─────────┴─────────────────────┴─────────┴─────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─event_date─┬─user_id─┬───────────timestamp─┬─eventID─┬─product─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2019-02-01 │       1 │ 2019-02-01 08:00:00 │    1010 │ phone   │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└────────────┴─────────┴─────────────────────┴─────────┴─────────┘</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Find out how far the user <code>user_id</code> could get through the chain in a period in January-February of 2019.</p><p>Query:</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">level</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> c</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        user_id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        windowFunnel</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">6048000000000000</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">timestamp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> eventID </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1003</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> eventID </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1009</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> eventID </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1007</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> eventID </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1010</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">level</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> trend</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">event_date </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2019-01-01&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">event_date </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2019-02-02&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> user_id</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">level</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">level</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Result:</p><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">┌─level─┬─c─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│     4 │ 1 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└───────┴───┘</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="retention">retention<a class="hash-link" href="#retention" title="Direct link to heading">​</a></h2><p>The function takes as arguments a set of conditions from 1 to 32 arguments of type <code>UInt8</code> that indicate whether a certain condition was met for the event.
Any condition can be specified as an argument (as in <a href="/docs/staging4/docs/en/sql-reference/statements/select/where#select-where">WHERE</a>).</p><p>The conditions, except the first, apply in pairs: the result of the second will be true if the first and second are true, of the third if the first and third are true, etc.</p><p><strong>Syntax</strong></p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">retention</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">cond1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> cond2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> cond32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><strong>Arguments</strong></p><ul><li><code>cond</code> — An expression that returns a <code>UInt8</code> result (1 or 0).</li></ul><p><strong>Returned value</strong></p><p>The array of 1 or 0.</p><ul><li>1 — Condition was met for the event.</li><li>0 — Condition wasn’t met for the event.</li></ul><p>Type: <code>UInt8</code>.</p><p><strong>Example</strong></p><p>Let’s consider an example of calculating the <code>retention</code> function to determine site traffic.</p><p><strong>1.</strong> Сreate a table to illustrate an example.</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">TABLE</span><span class="token plain"> retention_test</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">date</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">Date</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> uid Int32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ENGINE</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> Memory</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">INTO</span><span class="token plain"> retention_test </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-01&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> number </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> numbers</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">INTO</span><span class="token plain"> retention_test </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-02&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> number </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> numbers</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">INTO</span><span class="token plain"> retention_test </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-03&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> number </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> numbers</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">15</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Input table:</p><p>Query:</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> retention_test</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Result:</p><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">┌───────date─┬─uid─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-01 │   0 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-01 │   1 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-01 │   2 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-01 │   3 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-01 │   4 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└────────────┴─────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌───────date─┬─uid─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-02 │   0 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-02 │   1 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-02 │   2 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-02 │   3 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-02 │   4 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-02 │   5 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-02 │   6 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-02 │   7 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-02 │   8 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-02 │   9 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└────────────┴─────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌───────date─┬─uid─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-03 │   0 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-03 │   1 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-03 │   2 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-03 │   3 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-03 │   4 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-03 │   5 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-03 │   6 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-03 │   7 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-03 │   8 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-03 │   9 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-03 │  10 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-03 │  11 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-03 │  12 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-03 │  13 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 2020-01-03 │  14 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└────────────┴─────┘</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><strong>2.</strong> Group users by unique ID <code>uid</code> using the <code>retention</code> function.</p><p>Query:</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    uid</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    retention</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">date</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-01&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">date</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-02&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">date</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-03&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> r</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> retention_test</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">date</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-01&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-02&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-03&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> uid</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> uid </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Result:</p><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">┌─uid─┬─r───────┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│   0 │ [1,1,1] │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│   1 │ [1,1,1] │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│   2 │ [1,1,1] │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│   3 │ [1,1,1] │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│   4 │ [1,1,1] │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│   5 │ [0,0,0] │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│   6 │ [0,0,0] │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│   7 │ [0,0,0] │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│   8 │ [0,0,0] │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│   9 │ [0,0,0] │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  10 │ [0,0,0] │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  11 │ [0,0,0] │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  12 │ [0,0,0] │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  13 │ [0,0,0] │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  14 │ [0,0,0] │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─────┴─────────┘</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><strong>3.</strong> Calculate the total number of site visits per day.</p><p>Query:</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">r</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> r1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">r</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> r2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">r</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> r3</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        uid</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        retention</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">date</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-01&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">date</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-02&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">date</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-03&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> r</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> retention_test</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">date</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-01&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-02&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2020-01-03&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> uid</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Result:</p><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">┌─r1─┬─r2─┬─r3─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  5 │  5 │  5 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└────┴────┴────┘</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Where:</p><ul><li><code>r1</code>- the number of unique visitors who visited the site during 2020-01-01 (the <code>cond1</code> condition).</li><li><code>r2</code>- the number of unique visitors who visited the site during a specific time period between 2020-01-01 and 2020-01-02 (<code>cond1</code> and <code>cond2</code> conditions).</li><li><code>r3</code>- the number of unique visitors who visited the site during a specific time period between 2020-01-01 and 2020-01-03 (<code>cond1</code> and <code>cond3</code> conditions).</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="uniquptonx">uniqUpTo(N)(x)<a class="hash-link" href="#uniquptonx" title="Direct link to heading">​</a></h2><p>Calculates the number of different argument values ​​if it is less than or equal to N. If the number of different argument values is greater than N, it returns N + 1.</p><p>Recommended for use with small Ns, up to 10. The maximum value of N is 100.</p><p>For the state of an aggregate function, it uses the amount of memory equal to 1 + N <!-- -->*<!-- --> the size of one value of bytes.
For strings, it stores a non-cryptographic hash of 8 bytes. That is, the calculation is approximated for strings.</p><p>The function also works for several arguments.</p><p>It works as fast as possible, except for cases when a large N value is used and the number of unique values is slightly less than N.</p><p>Usage example:</p><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">Problem: Generate a report that shows only keywords that produced at least 5 unique users.</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Solution: Write in the GROUP BY query SearchPhrase HAVING uniqUpTo(4)(UserID) &gt;= 5</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="summapfilteredkeys-to-keepkeys-values">sumMapFiltered(keys_to_keep)(keys, values)<a class="hash-link" href="#summapfilteredkeys-to-keepkeys-values" title="Direct link to heading">​</a></h2><p>Same behavior as <a href="/docs/staging4/docs/en/sql-reference/aggregate-functions/reference/summap#agg_functions-summap">sumMap</a> except that an array of keys is passed as a parameter. This can be especially useful when working with a high cardinality of keys.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="sequenceNextNode">sequenceNextNode<a class="hash-link" href="#sequenceNextNode" title="Direct link to heading">​</a></h2><p>Returns a value of the next event that matched an event chain.</p><p><em>Experimental function, <code>SET allow_experimental_funnel_functions = 1</code> to enable it.</em></p><p><strong>Syntax</strong></p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">sequenceNextNode</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">direction</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> base</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">timestamp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> event_column</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> base_condition</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> event1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> event2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> event3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><strong>Parameters</strong></p><ul><li><p><code>direction</code> — Used to navigate to directions.</p><ul><li>forward — Moving forward.</li><li>backward — Moving backward.</li></ul></li><li><p><code>base</code> — Used to set the base point.</p><ul><li>head — Set the base point to the first event.</li><li>tail — Set the base point to the last event.</li><li>first_match — Set the base point to the first matched <code>event1</code>.</li><li>last_match — Set the base point to the last matched <code>event1</code>.</li></ul></li></ul><p><strong>Arguments</strong></p><ul><li><code>timestamp</code> — Name of the column containing the timestamp. Data types supported: <a href="/docs/staging4/docs/en/sql-reference/data-types/date">Date</a>, <a href="/docs/staging4/docs/en/sql-reference/data-types/datetime#data_type-datetime">DateTime</a> and other unsigned integer types.</li><li><code>event_column</code> — Name of the column containing the value of the next event to be returned. Data types supported: <a href="/docs/staging4/docs/en/sql-reference/data-types/string">String</a> and <a href="/docs/staging4/docs/en/sql-reference/data-types/nullable">Nullable(String)</a>.</li><li><code>base_condition</code> — Condition that the base point must fulfill.</li><li><code>event1</code>, <code>event2</code>, ... — Conditions describing the chain of events. <a href="/docs/staging4/docs/en/sql-reference/data-types/int-uint">UInt8</a>.</li></ul><p><strong>Returned values</strong></p><ul><li><code>event_column[next_index]</code> — If the pattern is matched and next value exists.</li><li><code>NULL</code> - If the pattern isn’t matched or next value doesn&#x27;t exist.</li></ul><p>Type: <a href="/docs/staging4/docs/en/sql-reference/data-types/nullable">Nullable(String)</a>.</p><p><strong>Example</strong></p><p>It can be used when events are A-&gt;B-&gt;C-&gt;D-&gt;E and you want to know the event following B-&gt;C, which is D.</p><p>The query statement searching the event following A-&gt;B:</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">TABLE</span><span class="token plain"> test_flow </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    dt </span><span class="token keyword" style="color:rgb(0, 0, 255)">DateTime</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    id </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    page String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ENGINE</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> MergeTree</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> toYYYYMMDD</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">dt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">INTO</span><span class="token plain"> test_flow </span><span class="token keyword" style="color:rgb(0, 0, 255)">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;A&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;B&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;C&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;D&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;E&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> sequenceNextNode</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;forward&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;head&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">dt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;A&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;A&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;B&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> next_flow </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> test_flow </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Result:</p><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token plain">┌─id─┬─next_flow─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  1 │ C         │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└────┴───────────┘</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><strong>Behavior for <code>forward</code> and <code>head</code></strong></p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">ALTER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">TABLE</span><span class="token plain"> test_flow </span><span class="token keyword" style="color:rgb(0, 0, 255)">DELETE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> settings mutations_sync </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">INTO</span><span class="token plain"> test_flow </span><span class="token keyword" style="color:rgb(0, 0, 255)">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Home&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Gift&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Exit&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">INTO</span><span class="token plain"> test_flow </span><span class="token keyword" style="color:rgb(0, 0, 255)">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Home&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Home&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Gift&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Basket&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">INTO</span><span class="token plain"> test_flow </span><span class="token keyword" style="color:rgb(0, 0, 255)">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Gift&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Home&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Gift&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Basket&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> sequenceNextNode</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;forward&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;head&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">dt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Home&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Home&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Gift&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> test_flow </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                  dt   id   page</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   Home </span><span class="token comment" style="color:rgb(0, 128, 0)">// Base point, Matched with Home</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   Gift </span><span class="token comment" style="color:rgb(0, 128, 0)">// Matched with Gift</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   </span><span class="token keyword" style="color:rgb(0, 0, 255)">Exit</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// The result</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">   Home </span><span class="token comment" style="color:rgb(0, 128, 0)">// Base point, Matched with Home</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">   Home </span><span class="token comment" style="color:rgb(0, 128, 0)">// Unmatched with Gift</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">   Gift</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">   Basket</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">   Gift </span><span class="token comment" style="color:rgb(0, 128, 0)">// Base point, Unmatched with Home</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">   Home</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">   Gift</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">   Basket</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><strong>Behavior for <code>backward</code> and <code>tail</code></strong></p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> sequenceNextNode</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;backward&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;tail&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">dt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Basket&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Basket&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Gift&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> test_flow </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                 dt   id   page</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   Home</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   Gift</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   </span><span class="token keyword" style="color:rgb(0, 0, 255)">Exit</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// Base point, Unmatched with Basket</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">   Home</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">   Home </span><span class="token comment" style="color:rgb(0, 128, 0)">// The result</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">   Gift </span><span class="token comment" style="color:rgb(0, 128, 0)">// Matched with Gift</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">   Basket </span><span class="token comment" style="color:rgb(0, 128, 0)">// Base point, Matched with Basket</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">   Gift</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">   Home </span><span class="token comment" style="color:rgb(0, 128, 0)">// The result</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">   Gift </span><span class="token comment" style="color:rgb(0, 128, 0)">// Base point, Matched with Gift</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">   Basket </span><span class="token comment" style="color:rgb(0, 128, 0)">// Base point, Matched with Basket</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><strong>Behavior for <code>forward</code> and <code>first_match</code></strong></p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> sequenceNextNode</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;forward&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;first_match&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">dt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Gift&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Gift&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> test_flow </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                 dt   id   page</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   Home</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   Gift </span><span class="token comment" style="color:rgb(0, 128, 0)">// Base point</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   </span><span class="token keyword" style="color:rgb(0, 0, 255)">Exit</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// The result</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">   Home</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">   Home</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">   Gift </span><span class="token comment" style="color:rgb(0, 128, 0)">// Base point</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">   Basket  The result</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">   Gift </span><span class="token comment" style="color:rgb(0, 128, 0)">// Base point</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">   Home </span><span class="token comment" style="color:rgb(0, 128, 0)">// The result</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">   Gift</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">   Basket</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> sequenceNextNode</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;forward&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;first_match&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">dt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Gift&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Gift&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Home&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> test_flow </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                 dt   id   page</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   Home</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   Gift </span><span class="token comment" style="color:rgb(0, 128, 0)">// Base point</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   </span><span class="token keyword" style="color:rgb(0, 0, 255)">Exit</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// Unmatched with Home</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">   Home</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">   Home</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">   Gift </span><span class="token comment" style="color:rgb(0, 128, 0)">// Base point</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">   Basket </span><span class="token comment" style="color:rgb(0, 128, 0)">// Unmatched with Home</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">   Gift </span><span class="token comment" style="color:rgb(0, 128, 0)">// Base point</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">   Home </span><span class="token comment" style="color:rgb(0, 128, 0)">// Matched with Home</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">   Gift </span><span class="token comment" style="color:rgb(0, 128, 0)">// The result</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">   Basket</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><strong>Behavior for <code>backward</code> and <code>last_match</code></strong></p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> sequenceNextNode</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;backward&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;last_match&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">dt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Gift&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Gift&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> test_flow </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                 dt   id   page</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   Home </span><span class="token comment" style="color:rgb(0, 128, 0)">// The result</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   Gift </span><span class="token comment" style="color:rgb(0, 128, 0)">// Base point</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   </span><span class="token keyword" style="color:rgb(0, 0, 255)">Exit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">   Home</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">   Home </span><span class="token comment" style="color:rgb(0, 128, 0)">// The result</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">   Gift </span><span class="token comment" style="color:rgb(0, 128, 0)">// Base point</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">   Basket</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">   Gift</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">   Home </span><span class="token comment" style="color:rgb(0, 128, 0)">// The result</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">   Gift </span><span class="token comment" style="color:rgb(0, 128, 0)">// Base point</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">   Basket</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> sequenceNextNode</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;backward&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;last_match&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">dt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Gift&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Gift&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Home&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> test_flow </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                 dt   id   page</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   Home </span><span class="token comment" style="color:rgb(0, 128, 0)">// Matched with Home, the result is null</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   Gift </span><span class="token comment" style="color:rgb(0, 128, 0)">// Base point</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   </span><span class="token keyword" style="color:rgb(0, 0, 255)">Exit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">   Home </span><span class="token comment" style="color:rgb(0, 128, 0)">// The result</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">   Home </span><span class="token comment" style="color:rgb(0, 128, 0)">// Matched with Home</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">   Gift </span><span class="token comment" style="color:rgb(0, 128, 0)">// Base point</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain">   Basket</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">   Gift </span><span class="token comment" style="color:rgb(0, 128, 0)">// The result</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">   Home </span><span class="token comment" style="color:rgb(0, 128, 0)">// Matched with Home</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">   Gift </span><span class="token comment" style="color:rgb(0, 128, 0)">// Base point</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">   Basket</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><strong>Behavior for <code>base_condition</code></strong></p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">TABLE</span><span class="token plain"> test_flow_basecond</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">dt</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">DateTime</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">id</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">int</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">page</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token plain"> String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token identifier">ref</span><span class="token identifier punctuation" style="color:rgb(4, 81, 165)">`</span><span class="token plain"> String</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ENGINE</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> MergeTree</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> toYYYYMMDD</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">dt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">INTO</span><span class="token plain"> test_flow_basecond </span><span class="token keyword" style="color:rgb(0, 0, 255)">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;A&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;ref4&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;A&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;ref3&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;B&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;ref2&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;B&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;ref1&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> sequenceNextNode</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;forward&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;head&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">dt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> ref </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;ref1&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;A&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> test_flow_basecond </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                  dt   id   page   ref</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   A      ref4 </span><span class="token comment" style="color:rgb(0, 128, 0)">// The head can not be base point because the ref column of the head unmatched with &#x27;ref1&#x27;.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   A      ref3</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   B      ref2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   B      ref1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> sequenceNextNode</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;backward&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;tail&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">dt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> ref </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;ref4&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;B&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> test_flow_basecond </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                  dt   id   page   ref</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   A      ref4</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   A      ref3</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   B      ref2</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   B      ref1 </span><span class="token comment" style="color:rgb(0, 128, 0)">// The tail can not be base point because the ref column of the tail unmatched with &#x27;ref4&#x27;.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> sequenceNextNode</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;forward&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;first_match&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">dt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> ref </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;ref3&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;A&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> test_flow_basecond </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                  dt   id   page   ref</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   A      ref4 </span><span class="token comment" style="color:rgb(0, 128, 0)">// This row can not be base point because the ref column unmatched with &#x27;ref3&#x27;.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   A      ref3 </span><span class="token comment" style="color:rgb(0, 128, 0)">// Base point</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   B      ref2 </span><span class="token comment" style="color:rgb(0, 128, 0)">// The result</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   B      ref1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx" style="color:#000000;background-color:#ffffff"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> sequenceNextNode</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;backward&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;last_match&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">dt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> ref </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;ref2&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> page </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;B&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> test_flow_basecond </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                  dt   id   page   ref</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   A      ref4</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   A      ref3 </span><span class="token comment" style="color:rgb(0, 128, 0)">// The result</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   B      ref2 </span><span class="token comment" style="color:rgb(0, 128, 0)">// Base point</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1970</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token plain">    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">   B      ref1 </span><span class="token comment" style="color:rgb(0, 128, 0)">// This row can not be base point because the ref column unmatched with &#x27;ref2&#x27;.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/staging4/docs/en/sql-reference/aggregate-functions/combinators"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Combinators</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/staging4/docs/en/sql-reference/table-functions/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Table Functions</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#histogram" class="table-of-contents__link toc-highlight">histogram</a></li><li><a href="#function-sequencematch" class="table-of-contents__link toc-highlight">sequenceMatch(pattern)(timestamp, cond1, cond2, …)</a></li><li><a href="#function-sequencecount" class="table-of-contents__link toc-highlight">sequenceCount(pattern)(time, cond1, cond2, …)</a></li><li><a href="#windowfunnel" class="table-of-contents__link toc-highlight">windowFunnel</a></li><li><a href="#retention" class="table-of-contents__link toc-highlight">retention</a></li><li><a href="#uniquptonx" class="table-of-contents__link toc-highlight">uniqUpTo(N)(x)</a></li><li><a href="#summapfilteredkeys-to-keepkeys-values" class="table-of-contents__link toc-highlight">sumMapFiltered(keys_to_keep)(keys, values)</a></li><li><a href="#sequenceNextNode" class="table-of-contents__link toc-highlight">sequenceNextNode</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">ClickHouse</div><ul class="footer__items"><li class="footer__item"><a href="https://clickhouse.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Company</a></li><li class="footer__item"><a href="https://clickhouse.com/cloud/" target="_blank" rel="noopener noreferrer" class="footer__link-item">ClickHouse as a Service</a></li><li class="footer__item"><a href="https://clickhouse.com/careers/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Careers</a></li><li class="footer__item"><a href="https://clickhouse.com/learn/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Learn ClickHouse</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/ClickHouse/ClickHouse" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://clickhouse.com/blog/en/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/c/ClickHouseDB" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/ClickHouseDB" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://join.slack.com/t/clickhousedb/shared_invite/zt-rxm3rdrk-lIUmhLC3V8WTaL0TGxsOmg" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Policies</div><ul class="footer__items"><li class="footer__item"><a href="https://clickhouse.com/legal/trademark-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Trademark Policy</a></li><li class="footer__item"><a href="https://clickhouse.com/legal/privacy-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy Policy</a></li><li class="footer__item"><a href="https://clickhouse.com/legal/cookie-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cookie Policy</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/docs/staging4/img/logo.png" alt="ClickHouse Documentation" class="themedImage_W2Cr themedImage--light_TfLj footer__logo"><img src="/docs/staging4/img/logo.png" alt="ClickHouse Documentation" class="themedImage_W2Cr themedImage--dark_oUvU footer__logo"></div><div class="footer__copyright">Copyright © 2016 - 2022 ClickHouse, Inc. ClickHouse Docs provided under the Creative Commons CC BY-NC-SA license. ClickHouse is a registered trademark of ClickHouse, Inc.</div></div></div></footer></div>
<script src="/docs/staging4/assets/js/runtime~main.1ca91862.js"></script>
<script src="/docs/staging4/assets/js/main.a46ac117.js"></script>
</body>
</html>