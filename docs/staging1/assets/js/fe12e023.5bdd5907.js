"use strict";(self.webpackChunkclickhouse=self.webpackChunkclickhouse||[]).push([[91703],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return d}});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var o=r.createContext({}),u=function(e){var t=r.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=u(e.components);return r.createElement(o.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,s=e.originalType,o=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),m=u(n),d=a,f=m["".concat(o,".").concat(d)]||m[d]||p[d]||s;return n?r.createElement(f,i(i({ref:t},c),{},{components:n})):r.createElement(f,i({ref:t},c))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var s=n.length,i=new Array(s);i[0]=m;var l={};for(var o in t)hasOwnProperty.call(t,o)&&(l[o]=t[o]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var u=2;u<s;u++)i[u]=n[u];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},47087:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return o},default:function(){return d},frontMatter:function(){return l},metadata:function(){return u},toc:function(){return p}});var r=n(87462),a=n(63366),s=(n(67294),n(3905)),i=["components"],l={sidebar_position:46,sidebar_label:"KILL"},o="KILL Statements",u={unversionedId:"en/sql-reference/statements/kill",id:"en/sql-reference/statements/kill",title:"KILL Statements",description:"kill-statements}",source:"@site/docs/en/sql-reference/statements/kill.md",sourceDirName:"en/sql-reference/statements",slug:"/en/sql-reference/statements/kill",permalink:"/docs/staging1/docs/en/sql-reference/statements/kill",tags:[],version:"current",sidebarPosition:46,frontMatter:{sidebar_position:46,sidebar_label:"KILL"},sidebar:"tutorialSidebar",previous:{title:"EXISTS",permalink:"/docs/staging1/docs/en/sql-reference/statements/exists"},next:{title:"OPTIMIZE",permalink:"/docs/staging1/docs/en/sql-reference/statements/optimize"}},c={},p=[{value:"KILL QUERY",id:"kill-query-statement",level:2},{value:"KILL MUTATION",id:"kill-mutation",level:2}],m={toc:p};function d(e){var t=e.components,n=(0,a.Z)(e,i);return(0,s.kt)("wrapper",(0,r.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"kill-statements"},"KILL Statements"),(0,s.kt)("p",null,"There are two kinds of kill statements: to kill a query and to kill a mutation"),(0,s.kt)("h2",{id:"kill-query-statement"},"KILL QUERY"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},"KILL QUERY [ON CLUSTER cluster]\n  WHERE <where expression to SELECT FROM system.processes query>\n  [SYNC|ASYNC|TEST]\n  [FORMAT format]\n")),(0,s.kt)("p",null,"Attempts to forcibly terminate the currently running queries.\nThe queries to terminate are selected from the system.processes table using the criteria defined in the ",(0,s.kt)("inlineCode",{parentName:"p"},"WHERE")," clause of the ",(0,s.kt)("inlineCode",{parentName:"p"},"KILL")," query."),(0,s.kt)("p",null,"Examples:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},"-- Forcibly terminates all queries with the specified query_id:\nKILL QUERY WHERE query_id='2-857d-4a57-9ee0-327da5d60a90'\n\n-- Synchronously terminates all queries run by 'username':\nKILL QUERY WHERE user='username' SYNC\n")),(0,s.kt)("p",null,"Read-only users can only stop their own queries."),(0,s.kt)("p",null,"By default, the asynchronous version of queries is used (",(0,s.kt)("inlineCode",{parentName:"p"},"ASYNC"),"), which does not wait for confirmation that queries have stopped."),(0,s.kt)("p",null,"The synchronous version (",(0,s.kt)("inlineCode",{parentName:"p"},"SYNC"),") waits for all queries to stop and displays information about each process as it stops.\nThe response contains the ",(0,s.kt)("inlineCode",{parentName:"p"},"kill_status")," column, which can take the following values:"),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("inlineCode",{parentName:"li"},"finished")," \u2013 The query was terminated successfully."),(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("inlineCode",{parentName:"li"},"waiting")," \u2013 Waiting for the query to end after sending it a signal to terminate."),(0,s.kt)("li",{parentName:"ol"},"The other values \u200b\u200bexplain why the query can\u2019t be stopped.")),(0,s.kt)("p",null,"A test query (",(0,s.kt)("inlineCode",{parentName:"p"},"TEST"),") only checks the user\u2019s rights and displays a list of queries to stop."),(0,s.kt)("h2",{id:"kill-mutation"},"KILL MUTATION"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},"KILL MUTATION [ON CLUSTER cluster]\n  WHERE <where expression to SELECT FROM system.mutations query>\n  [TEST]\n  [FORMAT format]\n")),(0,s.kt)("p",null,"Tries to cancel and remove ",(0,s.kt)("a",{parentName:"p",href:"/docs/staging1/docs/en/sql-reference/statements/alter/#alter-mutations"},"mutations")," that are currently executing. Mutations to cancel are selected from the ",(0,s.kt)("a",{parentName:"p",href:"/docs/staging1/docs/en/operations/system-tables/mutations#system_tables-mutations"},(0,s.kt)("inlineCode",{parentName:"a"},"system.mutations"))," table using the filter specified by the ",(0,s.kt)("inlineCode",{parentName:"p"},"WHERE")," clause of the ",(0,s.kt)("inlineCode",{parentName:"p"},"KILL")," query."),(0,s.kt)("p",null,"A test query (",(0,s.kt)("inlineCode",{parentName:"p"},"TEST"),") only checks the user\u2019s rights and displays a list of mutations to stop."),(0,s.kt)("p",null,"Examples:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sql"},"-- Cancel and remove all mutations of the single table:\nKILL MUTATION WHERE database = 'default' AND table = 'table'\n\n-- Cancel the specific mutation:\nKILL MUTATION WHERE database = 'default' AND table = 'table' AND mutation_id = 'mutation_3.txt'\n")),(0,s.kt)("p",null,"The query is useful when a mutation is stuck and cannot finish (e.g.\xa0if some function in the mutation query throws an exception when applied to the data contained in the table)."),(0,s.kt)("p",null,"Changes already made by the mutation are not rolled back."))}d.isMDXComponent=!0}}]);