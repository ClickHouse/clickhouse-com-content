










    



    



    



    
    






    <!doctype html>
<html ⚡ lang="en">
  <head>
    <meta charset="utf-8">
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    <title>2022 | ClickHouse Documentation</title>
    <link rel="canonical" href="https://clickhouse.com/docs/en/whats-new/changelog/" />
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    
<script type="application/ld+json">[{
"@context": "http://schema.org",
"@type": "TechArticle",
"headline": "2022 | ClickHouse Documentation",
"mainEntityOfPage": "https://clickhouse.com/docs/en/whats-new/changelog/",




"image": "https://clickhouse.com/images/clickhouse-209x60.png",
"author": {
  "@type": "Project",
  "name": "ClickHouse"
},
"publisher": {
  "@type": "Organization",
  "name": "ClickHouse, Inc.",
  "logo": {
    "@type": "ImageObject",
    "url": "https://clickhouse.com/images/logo-400x240.png",
    "width": 400,
    "height": 240
  }
}}, {
"@context": "http://schema.org",
"@type": "Episode",
"name": "2022 | ClickHouse Documentation",
"aggregateRating": {
  "@type": "AggregateRating",
  "ratingValue": RATING_VALUE,
  "ratingCount": RATING_COUNT
}
}]</script>

    
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <style amp-custom>:root{--blue:#007bff;--indigo:#6610f2;--purple:#6f42c1;--pink:#e83e8c;--red:#dc3545;--orange:#fd7e14;--yellow:#ffc107;--green:#28a745;--teal:#20c997;--cyan:#17a2b8;--gray:#6c757d;--gray-dark:#343a40;--brand-primary:#fc0;--brand-secondary:#ff3939;--primary-accent-yellow:#fc0;--primary-accent-light-yellow:#fffaf0;--primary-accent-blue:#257af4;--primary-accent-light-blue:#e3f1fe;--secondary-accent-orange:#ff8c00;--secondary-accent-light-orange:#ffe4b5;--secondary-accent-red:#ff3939;--secondary-accent-light-red:#ffe4e1;--primary:#fc0;--secondary:#212529;--success:#28a745;--info:#17a2b8;--warning:#ffc107;--danger:#dc3545;--light:#f1f6f9;--dark:#495057;--primary-light:#fffaf0;--secondary-light:#fff;--tertiary:#257af4;--tertiary-light:#e3f1fe;--white:#fff;--black:#212529;--blue:#257af4;--light-blue:#e3f1fe;--yellow:#fc0;--light-yellow:#fffaf0;--orange:#ff8c00;--light-orange:#ffe4b5;--red:#ff3939;--light-red:#ffe4e1;--medium:#d6dbdf;--breakpoint-xxs:0;--breakpoint-xs:400px;--breakpoint-sm:616px;--breakpoint-md:768px;--breakpoint-lg:980px;--breakpoint-xl:1240px;--font-family-sans-serif:"Noto Sans",sans-serif;--font-family-monospace:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}*,:after,:before{box-sizing:border-box}html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:rgba(33,37,41,0)}article,footer{display:block}body{margin:0;font-family:Noto Sans,sans-serif;font-size:1rem;font-weight:400;line-height:1.5;color:#212529;text-align:left;background-color:#fff}[tabindex="-1"]:focus:not(:focus-visible){outline:0}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:16px}p{margin-top:0;margin-bottom:1rem}address{font-style:normal;line-height:inherit}address,ul{margin-bottom:1rem}ul{margin-top:0}ul ul{margin-bottom:0}b{font-weight:bolder}small{font-size:80%}a{text-decoration:none;background-color:transparent}a,a:hover{color:#ff8c00}a:hover{text-decoration:underline}a:not([href]),a:not([href]):hover{color:inherit;text-decoration:none}code{font-family:SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em}img{border-style:none}img,svg{vertical-align:middle}svg{overflow:hidden}table{border-collapse:collapse}input,select{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}input{overflow:visible}select{text-transform:none}select{word-wrap:normal}[type=button],[type=reset],[type=submit]{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled){cursor:pointer}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{padding:0;border-style:none}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=date],input[type=datetime-local],input[type=month],input[type=time]{-webkit-appearance:listbox}progress{vertical-align:baseline}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:none}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}template{display:none}[hidden]{display:none}.h1,.h2,.h3,.h4,.h5,.h6,h1,h2,h3,h4,h5,h6{margin-bottom:16px;font-family:Hind Siliguri,sans-serif;font-weight:500;line-height:1.125}.h1,h1{font-size:2.5rem}@media(max-width:1200px){.h1,h1{font-size:calc(1.375rem+1.5vw)}}.h2,h2{font-size:2rem}@media(max-width:1200px){.h2,h2{font-size:calc(1.325rem+.9vw)}}.h3,h3{font-size:1.75rem}@media(max-width:1200px){.h3,h3{font-size:calc(1.3rem+.6vw)}}.h4,h4{font-size:1.5rem}@media(max-width:1200px){.h4,h4{font-size:calc(1.275rem+.3vw)}}.h5,h5{font-size:1.125rem}.h6,h6{font-size:.875rem}.lead{font-size:1.375rem;font-weight:400}@media(max-width:1200px){.lead{font-size:calc(1.2625rem+.15vw)}}.display-1{font-size:4rem;font-weight:600;line-height:1.125}@media(max-width:1200px){.display-1{font-size:calc(1.525rem+3.3vw)}}.display-2{font-size:2.5rem;font-weight:600;line-height:1.125}@media(max-width:1200px){.display-2{font-size:calc(1.375rem+1.5vw)}}.display-3{font-size:2rem;font-weight:500;line-height:1.125}@media(max-width:1200px){.display-3{font-size:calc(1.325rem+.9vw)}}.display-4{font-size:1.75rem;font-weight:500;line-height:1.125}@media(max-width:1200px){.display-4{font-size:calc(1.3rem+.6vw)}}.small,small{font-size:80%;font-weight:400}.list-inline{padding-left:0;list-style:none}.img-fluid{max-width:100%;height:auto}code{font-size:87.5%;color:#e83e8c;word-wrap:break-word}a>code{color:inherit}.container{width:100%;padding-right:20px;padding-left:20px;margin-right:auto;margin-left:auto}@media(min-width:400px){.container{max-width:576px}}@media(min-width:616px){.container{max-width:576px}}@media(min-width:768px){.container{max-width:958px}}@media(min-width:980px){.container{max-width:1008px}}@media(min-width:1240px){.container{max-width:1118px}}.container-fluid,.container-lg,.container-md{width:100%;padding-right:20px;padding-left:20px;margin-right:auto;margin-left:auto}@media(min-width:400px){.container{max-width:576px}}@media(min-width:616px){.container{max-width:576px}}@media(min-width:768px){.container,.container-md{max-width:958px}}@media(min-width:980px){.container,.container-lg,.container-md{max-width:1008px}}@media(min-width:1240px){.container,.container-lg,.container-md{max-width:1118px}}.row{display:flex;flex-wrap:wrap;margin-right:-20px;margin-left:-20px}.col,.col-1,.col-10,.col-11,.col-12,.col-2,.col-3,.col-4,.col-5,.col-6,.col-7,.col-8,.col-9,.col-auto,.col-lg,.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-lg-auto,.col-md,.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9,.col-md-auto{position:relative;width:100%;padding-right:20px;padding-left:20px}.col{flex-basis:0;flex-grow:1;max-width:100%}.col-auto{flex:0 0 auto;width:auto;max-width:100%}.col-1{flex:0 0 8.3333333333%;max-width:8.3333333333%}.col-2{flex:0 0 16.6666666667%;max-width:16.6666666667%}.col-3{flex:0 0 25%;max-width:25%}.col-4{flex:0 0 33.3333333333%;max-width:33.3333333333%}.col-5{flex:0 0 41.6666666667%;max-width:41.6666666667%}.col-6{flex:0 0 50%;max-width:50%}.col-7{flex:0 0 58.3333333333%;max-width:58.3333333333%}.col-8{flex:0 0 66.6666666667%;max-width:66.6666666667%}.col-9{flex:0 0 75%;max-width:75%}.col-10{flex:0 0 83.3333333333%;max-width:83.3333333333%}.col-11{flex:0 0 91.6666666667%;max-width:91.6666666667%}.col-12{flex:0 0 100%;max-width:100%}.order-0{order:0}.order-1{order:1}.order-2{order:2}.order-3{order:3}.order-4{order:4}.order-5{order:5}.order-6{order:6}.order-7{order:7}.order-8{order:8}.order-9{order:9}.order-10{order:10}.order-11{order:11}.order-12{order:12}.offset-1{margin-left:8.3333333333%}.offset-2{margin-left:16.6666666667%}.offset-3{margin-left:25%}.offset-4{margin-left:33.3333333333%}.offset-5{margin-left:41.6666666667%}.offset-6{margin-left:50%}.offset-7{margin-left:58.3333333333%}.offset-8{margin-left:66.6666666667%}.offset-9{margin-left:75%}.offset-10{margin-left:83.3333333333%}.offset-11{margin-left:91.6666666667%}@media(min-width:768px){.col-md{flex-basis:0;flex-grow:1;max-width:100%}.col-md-auto{flex:0 0 auto;width:auto;max-width:100%}.col-md-1{flex:0 0 8.3333333333%;max-width:8.3333333333%}.col-md-2{flex:0 0 16.6666666667%;max-width:16.6666666667%}.col-md-3{flex:0 0 25%;max-width:25%}.col-md-4{flex:0 0 33.3333333333%;max-width:33.3333333333%}.col-md-5{flex:0 0 41.6666666667%;max-width:41.6666666667%}.col-md-6{flex:0 0 50%;max-width:50%}.col-md-7{flex:0 0 58.3333333333%;max-width:58.3333333333%}.col-md-8{flex:0 0 66.6666666667%;max-width:66.6666666667%}.col-md-9{flex:0 0 75%;max-width:75%}.col-md-10{flex:0 0 83.3333333333%;max-width:83.3333333333%}.col-md-11{flex:0 0 91.6666666667%;max-width:91.6666666667%}.col-md-12{flex:0 0 100%;max-width:100%}.order-md-0{order:0}.order-md-1{order:1}.order-md-2{order:2}.order-md-3{order:3}.order-md-4{order:4}.order-md-5{order:5}.order-md-6{order:6}.order-md-7{order:7}.order-md-8{order:8}.order-md-9{order:9}.order-md-10{order:10}.order-md-11{order:11}.order-md-12{order:12}.offset-md-0{margin-left:0}.offset-md-1{margin-left:8.3333333333%}.offset-md-2{margin-left:16.6666666667%}.offset-md-3{margin-left:25%}.offset-md-4{margin-left:33.3333333333%}.offset-md-5{margin-left:41.6666666667%}.offset-md-6{margin-left:50%}.offset-md-7{margin-left:58.3333333333%}.offset-md-8{margin-left:66.6666666667%}.offset-md-9{margin-left:75%}.offset-md-10{margin-left:83.3333333333%}.offset-md-11{margin-left:91.6666666667%}}@media(min-width:980px){.col-lg{flex-basis:0;flex-grow:1;max-width:100%}.col-lg-auto{flex:0 0 auto;width:auto;max-width:100%}.col-lg-1{flex:0 0 8.3333333333%;max-width:8.3333333333%}.col-lg-2{flex:0 0 16.6666666667%;max-width:16.6666666667%}.col-lg-3{flex:0 0 25%;max-width:25%}.col-lg-4{flex:0 0 33.3333333333%;max-width:33.3333333333%}.col-lg-5{flex:0 0 41.6666666667%;max-width:41.6666666667%}.col-lg-6{flex:0 0 50%;max-width:50%}.col-lg-7{flex:0 0 58.3333333333%;max-width:58.3333333333%}.col-lg-8{flex:0 0 66.6666666667%;max-width:66.6666666667%}.col-lg-9{flex:0 0 75%;max-width:75%}.col-lg-10{flex:0 0 83.3333333333%;max-width:83.3333333333%}.col-lg-11{flex:0 0 91.6666666667%;max-width:91.6666666667%}.col-lg-12{flex:0 0 100%;max-width:100%}.order-lg-0{order:0}.order-lg-1{order:1}.order-lg-2{order:2}.order-lg-3{order:3}.order-lg-4{order:4}.order-lg-5{order:5}.order-lg-6{order:6}.order-lg-7{order:7}.order-lg-8{order:8}.order-lg-9{order:9}.order-lg-10{order:10}.order-lg-11{order:11}.order-lg-12{order:12}.offset-lg-0{margin-left:0}.offset-lg-1{margin-left:8.3333333333%}.offset-lg-2{margin-left:16.6666666667%}.offset-lg-3{margin-left:25%}.offset-lg-4{margin-left:33.3333333333%}.offset-lg-5{margin-left:41.6666666667%}.offset-lg-6{margin-left:50%}.offset-lg-7{margin-left:58.3333333333%}.offset-lg-8{margin-left:66.6666666667%}.offset-lg-9{margin-left:75%}.offset-lg-10{margin-left:83.3333333333%}.offset-lg-11{margin-left:91.6666666667%}}.table{width:100%;margin-bottom:8px;color:#212529}.table-primary{background-color:#fff1b8}.table-info{background-color:#bee5eb}.table-light{background-color:#fbfcfd}.table-dark{background-color:#ccced0}.table-primary-light{background-color:#fffefb}.table-white{background-color:#fff}.table-black{background-color:#c1c2c3}.table-orange{background-color:#ffdfb8}.table-light-orange{background-color:#fff7ea}.table-dark{color:#fff;background-color:#343a40}.form-control{display:block;width:100%;height:calc(1.5em+.75rem+2px);padding:.375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#6c757d;background-color:#fff;background-clip:padding-box;border:1px solid #ced4da;border-radius:8px;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media(prefers-reduced-motion:reduce){.form-control{transition:none}}.form-control::-ms-expand{background-color:transparent;border:0}.form-control:-moz-focusring{color:transparent;text-shadow:0 0 0 #6c757d}.form-control:focus{color:#6c757d;background-color:#fff;border-color:#ffe680;outline:0;box-shadow:0 0 0 .2rem rgba(255,204,0,.25)}.form-control::-moz-placeholder{color:#6c757d;opacity:1}.form-control:-ms-input-placeholder{color:#6c757d;opacity:1}.form-control::placeholder{color:#6c757d;opacity:1}.form-control:disabled,.form-control[readonly]{background-color:#e9ecef;opacity:1}select.form-control:focus::-ms-value{color:#6c757d;background-color:#fff}.form-control-file,.form-control-range{display:block;width:100%}.form-control-lg{height:calc(1.5em+1rem+2px);padding:.5rem 1rem;font-size:1.125rem;line-height:1.5;border-radius:8px}select.form-control[multiple],select.form-control[size]{height:auto}.form-group{margin-bottom:1rem}.form-text{display:block;margin-top:.25rem}.form-row{display:flex;flex-wrap:wrap;margin-right:-5px;margin-left:-5px}.form-row>.col,.form-row>[class*=col-]{padding-right:5px;padding-left:5px}.form-check{position:relative;display:block;padding-left:1.25rem}.form-check-input{position:absolute;margin-top:.3rem;margin-left:-1.25rem}.form-check-inline{display:inline-flex;align-items:center;padding-left:0;margin-right:.75rem}.form-check-inline .form-check-input{position:static;margin-top:0;margin-right:.3125rem;margin-left:0}.form-control.is-invalid{border-color:#dc3545;padding-right:calc(1.5em+.75rem);background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='none' stroke='%23dc3545'%3E%3Ccircle cx='6' cy='6' r='4.5'/%3E%3Cpath stroke-linejoin='round' d='M5.8 3.6h.4L6 6.5z'/%3E%3Ccircle cx='6' cy='8.2' r='.6' fill='%23dc3545' stroke='none'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right calc(.375em+.1875rem) center;background-size:calc(.75em+.375rem) calc(.75em+.375rem)}.form-control.is-invalid:focus{border-color:#dc3545;box-shadow:0 0 0 .2rem rgba(220,53,69,.25)}.custom-select.is-invalid{border-color:#dc3545;padding-right:calc(.75em+2.3125rem);background:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='4' height='5'%3E%3Cpath fill='%23343a40' d='M2 0L0 2h4zm0 5L0 3h4z'/%3E%3C/svg%3E") no-repeat right .75rem center/8px 10px,url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='none' stroke='%23dc3545'%3E%3Ccircle cx='6' cy='6' r='4.5'/%3E%3Cpath stroke-linejoin='round' d='M5.8 3.6h.4L6 6.5z'/%3E%3Ccircle cx='6' cy='8.2' r='.6' fill='%23dc3545' stroke='none'/%3E%3C/svg%3E") #fff no-repeat center right 1.75rem/calc(.75em+.375rem) calc(.75em+.375rem)}.custom-select.is-invalid:focus{border-color:#dc3545;box-shadow:0 0 0 .2rem rgba(220,53,69,.25)}.form-inline{display:flex;flex-flow:row wrap;align-items:center}.form-inline .form-check{width:100%}@media(min-width:616px){.form-inline .form-group{display:flex;align-items:center;margin-bottom:0}.form-inline .form-group{flex:0 0 auto;flex-flow:row wrap}.form-inline .form-control{display:inline-block;width:auto;vertical-align:middle}.form-inline .custom-select,.form-inline .input-group{width:auto}.form-inline .form-check{display:flex;align-items:center;justify-content:center;width:auto;padding-left:0}.form-inline .form-check-input{position:relative;flex-shrink:0;margin-top:0;margin-right:.25rem;margin-left:0}.form-inline .custom-control{align-items:center;justify-content:center}}.btn{display:inline-block;font-family:inherit;font-weight:700;color:#212529;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;padding:12px 32px;font-size:.875rem;line-height:20px;border-radius:8px;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media(prefers-reduced-motion:reduce){.btn{transition:none}}.btn:hover{color:#212529;text-decoration:none}.btn:focus{outline:0;box-shadow:none}.btn:disabled{opacity:.65}.btn-primary{color:#495057;background-color:#fc0;border-color:#fc0}.btn-primary:focus,.btn-primary:hover{color:#495057;background-color:#d9ad00;border-color:#cca300}.btn-primary:focus{box-shadow:0 0 0 0 rgba(228,185,13,.5)}.btn-primary:disabled{color:#495057;background-color:#fc0;border-color:#fc0}.btn-info{color:#fff;background-color:#17a2b8;border-color:#17a2b8}.btn-info:focus,.btn-info:hover{color:#fff;background-color:#138496;border-color:#117a8b}.btn-info:focus{box-shadow:0 0 0 0 rgba(58,176,195,.5)}.btn-info:disabled{color:#fff;background-color:#17a2b8;border-color:#17a2b8}.btn-light{color:#495057;background-color:#f1f6f9;border-color:#f1f6f9}.btn-light:focus,.btn-light:hover{color:#495057;background-color:#d6e5ee;border-color:#cddfea}.btn-light:focus{box-shadow:0 0 0 0 rgba(216,221,225,.5)}.btn-light:disabled{color:#495057;background-color:#f1f6f9;border-color:#f1f6f9}.btn-dark{color:#fff;background-color:#495057;border-color:#495057}.btn-dark:focus,.btn-dark:hover{color:#fff;background-color:#383d42;border-color:#32373b}.btn-dark:focus{box-shadow:0 0 0 0 rgba(100,106,112,.5)}.btn-dark:disabled{color:#fff;background-color:#495057;border-color:#495057}.btn-primary-light{color:#495057;background-color:#fffaf0;border-color:#fffaf0}.btn-primary-light:focus,.btn-primary-light:hover{color:#495057;background-color:#ffedca;border-color:#ffe9bd}.btn-primary-light:focus{box-shadow:0 0 0 0 rgba(228,225,217,.5)}.btn-primary-light:disabled{color:#495057;background-color:#fffaf0;border-color:#fffaf0}.btn-white{color:#495057;background-color:#fff;border-color:#fff}.btn-white:focus,.btn-white:hover{color:#495057;background-color:#ececec;border-color:#e6e6e6}.btn-white:focus{box-shadow:0 0 0 0 rgba(228,229,230,.5)}.btn-white:disabled{color:#495057;background-color:#fff;border-color:#fff}.btn-black{color:#fff;background-color:#212529;border-color:#212529}.btn-black:focus,.btn-black:hover{color:#fff;background-color:#101214;border-color:#0a0c0d}.btn-black:focus{box-shadow:0 0 0 0 rgba(66,70,73,.5)}.btn-black:disabled{color:#fff;background-color:#212529;border-color:#212529}.btn-orange{color:#495057;background-color:#ff8c00;border-color:#ff8c00}.btn-orange:focus,.btn-orange:hover{color:#fff;background-color:#d97700;border-color:#cc7000}.btn-orange:focus{box-shadow:0 0 0 0 rgba(228,131,13,.5)}.btn-orange:disabled{color:#495057;background-color:#ff8c00;border-color:#ff8c00}.btn-light-orange{color:#495057;background-color:#ffe4b5;border-color:#ffe4b5}.btn-light-orange:focus,.btn-light-orange:hover{color:#495057;background-color:#ffd68f;border-color:#ffd182}.btn-light-orange:focus{box-shadow:0 0 0 0 rgba(228,206,167,.5)}.btn-light-orange:disabled{color:#495057;background-color:#ffe4b5;border-color:#ffe4b5}.btn-outline-primary{color:#fc0;border-color:#fc0}.btn-outline-primary:hover{color:#495057;background-color:#fc0;border-color:#fc0}.btn-outline-primary:focus{box-shadow:0 0 0 0 rgba(255,204,0,.5)}.btn-outline-primary:disabled{color:#fc0;background-color:transparent}.btn-outline-info{color:#17a2b8;border-color:#17a2b8}.btn-outline-info:hover{color:#fff;background-color:#17a2b8;border-color:#17a2b8}.btn-outline-info:focus{box-shadow:0 0 0 0 rgba(23,162,184,.5)}.btn-outline-info:disabled{color:#17a2b8;background-color:transparent}.btn-outline-light{color:#f1f6f9;border-color:#f1f6f9}.btn-outline-light:hover{color:#495057;background-color:#f1f6f9;border-color:#f1f6f9}.btn-outline-light:focus{box-shadow:0 0 0 0 rgba(241,246,249,.5)}.btn-outline-light:disabled{color:#f1f6f9;background-color:transparent}.btn-outline-dark{color:#495057;border-color:#495057}.btn-outline-dark:hover{color:#fff;background-color:#495057;border-color:#495057}.btn-outline-dark:focus{box-shadow:0 0 0 0 rgba(73,80,87,.5)}.btn-outline-dark:disabled{color:#495057;background-color:transparent}.btn-outline-primary-light{color:#fffaf0;border-color:#fffaf0}.btn-outline-primary-light:hover{color:#495057;background-color:#fffaf0;border-color:#fffaf0}.btn-outline-primary-light:focus{box-shadow:0 0 0 0 rgba(255,250,240,.5)}.btn-outline-primary-light:disabled{color:#fffaf0;background-color:transparent}.btn-outline-white{color:#fff;border-color:#fff}.btn-outline-white:hover{color:#495057;background-color:#fff;border-color:#fff}.btn-outline-white:focus{box-shadow:0 0 0 0 hsla(0,0%,100%,.5)}.btn-outline-white:disabled{color:#fff;background-color:transparent}.btn-outline-black{color:#212529;border-color:#212529}.btn-outline-black:hover{color:#fff;background-color:#212529;border-color:#212529}.btn-outline-black:focus{box-shadow:0 0 0 0 rgba(33,37,41,.5)}.btn-outline-black:disabled{color:#212529;background-color:transparent}.btn-outline-orange{color:#ff8c00;border-color:#ff8c00}.btn-outline-orange:hover{color:#495057;background-color:#ff8c00;border-color:#ff8c00}.btn-outline-orange:focus{box-shadow:0 0 0 0 rgba(255,140,0,.5)}.btn-outline-orange:disabled{color:#ff8c00;background-color:transparent}.btn-outline-light-orange{color:#ffe4b5;border-color:#ffe4b5}.btn-outline-light-orange:hover{color:#495057;background-color:#ffe4b5;border-color:#ffe4b5}.btn-outline-light-orange:focus{box-shadow:0 0 0 0 rgba(255,228,181,.5)}.btn-outline-light-orange:disabled{color:#ffe4b5;background-color:transparent}.btn-link{font-weight:400;color:#ff8c00;text-decoration:none}.btn-link:hover{color:#ff8c00;text-decoration:underline}.btn-link:focus{text-decoration:underline;box-shadow:none}.btn-link:disabled{color:#d6dbdf;pointer-events:none}.btn-group-lg>.btn,.btn-lg{padding:16px 32px;font-size:1.125rem;line-height:26px;border-radius:8px}.btn-block{display:block;width:100%}.btn-block+.btn-block{margin-top:24px}input[type=button].btn-block,input[type=reset].btn-block,input[type=submit].btn-block{width:100%}.btn-group{position:relative;display:inline-flex;vertical-align:middle}.btn-group>.btn{position:relative;flex:1 1 auto}.btn-group>.btn:active,.btn-group>.btn:focus,.btn-group>.btn:hover{z-index:1}.btn-group>.btn-group:not(:first-child),.btn-group>.btn:not(:first-child){margin-left:-1px}.btn-group>.btn-group:not(:last-child)>.btn{border-top-right-radius:0;border-bottom-right-radius:0}.btn-group>.btn-group:not(:first-child)>.btn,.btn-group>.btn:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.input-group{position:relative;display:flex;flex-wrap:wrap;align-items:stretch;width:100%}.input-group>.custom-file,.input-group>.custom-select,.input-group>.form-control{position:relative;flex:1 1 0;min-width:0;margin-bottom:0}.input-group>.custom-file+.custom-file,.input-group>.custom-file+.custom-select,.input-group>.custom-file+.form-control,.input-group>.custom-select+.custom-file,.input-group>.custom-select+.custom-select,.input-group>.custom-select+.form-control,.input-group>.form-control+.custom-file,.input-group>.form-control+.custom-select,.input-group>.form-control+.form-control{margin-left:-1px}.input-group>.custom-select:focus,.input-group>.form-control:focus{z-index:3}.input-group>.custom-file .custom-file-input:focus{z-index:4}.input-group>.custom-select:not(:last-child),.input-group>.form-control:not(:last-child){border-top-right-radius:0;border-bottom-right-radius:0}.input-group>.custom-select:not(:first-child),.input-group>.form-control:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.input-group>.custom-file{display:flex;align-items:center}.input-group-text{display:flex;align-items:center;padding:.375rem .75rem;margin-bottom:0;font-size:1rem;font-weight:400;line-height:1.5;color:#6c757d;text-align:center;white-space:nowrap;background-color:#e9ecef;border:1px solid #ced4da;border-radius:8px}.input-group-text input[type=checkbox],.input-group-text input[type=radio]{margin-top:0}.input-group-lg>.custom-select,.input-group-lg>.form-control:not(textarea){height:calc(1.5em+1rem+2px)}.input-group-lg>.custom-select,.input-group-lg>.form-control{padding:.5rem 1rem;font-size:1.125rem;line-height:1.5;border-radius:8px}.input-group-lg>.custom-select{padding-right:1.75rem}.custom-control{position:relative;display:block;min-height:1.5rem;padding-left:1.5rem}.custom-control-inline{display:inline-flex;margin-right:1rem}.custom-control-input{position:absolute;left:0;z-index:-1;width:1rem;height:1.25rem;opacity:0}.custom-select{display:inline-block;width:100%;height:calc(1.5em+.75rem+2px);padding:.375rem 1.75rem .375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#6c757d;vertical-align:middle;background:#fff url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='4' height='5'%3E%3Cpath fill='%23343a40' d='M2 0L0 2h4zm0 5L0 3h4z'/%3E%3C/svg%3E") no-repeat right .75rem center/8px 10px;border:1px solid #ced4da;border-radius:8px;-webkit-appearance:none;-moz-appearance:none;appearance:none}.custom-select:focus{border-color:#ffe680;outline:0;box-shadow:0 0 0 .2rem rgba(255,204,0,.25)}.custom-select:focus::-ms-value{color:#6c757d;background-color:#fff}.custom-select[multiple],.custom-select[size]:not([size="1"]){height:auto;padding-right:.75rem;background-image:none}.custom-select:disabled{color:#6c757d;background-color:#e9ecef}.custom-select::-ms-expand{display:none}.custom-select:-moz-focusring{color:transparent;text-shadow:0 0 0 #6c757d}.custom-select-lg{height:calc(1.5em+1rem+2px);padding-top:.5rem;padding-bottom:.5rem;padding-left:1rem;font-size:1.125rem}.custom-file{display:inline-block;margin-bottom:0}.custom-file,.custom-file-input{position:relative;width:100%;height:calc(1.5em+.75rem+2px)}.custom-file-input{z-index:2;margin:0;opacity:0}.custom-range{width:100%;height:1.4rem;padding:0;background-color:transparent;-webkit-appearance:none;-moz-appearance:none;appearance:none}.custom-range:focus{outline:0}.custom-range:focus::-webkit-slider-thumb{box-shadow:0 0 0 1px #fff,0 0 0 .2rem rgba(255,204,0,.25)}.custom-range:focus::-moz-range-thumb{box-shadow:0 0 0 1px #fff,0 0 0 .2rem rgba(255,204,0,.25)}.custom-range:focus::-ms-thumb{box-shadow:0 0 0 1px #fff,0 0 0 .2rem rgba(255,204,0,.25)}.custom-range::-moz-focus-outer{border:0}.custom-range::-webkit-slider-thumb{width:1rem;height:1rem;margin-top:-.25rem;background-color:#fc0;border:0;border-radius:1rem;-webkit-transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;-webkit-appearance:none;appearance:none}@media(prefers-reduced-motion:reduce){.custom-range::-webkit-slider-thumb{-webkit-transition:none;transition:none}}.custom-range::-webkit-slider-thumb:active{background-color:#fff0b3}.custom-range::-webkit-slider-runnable-track{width:100%;height:.5rem;color:transparent;cursor:pointer;background-color:#dee2e6;border-color:transparent;border-radius:1rem}.custom-range::-moz-range-thumb{width:1rem;height:1rem;background-color:#fc0;border:0;border-radius:1rem;-moz-transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;-moz-appearance:none;appearance:none}@media(prefers-reduced-motion:reduce){.custom-range::-moz-range-thumb{-moz-transition:none;transition:none}}.custom-range::-moz-range-thumb:active{background-color:#fff0b3}.custom-range::-moz-range-track{width:100%;height:.5rem;color:transparent;cursor:pointer;background-color:#dee2e6;border-color:transparent;border-radius:1rem}.custom-range::-ms-thumb{width:1rem;height:1rem;margin-top:0;margin-right:.2rem;margin-left:.2rem;background-color:#fc0;border:0;border-radius:1rem;-ms-transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;appearance:none}@media(prefers-reduced-motion:reduce){.custom-range::-ms-thumb{-ms-transition:none;transition:none}}.custom-range::-ms-thumb:active{background-color:#fff0b3}.custom-range::-ms-track{width:100%;height:.5rem;color:transparent;cursor:pointer;background-color:transparent;border-color:transparent;border-width:.5rem}.custom-range::-ms-fill-lower,.custom-range::-ms-fill-upper{background-color:#dee2e6;border-radius:1rem}.custom-range::-ms-fill-upper{margin-right:15px}.custom-range:disabled::-webkit-slider-thumb{background-color:#d6dbdf}.custom-range:disabled::-webkit-slider-runnable-track{cursor:default}.custom-range:disabled::-moz-range-thumb{background-color:#d6dbdf}.custom-range:disabled::-moz-range-track{cursor:default}.custom-range:disabled::-ms-thumb{background-color:#d6dbdf}.custom-select{transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media(prefers-reduced-motion:reduce){.custom-select{transition:none}}img{page-break-inside:avoid}h2,h3,p{orphans:3;widows:3}h2,h3{page-break-after:avoid}@page{size:a3}.container,body{min-width:980px}.table{border-collapse:collapse}.table-dark{color:inherit}</style>
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    <script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>
  </head>
  <body class="amp" dir="ltr">
    <div class="container-fluid container-lg pb-5">
      <div class="row pt-3 mb-3">
        <div class="col">
          <a href="/" class="text-decoration-none">
            <amp-img class="d-inline-block mr-3" layout="fixed" width="40" height="36" src="/images/logo.svg" alt="ClickHouse logo" title="ClickHouse logo"></amp-img><amp-img class="invert-dark d-inline-block" layout="fixed" width="238" height="36" src="/images/clickhouse-black.svg" alt="ClickHouse" title="ClickHouse"></amp-img>
          </a>
        </div>
      </div>
      <div class="row">
        <div id="content" class="col">
          
          <h3 id=clickhouse-release-v22-1-2022-01-18>ClickHouse release v22.1, 2022-01-18<a class=headerlink href=../amp/#clickhouse-release-v22-1-2022-01-18 title="Permanent link"> </a></h3> <h4 id=upgrade-notes>Upgrade Notes<a class=headerlink href=../amp/#upgrade-notes title="Permanent link"> </a></h4> <ul> <li>The functions <code class=syntax>left</code> and <code class=syntax>right</code> were previously implemented in parser and now full-featured. Distributed queries with <code class=syntax>left</code> or <code class=syntax>right</code> functions without aliases may throw exception if cluster contains different versions of clickhouse-server. If you are upgrading your cluster and encounter this error, you should finish upgrading your cluster to ensure all nodes have the same version. Also you can add aliases (<code class=syntax>AS something</code>) to the columns in your queries to avoid this issue. <a href=https://github.com/ClickHouse/ClickHouse/pull/33407 rel="external nofollow noreferrer" target=_blank>#33407</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer" target=_blank>alexey-milovidov</a>).</li> <li>Resource usage by scalar subqueries is fully accounted since this version. With this change, rows read in scalar subqueries are now reported in the query_log. If the scalar subquery is cached (repeated or called for several rows) the rows read are only counted once. This change allows KILLing queries and reporting progress while they are executing scalar subqueries. <a href=https://github.com/ClickHouse/ClickHouse/pull/32271 rel="external nofollow noreferrer" target=_blank>#32271</a> (<a href=https://github.com/Algunenano rel="external nofollow noreferrer" target=_blank>Raúl Marín</a>).</li> </ul> <h4 id=new-feature>New Feature<a class=headerlink href=../amp/#new-feature title="Permanent link"> </a></h4> <ul> <li>Implement data schema inference for input formats. Allow to skip structure (or write just <code class=syntax>auto</code>) in table functions <code class=syntax>file</code>, <code class=syntax>url</code>, <code class=syntax>s3</code>, <code class=syntax>hdfs</code> and in parameters of <code class=syntax>clickhouse-local</code> . Allow to skip structure in create query for table engines <code class=syntax>File</code>, <code class=syntax>HDFS</code>, <code class=syntax>S3</code>, <code class=syntax>URL</code>, <code class=syntax>Merge</code>, <code class=syntax>Buffer</code>, <code class=syntax>Distributed</code> and <code class=syntax>ReplicatedMergeTree</code> (if we add new replicas). <a href=https://github.com/ClickHouse/ClickHouse/pull/32455 rel="external nofollow noreferrer" target=_blank>#32455</a> (<a href=https://github.com/Avogar rel="external nofollow noreferrer" target=_blank>Kruglov Pavel</a>).</li> <li>Detect format by file extension in <code class=syntax>file</code>/<code class=syntax>hdfs</code>/<code class=syntax>s3</code>/<code class=syntax>url</code> table functions and <code class=syntax>HDFS</code>/<code class=syntax>S3</code>/<code class=syntax>URL</code> table engines and also for <code class=syntax>SELECT INTO OUTFILE</code> and <code class=syntax>INSERT FROM INFILE</code> <a href=https://github.com/ClickHouse/ClickHouse/pull/33565 rel="external nofollow noreferrer" target=_blank>#33565</a> (<a href=https://github.com/Avogar rel="external nofollow noreferrer" target=_blank>Kruglov Pavel</a>). Close <a href=https://github.com/ClickHouse/ClickHouse/issues/30918 rel="external nofollow noreferrer" target=_blank>#30918</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33443 rel="external nofollow noreferrer" target=_blank>#33443</a> (<a href=https://github.com/zhongyuankai rel="external nofollow noreferrer" target=_blank>OnePiece</a>).</li> <li>A tool for collecting diagnostics data if you need support. <a href=https://github.com/ClickHouse/ClickHouse/pull/33175 rel="external nofollow noreferrer" target=_blank>#33175</a> (<a href=https://github.com/Alex-Burmak rel="external nofollow noreferrer" target=_blank>Alexander Burmak</a>).</li> <li>Automatic cluster discovery via Zoo/Keeper. It allows to add replicas to the cluster without changing configuration on every server. <a href=https://github.com/ClickHouse/ClickHouse/pull/31442 rel="external nofollow noreferrer" target=_blank>#31442</a> (<a href=https://github.com/vdimir rel="external nofollow noreferrer" target=_blank>vdimir</a>).</li> <li>Implement hive table engine to access apache hive from clickhouse. This implements: <a href=https://github.com/ClickHouse/ClickHouse/issues/29245 rel="external nofollow noreferrer" target=_blank>#29245</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/31104 rel="external nofollow noreferrer" target=_blank>#31104</a> (<a href=https://github.com/taiyang-li rel="external nofollow noreferrer" target=_blank>taiyang-li</a>).</li> <li>Add aggregate functions <code class=syntax>cramersV</code>, <code class=syntax>cramersVBiasCorrected</code>, <code class=syntax>theilsU</code> and <code class=syntax>contingency</code>. These functions calculate dependency (measure of association) between categorical values. All these functions are using cross-tab (histogram on pairs) for implementation. You can imagine it like a correlation coefficient but for any discrete values (not necessary numbers). <a href=https://github.com/ClickHouse/ClickHouse/pull/33366 rel="external nofollow noreferrer" target=_blank>#33366</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer" target=_blank>alexey-milovidov</a>). Initial implementation by <a href=https://github.com/Vanyok-All-is-OK rel="external nofollow noreferrer" target=_blank>Vanyok-All-is-OK</a> and <a href=https://github.com/antikvist rel="external nofollow noreferrer" target=_blank>antikvist</a>.</li> <li>Added table function <code class=syntax>hdfsCluster</code> which allows processing files from HDFS in parallel from many nodes in a specified cluster, similarly to <code class=syntax>s3Cluster</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/32400 rel="external nofollow noreferrer" target=_blank>#32400</a> (<a href=https://github.com/yuzhichang rel="external nofollow noreferrer" target=_blank>Zhichang Yu</a>).</li> <li>Adding support for disks backed by Azure Blob Storage, in a similar way it has been done for disks backed by AWS S3. <a href=https://github.com/ClickHouse/ClickHouse/pull/31505 rel="external nofollow noreferrer" target=_blank>#31505</a> (<a href=https://github.com/jkuklis rel="external nofollow noreferrer" target=_blank>Jakub Kuklis</a>).</li> <li>Allow <code class=syntax>COMMENT</code> in <code class=syntax>CREATE VIEW</code> (for all VIEW kinds). <a href=https://github.com/ClickHouse/ClickHouse/pull/31062 rel="external nofollow noreferrer" target=_blank>#31062</a> (<a href=https://github.com/Enmk rel="external nofollow noreferrer" target=_blank>Vasily Nemkov</a>).</li> <li>Dynamically reinitialize listening ports and protocols when configuration changes. <a href=https://github.com/ClickHouse/ClickHouse/pull/30549 rel="external nofollow noreferrer" target=_blank>#30549</a> (<a href=https://github.com/kmichel-aiven rel="external nofollow noreferrer" target=_blank>Kevin Michel</a>).</li> <li>Added <code class=syntax>left</code>, <code class=syntax>right</code>, <code class=syntax>leftUTF8</code>, <code class=syntax>rightUTF8</code> functions. Fix error in implementation of <code class=syntax>substringUTF8</code> function with negative offset (offset from the end of string). <a href=https://github.com/ClickHouse/ClickHouse/pull/33407 rel="external nofollow noreferrer" target=_blank>#33407</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer" target=_blank>alexey-milovidov</a>).</li> <li>Add new functions for <code class=syntax>H3</code> coordinate system: <code class=syntax>h3HexAreaKm2</code>, <code class=syntax>h3CellAreaM2</code>, <code class=syntax>h3CellAreaRads2</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33479 rel="external nofollow noreferrer" target=_blank>#33479</a> (<a href=https://github.com/bharatnc rel="external nofollow noreferrer" target=_blank>Bharat Nallan</a>).</li> <li>Add <code class=syntax>MONTHNAME</code> function. <a href=https://github.com/ClickHouse/ClickHouse/pull/33436 rel="external nofollow noreferrer" target=_blank>#33436</a> (<a href=https://github.com/usurai rel="external nofollow noreferrer" target=_blank>usurai</a>).</li> <li>Added function <code class=syntax>arrayLast</code>. Closes <a href=https://github.com/ClickHouse/ClickHouse/issues/33390 rel="external nofollow noreferrer" target=_blank>#33390</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33415 rel="external nofollow noreferrer" target=_blank>#33415</a> Added function <code class=syntax>arrayLastIndex</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33465 rel="external nofollow noreferrer" target=_blank>#33465</a> (<a href=https://github.com/kitaisreal rel="external nofollow noreferrer" target=_blank>Maksim Kita</a>).</li> <li>Add function <code class=syntax>decodeURLFormComponent</code> slightly different to <code class=syntax>decodeURLComponent</code>. Close <a href=https://github.com/ClickHouse/ClickHouse/issues/10298 rel="external nofollow noreferrer" target=_blank>#10298</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33451 rel="external nofollow noreferrer" target=_blank>#33451</a> (<a href=https://github.com/cmsxbc rel="external nofollow noreferrer" target=_blank>SuperDJY</a>).</li> <li>Allow to split <code class=syntax>GraphiteMergeTree</code> rollup rules for plain/tagged metrics (optional rule_type field). <a href=https://github.com/ClickHouse/ClickHouse/pull/33494 rel="external nofollow noreferrer" target=_blank>#33494</a> (<a href=https://github.com/msaf1980 rel="external nofollow noreferrer" target=_blank>Michail Safronov</a>).</li> </ul> <h4 id=performance-improvement>Performance Improvement<a class=headerlink href=../amp/#performance-improvement title="Permanent link"> </a></h4> <ul> <li>Support moving conditions to <code class=syntax>PREWHERE</code> (setting <code class=syntax>optimize_move_to_prewhere</code>) for tables of <code class=syntax>Merge</code> engine if its all underlying tables supports <code class=syntax>PREWHERE</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33300 rel="external nofollow noreferrer" target=_blank>#33300</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer" target=_blank>Anton Popov</a>).</li> <li>More efficient handling of globs for URL storage. Now you can easily query million URLs in parallel with retries. Closes <a href=https://github.com/ClickHouse/ClickHouse/issues/32866 rel="external nofollow noreferrer" target=_blank>#32866</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/32907 rel="external nofollow noreferrer" target=_blank>#32907</a> (<a href=https://github.com/kssenii rel="external nofollow noreferrer" target=_blank>Kseniia Sumarokova</a>).</li> <li>Avoid exponential backtracking in parser. This closes <a href=https://github.com/ClickHouse/ClickHouse/issues/20158 rel="external nofollow noreferrer" target=_blank>#20158</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33481 rel="external nofollow noreferrer" target=_blank>#33481</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer" target=_blank>alexey-milovidov</a>).</li> <li>Abuse of <code class=syntax>untuple</code> function was leading to exponential complexity of query analysis (found by fuzzer). This closes <a href=https://github.com/ClickHouse/ClickHouse/issues/33297 rel="external nofollow noreferrer" target=_blank>#33297</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33445 rel="external nofollow noreferrer" target=_blank>#33445</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer" target=_blank>alexey-milovidov</a>).</li> <li>Reduce allocated memory for dictionaries with string attributes. <a href=https://github.com/ClickHouse/ClickHouse/pull/33466 rel="external nofollow noreferrer" target=_blank>#33466</a> (<a href=https://github.com/kitaisreal rel="external nofollow noreferrer" target=_blank>Maksim Kita</a>).</li> <li>Slight performance improvement of <code class=syntax>reinterpret</code> function. <a href=https://github.com/ClickHouse/ClickHouse/pull/32587 rel="external nofollow noreferrer" target=_blank>#32587</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer" target=_blank>alexey-milovidov</a>).</li> <li>Non significant change. In extremely rare cases when data part is lost on every replica, after merging of some data parts, the subsequent queries may skip less amount of partitions during partition pruning. This hardly affects anything. <a href=https://github.com/ClickHouse/ClickHouse/pull/32220 rel="external nofollow noreferrer" target=_blank>#32220</a> (<a href=https://github.com/azat rel="external nofollow noreferrer" target=_blank>Azat Khuzhin</a>).</li> <li>Improve <code class=syntax>clickhouse-keeper</code> writing performance by optimization the size calculation logic. <a href=https://github.com/ClickHouse/ClickHouse/pull/32366 rel="external nofollow noreferrer" target=_blank>#32366</a> (<a href=https://github.com/zhanglistar rel="external nofollow noreferrer" target=_blank>zhanglistar</a>).</li> <li>Optimize single part projection materialization. This closes <a href=https://github.com/ClickHouse/ClickHouse/issues/31669 rel="external nofollow noreferrer" target=_blank>#31669</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/31885 rel="external nofollow noreferrer" target=_blank>#31885</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer" target=_blank>Amos Bird</a>).</li> <li>Improve query performance of system tables. <a href=https://github.com/ClickHouse/ClickHouse/pull/33312 rel="external nofollow noreferrer" target=_blank>#33312</a> (<a href=https://github.com/zhongyuankai rel="external nofollow noreferrer" target=_blank>OnePiece</a>).</li> <li>Optimize selecting of MergeTree parts that can be moved between volumes. <a href=https://github.com/ClickHouse/ClickHouse/pull/33225 rel="external nofollow noreferrer" target=_blank>#33225</a> (<a href=https://github.com/zhongyuankai rel="external nofollow noreferrer" target=_blank>OnePiece</a>).</li> <li>Fix <code class=syntax>sparse_hashed</code> dict performance with sequential keys (wrong hash function). <a href=https://github.com/ClickHouse/ClickHouse/pull/32536 rel="external nofollow noreferrer" target=_blank>#32536</a> (<a href=https://github.com/azat rel="external nofollow noreferrer" target=_blank>Azat Khuzhin</a>).</li> </ul> <h4 id=experimental-feature>Experimental Feature<a class=headerlink href=../amp/#experimental-feature title="Permanent link"> </a></h4> <ul> <li>Parallel reading from multiple replicas within a shard during distributed query without using sample key. To enable this, set <code class=syntax>allow_experimental_parallel_reading_from_replicas = 1</code> and <code class=syntax>max_parallel_replicas</code> to any number. This closes <a href=https://github.com/ClickHouse/ClickHouse/issues/26748 rel="external nofollow noreferrer" target=_blank>#26748</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/29279 rel="external nofollow noreferrer" target=_blank>#29279</a> (<a href=https://github.com/nikitamikhaylov rel="external nofollow noreferrer" target=_blank>Nikita Mikhaylov</a>).</li> <li>Implemented sparse serialization. It can reduce usage of disk space and improve performance of some queries for columns, which contain a lot of default (zero) values. It can be enabled by setting <code class=syntax>ratio_for_sparse_serialization</code>. Sparse serialization will be chosen dynamically for column, if it has ratio of number of default values to number of all values above that threshold. Serialization (default or sparse) will be fixed for every column in part, but may varies between parts. <a href=https://github.com/ClickHouse/ClickHouse/pull/22535 rel="external nofollow noreferrer" target=_blank>#22535</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer" target=_blank>Anton Popov</a>).</li> <li>Add "TABLE OVERRIDE" feature for customizing MaterializedMySQL table schemas. <a href=https://github.com/ClickHouse/ClickHouse/pull/32325 rel="external nofollow noreferrer" target=_blank>#32325</a> (<a href=https://github.com/stigsb rel="external nofollow noreferrer" target=_blank>Stig Bakken</a>).</li> <li>Add <code class=syntax>EXPLAIN TABLE OVERRIDE</code> query. <a href=https://github.com/ClickHouse/ClickHouse/pull/32836 rel="external nofollow noreferrer" target=_blank>#32836</a> (<a href=https://github.com/stigsb rel="external nofollow noreferrer" target=_blank>Stig Bakken</a>).</li> <li>Support TABLE OVERRIDE clause for MaterializedPostgreSQL. RFC: <a href=https://github.com/ClickHouse/ClickHouse/issues/31480 rel="external nofollow noreferrer" target=_blank>#31480</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/32749 rel="external nofollow noreferrer" target=_blank>#32749</a> (<a href=https://github.com/kssenii rel="external nofollow noreferrer" target=_blank>Kseniia Sumarokova</a>).</li> <li>Change ZooKeeper path for zero-copy marks for shared data. Note that "zero-copy replication" is non-production feature (in early stages of development) that you shouldn't use anyway. But in case if you have used it, let you keep in mind this change. <a href=https://github.com/ClickHouse/ClickHouse/pull/32061 rel="external nofollow noreferrer" target=_blank>#32061</a> (<a href=https://github.com/ianton-ru rel="external nofollow noreferrer" target=_blank>ianton-ru</a>).</li> <li>Events clause support for WINDOW VIEW watch query. <a href=https://github.com/ClickHouse/ClickHouse/pull/32607 rel="external nofollow noreferrer" target=_blank>#32607</a> (<a href=https://github.com/Vxider rel="external nofollow noreferrer" target=_blank>vxider</a>).</li> <li>Fix ACL with explicit digit hash in <code class=syntax>clickhouse-keeper</code>: now the behavior consistent with ZooKeeper and generated digest is always accepted. <a href=https://github.com/ClickHouse/ClickHouse/pull/33249 rel="external nofollow noreferrer" target=_blank>#33249</a> (<a href=https://github.com/nicelulu rel="external nofollow noreferrer" target=_blank>小路</a>). <a href=https://github.com/ClickHouse/ClickHouse/pull/33246 rel="external nofollow noreferrer" target=_blank>#33246</a>.</li> <li>Fix unexpected projection removal when detaching parts. <a href=https://github.com/ClickHouse/ClickHouse/pull/32067 rel="external nofollow noreferrer" target=_blank>#32067</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer" target=_blank>Amos Bird</a>).</li> </ul> <h4 id=improvement>Improvement<a class=headerlink href=../amp/#improvement title="Permanent link"> </a></h4> <ul> <li>Now date time conversion functions that generates time before <code class=syntax>1970-01-01 00:00:00</code> will be saturated to zero instead of overflow. <a href=https://github.com/ClickHouse/ClickHouse/pull/29953 rel="external nofollow noreferrer" target=_blank>#29953</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer" target=_blank>Amos Bird</a>). It also fixes a bug in index analysis if date truncation function would yield result before the Unix epoch. </li> <li>Always display resource usage (total CPU usage, total RAM usage and max RAM usage per host) in client. <a href=https://github.com/ClickHouse/ClickHouse/pull/33271 rel="external nofollow noreferrer" target=_blank>#33271</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer" target=_blank>alexey-milovidov</a>).</li> <li>Improve <code class=syntax>Bool</code> type serialization and deserialization, check the range of values. <a href=https://github.com/ClickHouse/ClickHouse/pull/32984 rel="external nofollow noreferrer" target=_blank>#32984</a> (<a href=https://github.com/Avogar rel="external nofollow noreferrer" target=_blank>Kruglov Pavel</a>).</li> <li>If an invalid setting is defined using the <code class=syntax>SET</code> query or using the query parameters in the HTTP request, error message will contain suggestions that are similar to the invalid setting string (if any exists). <a href=https://github.com/ClickHouse/ClickHouse/pull/32946 rel="external nofollow noreferrer" target=_blank>#32946</a> (<a href=https://github.com/antonio2368 rel="external nofollow noreferrer" target=_blank>Antonio Andelic</a>).</li> <li>Support hints for mistyped setting names for clickhouse-client and clickhouse-local. Closes <a href=https://github.com/ClickHouse/ClickHouse/issues/32237 rel="external nofollow noreferrer" target=_blank>#32237</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/32841 rel="external nofollow noreferrer" target=_blank>#32841</a> (<a href=https://github.com/lingtaolf rel="external nofollow noreferrer" target=_blank>凌涛</a>).</li> <li>Allow to use virtual columns in Materialized Views. Close <a href=https://github.com/ClickHouse/ClickHouse/issues/11210 rel="external nofollow noreferrer" target=_blank>#11210</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33482 rel="external nofollow noreferrer" target=_blank>#33482</a> (<a href=https://github.com/zhongyuankai rel="external nofollow noreferrer" target=_blank>OnePiece</a>).</li> <li>Add config to disable IPv6 in clickhouse-keeper if needed. This close <a href=https://github.com/ClickHouse/ClickHouse/issues/33381 rel="external nofollow noreferrer" target=_blank>#33381</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33450 rel="external nofollow noreferrer" target=_blank>#33450</a> (<a href=https://github.com/wuxueyang96 rel="external nofollow noreferrer" target=_blank>Wu Xueyang</a>).</li> <li>Add more info to <code class=syntax>system.build_options</code> about current git revision. <a href=https://github.com/ClickHouse/ClickHouse/pull/33431 rel="external nofollow noreferrer" target=_blank>#33431</a> (<a href=https://github.com/taiyang-li rel="external nofollow noreferrer" target=_blank>taiyang-li</a>).</li> <li><code class=syntax>clickhouse-local</code>: track memory under <code class=syntax>--max_memory_usage_in_client</code> option. <a href=https://github.com/ClickHouse/ClickHouse/pull/33341 rel="external nofollow noreferrer" target=_blank>#33341</a> (<a href=https://github.com/azat rel="external nofollow noreferrer" target=_blank>Azat Khuzhin</a>).</li> <li>Allow negative intervals in function <code class=syntax>intervalLengthSum</code>. Their length will be added as well. This closes <a href=https://github.com/ClickHouse/ClickHouse/issues/33323 rel="external nofollow noreferrer" target=_blank>#33323</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33335 rel="external nofollow noreferrer" target=_blank>#33335</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer" target=_blank>alexey-milovidov</a>).</li> <li><code class=syntax>LineAsString</code> can be used as output format. This closes <a href=https://github.com/ClickHouse/ClickHouse/issues/30919 rel="external nofollow noreferrer" target=_blank>#30919</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33331 rel="external nofollow noreferrer" target=_blank>#33331</a> (<a href=https://github.com/serxa rel="external nofollow noreferrer" target=_blank>Sergei Trifonov</a>).</li> <li>Support <code class=syntax>&lt;secure/&gt;</code> in cluster configuration, as an alternative form of <code class=syntax>&lt;secure&gt;1&lt;/secure&gt;</code>. Close <a href=https://github.com/ClickHouse/ClickHouse/issues/33270 rel="external nofollow noreferrer" target=_blank>#33270</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33330 rel="external nofollow noreferrer" target=_blank>#33330</a> (<a href=https://github.com/cmsxbc rel="external nofollow noreferrer" target=_blank>SuperDJY</a>).</li> <li>Pressing Ctrl+C twice will terminate <code class=syntax>clickhouse-benchmark</code> immediately without waiting for in-flight queries. This closes <a href=https://github.com/ClickHouse/ClickHouse/issues/32586 rel="external nofollow noreferrer" target=_blank>#32586</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33303 rel="external nofollow noreferrer" target=_blank>#33303</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer" target=_blank>alexey-milovidov</a>).</li> <li>Support Unix timestamp with milliseconds in <code class=syntax>parseDateTimeBestEffort</code> function. <a href=https://github.com/ClickHouse/ClickHouse/pull/33276 rel="external nofollow noreferrer" target=_blank>#33276</a> (<a href=https://github.com/benbiti rel="external nofollow noreferrer" target=_blank>Ben</a>).</li> <li>Allow to cancel query while reading data from external table in the formats: <code class=syntax>Arrow</code> / <code class=syntax>Parquet</code> / <code class=syntax>ORC</code> - it failed to be cancelled it case of big files and setting input_format_allow_seeks as false. Closes <a href=https://github.com/ClickHouse/ClickHouse/issues/29678 rel="external nofollow noreferrer" target=_blank>#29678</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33238 rel="external nofollow noreferrer" target=_blank>#33238</a> (<a href=https://github.com/kssenii rel="external nofollow noreferrer" target=_blank>Kseniia Sumarokova</a>).</li> <li>If table engine supports <code class=syntax>SETTINGS</code> clause, allow to pass the settings as key-value or via config. Add this support for MySQL. <a href=https://github.com/ClickHouse/ClickHouse/pull/33231 rel="external nofollow noreferrer" target=_blank>#33231</a> (<a href=https://github.com/kssenii rel="external nofollow noreferrer" target=_blank>Kseniia Sumarokova</a>).</li> <li>Correctly prevent Nullable primary keys if necessary. This is for <a href=https://github.com/ClickHouse/ClickHouse/issues/32780 rel="external nofollow noreferrer" target=_blank>#32780</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33218 rel="external nofollow noreferrer" target=_blank>#33218</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer" target=_blank>Amos Bird</a>).</li> <li>Add retry for <code class=syntax>PostgreSQL</code> connections in case nothing has been fetched yet. Closes <a href=https://github.com/ClickHouse/ClickHouse/issues/33199 rel="external nofollow noreferrer" target=_blank>#33199</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33209 rel="external nofollow noreferrer" target=_blank>#33209</a> (<a href=https://github.com/kssenii rel="external nofollow noreferrer" target=_blank>Kseniia Sumarokova</a>).</li> <li>Validate config keys for external dictionaries. <a href=https://github.com/ClickHouse/ClickHouse/issues/33095#issuecomment-1000577517 rel="external nofollow noreferrer" target=_blank>#33095</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33130 rel="external nofollow noreferrer" target=_blank>#33130</a> (<a href=https://github.com/kssenii rel="external nofollow noreferrer" target=_blank>Kseniia Sumarokova</a>).</li> <li>Send profile info inside <code class=syntax>clickhouse-local</code>. Closes <a href=https://github.com/ClickHouse/ClickHouse/issues/33093 rel="external nofollow noreferrer" target=_blank>#33093</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33097 rel="external nofollow noreferrer" target=_blank>#33097</a> (<a href=https://github.com/kssenii rel="external nofollow noreferrer" target=_blank>Kseniia Sumarokova</a>).</li> <li>Short circuit evaluation: support for function <code class=syntax>throwIf</code>. Closes <a href=https://github.com/ClickHouse/ClickHouse/issues/32969 rel="external nofollow noreferrer" target=_blank>#32969</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/32973 rel="external nofollow noreferrer" target=_blank>#32973</a> (<a href=https://github.com/kitaisreal rel="external nofollow noreferrer" target=_blank>Maksim Kita</a>).</li> <li>(This only happens in unofficial builds). Fixed segfault when inserting data into compressed Decimal, String, FixedString and Array columns. This closes <a href=https://github.com/ClickHouse/ClickHouse/issues/32939 rel="external nofollow noreferrer" target=_blank>#32939</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/32940 rel="external nofollow noreferrer" target=_blank>#32940</a> (<a href=https://github.com/nkolotov rel="external nofollow noreferrer" target=_blank>N. Kolotov</a>).</li> <li>Added support for specifying subquery as SQL user defined function. Example: <code class=syntax>CREATE FUNCTION test AS () -&gt; (SELECT 1)</code>. Closes <a href=https://github.com/ClickHouse/ClickHouse/issues/30755 rel="external nofollow noreferrer" target=_blank>#30755</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/32758 rel="external nofollow noreferrer" target=_blank>#32758</a> (<a href=https://github.com/kitaisreal rel="external nofollow noreferrer" target=_blank>Maksim Kita</a>).</li> <li>Improve gRPC compression support for <a href=https://github.com/ClickHouse/ClickHouse/issues/28671 rel="external nofollow noreferrer" target=_blank>#28671</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/32747 rel="external nofollow noreferrer" target=_blank>#32747</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer" target=_blank>Vitaly Baranov</a>).</li> <li>Flush all In-Memory data parts when WAL is not enabled while shutdown server or detaching table. <a href=https://github.com/ClickHouse/ClickHouse/pull/32742 rel="external nofollow noreferrer" target=_blank>#32742</a> (<a href=https://github.com/nautaa rel="external nofollow noreferrer" target=_blank>nauta</a>).</li> <li>Allow to control connection timeouts for MySQL (previously was supported only for dictionary source). Closes <a href=https://github.com/ClickHouse/ClickHouse/issues/16669 rel="external nofollow noreferrer" target=_blank>#16669</a>. Previously default connect_timeout was rather small, now it is configurable. <a href=https://github.com/ClickHouse/ClickHouse/pull/32734 rel="external nofollow noreferrer" target=_blank>#32734</a> (<a href=https://github.com/kssenii rel="external nofollow noreferrer" target=_blank>Kseniia Sumarokova</a>).</li> <li>Support <code class=syntax>authSource</code> option for storage <code class=syntax>MongoDB</code>. Closes <a href=https://github.com/ClickHouse/ClickHouse/issues/32594 rel="external nofollow noreferrer" target=_blank>#32594</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/32702 rel="external nofollow noreferrer" target=_blank>#32702</a> (<a href=https://github.com/kssenii rel="external nofollow noreferrer" target=_blank>Kseniia Sumarokova</a>).</li> <li>Support <code class=syntax>Date32</code> type in <code class=syntax>genarateRandom</code> table function. <a href=https://github.com/ClickHouse/ClickHouse/pull/32643 rel="external nofollow noreferrer" target=_blank>#32643</a> (<a href=https://github.com/nautaa rel="external nofollow noreferrer" target=_blank>nauta</a>).</li> <li>Add settings <code class=syntax>max_concurrent_select_queries</code> and <code class=syntax>max_concurrent_insert_queries</code> for control concurrent queries by query kind. Close <a href=https://github.com/ClickHouse/ClickHouse/issues/3575 rel="external nofollow noreferrer" target=_blank>#3575</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/32609 rel="external nofollow noreferrer" target=_blank>#32609</a> (<a href=https://github.com/cmsxbc rel="external nofollow noreferrer" target=_blank>SuperDJY</a>).</li> <li>Improve handling nested structures with missing columns while reading data in <code class=syntax>Protobuf</code> format. Follow-up to <a href=https://github.com/ClickHouse/ClickHouse/pull/31988 target=_blank>https://github.com/ClickHouse/ClickHouse/pull/31988</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/32531 rel="external nofollow noreferrer" target=_blank>#32531</a> (<a href=https://github.com/vitlibar rel="external nofollow noreferrer" target=_blank>Vitaly Baranov</a>).</li> <li>Allow empty credentials for <code class=syntax>MongoDB</code> engine. Closes <a href=https://github.com/ClickHouse/ClickHouse/issues/26267 rel="external nofollow noreferrer" target=_blank>#26267</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/32460 rel="external nofollow noreferrer" target=_blank>#32460</a> (<a href=https://github.com/kssenii rel="external nofollow noreferrer" target=_blank>Kseniia Sumarokova</a>).</li> <li>Disable some optimizations for window functions that may lead to exceptions. Closes <a href=https://github.com/ClickHouse/ClickHouse/issues/31535 rel="external nofollow noreferrer" target=_blank>#31535</a>. Closes <a href=https://github.com/ClickHouse/ClickHouse/issues/31620 rel="external nofollow noreferrer" target=_blank>#31620</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/32453 rel="external nofollow noreferrer" target=_blank>#32453</a> (<a href=https://github.com/kssenii rel="external nofollow noreferrer" target=_blank>Kseniia Sumarokova</a>).</li> <li>Allows to connect to MongoDB 5.0. Closes <a href=https://github.com/ClickHouse/ClickHouse/issues/31483 rel="external nofollow noreferrer" target=_blank>#31483</a>,. <a href=https://github.com/ClickHouse/ClickHouse/pull/32416 rel="external nofollow noreferrer" target=_blank>#32416</a> (<a href=https://github.com/kssenii rel="external nofollow noreferrer" target=_blank>Kseniia Sumarokova</a>).</li> <li>Enable comparison between <code class=syntax>Decimal</code> and <code class=syntax>Float</code>. Closes <a href=https://github.com/ClickHouse/ClickHouse/issues/22626 rel="external nofollow noreferrer" target=_blank>#22626</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/31966 rel="external nofollow noreferrer" target=_blank>#31966</a> (<a href=https://github.com/ucasFL rel="external nofollow noreferrer" target=_blank>flynn</a>).</li> <li>Added settings <code class=syntax>command_read_timeout</code>, <code class=syntax>command_write_timeout</code> for <code class=syntax>StorageExecutable</code>, <code class=syntax>StorageExecutablePool</code>, <code class=syntax>ExecutableDictionary</code>, <code class=syntax>ExecutablePoolDictionary</code>, <code class=syntax>ExecutableUserDefinedFunctions</code>. Setting <code class=syntax>command_read_timeout</code> controls timeout for reading data from command stdout in milliseconds. Setting <code class=syntax>command_write_timeout</code> timeout for writing data to command stdin in milliseconds. Added settings <code class=syntax>command_termination_timeout</code> for <code class=syntax>ExecutableUserDefinedFunction</code>, <code class=syntax>ExecutableDictionary</code>, <code class=syntax>StorageExecutable</code>. Added setting <code class=syntax>execute_direct</code> for <code class=syntax>ExecutableUserDefinedFunction</code>, by default true. Added setting <code class=syntax>execute_direct</code> for <code class=syntax>ExecutableDictionary</code>, <code class=syntax>ExecutablePoolDictionary</code>, by default false. <a href=https://github.com/ClickHouse/ClickHouse/pull/30957 rel="external nofollow noreferrer" target=_blank>#30957</a> (<a href=https://github.com/kitaisreal rel="external nofollow noreferrer" target=_blank>Maksim Kita</a>).</li> <li>Bitmap aggregate functions will give correct result for out of range argument instead of wraparound. <a href=https://github.com/ClickHouse/ClickHouse/pull/33127 rel="external nofollow noreferrer" target=_blank>#33127</a> (<a href=https://github.com/freedomDR rel="external nofollow noreferrer" target=_blank>DR</a>).</li> <li>Fix parsing incorrect queries with <code class=syntax>FROM INFILE</code> statement. <a href=https://github.com/ClickHouse/ClickHouse/pull/33521 rel="external nofollow noreferrer" target=_blank>#33521</a> (<a href=https://github.com/Avogar rel="external nofollow noreferrer" target=_blank>Kruglov Pavel</a>).</li> <li>Don't allow to write into <code class=syntax>S3</code> if path contains globs. <a href=https://github.com/ClickHouse/ClickHouse/pull/33142 rel="external nofollow noreferrer" target=_blank>#33142</a> (<a href=https://github.com/Avogar rel="external nofollow noreferrer" target=_blank>Kruglov Pavel</a>).</li> <li><code class=syntax>--echo</code> option was not used by <code class=syntax>clickhouse-client</code> in batch mode with single query. <a href=https://github.com/ClickHouse/ClickHouse/pull/32843 rel="external nofollow noreferrer" target=_blank>#32843</a> (<a href=https://github.com/nkolotov rel="external nofollow noreferrer" target=_blank>N. Kolotov</a>).</li> <li>Use <code class=syntax>--database</code> option for clickhouse-local. <a href=https://github.com/ClickHouse/ClickHouse/pull/32797 rel="external nofollow noreferrer" target=_blank>#32797</a> (<a href=https://github.com/kssenii rel="external nofollow noreferrer" target=_blank>Kseniia Sumarokova</a>).</li> <li>Fix surprisingly bad code in SQL ordinary function <code class=syntax>file</code>. Now it supports symlinks. <a href=https://github.com/ClickHouse/ClickHouse/pull/32640 rel="external nofollow noreferrer" target=_blank>#32640</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer" target=_blank>alexey-milovidov</a>).</li> <li>Updating <code class=syntax>modification_time</code> for data part in <code class=syntax>system.parts</code> after part movement <a href=https://github.com/ClickHouse/ClickHouse/issues/32964 rel="external nofollow noreferrer" target=_blank>#32964</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/32965 rel="external nofollow noreferrer" target=_blank>#32965</a> (<a href=https://github.com/save-my-heart rel="external nofollow noreferrer" target=_blank>save-my-heart</a>).</li> <li>Potential issue, cannot be exploited: integer overflow may happen in array resize. <a href=https://github.com/ClickHouse/ClickHouse/pull/33024 rel="external nofollow noreferrer" target=_blank>#33024</a> (<a href=https://github.com/varadarajkumar rel="external nofollow noreferrer" target=_blank>varadarajkumar</a>).</li> </ul> <h4 id=build-testing-packaging-improvement>Build/Testing/Packaging Improvement<a class=headerlink href=../amp/#build-testing-packaging-improvement title="Permanent link"> </a></h4> <ul> <li>Add packages, functional tests and Docker builds for AArch64 (ARM) version of ClickHouse. <a href=https://github.com/ClickHouse/ClickHouse/pull/32911 rel="external nofollow noreferrer" target=_blank>#32911</a> (<a href=https://github.com/Felixoid rel="external nofollow noreferrer" target=_blank>Mikhail f. Shiryaev</a>). <a href=https://github.com/ClickHouse/ClickHouse/pull/32415 rel="external nofollow noreferrer" target=_blank>#32415</a></li> <li>Prepare ClickHouse to be built with musl-libc. It is not enabled by default. <a href=https://github.com/ClickHouse/ClickHouse/pull/33134 rel="external nofollow noreferrer" target=_blank>#33134</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer" target=_blank>alexey-milovidov</a>).</li> <li>Make installation script working on FreeBSD. This closes <a href=https://github.com/ClickHouse/ClickHouse/issues/33384 rel="external nofollow noreferrer" target=_blank>#33384</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33418 rel="external nofollow noreferrer" target=_blank>#33418</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer" target=_blank>alexey-milovidov</a>).</li> <li>Add <code class=syntax>actionlint</code> for GitHub Actions workflows and verify workflow files via <code class=syntax>act --list</code> to check the correct workflow syntax. <a href=https://github.com/ClickHouse/ClickHouse/pull/33612 rel="external nofollow noreferrer" target=_blank>#33612</a> (<a href=https://github.com/Felixoid rel="external nofollow noreferrer" target=_blank>Mikhail f. Shiryaev</a>).</li> <li>Add more tests for the nullable primary key feature. Add more tests with different types and merge tree kinds, plus randomly generated data. <a href=https://github.com/ClickHouse/ClickHouse/pull/33228 rel="external nofollow noreferrer" target=_blank>#33228</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer" target=_blank>Amos Bird</a>).</li> <li>Add a simple tool to visualize flaky tests in web browser. <a href=https://github.com/ClickHouse/ClickHouse/pull/33185 rel="external nofollow noreferrer" target=_blank>#33185</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer" target=_blank>alexey-milovidov</a>).</li> <li>Enable hermetic build for shared builds. This is mainly for developers. <a href=https://github.com/ClickHouse/ClickHouse/pull/32968 rel="external nofollow noreferrer" target=_blank>#32968</a> (<a href=https://github.com/amosbird rel="external nofollow noreferrer" target=_blank>Amos Bird</a>).</li> <li>Update <code class=syntax>libc++</code> and <code class=syntax>libc++abi</code> to the latest. <a href=https://github.com/ClickHouse/ClickHouse/pull/32484 rel="external nofollow noreferrer" target=_blank>#32484</a> (<a href=https://github.com/Algunenano rel="external nofollow noreferrer" target=_blank>Raúl Marín</a>).</li> <li>Added integration test for external .NET client (<a href=https://github.com/DarkWanderer/ClickHouse.Client rel="external nofollow noreferrer" target=_blank>ClickHouse.Client</a>). <a href=https://github.com/ClickHouse/ClickHouse/pull/23230 rel="external nofollow noreferrer" target=_blank>#23230</a> (<a href=https://github.com/DarkWanderer rel="external nofollow noreferrer" target=_blank>Oleg V. Kozlyuk</a>).</li> <li>Inject git information into clickhouse binary file. So we can get source code revision easily from clickhouse binary file. <a href=https://github.com/ClickHouse/ClickHouse/pull/33124 rel="external nofollow noreferrer" target=_blank>#33124</a> (<a href=https://github.com/taiyang-li rel="external nofollow noreferrer" target=_blank>taiyang-li</a>).</li> <li>Remove obsolete code from ConfigProcessor. Yandex specific code is not used anymore. The code contained one minor defect. This defect was reported by <a href=https://github.com/SadiHassan rel="external nofollow noreferrer" target=_blank>Mallik Hassan</a> in <a href=https://github.com/ClickHouse/ClickHouse/issues/33032 rel="external nofollow noreferrer" target=_blank>#33032</a>. This closes <a href=https://github.com/ClickHouse/ClickHouse/issues/33032 rel="external nofollow noreferrer" target=_blank>#33032</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33026 rel="external nofollow noreferrer" target=_blank>#33026</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer" target=_blank>alexey-milovidov</a>).</li> </ul> <h4 id=bug-fix-user-visible-misbehavior-in-official-stable-or-prestable-release>Bug Fix (user-visible misbehavior in official stable or prestable release)<a class=headerlink href=../amp/#bug-fix-user-visible-misbehavior-in-official-stable-or-prestable-release title="Permanent link"> </a></h4> <ul> <li>Several fixes for format parsing. This is relevant if <code class=syntax>clickhouse-server</code> is open for write access to adversary. Specifically crafted input data for <code class=syntax>Native</code> format may lead to reading uninitialized memory or crash. This is relevant if <code class=syntax>clickhouse-server</code> is open for write access to adversary. <a href=https://github.com/ClickHouse/ClickHouse/pull/33050 rel="external nofollow noreferrer" target=_blank>#33050</a> (<a href=https://github.com/HeenaBansal2009 rel="external nofollow noreferrer" target=_blank>Heena Bansal</a>). Fixed Apache Avro Union type index out of boundary issue in Apache Avro binary format. <a href=https://github.com/ClickHouse/ClickHouse/pull/33022 rel="external nofollow noreferrer" target=_blank>#33022</a> (<a href=https://github.com/HarryLeeIBM rel="external nofollow noreferrer" target=_blank>Harry Lee</a>). Fix null pointer dereference in <code class=syntax>LowCardinality</code> data when deserializing <code class=syntax>LowCardinality</code> data in the Native format. <a href=https://github.com/ClickHouse/ClickHouse/pull/33021 rel="external nofollow noreferrer" target=_blank>#33021</a> (<a href=https://github.com/HarryLeeIBM rel="external nofollow noreferrer" target=_blank>Harry Lee</a>).</li> <li>ClickHouse Keeper handler will correctly remove operation when response sent. <a href=https://github.com/ClickHouse/ClickHouse/pull/32988 rel="external nofollow noreferrer" target=_blank>#32988</a> (<a href=https://github.com/JackyWoo rel="external nofollow noreferrer" target=_blank>JackyWoo</a>).</li> <li>Potential off-by-one miscalculation of quotas: quota limit was not reached, but the limit was exceeded. This fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/31174 rel="external nofollow noreferrer" target=_blank>#31174</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/31656 rel="external nofollow noreferrer" target=_blank>#31656</a> (<a href=https://github.com/sunny19930321 rel="external nofollow noreferrer" target=_blank>sunny</a>).</li> <li>Fixed CASTing from String to IPv4 or IPv6 and back. Fixed error message in case of failed conversion. <a href=https://github.com/ClickHouse/ClickHouse/pull/29224 rel="external nofollow noreferrer" target=_blank>#29224</a> (<a href=https://github.com/novikd rel="external nofollow noreferrer" target=_blank>Dmitry Novik</a>) <a href=https://github.com/ClickHouse/ClickHouse/pull/27914 rel="external nofollow noreferrer" target=_blank>#27914</a> (<a href=https://github.com/Enmk rel="external nofollow noreferrer" target=_blank>Vasily Nemkov</a>).</li> <li>Fixed an exception like <code class=syntax>Unknown aggregate function nothing</code> during an execution on a remote server. This fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/16689 rel="external nofollow noreferrer" target=_blank>#16689</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/26074 rel="external nofollow noreferrer" target=_blank>#26074</a> (<a href=https://github.com/hexiaoting rel="external nofollow noreferrer" target=_blank>hexiaoting</a>).</li> <li>Fix wrong database for JOIN without explicit database in distributed queries (Fixes: <a href=https://github.com/ClickHouse/ClickHouse/issues/10471 rel="external nofollow noreferrer" target=_blank>#10471</a>). <a href=https://github.com/ClickHouse/ClickHouse/pull/33611 rel="external nofollow noreferrer" target=_blank>#33611</a> (<a href=https://github.com/azat rel="external nofollow noreferrer" target=_blank>Azat Khuzhin</a>).</li> <li>Fix segfault in Apache <code class=syntax>Avro</code> format that appears after the second insert into file. <a href=https://github.com/ClickHouse/ClickHouse/pull/33566 rel="external nofollow noreferrer" target=_blank>#33566</a> (<a href=https://github.com/Avogar rel="external nofollow noreferrer" target=_blank>Kruglov Pavel</a>).</li> <li>Fix segfault in Apache <code class=syntax>Arrow</code> format if schema contains <code class=syntax>Dictionary</code> type. Closes <a href=https://github.com/ClickHouse/ClickHouse/issues/33507 rel="external nofollow noreferrer" target=_blank>#33507</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33529 rel="external nofollow noreferrer" target=_blank>#33529</a> (<a href=https://github.com/Avogar rel="external nofollow noreferrer" target=_blank>Kruglov Pavel</a>).</li> <li>Out of band <code class=syntax>offset</code> and <code class=syntax>limit</code> settings may be applied incorrectly for views. Close <a href=https://github.com/ClickHouse/ClickHouse/issues/33289 rel="external nofollow noreferrer" target=_blank>#33289</a> <a href=https://github.com/ClickHouse/ClickHouse/pull/33518 rel="external nofollow noreferrer" target=_blank>#33518</a> (<a href=https://github.com/hexiaoting rel="external nofollow noreferrer" target=_blank>hexiaoting</a>).</li> <li>Fix an exception <code class=syntax>Block structure mismatch</code> which may happen during insertion into table with default nested <code class=syntax>LowCardinality</code> column. Fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/33028 rel="external nofollow noreferrer" target=_blank>#33028</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33504 rel="external nofollow noreferrer" target=_blank>#33504</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer" target=_blank>Nikolai Kochetov</a>).</li> <li>Fix dictionary expressions for <code class=syntax>range_hashed</code> range min and range max attributes when created using DDL. Closes <a href=https://github.com/ClickHouse/ClickHouse/issues/30809 rel="external nofollow noreferrer" target=_blank>#30809</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33478 rel="external nofollow noreferrer" target=_blank>#33478</a> (<a href=https://github.com/kitaisreal rel="external nofollow noreferrer" target=_blank>Maksim Kita</a>).</li> <li>Fix possible use-after-free for INSERT into Materialized View with concurrent DROP (<a href=https://github.com/azat rel="external nofollow noreferrer" target=_blank>Azat Khuzhin</a>).</li> <li>Do not try to read pass EOF (to workaround for a bug in the Linux kernel), this bug can be reproduced on kernels (3.14..5.9), and requires <code class=syntax>index_granularity_bytes=0</code> (i.e. turn off adaptive index granularity). <a href=https://github.com/ClickHouse/ClickHouse/pull/33372 rel="external nofollow noreferrer" target=_blank>#33372</a> (<a href=https://github.com/azat rel="external nofollow noreferrer" target=_blank>Azat Khuzhin</a>).</li> <li>The commands <code class=syntax>SYSTEM SUSPEND</code> and <code class=syntax>SYSTEM ... THREAD FUZZER</code> missed access control. It is fixed. Author: Kevin Michel. <a href=https://github.com/ClickHouse/ClickHouse/pull/33333 rel="external nofollow noreferrer" target=_blank>#33333</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer" target=_blank>alexey-milovidov</a>).</li> <li>Fix when <code class=syntax>COMMENT</code> for dictionaries does not appear in <code class=syntax>system.tables</code>, <code class=syntax>system.dictionaries</code>. Allow to modify the comment for <code class=syntax>Dictionary</code> engine. Closes <a href=https://github.com/ClickHouse/ClickHouse/issues/33251 rel="external nofollow noreferrer" target=_blank>#33251</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33261 rel="external nofollow noreferrer" target=_blank>#33261</a> (<a href=https://github.com/kitaisreal rel="external nofollow noreferrer" target=_blank>Maksim Kita</a>).</li> <li>Add asynchronous inserts (with enabled setting <code class=syntax>async_insert</code>) to query log. Previously such queries didn't appear in the query log. <a href=https://github.com/ClickHouse/ClickHouse/pull/33239 rel="external nofollow noreferrer" target=_blank>#33239</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer" target=_blank>Anton Popov</a>).</li> <li>Fix sending <code class=syntax>WHERE 1 = 0</code> expressions for external databases query. Closes <a href=https://github.com/ClickHouse/ClickHouse/issues/33152 rel="external nofollow noreferrer" target=_blank>#33152</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33214 rel="external nofollow noreferrer" target=_blank>#33214</a> (<a href=https://github.com/kssenii rel="external nofollow noreferrer" target=_blank>Kseniia Sumarokova</a>).</li> <li>Fix DDL validation for MaterializedPostgreSQL. Fix setting <code class=syntax>materialized_postgresql_allow_automatic_update</code>. Closes <a href=https://github.com/ClickHouse/ClickHouse/issues/29535 rel="external nofollow noreferrer" target=_blank>#29535</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33200 rel="external nofollow noreferrer" target=_blank>#33200</a> (<a href=https://github.com/kssenii rel="external nofollow noreferrer" target=_blank>Kseniia Sumarokova</a>). Make sure unused replication slots are always removed. Found in <a href=https://github.com/ClickHouse/ClickHouse/issues/26952 rel="external nofollow noreferrer" target=_blank>#26952</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33187 rel="external nofollow noreferrer" target=_blank>#33187</a> (<a href=https://github.com/kssenii rel="external nofollow noreferrer" target=_blank>Kseniia Sumarokova</a>). Fix MaterializedPostreSQL detach/attach (removing / adding to replication) tables with non-default schema. Found in <a href=https://github.com/ClickHouse/ClickHouse/issues/29535 rel="external nofollow noreferrer" target=_blank>#29535</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33179 rel="external nofollow noreferrer" target=_blank>#33179</a> (<a href=https://github.com/kssenii rel="external nofollow noreferrer" target=_blank>Kseniia Sumarokova</a>). Fix DROP MaterializedPostgreSQL database. <a href=https://github.com/ClickHouse/ClickHouse/pull/33468 rel="external nofollow noreferrer" target=_blank>#33468</a> (<a href=https://github.com/kssenii rel="external nofollow noreferrer" target=_blank>Kseniia Sumarokova</a>).</li> <li>The metric <code class=syntax>StorageBufferBytes</code> sometimes was miscalculated. <a href=https://github.com/ClickHouse/ClickHouse/pull/33159 rel="external nofollow noreferrer" target=_blank>#33159</a> (<a href=https://github.com/xuyatian rel="external nofollow noreferrer" target=_blank>xuyatian</a>).</li> <li>Fix error <code class=syntax>Invalid version for SerializationLowCardinality key column</code> in case of reading from <code class=syntax>LowCardinality</code> column with <code class=syntax>local_filesystem_read_prefetch</code> or <code class=syntax>remote_filesystem_read_prefetch</code> enabled. <a href=https://github.com/ClickHouse/ClickHouse/pull/33046 rel="external nofollow noreferrer" target=_blank>#33046</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer" target=_blank>Nikolai Kochetov</a>).</li> <li>Fix <code class=syntax>s3</code> table function reading empty file. Closes <a href=https://github.com/ClickHouse/ClickHouse/issues/33008 rel="external nofollow noreferrer" target=_blank>#33008</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33037 rel="external nofollow noreferrer" target=_blank>#33037</a> (<a href=https://github.com/kssenii rel="external nofollow noreferrer" target=_blank>Kseniia Sumarokova</a>).</li> <li>Fix Context leak in case of cancel_http_readonly_queries_on_client_close (i.e. leaking of external tables that had been uploaded the the server and other resources). <a href=https://github.com/ClickHouse/ClickHouse/pull/32982 rel="external nofollow noreferrer" target=_blank>#32982</a> (<a href=https://github.com/azat rel="external nofollow noreferrer" target=_blank>Azat Khuzhin</a>).</li> <li>Fix wrong tuple output in <code class=syntax>CSV</code> format in case of custom csv delimiter. <a href=https://github.com/ClickHouse/ClickHouse/pull/32981 rel="external nofollow noreferrer" target=_blank>#32981</a> (<a href=https://github.com/Avogar rel="external nofollow noreferrer" target=_blank>Kruglov Pavel</a>).</li> <li>Fix HDFS URL check that didn't allow using HA namenode address. Bug was introduced in <a href=https://github.com/ClickHouse/ClickHouse/pull/31042 target=_blank>https://github.com/ClickHouse/ClickHouse/pull/31042</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/32976 rel="external nofollow noreferrer" target=_blank>#32976</a> (<a href=https://github.com/Avogar rel="external nofollow noreferrer" target=_blank>Kruglov Pavel</a>).</li> <li>Fix throwing exception like positional argument out of bounds for non-positional arguments. Closes <a href=https://github.com/ClickHouse/ClickHouse/issues/31173 rel="external nofollow noreferrer" target=_blank>#31173</a>#event-5789668239. <a href=https://github.com/ClickHouse/ClickHouse/pull/32961 rel="external nofollow noreferrer" target=_blank>#32961</a> (<a href=https://github.com/kssenii rel="external nofollow noreferrer" target=_blank>Kseniia Sumarokova</a>).</li> <li>Fix UB in case of unexpected EOF during filling a set from HTTP query (i.e. if the client interrupted in the middle, i.e. <code class=syntax>timeout 0.15s curl -Ss -F 's=@t.csv;' 'http://127.0.0.1:8123/?s_structure=key+Int&amp;query=SELECT+dummy+IN+s'</code> and with large enough <code class=syntax>t.csv</code>). <a href=https://github.com/ClickHouse/ClickHouse/pull/32955 rel="external nofollow noreferrer" target=_blank>#32955</a> (<a href=https://github.com/azat rel="external nofollow noreferrer" target=_blank>Azat Khuzhin</a>).</li> <li>Fix a regression in <code class=syntax>replaceRegexpAll</code> function. The function worked incorrectly when matched substring was empty. This closes <a href=https://github.com/ClickHouse/ClickHouse/issues/32777 rel="external nofollow noreferrer" target=_blank>#32777</a>. This closes <a href=https://github.com/ClickHouse/ClickHouse/issues/30245 rel="external nofollow noreferrer" target=_blank>#30245</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/32945 rel="external nofollow noreferrer" target=_blank>#32945</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer" target=_blank>alexey-milovidov</a>).</li> <li>Fix <code class=syntax>ORC</code> format stripe reading. <a href=https://github.com/ClickHouse/ClickHouse/pull/32929 rel="external nofollow noreferrer" target=_blank>#32929</a> (<a href=https://github.com/kreuzerkrieg rel="external nofollow noreferrer" target=_blank>kreuzerkrieg</a>).</li> <li><code class=syntax>topKWeightedState</code> failed for some input types. <a href=https://github.com/ClickHouse/ClickHouse/issues/32487 rel="external nofollow noreferrer" target=_blank>#32487</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/32914 rel="external nofollow noreferrer" target=_blank>#32914</a> (<a href=https://github.com/vdimir rel="external nofollow noreferrer" target=_blank>vdimir</a>).</li> <li>Fix exception <code class=syntax>Single chunk is expected from view inner query (LOGICAL_ERROR)</code> in materialized view. Fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/31419 rel="external nofollow noreferrer" target=_blank>#31419</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/32862 rel="external nofollow noreferrer" target=_blank>#32862</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer" target=_blank>Nikolai Kochetov</a>).</li> <li>Fix optimization with lazy seek for async reads from remote filesystems. Closes <a href=https://github.com/ClickHouse/ClickHouse/issues/32803 rel="external nofollow noreferrer" target=_blank>#32803</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/32835 rel="external nofollow noreferrer" target=_blank>#32835</a> (<a href=https://github.com/kssenii rel="external nofollow noreferrer" target=_blank>Kseniia Sumarokova</a>).</li> <li><code class=syntax>MergeTree</code> table engine might silently skip some mutations if there are too many running mutations or in case of high memory consumption, it's fixed. Fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/17882 rel="external nofollow noreferrer" target=_blank>#17882</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/32814 rel="external nofollow noreferrer" target=_blank>#32814</a> (<a href=https://github.com/tavplubix rel="external nofollow noreferrer" target=_blank>tavplubix</a>).</li> <li>Avoid reusing the scalar subquery cache when processing MV blocks. This fixes a bug when the scalar query reference the source table but it means that all subscalar queries in the MV definition will be calculated for each block. <a href=https://github.com/ClickHouse/ClickHouse/pull/32811 rel="external nofollow noreferrer" target=_blank>#32811</a> (<a href=https://github.com/Algunenano rel="external nofollow noreferrer" target=_blank>Raúl Marín</a>).</li> <li>Server might fail to start if database with <code class=syntax>MySQL</code> engine cannot connect to MySQL server, it's fixed. Fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/14441 rel="external nofollow noreferrer" target=_blank>#14441</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/32802 rel="external nofollow noreferrer" target=_blank>#32802</a> (<a href=https://github.com/tavplubix rel="external nofollow noreferrer" target=_blank>tavplubix</a>).</li> <li>Fix crash when used <code class=syntax>fuzzBits</code> function, close <a href=https://github.com/ClickHouse/ClickHouse/issues/32737 rel="external nofollow noreferrer" target=_blank>#32737</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/32755 rel="external nofollow noreferrer" target=_blank>#32755</a> (<a href=https://github.com/cmsxbc rel="external nofollow noreferrer" target=_blank>SuperDJY</a>).</li> <li>Fix error <code class=syntax>Column is not under aggregate function</code> in case of MV with <code class=syntax>GROUP BY (list of columns)</code> (which is pared as <code class=syntax>GROUP BY tuple(...)</code>) over <code class=syntax>Kafka</code>/<code class=syntax>RabbitMQ</code>. Fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/32668 rel="external nofollow noreferrer" target=_blank>#32668</a> and <a href=https://github.com/ClickHouse/ClickHouse/issues/32744 rel="external nofollow noreferrer" target=_blank>#32744</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/32751 rel="external nofollow noreferrer" target=_blank>#32751</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer" target=_blank>Nikolai Kochetov</a>).</li> <li>Fix <code class=syntax>ALTER TABLE ... MATERIALIZE TTL</code> query with <code class=syntax>TTL ... DELETE WHERE ...</code> and <code class=syntax>TTL ... GROUP BY ...</code> modes. <a href=https://github.com/ClickHouse/ClickHouse/pull/32695 rel="external nofollow noreferrer" target=_blank>#32695</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer" target=_blank>Anton Popov</a>).</li> <li>Fix <code class=syntax>optimize_read_in_order</code> optimization in case when table engine is <code class=syntax>Distributed</code> or <code class=syntax>Merge</code> and its underlying <code class=syntax>MergeTree</code> tables have monotonous function in prefix of sorting key. <a href=https://github.com/ClickHouse/ClickHouse/pull/32670 rel="external nofollow noreferrer" target=_blank>#32670</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer" target=_blank>Anton Popov</a>).</li> <li>Fix LOGICAL_ERROR exception when the target of a materialized view is a JOIN or a SET table. <a href=https://github.com/ClickHouse/ClickHouse/pull/32669 rel="external nofollow noreferrer" target=_blank>#32669</a> (<a href=https://github.com/Algunenano rel="external nofollow noreferrer" target=_blank>Raúl Marín</a>).</li> <li>Inserting into S3 with multipart upload to Google Cloud Storage may trigger abort. <a href=https://github.com/ClickHouse/ClickHouse/issues/32504 rel="external nofollow noreferrer" target=_blank>#32504</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/32649 rel="external nofollow noreferrer" target=_blank>#32649</a> (<a href=https://github.com/vdimir rel="external nofollow noreferrer" target=_blank>vdimir</a>).</li> <li>Fix possible exception at <code class=syntax>RabbitMQ</code> storage startup by delaying channel creation. <a href=https://github.com/ClickHouse/ClickHouse/pull/32584 rel="external nofollow noreferrer" target=_blank>#32584</a> (<a href=https://github.com/kssenii rel="external nofollow noreferrer" target=_blank>Kseniia Sumarokova</a>).</li> <li>Fix table lifetime (i.e. possible use-after-free) in case of parallel DROP TABLE and INSERT. <a href=https://github.com/ClickHouse/ClickHouse/pull/32572 rel="external nofollow noreferrer" target=_blank>#32572</a> (<a href=https://github.com/azat rel="external nofollow noreferrer" target=_blank>Azat Khuzhin</a>).</li> <li>Fix async inserts with formats <code class=syntax>CustomSeparated</code>, <code class=syntax>Template</code>, <code class=syntax>Regexp</code>, <code class=syntax>MsgPack</code> and <code class=syntax>JSONAsString</code>. Previousely the async inserts with these formats didn't read any data. <a href=https://github.com/ClickHouse/ClickHouse/pull/32530 rel="external nofollow noreferrer" target=_blank>#32530</a> (<a href=https://github.com/Avogar rel="external nofollow noreferrer" target=_blank>Kruglov Pavel</a>).</li> <li>Fix <code class=syntax>groupBitmapAnd</code> function on distributed table. <a href=https://github.com/ClickHouse/ClickHouse/pull/32529 rel="external nofollow noreferrer" target=_blank>#32529</a> (<a href=https://github.com/dmthuc rel="external nofollow noreferrer" target=_blank>minhthucdao</a>).</li> <li>Fix crash in JOIN found by fuzzer, close <a href=https://github.com/ClickHouse/ClickHouse/issues/32458 rel="external nofollow noreferrer" target=_blank>#32458</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/32508 rel="external nofollow noreferrer" target=_blank>#32508</a> (<a href=https://github.com/vdimir rel="external nofollow noreferrer" target=_blank>vdimir</a>).</li> <li>Proper handling of the case with Apache Arrow column duplication. <a href=https://github.com/ClickHouse/ClickHouse/pull/32507 rel="external nofollow noreferrer" target=_blank>#32507</a> (<a href=https://github.com/DMokhnatkin rel="external nofollow noreferrer" target=_blank>Dmitriy Mokhnatkin</a>).</li> <li>Fix issue with ambiguous query formatting in distributed queries that led to errors when some table columns were named <code class=syntax>ALL</code> or <code class=syntax>DISTINCT</code>. This closes <a href=https://github.com/ClickHouse/ClickHouse/issues/32391 rel="external nofollow noreferrer" target=_blank>#32391</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/32490 rel="external nofollow noreferrer" target=_blank>#32490</a> (<a href=https://github.com/alexey-milovidov rel="external nofollow noreferrer" target=_blank>alexey-milovidov</a>).</li> <li>Fix failures in queries that are trying to use skipping indices, which are not materialized yet. Fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/32292 rel="external nofollow noreferrer" target=_blank>#32292</a> and <a href=https://github.com/ClickHouse/ClickHouse/issues/30343 rel="external nofollow noreferrer" target=_blank>#30343</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/32359 rel="external nofollow noreferrer" target=_blank>#32359</a> (<a href=https://github.com/CurtizJ rel="external nofollow noreferrer" target=_blank>Anton Popov</a>).</li> <li>Fix broken select query when there are more than 2 row policies on same column, begin at second queries on the same session. <a href=https://github.com/ClickHouse/ClickHouse/issues/31606 rel="external nofollow noreferrer" target=_blank>#31606</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/32291 rel="external nofollow noreferrer" target=_blank>#32291</a> (<a href=https://github.com/cmsxbc rel="external nofollow noreferrer" target=_blank>SuperDJY</a>).</li> <li>Fix fractional unix timestamp conversion to <code class=syntax>DateTime64</code>, fractional part was reversed for negative unix timestamps (before 1970-01-01). <a href=https://github.com/ClickHouse/ClickHouse/pull/32240 rel="external nofollow noreferrer" target=_blank>#32240</a> (<a href=https://github.com/benbiti rel="external nofollow noreferrer" target=_blank>Ben</a>).</li> <li>Some entries of replication queue might hang for <code class=syntax>temporary_directories_lifetime</code> (1 day by default) with <code class=syntax>Directory tmp_merge_&lt;part_name&gt;</code> or <code class=syntax>Part ... (state Deleting) already exists, but it will be deleted soon</code> or similar error. It's fixed. Fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/29616 rel="external nofollow noreferrer" target=_blank>#29616</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/32201 rel="external nofollow noreferrer" target=_blank>#32201</a> (<a href=https://github.com/tavplubix rel="external nofollow noreferrer" target=_blank>tavplubix</a>).</li> <li>Fix parsing of <code class=syntax>APPLY lambda</code> column transformer which could lead to client/server crash. <a href=https://github.com/ClickHouse/ClickHouse/pull/32138 rel="external nofollow noreferrer" target=_blank>#32138</a> (<a href=https://github.com/Avogar rel="external nofollow noreferrer" target=_blank>Kruglov Pavel</a>).</li> <li>Fix <code class=syntax>base64Encode</code> adding trailing bytes on small strings. <a href=https://github.com/ClickHouse/ClickHouse/pull/31797 rel="external nofollow noreferrer" target=_blank>#31797</a> (<a href=https://github.com/kmichel-aiven rel="external nofollow noreferrer" target=_blank>Kevin Michel</a>).</li> <li>Fix possible crash (or incorrect result) in case of <code class=syntax>LowCardinality</code> arguments of window function. Fixes <a href=https://github.com/ClickHouse/ClickHouse/issues/31114 rel="external nofollow noreferrer" target=_blank>#31114</a>. <a href=https://github.com/ClickHouse/ClickHouse/pull/31888 rel="external nofollow noreferrer" target=_blank>#31888</a> (<a href=https://github.com/KochetovNicolai rel="external nofollow noreferrer" target=_blank>Nikolai Kochetov</a>).</li> <li>Fix hang up with command <code class=syntax>DROP TABLE system.query_log sync</code>. <a href=https://github.com/ClickHouse/ClickHouse/pull/33293 rel="external nofollow noreferrer" target=_blank>#33293</a> (<a href=https://github.com/zhanghuajieHIT rel="external nofollow noreferrer" target=_blank>zhanghuajie</a>).</li> </ul> <h2 id=changelog-for-2021><a href=https://github.com/ClickHouse/ClickHouse/blob/master/docs/en/whats-new/changelog/2021.md rel="external nofollow noreferrer" target=_blank>Changelog for 2021</a><a class=headerlink href=../amp/#changelog-for-2021 title="Permanent link"> </a></h2>
        </div>
      </div>
      <div class="row">
        <div class="col">
          
<div class="alert alert-light my-3">
  <p class="float-right mb-0">Rating: RATING_VALUE - RATING_COUNT votes</p>
  <span class="alert-heading display-6">Article Rating</span>
  <div id="rating-stars" class="display-6 mb-0"
     
  >RATING_STARS</div>
</div>

<div id="content-footer" class="text-muted pt-3 mb-5">
    <div class="float-md-right">©2016–2022 ClickHouse, Inc.</div>
    <div>Built from <a href="https://github.com/ClickHouse/ClickHouse/commit/c60fd44c5b70c56ff0f9c7fc538e58c6c8186aea" rel="external nofollow noreferrer" target="_blank" class="text-reset">c60fd44c</a>
    
    </div>
</div>

        </div>
      </div>
      <div id="to-full-website" class="row fixed-bottom text-center bg-white py-3">
        <div class="col">
          <a class="btn btn-lg btn-outline-orange" href="https://clickhouse.com/docs/en/whats-new/changelog/">To full website</a>
        </div>
      </div>
    </div>
    <amp-analytics type="metrika">
      <script type="application/json">{
"vars": {
  "counterId": "18343495",
  "triggers": {
    "notBounce": {
      "on": "timer",
      "timerSpec": {
        "immediate": false,
        "interval": 15,
        "maxTimerLength": 16
      },
      "request": "notBounce"
    }
  }
}
}</script>
  </amp-analytics>
  </body>
</html>
