










    



    



    



    
    






    <!doctype html>
<html ⚡ lang="en">
  <head>
    <meta charset="utf-8">
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    <title>VIEW | ClickHouse Documentation</title>
    <link rel="canonical" href="https://clickhouse.com/docs/en/sql-reference/statements/create/view/" />
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    
<script type="application/ld+json">[{
"@context": "http://schema.org",
"@type": "TechArticle",
"headline": "VIEW | ClickHouse Documentation",
"mainEntityOfPage": "https://clickhouse.com/docs/en/sql-reference/statements/create/view/",




"image": "https://clickhouse.com/images/clickhouse-209x60.png",
"author": {
  "@type": "Project",
  "name": "ClickHouse"
},
"publisher": {
  "@type": "Organization",
  "name": "ClickHouse, Inc.",
  "logo": {
    "@type": "ImageObject",
    "url": "https://clickhouse.com/images/logo-400x240.png",
    "width": 400,
    "height": 240
  }
}}, {
"@context": "http://schema.org",
"@type": "Episode",
"name": "VIEW | ClickHouse Documentation",
"aggregateRating": {
  "@type": "AggregateRating",
  "ratingValue": RATING_VALUE,
  "ratingCount": RATING_COUNT
}
}]</script>

    
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <style amp-custom>:root{--blue:#007bff;--indigo:#6610f2;--purple:#6f42c1;--pink:#e83e8c;--red:#dc3545;--orange:#fd7e14;--yellow:#ffc107;--green:#28a745;--teal:#20c997;--cyan:#17a2b8;--gray:#6c757d;--gray-dark:#343a40;--brand-primary:#fc0;--brand-secondary:#ff3939;--primary-accent-yellow:#fc0;--primary-accent-light-yellow:#fffaf0;--primary-accent-blue:#257af4;--primary-accent-light-blue:#e3f1fe;--secondary-accent-orange:#ff8c00;--secondary-accent-light-orange:#ffe4b5;--secondary-accent-red:#ff3939;--secondary-accent-light-red:#ffe4e1;--primary:#fc0;--secondary:#212529;--success:#28a745;--info:#17a2b8;--warning:#ffc107;--danger:#dc3545;--light:#f1f6f9;--dark:#495057;--primary-light:#fffaf0;--secondary-light:#fff;--tertiary:#257af4;--tertiary-light:#e3f1fe;--white:#fff;--black:#212529;--blue:#257af4;--light-blue:#e3f1fe;--yellow:#fc0;--light-yellow:#fffaf0;--orange:#ff8c00;--light-orange:#ffe4b5;--red:#ff3939;--light-red:#ffe4e1;--medium:#d6dbdf;--breakpoint-xxs:0;--breakpoint-xs:400px;--breakpoint-sm:616px;--breakpoint-md:768px;--breakpoint-lg:980px;--breakpoint-xl:1240px;--font-family-sans-serif:"Noto Sans",sans-serif;--font-family-monospace:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}*,:after,:before{box-sizing:border-box}html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:rgba(33,37,41,0)}article,footer{display:block}body{margin:0;font-family:Noto Sans,sans-serif;font-size:1rem;font-weight:400;line-height:1.5;color:#212529;text-align:left;background-color:#fff}[tabindex="-1"]:focus:not(:focus-visible){outline:0}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:16px}p{margin-top:0;margin-bottom:1rem}ul{margin-bottom:1rem}ul{margin-top:0}ul ul{margin-bottom:0}b,strong{font-weight:bolder}a{text-decoration:none;background-color:transparent}a,a:hover{color:#ff8c00}a:hover{text-decoration:underline}a:not([href]),a:not([href]):hover{color:inherit;text-decoration:none}code,pre{font-family:SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em}pre{margin-top:0;margin-bottom:1rem;overflow:auto}img{border-style:none}img,svg{vertical-align:middle}svg{overflow:hidden}table{border-collapse:collapse}input,select{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}input{overflow:visible}select{text-transform:none}select{word-wrap:normal}[type=button],[type=reset],[type=submit]{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled){cursor:pointer}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{padding:0;border-style:none}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=date],input[type=datetime-local],input[type=month],input[type=time]{-webkit-appearance:listbox}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:none}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}[hidden]{display:none}.h1,.h2,.h3,.h4,.h5,.h6,h1,h2,h3,h4,h5,h6{margin-bottom:16px;font-family:Hind Siliguri,sans-serif;font-weight:500;line-height:1.125}.h1,h1{font-size:2.5rem}@media(max-width:1200px){.h1,h1{font-size:calc(1.375rem+1.5vw)}}.h2,h2{font-size:2rem}@media(max-width:1200px){.h2,h2{font-size:calc(1.325rem+.9vw)}}.h3,h3{font-size:1.75rem}@media(max-width:1200px){.h3,h3{font-size:calc(1.3rem+.6vw)}}.h4,h4{font-size:1.5rem}@media(max-width:1200px){.h4,h4{font-size:calc(1.275rem+.3vw)}}.h5,h5{font-size:1.125rem}.h6,h6{font-size:.875rem}.display-1{font-size:4rem;font-weight:600;line-height:1.125}@media(max-width:1200px){.display-1{font-size:calc(1.525rem+3.3vw)}}.display-2{font-size:2.5rem;font-weight:600;line-height:1.125}@media(max-width:1200px){.display-2{font-size:calc(1.375rem+1.5vw)}}.display-3{font-size:2rem;font-weight:500;line-height:1.125}@media(max-width:1200px){.display-3{font-size:calc(1.325rem+.9vw)}}.display-4{font-size:1.75rem;font-weight:500;line-height:1.125}@media(max-width:1200px){.display-4{font-size:calc(1.3rem+.6vw)}}.img-fluid{max-width:100%;height:auto}code{font-size:87.5%;color:#e83e8c;word-wrap:break-word}a>code{color:inherit}pre{display:block;font-size:87.5%;color:#495057}pre code{font-size:inherit;color:inherit;word-break:normal}.container{width:100%;padding-right:20px;padding-left:20px;margin-right:auto;margin-left:auto}@media(min-width:400px){.container{max-width:576px}}@media(min-width:616px){.container{max-width:576px}}@media(min-width:768px){.container{max-width:958px}}@media(min-width:980px){.container{max-width:1008px}}@media(min-width:1240px){.container{max-width:1118px}}.container-fluid,.container-lg,.container-md{width:100%;padding-right:20px;padding-left:20px;margin-right:auto;margin-left:auto}@media(min-width:400px){.container{max-width:576px}}@media(min-width:616px){.container{max-width:576px}}@media(min-width:768px){.container,.container-md{max-width:958px}}@media(min-width:980px){.container,.container-lg,.container-md{max-width:1008px}}@media(min-width:1240px){.container,.container-lg,.container-md{max-width:1118px}}.row{display:flex;flex-wrap:wrap;margin-right:-20px;margin-left:-20px}.col,.col-1,.col-10,.col-11,.col-12,.col-2,.col-3,.col-4,.col-5,.col-6,.col-7,.col-8,.col-9,.col-lg,.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-md,.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9{position:relative;width:100%;padding-right:20px;padding-left:20px}.col{flex-basis:0;flex-grow:1;max-width:100%}.col-1{flex:0 0 8.3333333333%;max-width:8.3333333333%}.col-2{flex:0 0 16.6666666667%;max-width:16.6666666667%}.col-3{flex:0 0 25%;max-width:25%}.col-4{flex:0 0 33.3333333333%;max-width:33.3333333333%}.col-5{flex:0 0 41.6666666667%;max-width:41.6666666667%}.col-6{flex:0 0 50%;max-width:50%}.col-7{flex:0 0 58.3333333333%;max-width:58.3333333333%}.col-8{flex:0 0 66.6666666667%;max-width:66.6666666667%}.col-9{flex:0 0 75%;max-width:75%}.col-10{flex:0 0 83.3333333333%;max-width:83.3333333333%}.col-11{flex:0 0 91.6666666667%;max-width:91.6666666667%}.col-12{flex:0 0 100%;max-width:100%}.order-first{order:-1}.order-last{order:13}.order-0{order:0}.order-1{order:1}.order-2{order:2}.order-3{order:3}.order-4{order:4}.order-5{order:5}.order-6{order:6}.order-7{order:7}.order-8{order:8}.order-9{order:9}.order-10{order:10}.order-11{order:11}.order-12{order:12}@media(min-width:768px){.col-md{flex-basis:0;flex-grow:1;max-width:100%}.col-md-1{flex:0 0 8.3333333333%;max-width:8.3333333333%}.col-md-2{flex:0 0 16.6666666667%;max-width:16.6666666667%}.col-md-3{flex:0 0 25%;max-width:25%}.col-md-4{flex:0 0 33.3333333333%;max-width:33.3333333333%}.col-md-5{flex:0 0 41.6666666667%;max-width:41.6666666667%}.col-md-6{flex:0 0 50%;max-width:50%}.col-md-7{flex:0 0 58.3333333333%;max-width:58.3333333333%}.col-md-8{flex:0 0 66.6666666667%;max-width:66.6666666667%}.col-md-9{flex:0 0 75%;max-width:75%}.col-md-10{flex:0 0 83.3333333333%;max-width:83.3333333333%}.col-md-11{flex:0 0 91.6666666667%;max-width:91.6666666667%}.col-md-12{flex:0 0 100%;max-width:100%}.order-md-first{order:-1}.order-md-last{order:13}.order-md-0{order:0}.order-md-1{order:1}.order-md-2{order:2}.order-md-3{order:3}.order-md-4{order:4}.order-md-5{order:5}.order-md-6{order:6}.order-md-7{order:7}.order-md-8{order:8}.order-md-9{order:9}.order-md-10{order:10}.order-md-11{order:11}.order-md-12{order:12}}@media(min-width:980px){.col-lg{flex-basis:0;flex-grow:1;max-width:100%}.col-lg-1{flex:0 0 8.3333333333%;max-width:8.3333333333%}.col-lg-2{flex:0 0 16.6666666667%;max-width:16.6666666667%}.col-lg-3{flex:0 0 25%;max-width:25%}.col-lg-4{flex:0 0 33.3333333333%;max-width:33.3333333333%}.col-lg-5{flex:0 0 41.6666666667%;max-width:41.6666666667%}.col-lg-6{flex:0 0 50%;max-width:50%}.col-lg-7{flex:0 0 58.3333333333%;max-width:58.3333333333%}.col-lg-8{flex:0 0 66.6666666667%;max-width:66.6666666667%}.col-lg-9{flex:0 0 75%;max-width:75%}.col-lg-10{flex:0 0 83.3333333333%;max-width:83.3333333333%}.col-lg-11{flex:0 0 91.6666666667%;max-width:91.6666666667%}.col-lg-12{flex:0 0 100%;max-width:100%}.order-lg-first{order:-1}.order-lg-last{order:13}.order-lg-0{order:0}.order-lg-1{order:1}.order-lg-2{order:2}.order-lg-3{order:3}.order-lg-4{order:4}.order-lg-5{order:5}.order-lg-6{order:6}.order-lg-7{order:7}.order-lg-8{order:8}.order-lg-9{order:9}.order-lg-10{order:10}.order-lg-11{order:11}.order-lg-12{order:12}}.table{width:100%;margin-bottom:8px;color:#212529}.table-primary{background-color:#fff1b8}.table-info{background-color:#bee5eb}.table-danger{background-color:#f5c6cb}.table-light{background-color:#fbfcfd}.table-dark{background-color:#ccced0}.table-primary-light{background-color:#fffefb}.table-white{background-color:#fff}.table-black{background-color:#c1c2c3}.table-orange{background-color:#ffdfb8}.table-light-orange{background-color:#fff7ea}.table-active{background-color:rgba(33,37,41,.075)}.table-dark{color:#fff;background-color:#343a40}.form-group{margin-bottom:1rem}.form-text{display:block;margin-top:.25rem}.form-row{display:flex;flex-wrap:wrap;margin-right:-5px;margin-left:-5px}.form-row>.col,.form-row>[class*=col-]{padding-right:5px;padding-left:5px}.form-inline{display:flex;flex-flow:row wrap;align-items:center}@media(min-width:616px){.form-inline .form-group{display:flex;align-items:center;margin-bottom:0}.form-inline .form-group{flex:0 0 auto;flex-flow:row wrap}.form-inline .custom-select,.form-inline .input-group{width:auto}}.btn{display:inline-block;font-family:inherit;font-weight:700;color:#212529;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;padding:12px 32px;font-size:.875rem;line-height:20px;border-radius:8px;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media(prefers-reduced-motion:reduce){.btn{transition:none}}.btn:hover{color:#212529;text-decoration:none}.btn:focus{outline:0;box-shadow:none}.btn:disabled{opacity:.65}.btn-primary{color:#495057;background-color:#fc0;border-color:#fc0}.btn-primary:focus,.btn-primary:hover{color:#495057;background-color:#d9ad00;border-color:#cca300}.btn-primary:focus{box-shadow:0 0 0 0 rgba(228,185,13,.5)}.btn-primary:disabled{color:#495057;background-color:#fc0;border-color:#fc0}.btn-info{color:#fff;background-color:#17a2b8;border-color:#17a2b8}.btn-info:focus,.btn-info:hover{color:#fff;background-color:#138496;border-color:#117a8b}.btn-info:focus{box-shadow:0 0 0 0 rgba(58,176,195,.5)}.btn-info:disabled{color:#fff;background-color:#17a2b8;border-color:#17a2b8}.btn-danger{color:#fff;background-color:#dc3545;border-color:#dc3545}.btn-danger:focus,.btn-danger:hover{color:#fff;background-color:#c82333;border-color:#bd2130}.btn-danger:focus{box-shadow:0 0 0 0 rgba(225,83,97,.5)}.btn-danger:disabled{color:#fff;background-color:#dc3545;border-color:#dc3545}.btn-light{color:#495057;background-color:#f1f6f9;border-color:#f1f6f9}.btn-light:focus,.btn-light:hover{color:#495057;background-color:#d6e5ee;border-color:#cddfea}.btn-light:focus{box-shadow:0 0 0 0 rgba(216,221,225,.5)}.btn-light:disabled{color:#495057;background-color:#f1f6f9;border-color:#f1f6f9}.btn-dark{color:#fff;background-color:#495057;border-color:#495057}.btn-dark:focus,.btn-dark:hover{color:#fff;background-color:#383d42;border-color:#32373b}.btn-dark:focus{box-shadow:0 0 0 0 rgba(100,106,112,.5)}.btn-dark:disabled{color:#fff;background-color:#495057;border-color:#495057}.btn-primary-light{color:#495057;background-color:#fffaf0;border-color:#fffaf0}.btn-primary-light:focus,.btn-primary-light:hover{color:#495057;background-color:#ffedca;border-color:#ffe9bd}.btn-primary-light:focus{box-shadow:0 0 0 0 rgba(228,225,217,.5)}.btn-primary-light:disabled{color:#495057;background-color:#fffaf0;border-color:#fffaf0}.btn-white{color:#495057;background-color:#fff;border-color:#fff}.btn-white:focus,.btn-white:hover{color:#495057;background-color:#ececec;border-color:#e6e6e6}.btn-white:focus{box-shadow:0 0 0 0 rgba(228,229,230,.5)}.btn-white:disabled{color:#495057;background-color:#fff;border-color:#fff}.btn-black{color:#fff;background-color:#212529;border-color:#212529}.btn-black:focus,.btn-black:hover{color:#fff;background-color:#101214;border-color:#0a0c0d}.btn-black:focus{box-shadow:0 0 0 0 rgba(66,70,73,.5)}.btn-black:disabled{color:#fff;background-color:#212529;border-color:#212529}.btn-orange{color:#495057;background-color:#ff8c00;border-color:#ff8c00}.btn-orange:focus,.btn-orange:hover{color:#fff;background-color:#d97700;border-color:#cc7000}.btn-orange:focus{box-shadow:0 0 0 0 rgba(228,131,13,.5)}.btn-orange:disabled{color:#495057;background-color:#ff8c00;border-color:#ff8c00}.btn-light-orange{color:#495057;background-color:#ffe4b5;border-color:#ffe4b5}.btn-light-orange:focus,.btn-light-orange:hover{color:#495057;background-color:#ffd68f;border-color:#ffd182}.btn-light-orange:focus{box-shadow:0 0 0 0 rgba(228,206,167,.5)}.btn-light-orange:disabled{color:#495057;background-color:#ffe4b5;border-color:#ffe4b5}.btn-outline-primary{color:#fc0;border-color:#fc0}.btn-outline-primary:hover{color:#495057;background-color:#fc0;border-color:#fc0}.btn-outline-primary:focus{box-shadow:0 0 0 0 rgba(255,204,0,.5)}.btn-outline-primary:disabled{color:#fc0;background-color:transparent}.btn-outline-info{color:#17a2b8;border-color:#17a2b8}.btn-outline-info:hover{color:#fff;background-color:#17a2b8;border-color:#17a2b8}.btn-outline-info:focus{box-shadow:0 0 0 0 rgba(23,162,184,.5)}.btn-outline-info:disabled{color:#17a2b8;background-color:transparent}.btn-outline-danger{color:#dc3545;border-color:#dc3545}.btn-outline-danger:hover{color:#fff;background-color:#dc3545;border-color:#dc3545}.btn-outline-danger:focus{box-shadow:0 0 0 0 rgba(220,53,69,.5)}.btn-outline-danger:disabled{color:#dc3545;background-color:transparent}.btn-outline-light{color:#f1f6f9;border-color:#f1f6f9}.btn-outline-light:hover{color:#495057;background-color:#f1f6f9;border-color:#f1f6f9}.btn-outline-light:focus{box-shadow:0 0 0 0 rgba(241,246,249,.5)}.btn-outline-light:disabled{color:#f1f6f9;background-color:transparent}.btn-outline-dark{color:#495057;border-color:#495057}.btn-outline-dark:hover{color:#fff;background-color:#495057;border-color:#495057}.btn-outline-dark:focus{box-shadow:0 0 0 0 rgba(73,80,87,.5)}.btn-outline-dark:disabled{color:#495057;background-color:transparent}.btn-outline-primary-light{color:#fffaf0;border-color:#fffaf0}.btn-outline-primary-light:hover{color:#495057;background-color:#fffaf0;border-color:#fffaf0}.btn-outline-primary-light:focus{box-shadow:0 0 0 0 rgba(255,250,240,.5)}.btn-outline-primary-light:disabled{color:#fffaf0;background-color:transparent}.btn-outline-white{color:#fff;border-color:#fff}.btn-outline-white:hover{color:#495057;background-color:#fff;border-color:#fff}.btn-outline-white:focus{box-shadow:0 0 0 0 hsla(0,0%,100%,.5)}.btn-outline-white:disabled{color:#fff;background-color:transparent}.btn-outline-black{color:#212529;border-color:#212529}.btn-outline-black:hover{color:#fff;background-color:#212529;border-color:#212529}.btn-outline-black:focus{box-shadow:0 0 0 0 rgba(33,37,41,.5)}.btn-outline-black:disabled{color:#212529;background-color:transparent}.btn-outline-orange{color:#ff8c00;border-color:#ff8c00}.btn-outline-orange:hover{color:#495057;background-color:#ff8c00;border-color:#ff8c00}.btn-outline-orange:focus{box-shadow:0 0 0 0 rgba(255,140,0,.5)}.btn-outline-orange:disabled{color:#ff8c00;background-color:transparent}.btn-outline-light-orange{color:#ffe4b5;border-color:#ffe4b5}.btn-outline-light-orange:hover{color:#495057;background-color:#ffe4b5;border-color:#ffe4b5}.btn-outline-light-orange:focus{box-shadow:0 0 0 0 rgba(255,228,181,.5)}.btn-outline-light-orange:disabled{color:#ffe4b5;background-color:transparent}.btn-link{font-weight:400;color:#ff8c00;text-decoration:none}.btn-link:hover{color:#ff8c00;text-decoration:underline}.btn-link:focus{text-decoration:underline;box-shadow:none}.btn-link:disabled{color:#d6dbdf;pointer-events:none}.btn-group-lg>.btn,.btn-lg{padding:16px 32px;font-size:1.125rem;line-height:26px;border-radius:8px}.btn-block{display:block;width:100%}.btn-block+.btn-block{margin-top:24px}input[type=button].btn-block,input[type=reset].btn-block,input[type=submit].btn-block{width:100%}.btn-group{position:relative;display:inline-flex;vertical-align:middle}.btn-group>.btn{position:relative;flex:1 1 auto}.btn-group>.btn.active,.btn-group>.btn:active,.btn-group>.btn:focus,.btn-group>.btn:hover{z-index:1}.btn-group>.btn-group:not(:first-child),.btn-group>.btn:not(:first-child){margin-left:-1px}.btn-group>.btn-group:not(:last-child)>.btn{border-top-right-radius:0;border-bottom-right-radius:0}.btn-group>.btn-group:not(:first-child)>.btn,.btn-group>.btn:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.input-group{position:relative;display:flex;flex-wrap:wrap;align-items:stretch;width:100%}.input-group>.custom-select{position:relative;flex:1 1 0;min-width:0;margin-bottom:0}.input-group>.custom-select+.custom-select{margin-left:-1px}.input-group>.custom-select:focus{z-index:3}.input-group>.custom-select:not(:last-child){border-top-right-radius:0;border-bottom-right-radius:0}.input-group>.custom-select:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.input-group-text{display:flex;align-items:center;padding:.375rem .75rem;margin-bottom:0;font-size:1rem;font-weight:400;line-height:1.5;color:#6c757d;text-align:center;white-space:nowrap;background-color:#e9ecef;border:1px solid #ced4da;border-radius:8px}.input-group-text input[type=checkbox],.input-group-text input[type=radio]{margin-top:0}.input-group-lg>.custom-select{height:calc(1.5em+1rem+2px)}.input-group-lg>.custom-select{padding:.5rem 1rem;font-size:1.125rem;line-height:1.5;border-radius:8px}.input-group-lg>.custom-select{padding-right:1.75rem}.custom-select{display:inline-block;width:100%;height:calc(1.5em+.75rem+2px);padding:.375rem 1.75rem .375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#6c757d;vertical-align:middle;background:#fff url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='4' height='5'%3E%3Cpath fill='%23343a40' d='M2 0L0 2h4zm0 5L0 3h4z'/%3E%3C/svg%3E") no-repeat right .75rem center/8px 10px;border:1px solid #ced4da;border-radius:8px;-webkit-appearance:none;-moz-appearance:none;appearance:none}.custom-select:focus{border-color:#ffe680;outline:0;box-shadow:0 0 0 .2rem rgba(255,204,0,.25)}.custom-select:focus::-ms-value{color:#6c757d;background-color:#fff}.custom-select[multiple],.custom-select[size]:not([size="1"]){height:auto;padding-right:.75rem;background-image:none}.custom-select:disabled{color:#6c757d;background-color:#e9ecef}.custom-select::-ms-expand{display:none}.custom-select:-moz-focusring{color:transparent;text-shadow:0 0 0 #6c757d}.custom-select-lg{height:calc(1.5em+1rem+2px);padding-top:.5rem;padding-bottom:.5rem;padding-left:1rem;font-size:1.125rem}.custom-select{transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media(prefers-reduced-motion:reduce){.custom-select{transition:none}}pre{white-space:pre-wrap}pre{border:1px solid #d6dbdf;page-break-inside:avoid}img{page-break-inside:avoid}h2,h3,p{orphans:3;widows:3}h2,h3{page-break-after:avoid}@page{size:a3}.container,body{min-width:980px}.table{border-collapse:collapse}.table-dark{color:inherit}</style>
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    <script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>
  </head>
  <body class="amp" dir="ltr">
    <div class="container-fluid container-lg pb-5">
      <div class="row pt-3 mb-3">
        <div class="col">
          <a href="/" class="text-decoration-none">
            <amp-img class="d-inline-block mr-3" layout="fixed" width="40" height="36" src="/docs/images/logo.svg" alt="ClickHouse logo" title="ClickHouse logo"></amp-img><amp-img class="invert-dark d-inline-block" layout="fixed" width="238" height="36" src="/docs/images/clickhouse-black.svg" alt="ClickHouse" title="ClickHouse"></amp-img>
          </a>
        </div>
      </div>
      <div class="row">
        <div id="content" class="col">
          
          <h1 id=create-view>CREATE VIEW<a class=headerlink href=../amp/#create-view title="Permanent link"> </a></h1> <p>Creates a new view. Views can be <a href=../amp/#normal>normal</a>, <a href=../amp/#materialized>materialized</a>, <a href=../amp/#live-view>live</a>, and <a href=../amp/#window-view>window</a> (live view and window view are experimental features).</p> <h2 id=normal>Normal View<a class=headerlink href=../amp/#normal title="Permanent link"> </a></h2> <p>Syntax:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span><span class=w> </span><span class=p>[</span><span class=k>OR</span><span class=w> </span><span class=k>REPLACE</span><span class=p>]</span><span class=w> </span><span class=k>VIEW</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=k>table_name</span><span class=w> </span><span class=p>[</span><span class=k>ON</span><span class=w> </span><span class=k>CLUSTER</span><span class=p>]</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=p>...</span><span class=w></span>
</code></pre></div> <p>Normal views do not store any data. They just perform a read from another table on each access. In other words, a normal view is nothing more than a saved query. When reading from a view, this saved query is used as a subquery in the <a href=../../../select/from/amp/ >FROM</a> clause.</p> <p>As an example, assume you’ve created a view:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span><span class=w> </span><span class=k>VIEW</span><span class=w> </span><span class=k>view</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=p>...</span><span class=w></span>
</code></pre></div> <p>and written a query:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=k>c</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>view</span><span class=w></span>
</code></pre></div> <p>This query is fully equivalent to using the subquery:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=k>c</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=p>...)</span><span class=w></span>
</code></pre></div> <h2 id=materialized>Materialized View<a class=headerlink href=../amp/#materialized title="Permanent link"> </a></h2> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span><span class=w> </span><span class=n>MATERIALIZED</span><span class=w> </span><span class=k>VIEW</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=k>table_name</span><span class=w> </span><span class=p>[</span><span class=k>ON</span><span class=w> </span><span class=k>CLUSTER</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=k>TO</span><span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=n>name</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>ENGINE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>engine</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>POPULATE</span><span class=p>]</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=p>...</span><span class=w></span>
</code></pre></div> <p>Materialized views store data transformed by the corresponding <a href=../../../select/amp/ >SELECT</a> query.</p> <p>When creating a materialized view without <code class=syntax>TO [db].[table]</code>, you must specify <code class=syntax>ENGINE</code> – the table engine for storing data.</p> <p>When creating a materialized view with <code class=syntax>TO [db].[table]</code>, you must not use <code class=syntax>POPULATE</code>.</p> <p>A materialized view is implemented as follows: when inserting data to the table specified in <code class=syntax>SELECT</code>, part of the inserted data is converted by this <code class=syntax>SELECT</code> query, and the result is inserted in the view.</p> <div class="admonition important alert pb-0 mb-4 alert-danger" role=alert> <p class="admonition-title alert-heading display-4 text-reset mb-2">Important</p> <p>Materialized views in ClickHouse use <strong>column names</strong> instead of column order during insertion into destination table. If some column names are not present in the <code class=syntax>SELECT</code> query result, ClickHouse uses a default value, even if the column is not <a href=../../../../data-types/nullable/amp/ class=alert-link>Nullable</a>. A safe practice would be to add aliases for every column when using Materialized views.</p> <p>Materialized views in ClickHouse are implemented more like insert triggers. If there’s some aggregation in the view query, it’s applied only to the batch of freshly inserted data. Any changes to existing data of source table (like update, delete, drop partition, etc.) does not change the materialized view.</p> </div> <p>If you specify <code class=syntax>POPULATE</code>, the existing table data is inserted into the view when creating it, as if making a <code class=syntax>CREATE TABLE ... AS SELECT ...</code> . Otherwise, the query contains only the data inserted in the table after creating the view. We <strong>do not recommend</strong> using <code class=syntax>POPULATE</code>, since data inserted in the table during the view creation will not be inserted in it.</p> <p>A <code class=syntax>SELECT</code> query can contain <code class=syntax>DISTINCT</code>, <code class=syntax>GROUP BY</code>, <code class=syntax>ORDER BY</code>, <code class=syntax>LIMIT</code>. Note that the corresponding conversions are performed independently on each block of inserted data. For example, if <code class=syntax>GROUP BY</code> is set, data is aggregated during insertion, but only within a single packet of inserted data. The data won’t be further aggregated. The exception is when using an <code class=syntax>ENGINE</code> that independently performs data aggregation, such as <code class=syntax>SummingMergeTree</code>.</p> <p>The execution of <a href=../../../alter/view/amp/ >ALTER</a> queries on materialized views has limitations, so they might be inconvenient. If the materialized view uses the construction <code class=syntax>TO [db.]name</code>, you can <code class=syntax>DETACH</code> the view, run <code class=syntax>ALTER</code> for the target table, and then <code class=syntax>ATTACH</code> the previously detached (<code class=syntax>DETACH</code>) view.</p> <p>Note that materialized view is influenced by <a href=../../../../../operations/settings/settings/amp/#optimize-on-insert>optimize_on_insert</a> setting. The data is merged before the insertion into a view.</p> <p>Views look the same as normal tables. For example, they are listed in the result of the <code class=syntax>SHOW TABLES</code> query.</p> <p>To delete a view, use <a href=../../../drop/amp/#drop-view>DROP VIEW</a>. Although <code class=syntax>DROP TABLE</code> works for VIEWs as well.</p> <h2 id=live-view>Live View [Experimental]<a class=headerlink href=../amp/#live-view title="Permanent link"> </a></h2> <div class="admonition important alert pb-0 mb-4 alert-danger" role=alert> <p class="admonition-title alert-heading display-4 text-reset mb-2">Important</p> <p>This is an experimental feature that may change in backwards-incompatible ways in the future releases.<br> Enable usage of live views and <code class=syntax>WATCH</code> query using <a class=alert-link href=../../../../../operations/settings/settings/amp/#allow-experimental-live-view>allow_experimental_live_view</a> setting. Input the command <code class=syntax>set allow_experimental_live_view = 1</code>.</p> </div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span><span class=w> </span><span class=n>LIVE</span><span class=w> </span><span class=k>VIEW</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=k>table_name</span><span class=w> </span><span class=p>[</span><span class=k>WITH</span><span class=w> </span><span class=p>[</span><span class=n>TIMEOUT</span><span class=w> </span><span class=p>[</span><span class=n>value_in_sec</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=k>AND</span><span class=p>]]</span><span class=w> </span><span class=p>[</span><span class=n>REFRESH</span><span class=w> </span><span class=p>[</span><span class=n>value_in_sec</span><span class=p>]]]</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=p>...</span><span class=w></span>
</code></pre></div> <p>Live views store result of the corresponding <a href=../../../select/amp/ >SELECT</a> query and are updated any time the result of the query changes. Query result as well as partial result needed to combine with new data are stored in memory providing increased performance for repeated queries. Live views can provide push notifications when query result changes using the <a href=../../../watch/amp/ >WATCH</a> query.</p> <p>Live views are triggered by insert into the innermost table specified in the query.</p> <p>Live views work similarly to how a query in a distributed table works. But instead of combining partial results from different servers they combine partial result from current data with partial result from the new data. When a live view query includes a subquery then the cached partial result is only stored for the innermost subquery.</p> <div class="admonition info alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-4 text-reset mb-2">Limitations</p> <ul> <li><a href=../../../../table-functions/amp/ class=alert-link>Table function</a> is not supported as the innermost table.</li> <li>Tables that do not have inserts such as a <a href=../../../../dictionaries/amp/ class=alert-link>dictionary</a>, <a href=../../../../../operations/system-tables/amp/ class=alert-link>system table</a>, a <a class=alert-link href=../amp/#normal>normal view</a>, or a <a class=alert-link href=../amp/#materialized>materialized view</a> will not trigger a live view.</li> <li>Only queries where one can combine partial result from the old data plus partial result from the new data will work. Live view will not work for queries that require the complete data set to compute the final result or aggregations where the state of the aggregation must be preserved.</li> <li>Does not work with replicated or distributed tables where inserts are performed on different nodes.</li> <li>Can't be triggered by multiple tables.</li> </ul> <p>See <a class=alert-link href=../amp/#live-view-with-refresh>WITH REFRESH</a> to force periodic updates of a live view that in some cases can be used as a workaround.</p> </div> <h3 id=live-view-monitoring>Monitoring Live View Changes<a class=headerlink href=../amp/#live-view-monitoring title="Permanent link"> </a></h3> <p>You can monitor changes in the <code class=syntax>LIVE VIEW</code> query result using <a href=../../../watch/amp/ >WATCH</a> query.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>WATCH</span><span class=w> </span><span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=n>live_view</span><span class=w></span>
</code></pre></div> <p><strong>Example:</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>mt</span><span class=w> </span><span class=p>(</span><span class=n>x</span><span class=w> </span><span class=nb>Int8</span><span class=p>)</span><span class=w> </span><span class=n>Engine</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>MergeTree</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>x</span><span class=p>;</span><span class=w></span>
<span class=k>CREATE</span><span class=w> </span><span class=n>LIVE</span><span class=w> </span><span class=k>VIEW</span><span class=w> </span><span class=n>lv</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=k>sum</span><span class=p>(</span><span class=n>x</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>mt</span><span class=p>;</span><span class=w></span>
</code></pre></div> <p>Watch a live view while doing a parallel insert into the source table.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>WATCH</span><span class=w> </span><span class=n>lv</span><span class=p>;</span><span class=w></span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─sum<span class=o>(</span>x<span class=o>)</span>─┬─_version─┐
│      <span class=m>1</span> │        <span class=m>1</span> │
└────────┴──────────┘
┌─sum<span class=o>(</span>x<span class=o>)</span>─┬─_version─┐
│      <span class=m>3</span> │        <span class=m>2</span> │
└────────┴──────────┘
┌─sum<span class=o>(</span>x<span class=o>)</span>─┬─_version─┐
│      <span class=m>6</span> │        <span class=m>3</span> │
└────────┴──────────┘
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>mt</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=p>);</span><span class=w></span>
<span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>mt</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>2</span><span class=p>);</span><span class=w></span>
<span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>mt</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>3</span><span class=p>);</span><span class=w></span>
</code></pre></div> <p>Or add <a href=../../../watch/amp/#events-clause>EVENTS</a> clause to just get change events.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>WATCH</span><span class=w> </span><span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=n>live_view</span><span class=w> </span><span class=n>EVENTS</span><span class=p>;</span><span class=w></span>
</code></pre></div> <p><strong>Example:</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>WATCH</span><span class=w> </span><span class=n>lv</span><span class=w> </span><span class=n>EVENTS</span><span class=p>;</span><span class=w></span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─version─┐
│       <span class=m>1</span> │
└─────────┘
┌─version─┐
│       <span class=m>2</span> │
└─────────┘
┌─version─┐
│       <span class=m>3</span> │
└─────────┘
</code></pre></div> <p>You can execute <a href=../../../select/amp/ >SELECT</a> query on a live view in the same way as for any regular view or a table. If the query result is cached it will return the result immediately without running the stored query on the underlying tables.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=n>live_view</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=p>...</span><span class=w></span>
</code></pre></div> <h3 id=live-view-alter-refresh>Force Live View Refresh<a class=headerlink href=../amp/#live-view-alter-refresh title="Permanent link"> </a></h3> <p>You can force live view refresh using the <code class=syntax>ALTER LIVE VIEW [db.]table_name REFRESH</code> statement.</p> <h3 id=live-view-with-timeout>WITH TIMEOUT Clause<a class=headerlink href=../amp/#live-view-with-timeout title="Permanent link"> </a></h3> <p>When a live view is created with a <code class=syntax>WITH TIMEOUT</code> clause then the live view will be dropped automatically after the specified number of seconds elapse since the end of the last <a href=../../../watch/amp/ >WATCH</a> query that was watching the live view.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span><span class=w> </span><span class=n>LIVE</span><span class=w> </span><span class=k>VIEW</span><span class=w> </span><span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=k>table_name</span><span class=w> </span><span class=k>WITH</span><span class=w> </span><span class=n>TIMEOUT</span><span class=w> </span><span class=p>[</span><span class=n>value_in_sec</span><span class=p>]</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=p>...</span><span class=w></span>
</code></pre></div> <p>If the timeout value is not specified then the value specified by the <a href=../../../../../operations/settings/settings/amp/#temporary-live-view-timeout>temporary_live_view_timeout</a> setting is used.</p> <p><strong>Example:</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>mt</span><span class=w> </span><span class=p>(</span><span class=n>x</span><span class=w> </span><span class=nb>Int8</span><span class=p>)</span><span class=w> </span><span class=n>Engine</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>MergeTree</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>x</span><span class=p>;</span><span class=w></span>
<span class=k>CREATE</span><span class=w> </span><span class=n>LIVE</span><span class=w> </span><span class=k>VIEW</span><span class=w> </span><span class=n>lv</span><span class=w> </span><span class=k>WITH</span><span class=w> </span><span class=n>TIMEOUT</span><span class=w> </span><span class=mi>15</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=k>sum</span><span class=p>(</span><span class=n>x</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>mt</span><span class=p>;</span><span class=w></span>
</code></pre></div> <h3 id=live-view-with-refresh>WITH REFRESH Clause<a class=headerlink href=../amp/#live-view-with-refresh title="Permanent link"> </a></h3> <p>When a live view is created with a <code class=syntax>WITH REFRESH</code> clause then it will be automatically refreshed after the specified number of seconds elapse since the last refresh or trigger.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span><span class=w> </span><span class=n>LIVE</span><span class=w> </span><span class=k>VIEW</span><span class=w> </span><span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=k>table_name</span><span class=w> </span><span class=k>WITH</span><span class=w> </span><span class=n>REFRESH</span><span class=w> </span><span class=p>[</span><span class=n>value_in_sec</span><span class=p>]</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=p>...</span><span class=w></span>
</code></pre></div> <p>If the refresh value is not specified then the value specified by the <a href=../../../../../operations/settings/settings/amp/#periodic-live-view-refresh>periodic_live_view_refresh</a> setting is used.</p> <p><strong>Example:</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span><span class=w> </span><span class=n>LIVE</span><span class=w> </span><span class=k>VIEW</span><span class=w> </span><span class=n>lv</span><span class=w> </span><span class=k>WITH</span><span class=w> </span><span class=n>REFRESH</span><span class=w> </span><span class=mi>5</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=n>now</span><span class=p>();</span><span class=w></span>
<span class=n>WATCH</span><span class=w> </span><span class=n>lv</span><span class=w></span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌───────────────now<span class=o>()</span>─┬─_version─┐
│ <span class=m>2021</span>-02-21 <span class=m>08</span>:47:05 │        <span class=m>1</span> │
└─────────────────────┴──────────┘
┌───────────────now<span class=o>()</span>─┬─_version─┐
│ <span class=m>2021</span>-02-21 <span class=m>08</span>:47:10 │        <span class=m>2</span> │
└─────────────────────┴──────────┘
┌───────────────now<span class=o>()</span>─┬─_version─┐
│ <span class=m>2021</span>-02-21 <span class=m>08</span>:47:15 │        <span class=m>3</span> │
└─────────────────────┴──────────┘
</code></pre></div> <p>You can combine <code class=syntax>WITH TIMEOUT</code> and <code class=syntax>WITH REFRESH</code> clauses using an <code class=syntax>AND</code> clause.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span><span class=w> </span><span class=n>LIVE</span><span class=w> </span><span class=k>VIEW</span><span class=w> </span><span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=k>table_name</span><span class=w> </span><span class=k>WITH</span><span class=w> </span><span class=n>TIMEOUT</span><span class=w> </span><span class=p>[</span><span class=n>value_in_sec</span><span class=p>]</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>REFRESH</span><span class=w> </span><span class=p>[</span><span class=n>value_in_sec</span><span class=p>]</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=p>...</span><span class=w></span>
</code></pre></div> <p><strong>Example:</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span><span class=w> </span><span class=n>LIVE</span><span class=w> </span><span class=k>VIEW</span><span class=w> </span><span class=n>lv</span><span class=w> </span><span class=k>WITH</span><span class=w> </span><span class=n>TIMEOUT</span><span class=w> </span><span class=mi>15</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>REFRESH</span><span class=w> </span><span class=mi>5</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=n>now</span><span class=p>();</span><span class=w></span>
</code></pre></div> <p>After 15 sec the live view will be automatically dropped if there are no active <code class=syntax>WATCH</code> queries.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>WATCH</span><span class=w> </span><span class=n>lv</span><span class=w></span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=n>Code</span><span class=o>:</span><span class=w> </span><span class=mi>60</span><span class=o>.</span><span class=w> </span><span class=n>DB</span><span class=o>::</span><span class=n>Exception</span><span class=o>:</span><span class=w> </span><span class=n>Received</span><span class=w> </span><span class=n>from</span><span class=w> </span><span class=n>localhost</span><span class=o>:</span><span class=mi>9000</span><span class=o>.</span><span class=w> </span><span class=n>DB</span><span class=o>::</span><span class=n>Exception</span><span class=o>:</span><span class=w> </span><span class=n>Table</span><span class=w> </span><span class=k>default</span><span class=o>.</span><span class=na>lv</span><span class=w> </span><span class=n>does</span><span class=w> </span><span class=n>not</span><span class=w> </span><span class=n>exist</span><span class=o>..</span><span class=w></span>
</code></pre></div> <h3 id=live-view-usage>Live View Usage<a class=headerlink href=../amp/#live-view-usage title="Permanent link"> </a></h3> <p>Most common uses of live view tables include:</p> <ul> <li>Providing push notifications for query result changes to avoid polling.</li> <li>Caching results of most frequent queries to provide immediate query results.</li> <li>Watching for table changes and triggering a follow-up select queries.</li> <li>Watching metrics from system tables using periodic refresh.</li> </ul> <p><strong>See Also</strong><br> - <a href=../../../alter/view/amp/#alter-live-view>ALTER LIVE VIEW</a></p> <h2 id=window-view>Window View [Experimental]<a class=headerlink href=../amp/#window-view title="Permanent link"> </a></h2> <div class="admonition important alert pb-0 mb-4 alert-danger" role=alert> <p class="admonition-title alert-heading display-4 text-reset mb-2">Important</p> <p>This is an experimental feature that may change in backwards-incompatible ways in the future releases.<br> Enable usage of window views and <code class=syntax>WATCH</code> query using <a class=alert-link href=../../../../../operations/settings/settings/amp/#allow-experimental-window-view>allow_experimental_window_view</a> setting. Input the command <code class=syntax>set allow_experimental_window_view = 1</code>.</p> </div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span><span class=w> </span><span class=n>WINDOW</span><span class=w> </span><span class=k>VIEW</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=k>table_name</span><span class=w> </span><span class=p>[</span><span class=k>TO</span><span class=w> </span><span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=k>table_name</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>ENGINE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>engine</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>WATERMARK</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>strategy</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>ALLOWED_LATENESS</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>interval_function</span><span class=p>]</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=p>...</span><span class=w> </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>time_window_function</span><span class=w></span>
</code></pre></div> <p>Window view can aggregate data by time window and output the results when the window is ready to fire. It stores the partial aggregation results in an inner(or specified) table to reduce latency and can push the processing result to a specified table or push notifications using the WATCH query.</p> <p>Creating a window view is similar to creating <code class=syntax>MATERIALIZED VIEW</code>. Window view needs an inner storage engine to store intermediate data. The inner storage will use <code class=syntax>AggregatingMergeTree</code> as the default engine.</p> <h3 id=window-view-timewindowfunctions>Time Window Functions<a class=headerlink href=../amp/#window-view-timewindowfunctions title="Permanent link"> </a></h3> <p><a href=../../../../functions/time-window-functions/amp/ >Time window functions</a> are used to get the lower and upper window bound of records. The window view needs to be used with a time window function.</p> <h3 id=window-view-timeattributes>TIME ATTRIBUTES<a class=headerlink href=../amp/#window-view-timeattributes title="Permanent link"> </a></h3> <p>Window view supports <strong>processing time</strong> and <strong>event time</strong> process.</p> <p><strong>Processing time</strong> allows window view to produce results based on the local machine's time and is used by default. It is the most straightforward notion of time but does not provide determinism. The processing time attribute can be defined by setting the <code class=syntax>time_attr</code> of the time window function to a table column or using the function <code class=syntax>now()</code>. The following query creates a window view with processing time.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span><span class=w> </span><span class=n>WINDOW</span><span class=w> </span><span class=k>VIEW</span><span class=w> </span><span class=n>wv</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=k>count</span><span class=p>(</span><span class=nb>number</span><span class=p>),</span><span class=w> </span><span class=n>tumbleStart</span><span class=p>(</span><span class=n>w_id</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>w_start</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=nb>date</span><span class=w> </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>tumble</span><span class=p>(</span><span class=n>now</span><span class=p>(),</span><span class=w> </span><span class=nb>INTERVAL</span><span class=w> </span><span class=s1>'5'</span><span class=w> </span><span class=k>SECOND</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>w_id</span><span class=w></span>
</code></pre></div> <p><strong>Event time</strong> is the time that each individual event occurred on its producing device. This time is typically embedded within the records when it is generated. Event time processing allows for consistent results even in case of out-of-order events or late events. Window view supports event time processing by using <code class=syntax>WATERMARK</code> syntax.</p> <p>Window view provides three watermark strategies:</p> <ul> <li><code class=syntax>STRICTLY_ASCENDING</code>: Emits a watermark of the maximum observed timestamp so far. Rows that have a timestamp smaller to the max timestamp are not late.</li> <li><code class=syntax>ASCENDING</code>: Emits a watermark of the maximum observed timestamp so far minus 1. Rows that have a timestamp equal and smaller to the max timestamp are not late.</li> <li><code class=syntax>BOUNDED</code>: WATERMARK=INTERVAL. Emits watermarks, which are the maximum observed timestamp minus the specified delay.</li> </ul> <p>The following queries are examples of creating a window view with <code class=syntax>WATERMARK</code>:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span><span class=w> </span><span class=n>WINDOW</span><span class=w> </span><span class=k>VIEW</span><span class=w> </span><span class=n>wv</span><span class=w> </span><span class=n>WATERMARK</span><span class=o>=</span><span class=n>STRICTLY_ASCENDING</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=k>count</span><span class=p>(</span><span class=nb>number</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=nb>date</span><span class=w> </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>tumble</span><span class=p>(</span><span class=k>timestamp</span><span class=p>,</span><span class=w> </span><span class=nb>INTERVAL</span><span class=w> </span><span class=s1>'5'</span><span class=w> </span><span class=k>SECOND</span><span class=p>);</span><span class=w></span>
<span class=k>CREATE</span><span class=w> </span><span class=n>WINDOW</span><span class=w> </span><span class=k>VIEW</span><span class=w> </span><span class=n>wv</span><span class=w> </span><span class=n>WATERMARK</span><span class=o>=</span><span class=n>ASCENDING</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=k>count</span><span class=p>(</span><span class=nb>number</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=nb>date</span><span class=w> </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>tumble</span><span class=p>(</span><span class=k>timestamp</span><span class=p>,</span><span class=w> </span><span class=nb>INTERVAL</span><span class=w> </span><span class=s1>'5'</span><span class=w> </span><span class=k>SECOND</span><span class=p>);</span><span class=w></span>
<span class=k>CREATE</span><span class=w> </span><span class=n>WINDOW</span><span class=w> </span><span class=k>VIEW</span><span class=w> </span><span class=n>wv</span><span class=w> </span><span class=n>WATERMARK</span><span class=o>=</span><span class=nb>INTERVAL</span><span class=w> </span><span class=s1>'3'</span><span class=w> </span><span class=k>SECOND</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=k>count</span><span class=p>(</span><span class=nb>number</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=nb>date</span><span class=w> </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>tumble</span><span class=p>(</span><span class=k>timestamp</span><span class=p>,</span><span class=w> </span><span class=nb>INTERVAL</span><span class=w> </span><span class=s1>'5'</span><span class=w> </span><span class=k>SECOND</span><span class=p>);</span><span class=w></span>
</code></pre></div> <p>By default, the window will be fired when the watermark comes, and elements that arrived behind the watermark will be dropped. Window view supports late event processing by setting <code class=syntax>ALLOWED_LATENESS=INTERVAL</code>. An example of lateness handling is:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span><span class=w> </span><span class=n>WINDOW</span><span class=w> </span><span class=k>VIEW</span><span class=w> </span><span class=n>test</span><span class=p>.</span><span class=n>wv</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=n>test</span><span class=p>.</span><span class=n>dst</span><span class=w> </span><span class=n>WATERMARK</span><span class=o>=</span><span class=n>ASCENDING</span><span class=w> </span><span class=n>ALLOWED_LATENESS</span><span class=o>=</span><span class=nb>INTERVAL</span><span class=w> </span><span class=s1>'2'</span><span class=w> </span><span class=k>SECOND</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=k>count</span><span class=p>(</span><span class=n>a</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>count</span><span class=p>,</span><span class=w> </span><span class=n>tumbleEnd</span><span class=p>(</span><span class=n>wid</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>w_end</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>test</span><span class=p>.</span><span class=n>mt</span><span class=w> </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>tumble</span><span class=p>(</span><span class=k>timestamp</span><span class=p>,</span><span class=w> </span><span class=nb>INTERVAL</span><span class=w> </span><span class=s1>'5'</span><span class=w> </span><span class=k>SECOND</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>wid</span><span class=p>;</span><span class=w></span>
</code></pre></div> <p>Note that elements emitted by a late firing should be treated as updated results of a previous computation. Instead of firing at the end of windows, the window view will fire immediately when the late event arrives. Thus, it will result in multiple outputs for the same window. Users need to take these duplicated results into account or deduplicate them.</p> <h3 id=window-view-monitoring>Monitoring New Windows<a class=headerlink href=../amp/#window-view-monitoring title="Permanent link"> </a></h3> <p>Window view supports the <a href=../../../watch/amp/ >WATCH</a> query to monitoring changes, or use <code class=syntax>TO</code> syntax to output the results to a table.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>WATCH</span><span class=w> </span><span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=n>window_view</span><span class=w></span>
<span class=p>[</span><span class=n>EVENTS</span><span class=p>]</span><span class=w></span>
<span class=p>[</span><span class=k>LIMIT</span><span class=w> </span><span class=n>n</span><span class=p>]</span><span class=w></span>
<span class=p>[</span><span class=n>FORMAT</span><span class=w> </span><span class=n>format</span><span class=p>]</span><span class=w></span>
</code></pre></div> <p><code class=syntax>WATCH</code> query acts similar as in <code class=syntax>LIVE VIEW</code>. A <code class=syntax>LIMIT</code> can be specified to set the number of updates to receive before terminating the query. The <code class=syntax>EVENTS</code> clause can be used to obtain a short form of the <code class=syntax>WATCH</code> query where instead of the query result you will just get the latest query watermark.</p> <h3 id=window-view-settings>Settings<a class=headerlink href=../amp/#window-view-settings title="Permanent link"> </a></h3> <ul> <li><code class=syntax>window_view_clean_interval</code>: The clean interval of window view in seconds to free outdated data. The system will retain the windows that have not been fully triggered according to the system time or <code class=syntax>WATERMARK</code> configuration, and the other data will be deleted.</li> <li><code class=syntax>window_view_heartbeat_interval</code>: The heartbeat interval in seconds to indicate the watch query is alive.</li> </ul> <h3 id=window-view-example>Example<a class=headerlink href=../amp/#window-view-example title="Permanent link"> </a></h3> <p>Suppose we need to count the number of click logs per 10 seconds in a log table called <code class=syntax>data</code>, and its table structure is:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>data</span><span class=w> </span><span class=p>(</span><span class=w> </span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=w> </span><span class=n>UInt64</span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=k>timestamp</span><span class=o>`</span><span class=w> </span><span class=n>DateTime</span><span class=p>)</span><span class=w> </span><span class=n>ENGINE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Memory</span><span class=p>;</span><span class=w></span>
</code></pre></div> <p>First, we create a window view with tumble window of 10 seconds interval:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span><span class=w> </span><span class=n>WINDOW</span><span class=w> </span><span class=k>VIEW</span><span class=w> </span><span class=n>wv</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=k>select</span><span class=w> </span><span class=k>count</span><span class=p>(</span><span class=n>id</span><span class=p>),</span><span class=w> </span><span class=n>tumbleStart</span><span class=p>(</span><span class=n>w_id</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>window_start</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=k>data</span><span class=w> </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>tumble</span><span class=p>(</span><span class=k>timestamp</span><span class=p>,</span><span class=w> </span><span class=nb>INTERVAL</span><span class=w> </span><span class=s1>'10'</span><span class=w> </span><span class=k>SECOND</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>w_id</span><span class=w></span>
</code></pre></div> <p>Then, we use the <code class=syntax>WATCH</code> query to get the results.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>WATCH</span><span class=w> </span><span class=n>wv</span><span class=w></span>
</code></pre></div> <p>When logs are inserted into table <code class=syntax>data</code>,</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=k>data</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=n>now</span><span class=p>())</span><span class=w></span>
</code></pre></div> <p>The <code class=syntax>WATCH</code> query should print the results as follows:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─count(id)─┬────────window_start─┐
│         1 │ 2020-01-14 16:56:40 │
└───────────┴─────────────────────┘
</code></pre></div> <p>Alternatively, we can attach the output to another table using <code class=syntax>TO</code> syntax.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span><span class=w> </span><span class=n>WINDOW</span><span class=w> </span><span class=k>VIEW</span><span class=w> </span><span class=n>wv</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=n>dst</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=k>count</span><span class=p>(</span><span class=n>id</span><span class=p>),</span><span class=w> </span><span class=n>tumbleStart</span><span class=p>(</span><span class=n>w_id</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>window_start</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>data</span><span class=w> </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>tumble</span><span class=p>(</span><span class=k>timestamp</span><span class=p>,</span><span class=w> </span><span class=nb>INTERVAL</span><span class=w> </span><span class=s1>'10'</span><span class=w> </span><span class=k>SECOND</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>w_id</span><span class=w></span>
</code></pre></div> <p>Additional examples can be found among stateful tests of ClickHouse (they are named <code class=syntax>*window_view*</code> there).</p> <h3 id=window-view-usage>Window View Usage<a class=headerlink href=../amp/#window-view-usage title="Permanent link"> </a></h3> <p>The window view is useful in the following scenarios:</p> <ul> <li><strong>Monitoring</strong>: Aggregate and calculate the metrics logs by time, and output the results to a target table. The dashboard can use the target table as a source table.</li> <li><strong>Analyzing</strong>: Automatically aggregate and preprocess data in the time window. This can be useful when analyzing a large number of logs. The preprocessing eliminates repeated calculations in multiple queries and reduces query latency.</li> </ul>
        </div>
      </div>
      <div class="row">
        <div class="col">
          
<div class="alert alert-light my-3">
  <p class="float-right mb-0">Rating: RATING_VALUE - RATING_COUNT votes</p>
  <span class="alert-heading display-6">Article Rating</span>
  <div id="rating-stars" class="display-6 mb-0"
     
  >RATING_STARS</div>
</div>

<div id="content-footer" class="text-muted pt-3 mb-5">
    <div class="float-md-right">©2016–2022 ClickHouse, Inc.</div>
    <div>Built from <a href="https://github.com/ClickHouse/ClickHouse/commit/38993f215f9186c1ac3505b1e09697cd9a468b5d" rel="external nofollow noreferrer" target="_blank" class="text-reset">38993f21</a>
    
    </div>
</div>

        </div>
      </div>
      <div id="to-full-website" class="row fixed-bottom text-center bg-white py-3">
        <div class="col">
          <a class="btn btn-lg btn-outline-orange" href="https://clickhouse.com/docs/en/sql-reference/statements/create/view/">To full website</a>
        </div>
      </div>
    </div>
    <amp-analytics type="metrika">
      <script type="application/json">{
"vars": {
  "counterId": "18343495",
  "triggers": {
    "notBounce": {
      "on": "timer",
      "timerSpec": {
        "immediate": false,
        "interval": 15,
        "maxTimerLength": 16
      },
      "request": "notBounce"
    }
  }
}
}</script>
  </amp-analytics>
  </body>
</html>
