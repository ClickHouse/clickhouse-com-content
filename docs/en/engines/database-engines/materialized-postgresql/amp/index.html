










    



    



    



    
    






    <!doctype html>
<html ⚡ lang="en">
  <head>
    <meta charset="utf-8">
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    <title>MaterializedPostgreSQL | ClickHouse Documentation</title>
    <link rel="canonical" href="https://clickhouse.com/docs/en/engines/database-engines/materialized-postgresql/" />
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    
<script type="application/ld+json">[{
"@context": "http://schema.org",
"@type": "TechArticle",
"headline": "MaterializedPostgreSQL | ClickHouse Documentation",
"mainEntityOfPage": "https://clickhouse.com/docs/en/engines/database-engines/materialized-postgresql/",




"image": "https://clickhouse.com/images/clickhouse-209x60.png",
"author": {
  "@type": "Project",
  "name": "ClickHouse"
},
"publisher": {
  "@type": "Organization",
  "name": "ClickHouse, Inc.",
  "logo": {
    "@type": "ImageObject",
    "url": "https://clickhouse.com/images/logo-400x240.png",
    "width": 400,
    "height": 240
  }
}}, {
"@context": "http://schema.org",
"@type": "Episode",
"name": "MaterializedPostgreSQL | ClickHouse Documentation",
"aggregateRating": {
  "@type": "AggregateRating",
  "ratingValue": RATING_VALUE,
  "ratingCount": RATING_COUNT
}
}]</script>

    
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <style amp-custom>:root{--blue:#007bff;--indigo:#6610f2;--purple:#6f42c1;--pink:#e83e8c;--red:#dc3545;--orange:#fd7e14;--yellow:#ffc107;--green:#28a745;--teal:#20c997;--cyan:#17a2b8;--gray:#6c757d;--gray-dark:#343a40;--brand-primary:#fc0;--brand-secondary:#ff3939;--primary-accent-yellow:#fc0;--primary-accent-light-yellow:#fffaf0;--primary-accent-blue:#257af4;--primary-accent-light-blue:#e3f1fe;--secondary-accent-orange:#ff8c00;--secondary-accent-light-orange:#ffe4b5;--secondary-accent-red:#ff3939;--secondary-accent-light-red:#ffe4e1;--primary:#fc0;--secondary:#212529;--success:#28a745;--info:#17a2b8;--warning:#ffc107;--danger:#dc3545;--light:#f1f6f9;--dark:#495057;--primary-light:#fffaf0;--secondary-light:#fff;--tertiary:#257af4;--tertiary-light:#e3f1fe;--white:#fff;--black:#212529;--blue:#257af4;--light-blue:#e3f1fe;--yellow:#fc0;--light-yellow:#fffaf0;--orange:#ff8c00;--light-orange:#ffe4b5;--red:#ff3939;--light-red:#ffe4e1;--medium:#d6dbdf;--breakpoint-xxs:0;--breakpoint-xs:400px;--breakpoint-sm:616px;--breakpoint-md:768px;--breakpoint-lg:980px;--breakpoint-xl:1240px;--font-family-sans-serif:"Noto Sans",sans-serif;--font-family-monospace:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}*,:after,:before{box-sizing:border-box}html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:rgba(33,37,41,0)}article,footer{display:block}body{margin:0;font-family:Noto Sans,sans-serif;font-size:1rem;font-weight:400;line-height:1.5;color:#212529;text-align:left;background-color:#fff}[tabindex="-1"]:focus:not(:focus-visible){outline:0}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:16px}p{margin-top:0;margin-bottom:1rem}ol,ul{margin-bottom:1rem}ol,ul{margin-top:0}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}b,strong{font-weight:bolder}a{text-decoration:none;background-color:transparent}a,a:hover{color:#ff8c00}a:hover{text-decoration:underline}a:not([href]),a:not([href]):hover{color:inherit;text-decoration:none}code,pre{font-family:SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em}pre{margin-top:0;margin-bottom:1rem;overflow:auto}img{border-style:none}img,svg{vertical-align:middle}svg{overflow:hidden}table{border-collapse:collapse}select{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}select{text-transform:none}select{word-wrap:normal}[type=button],[type=reset],[type=submit]{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled){cursor:pointer}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{padding:0;border-style:none}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:none}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}[hidden]{display:none}.h1,.h2,.h3,.h4,.h5,.h6,h1,h2,h3,h4,h5,h6{margin-bottom:16px;font-family:Hind Siliguri,sans-serif;font-weight:500;line-height:1.125}.h1,h1{font-size:2.5rem}@media(max-width:1200px){.h1,h1{font-size:calc(1.375rem+1.5vw)}}.h2,h2{font-size:2rem}@media(max-width:1200px){.h2,h2{font-size:calc(1.325rem+.9vw)}}.h3,h3{font-size:1.75rem}@media(max-width:1200px){.h3,h3{font-size:calc(1.3rem+.6vw)}}.h4,h4{font-size:1.5rem}@media(max-width:1200px){.h4,h4{font-size:calc(1.275rem+.3vw)}}.h5,h5{font-size:1.125rem}.h6,h6{font-size:.875rem}.lead{font-size:1.375rem;font-weight:400}@media(max-width:1200px){.lead{font-size:calc(1.2625rem+.15vw)}}.display-1{font-size:4rem;font-weight:600;line-height:1.125}@media(max-width:1200px){.display-1{font-size:calc(1.525rem+3.3vw)}}.display-2{font-size:2.5rem;font-weight:600;line-height:1.125}@media(max-width:1200px){.display-2{font-size:calc(1.375rem+1.5vw)}}.display-3{font-size:2rem;font-weight:500;line-height:1.125}@media(max-width:1200px){.display-3{font-size:calc(1.325rem+.9vw)}}.display-4{font-size:1.75rem;font-weight:500;line-height:1.125}@media(max-width:1200px){.display-4{font-size:calc(1.3rem+.6vw)}}.list-inline{padding-left:0;list-style:none}.img-fluid{max-width:100%;height:auto}code{font-size:87.5%;color:#e83e8c;word-wrap:break-word}a>code{color:inherit}pre{display:block;font-size:87.5%;color:#495057}pre code{font-size:inherit;color:inherit;word-break:normal}.container{width:100%;padding-right:20px;padding-left:20px;margin-right:auto;margin-left:auto}@media(min-width:400px){.container{max-width:576px}}@media(min-width:616px){.container{max-width:576px}}@media(min-width:768px){.container{max-width:958px}}@media(min-width:980px){.container{max-width:1008px}}@media(min-width:1240px){.container{max-width:1118px}}.container-fluid,.container-lg,.container-md{width:100%;padding-right:20px;padding-left:20px;margin-right:auto;margin-left:auto}@media(min-width:400px){.container{max-width:576px}}@media(min-width:616px){.container{max-width:576px}}@media(min-width:768px){.container,.container-md{max-width:958px}}@media(min-width:980px){.container,.container-lg,.container-md{max-width:1008px}}@media(min-width:1240px){.container,.container-lg,.container-md{max-width:1118px}}.row{display:flex;flex-wrap:wrap;margin-right:-20px;margin-left:-20px}.col,.col-1,.col-10,.col-11,.col-12,.col-2,.col-3,.col-4,.col-5,.col-6,.col-7,.col-8,.col-9,.col-lg,.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-md,.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9{position:relative;width:100%;padding-right:20px;padding-left:20px}.col{flex-basis:0;flex-grow:1;max-width:100%}.col-1{flex:0 0 8.3333333333%;max-width:8.3333333333%}.col-2{flex:0 0 16.6666666667%;max-width:16.6666666667%}.col-3{flex:0 0 25%;max-width:25%}.col-4{flex:0 0 33.3333333333%;max-width:33.3333333333%}.col-5{flex:0 0 41.6666666667%;max-width:41.6666666667%}.col-6{flex:0 0 50%;max-width:50%}.col-7{flex:0 0 58.3333333333%;max-width:58.3333333333%}.col-8{flex:0 0 66.6666666667%;max-width:66.6666666667%}.col-9{flex:0 0 75%;max-width:75%}.col-10{flex:0 0 83.3333333333%;max-width:83.3333333333%}.col-11{flex:0 0 91.6666666667%;max-width:91.6666666667%}.col-12{flex:0 0 100%;max-width:100%}@media(min-width:768px){.col-md{flex-basis:0;flex-grow:1;max-width:100%}.col-md-1{flex:0 0 8.3333333333%;max-width:8.3333333333%}.col-md-2{flex:0 0 16.6666666667%;max-width:16.6666666667%}.col-md-3{flex:0 0 25%;max-width:25%}.col-md-4{flex:0 0 33.3333333333%;max-width:33.3333333333%}.col-md-5{flex:0 0 41.6666666667%;max-width:41.6666666667%}.col-md-6{flex:0 0 50%;max-width:50%}.col-md-7{flex:0 0 58.3333333333%;max-width:58.3333333333%}.col-md-8{flex:0 0 66.6666666667%;max-width:66.6666666667%}.col-md-9{flex:0 0 75%;max-width:75%}.col-md-10{flex:0 0 83.3333333333%;max-width:83.3333333333%}.col-md-11{flex:0 0 91.6666666667%;max-width:91.6666666667%}.col-md-12{flex:0 0 100%;max-width:100%}}@media(min-width:980px){.col-lg{flex-basis:0;flex-grow:1;max-width:100%}.col-lg-1{flex:0 0 8.3333333333%;max-width:8.3333333333%}.col-lg-2{flex:0 0 16.6666666667%;max-width:16.6666666667%}.col-lg-3{flex:0 0 25%;max-width:25%}.col-lg-4{flex:0 0 33.3333333333%;max-width:33.3333333333%}.col-lg-5{flex:0 0 41.6666666667%;max-width:41.6666666667%}.col-lg-6{flex:0 0 50%;max-width:50%}.col-lg-7{flex:0 0 58.3333333333%;max-width:58.3333333333%}.col-lg-8{flex:0 0 66.6666666667%;max-width:66.6666666667%}.col-lg-9{flex:0 0 75%;max-width:75%}.col-lg-10{flex:0 0 83.3333333333%;max-width:83.3333333333%}.col-lg-11{flex:0 0 91.6666666667%;max-width:91.6666666667%}.col-lg-12{flex:0 0 100%;max-width:100%}}.table{width:100%;margin-bottom:8px;color:#212529}.table-primary{background-color:#fff1b8}.table-warning{background-color:#ffeeba}.table-light{background-color:#fbfcfd}.table-dark{background-color:#ccced0}.table-primary-light{background-color:#fffefb}.table-white{background-color:#fff}.table-black{background-color:#c1c2c3}.table-orange{background-color:#ffdfb8}.table-light-orange{background-color:#fff7ea}.table-dark{color:#fff;background-color:#343a40}.btn{display:inline-block;font-family:inherit;font-weight:700;color:#212529;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;padding:12px 32px;font-size:.875rem;line-height:20px;border-radius:8px;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media(prefers-reduced-motion:reduce){.btn{transition:none}}.btn:hover{color:#212529;text-decoration:none}.btn:focus{outline:0;box-shadow:none}.btn:disabled{opacity:.65}.btn-primary{color:#495057;background-color:#fc0;border-color:#fc0}.btn-primary:focus,.btn-primary:hover{color:#495057;background-color:#d9ad00;border-color:#cca300}.btn-primary:focus{box-shadow:0 0 0 0 rgba(228,185,13,.5)}.btn-primary:disabled{color:#495057;background-color:#fc0;border-color:#fc0}.btn-warning{color:#495057;background-color:#ffc107;border-color:#ffc107}.btn-warning:focus,.btn-warning:hover{color:#495057;background-color:#e0a800;border-color:#d39e00}.btn-warning:focus{box-shadow:0 0 0 0 rgba(228,176,19,.5)}.btn-warning:disabled{color:#495057;background-color:#ffc107;border-color:#ffc107}.btn-light{color:#495057;background-color:#f1f6f9;border-color:#f1f6f9}.btn-light:focus,.btn-light:hover{color:#495057;background-color:#d6e5ee;border-color:#cddfea}.btn-light:focus{box-shadow:0 0 0 0 rgba(216,221,225,.5)}.btn-light:disabled{color:#495057;background-color:#f1f6f9;border-color:#f1f6f9}.btn-dark{color:#fff;background-color:#495057;border-color:#495057}.btn-dark:focus,.btn-dark:hover{color:#fff;background-color:#383d42;border-color:#32373b}.btn-dark:focus{box-shadow:0 0 0 0 rgba(100,106,112,.5)}.btn-dark:disabled{color:#fff;background-color:#495057;border-color:#495057}.btn-primary-light{color:#495057;background-color:#fffaf0;border-color:#fffaf0}.btn-primary-light:focus,.btn-primary-light:hover{color:#495057;background-color:#ffedca;border-color:#ffe9bd}.btn-primary-light:focus{box-shadow:0 0 0 0 rgba(228,225,217,.5)}.btn-primary-light:disabled{color:#495057;background-color:#fffaf0;border-color:#fffaf0}.btn-white{color:#495057;background-color:#fff;border-color:#fff}.btn-white:focus,.btn-white:hover{color:#495057;background-color:#ececec;border-color:#e6e6e6}.btn-white:focus{box-shadow:0 0 0 0 rgba(228,229,230,.5)}.btn-white:disabled{color:#495057;background-color:#fff;border-color:#fff}.btn-black{color:#fff;background-color:#212529;border-color:#212529}.btn-black:focus,.btn-black:hover{color:#fff;background-color:#101214;border-color:#0a0c0d}.btn-black:focus{box-shadow:0 0 0 0 rgba(66,70,73,.5)}.btn-black:disabled{color:#fff;background-color:#212529;border-color:#212529}.btn-orange{color:#495057;background-color:#ff8c00;border-color:#ff8c00}.btn-orange:focus,.btn-orange:hover{color:#fff;background-color:#d97700;border-color:#cc7000}.btn-orange:focus{box-shadow:0 0 0 0 rgba(228,131,13,.5)}.btn-orange:disabled{color:#495057;background-color:#ff8c00;border-color:#ff8c00}.btn-light-orange{color:#495057;background-color:#ffe4b5;border-color:#ffe4b5}.btn-light-orange:focus,.btn-light-orange:hover{color:#495057;background-color:#ffd68f;border-color:#ffd182}.btn-light-orange:focus{box-shadow:0 0 0 0 rgba(228,206,167,.5)}.btn-light-orange:disabled{color:#495057;background-color:#ffe4b5;border-color:#ffe4b5}.btn-outline-primary{color:#fc0;border-color:#fc0}.btn-outline-primary:hover{color:#495057;background-color:#fc0;border-color:#fc0}.btn-outline-primary:focus{box-shadow:0 0 0 0 rgba(255,204,0,.5)}.btn-outline-primary:disabled{color:#fc0;background-color:transparent}.btn-outline-warning{color:#ffc107;border-color:#ffc107}.btn-outline-warning:hover{color:#495057;background-color:#ffc107;border-color:#ffc107}.btn-outline-warning:focus{box-shadow:0 0 0 0 rgba(255,193,7,.5)}.btn-outline-warning:disabled{color:#ffc107;background-color:transparent}.btn-outline-light{color:#f1f6f9;border-color:#f1f6f9}.btn-outline-light:hover{color:#495057;background-color:#f1f6f9;border-color:#f1f6f9}.btn-outline-light:focus{box-shadow:0 0 0 0 rgba(241,246,249,.5)}.btn-outline-light:disabled{color:#f1f6f9;background-color:transparent}.btn-outline-dark{color:#495057;border-color:#495057}.btn-outline-dark:hover{color:#fff;background-color:#495057;border-color:#495057}.btn-outline-dark:focus{box-shadow:0 0 0 0 rgba(73,80,87,.5)}.btn-outline-dark:disabled{color:#495057;background-color:transparent}.btn-outline-primary-light{color:#fffaf0;border-color:#fffaf0}.btn-outline-primary-light:hover{color:#495057;background-color:#fffaf0;border-color:#fffaf0}.btn-outline-primary-light:focus{box-shadow:0 0 0 0 rgba(255,250,240,.5)}.btn-outline-primary-light:disabled{color:#fffaf0;background-color:transparent}.btn-outline-white{color:#fff;border-color:#fff}.btn-outline-white:hover{color:#495057;background-color:#fff;border-color:#fff}.btn-outline-white:focus{box-shadow:0 0 0 0 hsla(0,0%,100%,.5)}.btn-outline-white:disabled{color:#fff;background-color:transparent}.btn-outline-black{color:#212529;border-color:#212529}.btn-outline-black:hover{color:#fff;background-color:#212529;border-color:#212529}.btn-outline-black:focus{box-shadow:0 0 0 0 rgba(33,37,41,.5)}.btn-outline-black:disabled{color:#212529;background-color:transparent}.btn-outline-orange{color:#ff8c00;border-color:#ff8c00}.btn-outline-orange:hover{color:#495057;background-color:#ff8c00;border-color:#ff8c00}.btn-outline-orange:focus{box-shadow:0 0 0 0 rgba(255,140,0,.5)}.btn-outline-orange:disabled{color:#ff8c00;background-color:transparent}.btn-outline-light-orange{color:#ffe4b5;border-color:#ffe4b5}.btn-outline-light-orange:hover{color:#495057;background-color:#ffe4b5;border-color:#ffe4b5}.btn-outline-light-orange:focus{box-shadow:0 0 0 0 rgba(255,228,181,.5)}.btn-outline-light-orange:disabled{color:#ffe4b5;background-color:transparent}.btn-link{font-weight:400;color:#ff8c00;text-decoration:none}.btn-link:hover{color:#ff8c00;text-decoration:underline}.btn-link:focus{text-decoration:underline;box-shadow:none}.btn-link:disabled{color:#d6dbdf;pointer-events:none}.btn-lg{padding:16px 32px;font-size:1.125rem;line-height:26px;border-radius:8px}.btn-block{display:block;width:100%}.btn-block+.btn-block{margin-top:24px}.custom-select{display:inline-block;width:100%;height:calc(1.5em+.75rem+2px);padding:.375rem 1.75rem .375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#6c757d;vertical-align:middle;background:#fff url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='4' height='5'%3E%3Cpath fill='%23343a40' d='M2 0L0 2h4zm0 5L0 3h4z'/%3E%3C/svg%3E") no-repeat right .75rem center/8px 10px;border:1px solid #ced4da;border-radius:8px;-webkit-appearance:none;-moz-appearance:none;appearance:none}.custom-select:focus{border-color:#ffe680;outline:0;box-shadow:0 0 0 .2rem rgba(255,204,0,.25)}.custom-select:focus::-ms-value{color:#6c757d;background-color:#fff}.custom-select[multiple],.custom-select[size]:not([size="1"]){height:auto;padding-right:.75rem;background-image:none}.custom-select:disabled{color:#6c757d;background-color:#e9ecef}.custom-select::-ms-expand{display:none}.custom-select:-moz-focusring{color:transparent;text-shadow:0 0 0 #6c757d}.custom-select-lg{height:calc(1.5em+1rem+2px);padding-top:.5rem;padding-bottom:.5rem;padding-left:1rem;font-size:1.125rem}.custom-file{display:inline-block;margin-bottom:0}.custom-file{position:relative;width:100%;height:calc(1.5em+.75rem+2px)}.custom-select{transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media(prefers-reduced-motion:reduce){.custom-select{transition:none}}pre{white-space:pre-wrap}pre{border:1px solid #d6dbdf;page-break-inside:avoid}img{page-break-inside:avoid}h2,h3,p{orphans:3;widows:3}h2,h3{page-break-after:avoid}@page{size:a3}.container,body{min-width:980px}.table{border-collapse:collapse}.table-dark{color:inherit}</style>
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    <script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>
  </head>
  <body class="amp" dir="ltr">
    <div class="container-fluid container-lg pb-5">
      <div class="row pt-3 mb-3">
        <div class="col">
          <a href="/" class="text-decoration-none">
            <amp-img class="d-inline-block mr-3" layout="fixed" width="40" height="36" src="/docs/images/logo.svg" alt="ClickHouse logo" title="ClickHouse logo"></amp-img><amp-img class="invert-dark d-inline-block" layout="fixed" width="238" height="36" src="/docs/images/clickhouse-black.svg" alt="ClickHouse" title="ClickHouse"></amp-img>
          </a>
        </div>
      </div>
      <div class="row">
        <div id="content" class="col">
          
          <h1 id=materialize-postgresql>[experimental] MaterializedPostgreSQL<a class=headerlink href=../amp/#materialize-postgresql title="Permanent link"> </a></h1> <p>Creates a ClickHouse database with tables from PostgreSQL database. Firstly, database with engine <code class=syntax>MaterializedPostgreSQL</code> creates a snapshot of PostgreSQL database and loads required tables. Required tables can include any subset of tables from any subset of schemas from specified database. Along with the snapshot database engine acquires LSN and once initial dump of tables is performed - it starts pulling updates from WAL. After database is created, newly added tables to PostgreSQL database are not automatically added to replication. They have to be added manually with <code class=syntax>ATTACH TABLE db.table</code> query.</p> <p>Replication is implemented with PostgreSQL Logical Replication Protocol, which does not allow to replicate DDL, but allows to know whether replication breaking changes happened (column type changes, adding/removing columns). Such changes are detected and according tables stop receiving updates. Such tables can be automatically reloaded in the background in case required setting is turned on (can be used starting from 22.1). Safest way for now is to use <code class=syntax>ATTACH</code>/ <code class=syntax>DETACH</code> queries to reload table completely. If DDL does not break replication (for example, renaming a column) table will still receive updates (insertion is done by position).</p> <h2 id=creating-a-database>Creating a Database<a class=headerlink href=../amp/#creating-a-database title="Permanent link"> </a></h2> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span><span class=w> </span><span class=k>DATABASE</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=n>db_name</span><span class=w> </span><span class=p>[</span><span class=k>ON</span><span class=w> </span><span class=k>CLUSTER</span><span class=w> </span><span class=k>cluster</span><span class=p>]</span><span class=w></span>
<span class=n>ENGINE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>MaterializedPostgreSQL</span><span class=p>(</span><span class=s1>'host:port'</span><span class=p>,</span><span class=w> </span><span class=s1>'database'</span><span class=p>,</span><span class=w> </span><span class=s1>'user'</span><span class=p>,</span><span class=w> </span><span class=s1>'password'</span><span class=p>)</span><span class=w> </span><span class=p>[</span><span class=n>SETTINGS</span><span class=w> </span><span class=p>...]</span><span class=w></span>
</code></pre></div> <p><strong>Engine Parameters</strong></p> <ul> <li><code class=syntax>host:port</code> — PostgreSQL server endpoint.</li> <li><code class=syntax>database</code> — PostgreSQL database name.</li> <li><code class=syntax>user</code> — PostgreSQL user.</li> <li><code class=syntax>password</code> — User password.</li> </ul> <h2 id=example-of-use>Example of Use<a class=headerlink href=../amp/#example-of-use title="Permanent link"> </a></h2> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span><span class=w> </span><span class=k>DATABASE</span><span class=w> </span><span class=n>postgres_db</span><span class=w></span>
<span class=n>ENGINE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>MaterializedPostgreSQL</span><span class=p>(</span><span class=s1>'postgres1:5432'</span><span class=p>,</span><span class=w> </span><span class=s1>'postgres_database'</span><span class=p>,</span><span class=w> </span><span class=s1>'postgres_user'</span><span class=p>,</span><span class=w> </span><span class=s1>'postgres_password'</span><span class=p>);</span><span class=w></span>

<span class=k>SHOW</span><span class=w> </span><span class=n>TABLES</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>postgres_db</span><span class=p>;</span><span class=w></span>

<span class=err>┌─</span><span class=n>name</span><span class=err>───┐</span><span class=w></span>
<span class=err>│</span><span class=w> </span><span class=n>table1</span><span class=w> </span><span class=err>│</span><span class=w></span>
<span class=err>└────────┘</span><span class=w></span>

<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>postgresql_db</span><span class=p>.</span><span class=n>postgres_table</span><span class=p>;</span><span class=w></span>
</code></pre></div> <h2 id=dynamically-adding-table-to-replication>Dynamically adding new tables to replication<a class=headerlink href=../amp/#dynamically-adding-table-to-replication title="Permanent link"> </a></h2> <p>After <code class=syntax>MaterializedPostgreSQL</code> database is created, it does not automatically detect new tables in according PostgreSQL database. Such tables can be added manually:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>ATTACH</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>postgres_database</span><span class=p>.</span><span class=n>new_table</span><span class=p>;</span><span class=w></span>
</code></pre></div> <p>Warning: before version 22.1 adding table to replication left unremoved temprorary replication slot (named <code class=syntax>{db_name}_ch_replication_slot_tmp</code>). If attaching tables in clickhouse version before 22.1, make sure to delete it manually (<code class=syntax>SELECT pg_drop_replication_slot('{db_name}_ch_replication_slot_tmp')</code>). Otherwise disk usage will grow. Issue is fixed in 22.1.</p> <h2 id=dynamically-removing-table-from-replication>Dynamically removing tables from replication<a class=headerlink href=../amp/#dynamically-removing-table-from-replication title="Permanent link"> </a></h2> <p>It is possible to remove specific tables from replication:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>DETACH</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>postgres_database</span><span class=p>.</span><span class=n>table_to_remove</span><span class=p>;</span><span class=w></span>
</code></pre></div> <h2 id=schema>PostgreSQL schema<a class=headerlink href=../amp/#schema title="Permanent link"> </a></h2> <p>PostgreSQL <a href=https://www.postgresql.org/docs/9.1/ddl-schemas.html rel="external nofollow noreferrer" target=_blank>schema</a> can be configured in 3 ways (starting from version 21.12).</p> <ol> <li>One schema for one <code class=syntax>MaterializedPostgreSQL</code> database engine. Requires to use setting <code class=syntax>materialized_postgresql_schema</code>.<br> Tables are accessed via table name only:</li> </ol> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span><span class=w> </span><span class=k>DATABASE</span><span class=w> </span><span class=n>postgres_database</span><span class=w></span>
<span class=n>ENGINE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>MaterializedPostgreSQL</span><span class=p>(</span><span class=s1>'postgres1:5432'</span><span class=p>,</span><span class=w> </span><span class=s1>'postgres_database'</span><span class=p>,</span><span class=w> </span><span class=s1>'postgres_user'</span><span class=p>,</span><span class=w> </span><span class=s1>'postgres_password'</span><span class=p>)</span><span class=w></span>
<span class=n>SETTINGS</span><span class=w> </span><span class=n>materialized_postgresql_schema</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>'postgres_schema'</span><span class=p>;</span><span class=w></span>

<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>postgres_database</span><span class=p>.</span><span class=n>table1</span><span class=p>;</span><span class=w></span>
</code></pre></div> <ol start=2> <li>Any number of schemas with specified set of tables for one <code class=syntax>MaterializedPostgreSQL</code> database engine. Requires to use setting <code class=syntax>materialized_postgresql_tables_list</code>. Each table is written along with its schema.<br> Tables are accessed via schema name and table name at the same time:</li> </ol> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span><span class=w> </span><span class=k>DATABASE</span><span class=w> </span><span class=n>database1</span><span class=w></span>
<span class=n>ENGINE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>MaterializedPostgreSQL</span><span class=p>(</span><span class=s1>'postgres1:5432'</span><span class=p>,</span><span class=w> </span><span class=s1>'postgres_database'</span><span class=p>,</span><span class=w> </span><span class=s1>'postgres_user'</span><span class=p>,</span><span class=w> </span><span class=s1>'postgres_password'</span><span class=p>)</span><span class=w></span>
<span class=n>SETTINGS</span><span class=w> </span><span class=n>materialized_postgresql_tables_list</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>'schema1.table1,schema2.table2,schema1.table3'</span><span class=p>,</span><span class=w></span>
<span class=w>         </span><span class=n>materialized_postgresql_tables_list_with_schema</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w></span>

<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>database1</span><span class=p>.</span><span class=o>`</span><span class=n>schema1</span><span class=p>.</span><span class=n>table1</span><span class=o>`</span><span class=p>;</span><span class=w></span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>database1</span><span class=p>.</span><span class=o>`</span><span class=n>schema2</span><span class=p>.</span><span class=n>table2</span><span class=o>`</span><span class=p>;</span><span class=w></span>
</code></pre></div> <p>But in this case all tables in <code class=syntax>materialized_postgresql_tables_list</code> must be written with its schema name.<br> Requires <code class=syntax>materialized_postgresql_tables_list_with_schema = 1</code>.</p> <p>Warning: for this case dots in table name are not allowed.</p> <ol start=3> <li>Any number of schemas with full set of tables for one <code class=syntax>MaterializedPostgreSQL</code> database engine. Requires to use setting <code class=syntax>materialized_postgresql_schema_list</code>.</li> </ol> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span><span class=w> </span><span class=k>DATABASE</span><span class=w> </span><span class=n>database1</span><span class=w></span>
<span class=n>ENGINE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>MaterializedPostgreSQL</span><span class=p>(</span><span class=s1>'postgres1:5432'</span><span class=p>,</span><span class=w> </span><span class=s1>'postgres_database'</span><span class=p>,</span><span class=w> </span><span class=s1>'postgres_user'</span><span class=p>,</span><span class=w> </span><span class=s1>'postgres_password'</span><span class=p>)</span><span class=w></span>
<span class=n>SETTINGS</span><span class=w> </span><span class=n>materialized_postgresql_schema_list</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>'schema1,schema2,schema3'</span><span class=p>;</span><span class=w></span>

<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>database1</span><span class=p>.</span><span class=o>`</span><span class=n>schema1</span><span class=p>.</span><span class=n>table1</span><span class=o>`</span><span class=p>;</span><span class=w></span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>database1</span><span class=p>.</span><span class=o>`</span><span class=n>schema1</span><span class=p>.</span><span class=n>table2</span><span class=o>`</span><span class=p>;</span><span class=w></span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>database1</span><span class=p>.</span><span class=o>`</span><span class=n>schema2</span><span class=p>.</span><span class=n>table2</span><span class=o>`</span><span class=p>;</span><span class=w></span>
</code></pre></div> <p>Warning: for this case dots in table name are not allowed.</p> <h2 id=requirements>Requirements<a class=headerlink href=../amp/#requirements title="Permanent link"> </a></h2> <ol> <li> <p>The <a href=https://www.postgresql.org/docs/current/runtime-config-wal.html rel="external nofollow noreferrer" target=_blank>wal_level</a> setting must have a value <code class=syntax>logical</code> and <code class=syntax>max_replication_slots</code> parameter must have a value at least <code class=syntax>2</code> in the PostgreSQL config file.</p> </li> <li> <p>Each replicated table must have one of the following <a href=https://www.postgresql.org/docs/10/sql-altertable.html#SQL-CREATETABLE-REPLICA-IDENTITY rel="external nofollow noreferrer" target=_blank>replica identity</a>:</p> </li> </ol> <ul> <li> <p>primary key (by default)</p> </li> <li> <p>index</p> </li> </ul> <div class=codehilite><pre><span></span><code class=syntax>postgres# CREATE TABLE postgres_table <span class=o>(</span>a Integer NOT NULL, b Integer, c Integer NOT NULL, d Integer, e Integer NOT NULL<span class=o>)</span><span class=p>;</span>
postgres# CREATE unique INDEX postgres_table_index on postgres_table<span class=o>(</span>a, c, e<span class=o>)</span><span class=p>;</span>
postgres# ALTER TABLE postgres_table REPLICA IDENTITY USING INDEX postgres_table_index<span class=p>;</span>
</code></pre></div> <p>The primary key is always checked first. If it is absent, then the index, defined as replica identity index, is checked.<br> If the index is used as a replica identity, there has to be only one such index in a table.<br> You can check what type is used for a specific table with the following command:</p> <div class=codehilite><pre><span></span><code class=syntax>postgres# SELECT CASE relreplident
          WHEN <span class=s1>'d'</span> THEN <span class=s1>'default'</span>
          WHEN <span class=s1>'n'</span> THEN <span class=s1>'nothing'</span>
          WHEN <span class=s1>'f'</span> THEN <span class=s1>'full'</span>
          WHEN <span class=s1>'i'</span> THEN <span class=s1>'index'</span>
       END AS replica_identity
FROM pg_class
WHERE <span class=nv>oid</span> <span class=o>=</span> <span class=s1>'postgres_table'</span>::regclass<span class=p>;</span>
</code></pre></div> <div class="admonition warning alert pb-0 mb-4 alert-warning" role=alert> <p class="admonition-title alert-heading display-4 text-reset mb-2">Warning</p> <p>Replication of <a class=alert-link href=https://www.postgresql.org/docs/9.5/storage-toast.html rel="external nofollow noreferrer" target=_blank><strong>TOAST</strong></a> values is not supported. The default value for the data type will be used.</p> </div> <h2 id=settings>Settings<a class=headerlink href=../amp/#settings title="Permanent link"> </a></h2> <ol> <li>materialized_postgresql_tables_list {#materialized-postgresql-tables-list}</li> </ol> <p>Sets a comma-separated list of PostgreSQL database tables, which will be replicated via <a href=.././amp/ >MaterializedPostgreSQL</a> database engine.</p> <p>Default value: empty list — means whole PostgreSQL database will be replicated.</p> <ol start=2> <li>materialized_postgresql_schema {#materialized-postgresql-schema}</li> </ol> <p>Default value: empty string. (Default schema is used)</p> <ol start=3> <li>materialized_postgresql_schema_list {#materialized-postgresql-schema-list}</li> </ol> <p>Default value: empty list. (Default schema is used)</p> <ol start=4> <li>materialized_postgresql_allow_automatic_update {#materialized-postgresql-allow-automatic-update}</li> </ol> <p>Do not use this setting before 22.1 version.</p> <p>Allows reloading table in the background, when schema changes are detected. DDL queries on the PostgreSQL side are not replicated via ClickHouse <a href=.././amp/ >MaterializedPostgreSQL</a> engine, because it is not allowed with PostgreSQL logical replication protocol, but the fact of DDL changes is detected transactionally. In this case, the default behaviour is to stop replicating those tables once DDL is detected. However, if this setting is enabled, then, instead of stopping the replication of those tables, they will be reloaded in the background via database snapshot without data losses and replication will continue for them.</p> <p>Possible values:</p> <ul> <li>0 — The table is not automatically updated in the background, when schema changes are detected.</li> <li>1 — The table is automatically updated in the background, when schema changes are detected.</li> </ul> <p>Default value: <code class=syntax>0</code>.</p> <ol start=5> <li>materialized_postgresql_max_block_size {#materialized-postgresql-max-block-size}</li> </ol> <p>Sets the number of rows collected in memory before flushing data into PostgreSQL database table.</p> <p>Possible values:</p> <ul> <li>Positive integer.</li> </ul> <p>Default value: <code class=syntax>65536</code>.</p> <ol start=6> <li>materialized_postgresql_replication_slot {#materialized-postgresql-replication-slot}</li> </ol> <p>A user-created replication slot. Must be used together with <code class=syntax>materialized_postgresql_snapshot</code>.</p> <ol start=7> <li>materialized_postgresql_snapshot {#materialized-postgresql-snapshot}</li> </ol> <p>A text string identifying a snapshot, from which <a href=.././amp/ >initial dump of PostgreSQL tables</a> will be performed. Must be used together with <code class=syntax>materialized_postgresql_replication_slot</code>.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span><span class=w> </span><span class=k>DATABASE</span><span class=w> </span><span class=n>database1</span><span class=w></span>
<span class=n>ENGINE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>MaterializedPostgreSQL</span><span class=p>(</span><span class=s1>'postgres1:5432'</span><span class=p>,</span><span class=w> </span><span class=s1>'postgres_database'</span><span class=p>,</span><span class=w> </span><span class=s1>'postgres_user'</span><span class=p>,</span><span class=w> </span><span class=s1>'postgres_password'</span><span class=p>)</span><span class=w></span>
<span class=n>SETTINGS</span><span class=w> </span><span class=n>materialized_postgresql_tables_list</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>'table1,table2,table3'</span><span class=p>;</span><span class=w></span>

<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>database1</span><span class=p>.</span><span class=n>table1</span><span class=p>;</span><span class=w></span>
</code></pre></div> <p>The settings can be changed, if necessary, using a DDL query. But it is impossible to change the setting <code class=syntax>materialized_postgresql_tables_list</code>. To update the list of tables in this setting use the <code class=syntax>ATTACH TABLE</code> query.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>DATABASE</span><span class=w> </span><span class=n>postgres_database</span><span class=w> </span><span class=k>MODIFY</span><span class=w> </span><span class=n>SETTING</span><span class=w> </span><span class=n>materialized_postgresql_max_block_size</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>&lt;</span><span class=n>new_size</span><span class=o>&gt;</span><span class=p>;</span><span class=w></span>
</code></pre></div> <h2 id=notes>Notes<a class=headerlink href=../amp/#notes title="Permanent link"> </a></h2> <h3 id=logical-replication-slot-failover>Failover of the logical replication slot<a class=headerlink href=../amp/#logical-replication-slot-failover title="Permanent link"> </a></h3> <p>Logical Replication Slots which exist on the primary are not available on standby replicas.<br> So if there is a failover, new primary (the old physical standby) won’t be aware of any slots which were existing with old primary. This will lead to a broken replication from PostgreSQL.<br> A solution to this is to manage replication slots yourself and define a permanent replication slot (some information can be found <a href=https://patroni.readthedocs.io/en/latest/SETTINGS.html rel="external nofollow noreferrer" target=_blank>here</a>). You'll need to pass slot name via <code class=syntax>materialized_postgresql_replication_slot</code> setting, and it has to be exported with <code class=syntax>EXPORT SNAPSHOT</code> option. The snapshot identifier needs to be passed via <code class=syntax>materialized_postgresql_snapshot</code> setting.</p> <p>Please note that this should be used only if it is actually needed. If there is no real need for that or full understanding why, then it is better to allow the table engine to create and manage its own replication slot.</p> <p><strong>Example (from <a href=https://github.com/bchrobot rel="external nofollow noreferrer" target=_blank>@bchrobot</a>)</strong></p> <ol> <li>Configure replication slot in PostgreSQL.</li> </ol> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=s>"acid.zalan.do/v1"</span><span class=w></span>
<span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">postgresql</span><span class=w></span>
<span class=nt>metadata</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">acid-demo-cluster</span><span class=w></span>
<span class=nt>spec</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class=nt>numberOfInstances</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">2</span><span class=w></span>
<span class=w>  </span><span class=nt>postgresql</span><span class=p>:</span><span class=w></span>
<span class=w>    </span><span class=nt>parameters</span><span class=p>:</span><span class=w></span>
<span class=w>      </span><span class=nt>wal_level</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">logical</span><span class=w></span>
<span class=w>  </span><span class=nt>patroni</span><span class=p>:</span><span class=w></span>
<span class=w>    </span><span class=nt>slots</span><span class=p>:</span><span class=w></span>
<span class=w>      </span><span class=nt>clickhouse_sync</span><span class=p>:</span><span class=w></span>
<span class=w>        </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">logical</span><span class=w></span>
<span class=w>        </span><span class=nt>database</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">demodb</span><span class=w></span>
<span class=w>        </span><span class=nt>plugin</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">pgoutput</span><span class=w></span>
</code></pre></div> <ol start=2> <li>Wait for replication slot to be ready, then begin a transaction and export the transaction snapshot identifier:</li> </ol> <div class=codehilite><pre><span></span><code class=syntax><span class=k>BEGIN</span><span class=p>;</span><span class=w></span>
<span class=k>SELECT</span><span class=w> </span><span class=n>pg_export_snapshot</span><span class=p>();</span><span class=w></span>
</code></pre></div> <ol start=3> <li>In ClickHouse create database:</li> </ol> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span><span class=w> </span><span class=k>DATABASE</span><span class=w> </span><span class=n>demodb</span><span class=w></span>
<span class=n>ENGINE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>MaterializedPostgreSQL</span><span class=p>(</span><span class=s1>'postgres1:5432'</span><span class=p>,</span><span class=w> </span><span class=s1>'postgres_database'</span><span class=p>,</span><span class=w> </span><span class=s1>'postgres_user'</span><span class=p>,</span><span class=w> </span><span class=s1>'postgres_password'</span><span class=p>)</span><span class=w></span>
<span class=n>SETTINGS</span><span class=w></span>
<span class=w>  </span><span class=n>materialized_postgresql_replication_slot</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>'clickhouse_sync'</span><span class=p>,</span><span class=w></span>
<span class=w>  </span><span class=n>materialized_postgresql_snapshot</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>'0000000A-0000023F-3'</span><span class=p>,</span><span class=w></span>
<span class=w>  </span><span class=n>materialized_postgresql_tables_list</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>'table1,table2,table3'</span><span class=p>;</span><span class=w></span>
</code></pre></div> <ol start=4> <li>End the PostgreSQL transaction once replication to ClickHouse DB is confirmed. Verify that replication continues after failover:</li> </ol> <div class=codehilite><pre><span></span><code class=syntax>kubectl <span class=nb>exec</span> acid-demo-cluster-0 -c postgres -- su postgres -c <span class=s1>'patronictl failover --candidate acid-demo-cluster-1 --force'</span>
</code></pre></div> <h3 id=required-permissions>Required permissions<a class=headerlink href=../amp/#required-permissions title="Permanent link"> </a></h3> <ol> <li> <p><a href=https://postgrespro.ru/docs/postgresql/14/sql-createpublication rel="external nofollow noreferrer" target=_blank>CREATE PUBLICATION</a> -- create query privilege.</p> </li> <li> <p><a href=https://postgrespro.ru/docs/postgrespro/10/protocol-replication#PROTOCOL-REPLICATION-CREATE-SLOT rel="external nofollow noreferrer" target=_blank>CREATE_REPLICATION_SLOT</a> -- replication privelege.</p> </li> <li> <p><a href=https://postgrespro.ru/docs/postgrespro/9.5/functions-admin#functions-replication rel="external nofollow noreferrer" target=_blank>pg_drop_replication_slot</a> -- replication privilege or superuser.</p> </li> <li> <p><a href=https://postgrespro.ru/docs/postgresql/10/sql-droppublication rel="external nofollow noreferrer" target=_blank>DROP PUBLICATION</a> -- owner of publication (<code class=syntax>username</code> in MaterializedPostgreSQL engine itself).</p> </li> </ol> <p>It is possible to avoid executing <code class=syntax>2</code> and <code class=syntax>3</code> commands and having those permissions. Use settings <code class=syntax>materialized_postgresql_replication_slot</code> and <code class=syntax>materialized_postgresql_snapshot</code>. But with much care.</p> <p>Access to tables:</p> <ol> <li> <p>pg_publication</p> </li> <li> <p>pg_replication_slots</p> </li> <li> <p>pg_publication_tables</p> </li> </ol>
        </div>
      </div>
      <div class="row">
        <div class="col">
          
<div class="alert alert-light my-3">
  <p class="float-right mb-0">Rating: RATING_VALUE - RATING_COUNT votes</p>
  <span class="alert-heading display-6">Article Rating</span>
  <div id="rating-stars" class="display-6 mb-0"
     
  >RATING_STARS</div>
</div>

<div id="content-footer" class="text-muted pt-3 mb-5">
    <div class="float-md-right">©2016–2022 ClickHouse, Inc.</div>
    <div>Built from <a href="https://github.com/ClickHouse/ClickHouse/commit/38993f215f9186c1ac3505b1e09697cd9a468b5d" rel="external nofollow noreferrer" target="_blank" class="text-reset">38993f21</a>
    
    </div>
</div>

        </div>
      </div>
      <div id="to-full-website" class="row fixed-bottom text-center bg-white py-3">
        <div class="col">
          <a class="btn btn-lg btn-outline-orange" href="https://clickhouse.com/docs/en/engines/database-engines/materialized-postgresql/">To full website</a>
        </div>
      </div>
    </div>
    <amp-analytics type="metrika">
      <script type="application/json">{
"vars": {
  "counterId": "18343495",
  "triggers": {
    "notBounce": {
      "on": "timer",
      "timerSpec": {
        "immediate": false,
        "interval": 15,
        "maxTimerLength": 16
      },
      "request": "notBounce"
    }
  }
}
}</script>
  </amp-analytics>
  </body>
</html>
