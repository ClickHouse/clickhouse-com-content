"use strict";(self.webpackChunkclickhouse=self.webpackChunkclickhouse||[]).push([[58442],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return f}});var r=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=r.createContext({}),c=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=c(e.components);return r.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=c(n),f=i,h=d["".concat(s,".").concat(f)]||d[f]||p[f]||a;return n?r.createElement(h,o(o({ref:t},u),{},{components:n})):r.createElement(h,o({ref:t},u))}));function f(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=n.length,o=new Array(a);o[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,o[1]=l;for(var c=2;c<a;c++)o[c]=n[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},24312:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return s},default:function(){return f},frontMatter:function(){return l},metadata:function(){return c},toc:function(){return p}});var r=n(87462),i=n(63366),a=(n(67294),n(3905)),o=["components"],l={sidebar_position:39,sidebar_label:"Internal Dictionaries"},s="Internal Dictionaries",c={unversionedId:"en/sql-reference/dictionaries/internal-dicts",id:"en/sql-reference/dictionaries/internal-dicts",title:"Internal Dictionaries",description:"internal_dicts}",source:"@site/docs/en/sql-reference/dictionaries/internal-dicts.md",sourceDirName:"en/sql-reference/dictionaries",slug:"/en/sql-reference/dictionaries/internal-dicts",permalink:"/docs/docs/en/sql-reference/dictionaries/internal-dicts",tags:[],version:"current",sidebarPosition:39,frontMatter:{sidebar_position:39,sidebar_label:"Internal Dictionaries"},sidebar:"tutorialSidebar",previous:{title:"Polygon Dictionaries With Grids",permalink:"/docs/docs/en/sql-reference/dictionaries/external-dictionaries/external-dicts-dict-polygon"},next:{title:"Data Types",permalink:"/docs/docs/en/sql-reference/data-types/"}},u={},p=[],d={toc:p};function f(e){var t=e.components,n=(0,i.Z)(e,o);return(0,a.kt)("wrapper",(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"internal_dicts"},"Internal Dictionaries"),(0,a.kt)("p",null,"ClickHouse contains a built-in feature for working with a geobase."),(0,a.kt)("p",null,"This allows you to:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Use a region\u2019s ID to get its name in the desired language."),(0,a.kt)("li",{parentName:"ul"},"Use a region\u2019s ID to get the ID of a city, area, federal district, country, or continent."),(0,a.kt)("li",{parentName:"ul"},"Check whether a region is part of another region."),(0,a.kt)("li",{parentName:"ul"},"Get a chain of parent regions.")),(0,a.kt)("p",null,"All the functions support \u201ctranslocality,\u201d the ability to simultaneously use different perspectives on region ownership. For more information, see the section \u201cFunctions for working with web analytics dictionaries\u201d."),(0,a.kt)("p",null,"The internal dictionaries are disabled in the default package.\nTo enable them, uncomment the parameters ",(0,a.kt)("inlineCode",{parentName:"p"},"path_to_regions_hierarchy_file")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"path_to_regions_names_files")," in the server configuration file."),(0,a.kt)("p",null,"The geobase is loaded from text files."),(0,a.kt)("p",null,"Place the ",(0,a.kt)("inlineCode",{parentName:"p"},"regions_hierarchy*.txt")," files into the ",(0,a.kt)("inlineCode",{parentName:"p"},"path_to_regions_hierarchy_file")," directory. This configuration parameter must contain the path to the ",(0,a.kt)("inlineCode",{parentName:"p"},"regions_hierarchy.txt")," file (the default regional hierarchy), and the other files (",(0,a.kt)("inlineCode",{parentName:"p"},"regions_hierarchy_ua.txt"),") must be located in the same directory."),(0,a.kt)("p",null,"Put the ",(0,a.kt)("inlineCode",{parentName:"p"},"regions_names_*.txt")," files in the ",(0,a.kt)("inlineCode",{parentName:"p"},"path_to_regions_names_files")," directory."),(0,a.kt)("p",null,"You can also create these files yourself. The file format is as follows:"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"regions_hierarchy*.txt"),": TabSeparated (no header), columns:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"region ID (",(0,a.kt)("inlineCode",{parentName:"li"},"UInt32"),")"),(0,a.kt)("li",{parentName:"ul"},"parent region ID (",(0,a.kt)("inlineCode",{parentName:"li"},"UInt32"),")"),(0,a.kt)("li",{parentName:"ul"},"region type (",(0,a.kt)("inlineCode",{parentName:"li"},"UInt8"),"): 1 - continent, 3 - country, 4 - federal district, 5 - region, 6 - city; other types do not have values"),(0,a.kt)("li",{parentName:"ul"},"population (",(0,a.kt)("inlineCode",{parentName:"li"},"UInt32"),") \u2014 optional column")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"regions_names_*.txt"),": TabSeparated (no header), columns:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"region ID (",(0,a.kt)("inlineCode",{parentName:"li"},"UInt32"),")"),(0,a.kt)("li",{parentName:"ul"},"region name (",(0,a.kt)("inlineCode",{parentName:"li"},"String"),") \u2014 Can\u2019t contain tabs or line feeds, even escaped ones.")),(0,a.kt)("p",null,"A flat array is used for storing in RAM. For this reason, IDs shouldn\u2019t be more than a million."),(0,a.kt)("p",null,"Dictionaries can be updated without restarting the server. However, the set of available dictionaries is not updated.\nFor updates, the file modification times are checked. If a file has changed, the dictionary is updated.\nThe interval to check for changes is configured in the ",(0,a.kt)("inlineCode",{parentName:"p"},"builtin_dictionaries_reload_interval")," parameter.\nDictionary updates (other than loading at first use) do not block queries. During updates, queries use the old versions of dictionaries. If an error occurs during an update, the error is written to the server log, and queries continue using the old version of dictionaries."),(0,a.kt)("p",null,"We recommend periodically updating the dictionaries with the geobase. During an update, generate new files and write them to a separate location. When everything is ready, rename them to the files used by the server."),(0,a.kt)("p",null,"There are also functions for working with OS identifiers and search engines, but they shouldn\u2019t be used."))}f.isMDXComponent=!0}}]);