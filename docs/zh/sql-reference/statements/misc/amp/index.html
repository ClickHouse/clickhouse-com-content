










    



    



    



    
    






    <!doctype html>
<html ⚡ lang="zh">
  <head>
    <meta charset="utf-8">
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    <title>其他 | ClickHouse文档</title>
    <link rel="canonical" href="https://clickhouse.com/docs/zh/sql-reference/statements/misc/" />
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    
<script type="application/ld+json">[{
"@context": "http://schema.org",
"@type": "TechArticle",
"headline": "其他 | ClickHouse文档",
"mainEntityOfPage": "https://clickhouse.com/docs/zh/sql-reference/statements/misc/",




"image": "https://clickhouse.com/images/clickhouse-209x60.png",
"author": {
  "@type": "Project",
  "name": "ClickHouse"
},
"publisher": {
  "@type": "Organization",
  "name": "ClickHouse, Inc.",
  "logo": {
    "@type": "ImageObject",
    "url": "https://clickhouse.com/images/logo-400x240.png",
    "width": 400,
    "height": 240
  }
}}, {
"@context": "http://schema.org",
"@type": "Episode",
"name": "其他 | ClickHouse文档",
"aggregateRating": {
  "@type": "AggregateRating",
  "ratingValue": RATING_VALUE,
  "ratingCount": RATING_COUNT
}
}]</script>

    
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <style amp-custom>:root{--blue:#007bff;--indigo:#6610f2;--purple:#6f42c1;--pink:#e83e8c;--red:#dc3545;--orange:#fd7e14;--yellow:#ffc107;--green:#28a745;--teal:#20c997;--cyan:#17a2b8;--gray:#6c757d;--gray-dark:#343a40;--brand-primary:#fc0;--brand-secondary:#ff3939;--primary-accent-yellow:#fc0;--primary-accent-light-yellow:#fffaf0;--primary-accent-blue:#257af4;--primary-accent-light-blue:#e3f1fe;--secondary-accent-orange:#ff8c00;--secondary-accent-light-orange:#ffe4b5;--secondary-accent-red:#ff3939;--secondary-accent-light-red:#ffe4e1;--primary:#fc0;--secondary:#212529;--success:#28a745;--info:#17a2b8;--warning:#ffc107;--danger:#dc3545;--light:#f1f6f9;--dark:#495057;--primary-light:#fffaf0;--secondary-light:#fff;--tertiary:#257af4;--tertiary-light:#e3f1fe;--white:#fff;--black:#212529;--blue:#257af4;--light-blue:#e3f1fe;--yellow:#fc0;--light-yellow:#fffaf0;--orange:#ff8c00;--light-orange:#ffe4b5;--red:#ff3939;--light-red:#ffe4e1;--medium:#d6dbdf;--breakpoint-xxs:0;--breakpoint-xs:400px;--breakpoint-sm:616px;--breakpoint-md:768px;--breakpoint-lg:980px;--breakpoint-xl:1240px;--font-family-sans-serif:"Noto Sans",sans-serif;--font-family-monospace:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}*,:after,:before{box-sizing:border-box}html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:rgba(33,37,41,0)}article,footer,main{display:block}body{margin:0;font-family:Noto Sans,sans-serif;font-size:1rem;font-weight:400;line-height:1.5;color:#212529;text-align:left;background-color:#fff}[tabindex="-1"]:focus:not(:focus-visible){outline:0}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:16px}p{margin-top:0;margin-bottom:1rem}ol,ul{margin-bottom:1rem}ol,ul{margin-top:0}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}b,strong{font-weight:bolder}a{text-decoration:none;background-color:transparent}a,a:hover{color:#ff8c00}a:hover{text-decoration:underline}a:not([href]),a:not([href]):hover{color:inherit;text-decoration:none}code,pre{font-family:SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em}pre{margin-top:0;margin-bottom:1rem;overflow:auto}img{border-style:none}img,svg{vertical-align:middle}svg{overflow:hidden}table{border-collapse:collapse}select{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}select{text-transform:none}select{word-wrap:normal}[type=button],[type=reset],[type=submit]{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled){cursor:pointer}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{padding:0;border-style:none}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:none}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}[hidden]{display:none}.h1,.h2,.h3,.h4,.h5,.h6,h1,h2,h3,h4,h5,h6{margin-bottom:16px;font-family:Hind Siliguri,sans-serif;font-weight:500;line-height:1.125}.h1,h1{font-size:2.5rem}@media(max-width:1200px){.h1,h1{font-size:calc(1.375rem+1.5vw)}}.h2,h2{font-size:2rem}@media(max-width:1200px){.h2,h2{font-size:calc(1.325rem+.9vw)}}.h3,h3{font-size:1.75rem}@media(max-width:1200px){.h3,h3{font-size:calc(1.3rem+.6vw)}}.h4,h4{font-size:1.5rem}@media(max-width:1200px){.h4,h4{font-size:calc(1.275rem+.3vw)}}.h5,h5{font-size:1.125rem}.h6,h6{font-size:.875rem}.lead{font-size:1.375rem;font-weight:400}@media(max-width:1200px){.lead{font-size:calc(1.2625rem+.15vw)}}.display-1{font-size:4rem;font-weight:600;line-height:1.125}@media(max-width:1200px){.display-1{font-size:calc(1.525rem+3.3vw)}}.display-2{font-size:2.5rem;font-weight:600;line-height:1.125}@media(max-width:1200px){.display-2{font-size:calc(1.375rem+1.5vw)}}.display-3{font-size:2rem;font-weight:500;line-height:1.125}@media(max-width:1200px){.display-3{font-size:calc(1.325rem+.9vw)}}.display-4{font-size:1.75rem;font-weight:500;line-height:1.125}@media(max-width:1200px){.display-4{font-size:calc(1.3rem+.6vw)}}.img-fluid{max-width:100%;height:auto}code{font-size:87.5%;color:#e83e8c;word-wrap:break-word}a>code{color:inherit}pre{display:block;font-size:87.5%;color:#495057}pre code{font-size:inherit;color:inherit;word-break:normal}.container{width:100%;padding-right:20px;padding-left:20px;margin-right:auto;margin-left:auto}@media(min-width:400px){.container{max-width:576px}}@media(min-width:616px){.container{max-width:576px}}@media(min-width:768px){.container{max-width:958px}}@media(min-width:980px){.container{max-width:1008px}}@media(min-width:1240px){.container{max-width:1118px}}.container-fluid,.container-lg,.container-md{width:100%;padding-right:20px;padding-left:20px;margin-right:auto;margin-left:auto}@media(min-width:400px){.container{max-width:576px}}@media(min-width:616px){.container{max-width:576px}}@media(min-width:768px){.container,.container-md{max-width:958px}}@media(min-width:980px){.container,.container-lg,.container-md{max-width:1008px}}@media(min-width:1240px){.container,.container-lg,.container-md{max-width:1118px}}.row{display:flex;flex-wrap:wrap;margin-right:-20px;margin-left:-20px}.col,.col-1,.col-10,.col-11,.col-12,.col-2,.col-3,.col-4,.col-5,.col-6,.col-7,.col-8,.col-9,.col-lg,.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-md,.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9{position:relative;width:100%;padding-right:20px;padding-left:20px}.col{flex-basis:0;flex-grow:1;max-width:100%}.col-1{flex:0 0 8.3333333333%;max-width:8.3333333333%}.col-2{flex:0 0 16.6666666667%;max-width:16.6666666667%}.col-3{flex:0 0 25%;max-width:25%}.col-4{flex:0 0 33.3333333333%;max-width:33.3333333333%}.col-5{flex:0 0 41.6666666667%;max-width:41.6666666667%}.col-6{flex:0 0 50%;max-width:50%}.col-7{flex:0 0 58.3333333333%;max-width:58.3333333333%}.col-8{flex:0 0 66.6666666667%;max-width:66.6666666667%}.col-9{flex:0 0 75%;max-width:75%}.col-10{flex:0 0 83.3333333333%;max-width:83.3333333333%}.col-11{flex:0 0 91.6666666667%;max-width:91.6666666667%}.col-12{flex:0 0 100%;max-width:100%}@media(min-width:768px){.col-md{flex-basis:0;flex-grow:1;max-width:100%}.col-md-1{flex:0 0 8.3333333333%;max-width:8.3333333333%}.col-md-2{flex:0 0 16.6666666667%;max-width:16.6666666667%}.col-md-3{flex:0 0 25%;max-width:25%}.col-md-4{flex:0 0 33.3333333333%;max-width:33.3333333333%}.col-md-5{flex:0 0 41.6666666667%;max-width:41.6666666667%}.col-md-6{flex:0 0 50%;max-width:50%}.col-md-7{flex:0 0 58.3333333333%;max-width:58.3333333333%}.col-md-8{flex:0 0 66.6666666667%;max-width:66.6666666667%}.col-md-9{flex:0 0 75%;max-width:75%}.col-md-10{flex:0 0 83.3333333333%;max-width:83.3333333333%}.col-md-11{flex:0 0 91.6666666667%;max-width:91.6666666667%}.col-md-12{flex:0 0 100%;max-width:100%}}@media(min-width:980px){.col-lg{flex-basis:0;flex-grow:1;max-width:100%}.col-lg-1{flex:0 0 8.3333333333%;max-width:8.3333333333%}.col-lg-2{flex:0 0 16.6666666667%;max-width:16.6666666667%}.col-lg-3{flex:0 0 25%;max-width:25%}.col-lg-4{flex:0 0 33.3333333333%;max-width:33.3333333333%}.col-lg-5{flex:0 0 41.6666666667%;max-width:41.6666666667%}.col-lg-6{flex:0 0 50%;max-width:50%}.col-lg-7{flex:0 0 58.3333333333%;max-width:58.3333333333%}.col-lg-8{flex:0 0 66.6666666667%;max-width:66.6666666667%}.col-lg-9{flex:0 0 75%;max-width:75%}.col-lg-10{flex:0 0 83.3333333333%;max-width:83.3333333333%}.col-lg-11{flex:0 0 91.6666666667%;max-width:91.6666666667%}.col-lg-12{flex:0 0 100%;max-width:100%}}.table{width:100%;margin-bottom:8px;color:#212529}.table-primary{background-color:#fff1b8}.table-warning{background-color:#ffeeba}.table-light{background-color:#fbfcfd}.table-dark{background-color:#ccced0}.table-primary-light{background-color:#fffefb}.table-white{background-color:#fff}.table-black{background-color:#c1c2c3}.table-orange{background-color:#ffdfb8}.table-light-orange{background-color:#fff7ea}.table-dark{color:#fff;background-color:#343a40}.btn{display:inline-block;font-family:inherit;font-weight:700;color:#212529;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;padding:12px 32px;font-size:.875rem;line-height:20px;border-radius:8px;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media(prefers-reduced-motion:reduce){.btn{transition:none}}.btn:hover{color:#212529;text-decoration:none}.btn:focus{outline:0;box-shadow:none}.btn:disabled{opacity:.65}.btn-primary{color:#495057;background-color:#fc0;border-color:#fc0}.btn-primary:focus,.btn-primary:hover{color:#495057;background-color:#d9ad00;border-color:#cca300}.btn-primary:focus{box-shadow:0 0 0 0 rgba(228,185,13,.5)}.btn-primary:disabled{color:#495057;background-color:#fc0;border-color:#fc0}.btn-warning{color:#495057;background-color:#ffc107;border-color:#ffc107}.btn-warning:focus,.btn-warning:hover{color:#495057;background-color:#e0a800;border-color:#d39e00}.btn-warning:focus{box-shadow:0 0 0 0 rgba(228,176,19,.5)}.btn-warning:disabled{color:#495057;background-color:#ffc107;border-color:#ffc107}.btn-light{color:#495057;background-color:#f1f6f9;border-color:#f1f6f9}.btn-light:focus,.btn-light:hover{color:#495057;background-color:#d6e5ee;border-color:#cddfea}.btn-light:focus{box-shadow:0 0 0 0 rgba(216,221,225,.5)}.btn-light:disabled{color:#495057;background-color:#f1f6f9;border-color:#f1f6f9}.btn-dark{color:#fff;background-color:#495057;border-color:#495057}.btn-dark:focus,.btn-dark:hover{color:#fff;background-color:#383d42;border-color:#32373b}.btn-dark:focus{box-shadow:0 0 0 0 rgba(100,106,112,.5)}.btn-dark:disabled{color:#fff;background-color:#495057;border-color:#495057}.btn-primary-light{color:#495057;background-color:#fffaf0;border-color:#fffaf0}.btn-primary-light:focus,.btn-primary-light:hover{color:#495057;background-color:#ffedca;border-color:#ffe9bd}.btn-primary-light:focus{box-shadow:0 0 0 0 rgba(228,225,217,.5)}.btn-primary-light:disabled{color:#495057;background-color:#fffaf0;border-color:#fffaf0}.btn-white{color:#495057;background-color:#fff;border-color:#fff}.btn-white:focus,.btn-white:hover{color:#495057;background-color:#ececec;border-color:#e6e6e6}.btn-white:focus{box-shadow:0 0 0 0 rgba(228,229,230,.5)}.btn-white:disabled{color:#495057;background-color:#fff;border-color:#fff}.btn-black{color:#fff;background-color:#212529;border-color:#212529}.btn-black:focus,.btn-black:hover{color:#fff;background-color:#101214;border-color:#0a0c0d}.btn-black:focus{box-shadow:0 0 0 0 rgba(66,70,73,.5)}.btn-black:disabled{color:#fff;background-color:#212529;border-color:#212529}.btn-orange{color:#495057;background-color:#ff8c00;border-color:#ff8c00}.btn-orange:focus,.btn-orange:hover{color:#fff;background-color:#d97700;border-color:#cc7000}.btn-orange:focus{box-shadow:0 0 0 0 rgba(228,131,13,.5)}.btn-orange:disabled{color:#495057;background-color:#ff8c00;border-color:#ff8c00}.btn-light-orange{color:#495057;background-color:#ffe4b5;border-color:#ffe4b5}.btn-light-orange:focus,.btn-light-orange:hover{color:#495057;background-color:#ffd68f;border-color:#ffd182}.btn-light-orange:focus{box-shadow:0 0 0 0 rgba(228,206,167,.5)}.btn-light-orange:disabled{color:#495057;background-color:#ffe4b5;border-color:#ffe4b5}.btn-outline-primary{color:#fc0;border-color:#fc0}.btn-outline-primary:hover{color:#495057;background-color:#fc0;border-color:#fc0}.btn-outline-primary:focus{box-shadow:0 0 0 0 rgba(255,204,0,.5)}.btn-outline-primary:disabled{color:#fc0;background-color:transparent}.btn-outline-warning{color:#ffc107;border-color:#ffc107}.btn-outline-warning:hover{color:#495057;background-color:#ffc107;border-color:#ffc107}.btn-outline-warning:focus{box-shadow:0 0 0 0 rgba(255,193,7,.5)}.btn-outline-warning:disabled{color:#ffc107;background-color:transparent}.btn-outline-light{color:#f1f6f9;border-color:#f1f6f9}.btn-outline-light:hover{color:#495057;background-color:#f1f6f9;border-color:#f1f6f9}.btn-outline-light:focus{box-shadow:0 0 0 0 rgba(241,246,249,.5)}.btn-outline-light:disabled{color:#f1f6f9;background-color:transparent}.btn-outline-dark{color:#495057;border-color:#495057}.btn-outline-dark:hover{color:#fff;background-color:#495057;border-color:#495057}.btn-outline-dark:focus{box-shadow:0 0 0 0 rgba(73,80,87,.5)}.btn-outline-dark:disabled{color:#495057;background-color:transparent}.btn-outline-primary-light{color:#fffaf0;border-color:#fffaf0}.btn-outline-primary-light:hover{color:#495057;background-color:#fffaf0;border-color:#fffaf0}.btn-outline-primary-light:focus{box-shadow:0 0 0 0 rgba(255,250,240,.5)}.btn-outline-primary-light:disabled{color:#fffaf0;background-color:transparent}.btn-outline-white{color:#fff;border-color:#fff}.btn-outline-white:hover{color:#495057;background-color:#fff;border-color:#fff}.btn-outline-white:focus{box-shadow:0 0 0 0 hsla(0,0%,100%,.5)}.btn-outline-white:disabled{color:#fff;background-color:transparent}.btn-outline-black{color:#212529;border-color:#212529}.btn-outline-black:hover{color:#fff;background-color:#212529;border-color:#212529}.btn-outline-black:focus{box-shadow:0 0 0 0 rgba(33,37,41,.5)}.btn-outline-black:disabled{color:#212529;background-color:transparent}.btn-outline-orange{color:#ff8c00;border-color:#ff8c00}.btn-outline-orange:hover{color:#495057;background-color:#ff8c00;border-color:#ff8c00}.btn-outline-orange:focus{box-shadow:0 0 0 0 rgba(255,140,0,.5)}.btn-outline-orange:disabled{color:#ff8c00;background-color:transparent}.btn-outline-light-orange{color:#ffe4b5;border-color:#ffe4b5}.btn-outline-light-orange:hover{color:#495057;background-color:#ffe4b5;border-color:#ffe4b5}.btn-outline-light-orange:focus{box-shadow:0 0 0 0 rgba(255,228,181,.5)}.btn-outline-light-orange:disabled{color:#ffe4b5;background-color:transparent}.btn-link{font-weight:400;color:#ff8c00;text-decoration:none}.btn-link:hover{color:#ff8c00;text-decoration:underline}.btn-link:focus{text-decoration:underline;box-shadow:none}.btn-link:disabled{color:#d6dbdf;pointer-events:none}.btn-lg{padding:16px 32px;font-size:1.125rem;line-height:26px;border-radius:8px}.btn-block{display:block;width:100%}.btn-block+.btn-block{margin-top:24px}.custom-select{display:inline-block;width:100%;height:calc(1.5em+.75rem+2px);padding:.375rem 1.75rem .375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#6c757d;vertical-align:middle;background:#fff url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='4' height='5'%3E%3Cpath fill='%23343a40' d='M2 0L0 2h4zm0 5L0 3h4z'/%3E%3C/svg%3E") no-repeat right .75rem center/8px 10px;border:1px solid #ced4da;border-radius:8px;-webkit-appearance:none;-moz-appearance:none;appearance:none}.custom-select:focus{border-color:#ffe680;outline:0;box-shadow:0 0 0 .2rem rgba(255,204,0,.25)}.custom-select:focus::-ms-value{color:#6c757d;background-color:#fff}.custom-select[multiple],.custom-select[size]:not([size="1"]){height:auto;padding-right:.75rem;background-image:none}.custom-select:disabled{color:#6c757d;background-color:#e9ecef}.custom-select::-ms-expand{display:none}.custom-select:-moz-focusring{color:transparent;text-shadow:0 0 0 #6c757d}.custom-select-lg{height:calc(1.5em+1rem+2px);padding-top:.5rem;padding-bottom:.5rem;padding-left:1rem;font-size:1.125rem}.custom-file{display:inline-block;margin-bottom:0}.custom-file{position:relative;width:100%;height:calc(1.5em+.75rem+2px)}.custom-select{transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media(prefers-reduced-motion:reduce){.custom-select{transition:none}}pre{white-space:pre-wrap}pre{border:1px solid #d6dbdf;page-break-inside:avoid}img{page-break-inside:avoid}h2,h3,p{orphans:3;widows:3}h2,h3{page-break-after:avoid}@page{size:a3}.container,body{min-width:980px}.table{border-collapse:collapse}.table-dark{color:inherit}</style>
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    <script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>
  </head>
  <body class="amp" dir="ltr">
    <div class="container-fluid container-lg pb-5">
      <div class="row pt-3 mb-3">
        <div class="col">
          <a href="/" class="text-decoration-none">
            <amp-img class="d-inline-block mr-3" layout="fixed" width="40" height="36" src="/docs/images/logo.svg" alt="ClickHouse logo" title="ClickHouse logo"></amp-img><amp-img class="invert-dark d-inline-block" layout="fixed" width="238" height="36" src="/docs/images/clickhouse-black.svg" alt="ClickHouse" title="ClickHouse"></amp-img>
          </a>
        </div>
      </div>
      <div class="row">
        <div id="content" class="col">
          
    <div class="alert alert-primary" role="alert">
      <p class="display-5 mb-2">Help wanted!</p>
      <p class="lead">The following content of this documentation page has been machine-translated. But unlike other websites, it is not done on the fly. This translated text lives on GitHub repository alongside main ClickHouse codebase and waits for fellow native speakers to make it more human-readable. <a href="/docs/en/sql-reference/statements/misc/" class="alert-link">You can also use the original English version as a reference.</a></p>
      <p class="lead">
          <a class="btn btn-lg btn-primary text-white" href="https://github.com/ClickHouse/ClickHouse/edit/master/docs/zh/sql-reference/statements/misc.md" target="_blank" rel="external nofollow noreferrer">
              Help ClickHouse documentation by editing this page
          </a>
      </p>
    </div>

          <h1 id=miscellaneous-queries>杂项查询<a class=headerlink href=../amp/#miscellaneous-queries title="Permanent link"> </a></h1> <h2 id=attach>ATTACH<a class=headerlink href=../amp/#attach title="Permanent link"> </a></h2> <p>与<code class=syntax>CREATE</code>类似，但有所区别</p> <ul> <li>使用关键词 <code class=syntax>ATTACH</code></li> <li>查询不会在磁盘上创建数据。但会假定数据已经在对应位置存放，同时将与表相关的信息添加到服务器。<br> 执行 <code class=syntax>ATTACH</code> 查询后，服务器将知道表已经被创建。</li> </ul> <p>如果表之前已分离 (<code class=syntax>DETACH</code>），意味着其结构是已知的，可以使用简要的写法来建立表，即不需要定义表结构的Schema细节。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>ATTACH</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=n>name</span><span class=w> </span><span class=p>[</span><span class=k>ON</span><span class=w> </span><span class=k>CLUSTER</span><span class=w> </span><span class=k>cluster</span><span class=p>]</span><span class=w></span>
</code></pre></div> <p>启动服务器时会自动触发此查询。</p> <p>服务器将表的元数据作为文件存储 <code class=syntax>ATTACH</code> 查询，它只是在启动时运行。有些表例外，如系统表，它们是在服务器上显式指定的。</p> <h2 id=check-table>CHECK TABLE<a class=headerlink href=../amp/#check-table title="Permanent link"> </a></h2> <p>检查表中的数据是否已损坏。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CHECK</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=n>name</span><span class=w></span>
</code></pre></div> <p><code class=syntax>CHECK TABLE</code> 查询会比较存储在服务器上的实际文件大小与预期值。 如果文件大小与存储的值不匹配，则表示数据已损坏。 例如，这可能是由查询执行期间的系统崩溃引起的。</p> <p>查询返回一行结果，列名为 <code class=syntax>result</code>, 该行的值为 <a href=../../../data-types/boolean/amp/ >布尔值</a> 类型:</p> <ul> <li>0-表中的数据已损坏；</li> <li>1-数据保持完整性；</li> </ul> <p>该 <code class=syntax>CHECK TABLE</code> 查询支持下表引擎:</p> <ul> <li><a href=../../../../engines/table-engines/log-family/log/amp/ >Log</a></li> <li><a href=../../../../engines/table-engines/log-family/tinylog/amp/ >TinyLog</a></li> <li><a href=../../../../engines/table-engines/log-family/stripelog/amp/ >StripeLog</a></li> <li><a href=../../../../engines/table-engines/mergetree-family/mergetree/amp/ >MergeTree 家族</a></li> </ul> <p>对其他不支持的表引擎的表执行会导致异常。</p> <p>来自 <code class=syntax>*Log</code> 家族的引擎不提供故障自动数据恢复。 使用 <code class=syntax>CHECK TABLE</code> 查询及时跟踪数据丢失。</p> <p>对于 <code class=syntax>MergeTree</code> 家族引擎， <code class=syntax>CHECK TABLE</code> 查询显示本地服务器上表的每个单独数据部分的检查状态。</p> <p><strong>如果数据已损坏</strong></p> <p>如果表已损坏，则可以将未损坏的数据复制到另一个表。 要做到这一点:</p> <ol> <li>创建一个与损坏的表结构相同的新表。 请执行查询 <code class=syntax>CREATE TABLE &lt;new_table_name&gt; AS &lt;damaged_table_name&gt;</code>.</li> <li>将 <a href=../../../../operations/settings/settings/amp/#settings-max_threads>max_threads</a> 值设置为1，以在单个线程中处理下一个查询。 要这样做，请运行查询 <code class=syntax>SET max_threads = 1</code>.</li> <li>执行查询 <code class=syntax>INSERT INTO &lt;new_table_name&gt; SELECT * FROM &lt;damaged_table_name&gt;</code>. 此请求将未损坏的数据从损坏的表复制到另一个表。 只有损坏部分之前的数据才会被复制。</li> <li>重新启动 <code class=syntax>clickhouse-client</code> 以重置 <code class=syntax>max_threads</code> 值。</li> </ol> <h2 id=misc-describe-table>DESCRIBE TABLE<a class=headerlink href=../amp/#misc-describe-table title="Permanent link"> </a></h2> <p>查看表的描述信息，返回各列的Schema，语法如下：</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>DESC</span><span class=o>|</span><span class=k>DESCRIBE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=k>table</span><span class=w> </span><span class=p>[</span><span class=k>INTO</span><span class=w> </span><span class=n>OUTFILE</span><span class=w> </span><span class=n>filename</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>FORMAT</span><span class=w> </span><span class=n>format</span><span class=p>]</span><span class=w></span>
</code></pre></div> <p>返回以下 <code class=syntax>String</code> 类型列:</p> <ul> <li><code class=syntax>name</code> — 列名。</li> <li><code class=syntax>type</code>— 列的类型。</li> <li><code class=syntax>default_type</code> — <a href=../../create/amp/#create-default-values>默认表达式</a> (<code class=syntax>DEFAULT</code>, <code class=syntax>MATERIALIZED</code> 或 <code class=syntax>ALIAS</code>)中使用的子句。 如果没有指定默认表达式，则列包含一个空字符串。</li> <li><code class=syntax>default_expression</code> — <code class=syntax>DEFAULT</code> 子句中指定的值。</li> <li><code class=syntax>comment_expression</code> — 注释信息。</li> </ul> <p>嵌套数据结构以 “expanded” 格式输出。 每列分别显示，列名后加点号。</p> <h2 id=detach>DETACH<a class=headerlink href=../amp/#detach title="Permanent link"> </a></h2> <p>从服务器中删除目标表信息（删除对象是表), 执行查询后,服务器视作该表已经不存在。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>DETACH</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=n>name</span><span class=w> </span><span class=p>[</span><span class=k>ON</span><span class=w> </span><span class=k>CLUSTER</span><span class=w> </span><span class=k>cluster</span><span class=p>]</span><span class=w></span>
</code></pre></div> <p>这不会删除表的数据或元数据。 在下一次服务器启动时，服务器将读取元数据并再次查找该表。<br> 也可以不停止服务器的情况下，使用前面介绍的 <code class=syntax>ATTACH</code> 查询来重新关联该表（系统表除外，没有为它们存储元数据）。</p> <h2 id=drop>DROP<a class=headerlink href=../amp/#drop title="Permanent link"> </a></h2> <p>删除已经存在的实体。如果指定 <code class=syntax>IF EXISTS</code>， 则如果实体不存在，则不返回错误。<br> 建议使用时添加 <code class=syntax>IF EXISTS</code> 修饰符。</p> <h2 id=drop-database>DROP DATABASE<a class=headerlink href=../amp/#drop-database title="Permanent link"> </a></h2> <p>删除 <code class=syntax>db</code> 数据库中的所有表，然后删除 <code class=syntax>db</code> 数据库本身。</p> <p>语法:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>DROP</span><span class=w> </span><span class=k>DATABASE</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=n>db</span><span class=w> </span><span class=p>[</span><span class=k>ON</span><span class=w> </span><span class=k>CLUSTER</span><span class=w> </span><span class=k>cluster</span><span class=p>]</span><span class=w></span>
</code></pre></div> <h2 id=drop-table>DROP TABLE<a class=headerlink href=../amp/#drop-table title="Permanent link"> </a></h2> <p>删除表。</p> <p>语法:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>DROP</span><span class=w> </span><span class=p>[</span><span class=k>TEMPORARY</span><span class=p>]</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=n>name</span><span class=w> </span><span class=p>[</span><span class=k>ON</span><span class=w> </span><span class=k>CLUSTER</span><span class=w> </span><span class=k>cluster</span><span class=p>]</span><span class=w></span>
</code></pre></div> <h2 id=drop-dictionary>DROP DICTIONARY<a class=headerlink href=../amp/#drop-dictionary title="Permanent link"> </a></h2> <p>删除字典。</p> <p>语法:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>DROP</span><span class=w> </span><span class=k>DICTIONARY</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=n>name</span><span class=w></span>
</code></pre></div> <h2 id=drop-user-statement>DROP USER<a class=headerlink href=../amp/#drop-user-statement title="Permanent link"> </a></h2> <p>删除用户。</p> <p>语法:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>DROP</span><span class=w> </span><span class=k>USER</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=p>[,...]</span><span class=w> </span><span class=p>[</span><span class=k>ON</span><span class=w> </span><span class=k>CLUSTER</span><span class=w> </span><span class=n>cluster_name</span><span class=p>]</span><span class=w></span>
</code></pre></div> <h2 id=drop-role-statement>DROP ROLE<a class=headerlink href=../amp/#drop-role-statement title="Permanent link"> </a></h2> <p>删除角色。</p> <p>同时该角色所拥有的权限也会被收回。</p> <p>语法:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>DROP</span><span class=w> </span><span class=k>ROLE</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=p>[,...]</span><span class=w> </span><span class=p>[</span><span class=k>ON</span><span class=w> </span><span class=k>CLUSTER</span><span class=w> </span><span class=n>cluster_name</span><span class=p>]</span><span class=w></span>
</code></pre></div> <h2 id=drop-row-policy-statement>DROP ROW POLICY<a class=headerlink href=../amp/#drop-row-policy-statement title="Permanent link"> </a></h2> <p>删除行策略。</p> <p>已删除行策略将从分配该策略的所有实体撤销。</p> <p>语法:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>DROP</span><span class=w> </span><span class=p>[</span><span class=k>ROW</span><span class=p>]</span><span class=w> </span><span class=n>POLICY</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=p>[,...]</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=p>[</span><span class=k>database</span><span class=p>.]</span><span class=k>table</span><span class=w> </span><span class=p>[,...]</span><span class=w> </span><span class=p>[</span><span class=k>ON</span><span class=w> </span><span class=k>CLUSTER</span><span class=w> </span><span class=n>cluster_name</span><span class=p>]</span><span class=w></span>
</code></pre></div> <h2 id=drop-quota-statement>DROP QUOTA<a class=headerlink href=../amp/#drop-quota-statement title="Permanent link"> </a></h2> <p>删除配额。</p> <p>已删除的配额将从分配该配额的所有实体撤销。</p> <p>语法:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>DROP</span><span class=w> </span><span class=n>QUOTA</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=p>[,...]</span><span class=w> </span><span class=p>[</span><span class=k>ON</span><span class=w> </span><span class=k>CLUSTER</span><span class=w> </span><span class=n>cluster_name</span><span class=p>]</span><span class=w></span>
</code></pre></div> <h2 id=drop-settings-profile-statement>DROP SETTINGS PROFILE<a class=headerlink href=../amp/#drop-settings-profile-statement title="Permanent link"> </a></h2> <p>删除settings配置。</p> <p>已删除的settings配置将从分配该settings配置的所有实体撤销。</p> <p>语法:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>DROP</span><span class=w> </span><span class=p>[</span><span class=n>SETTINGS</span><span class=p>]</span><span class=w> </span><span class=n>PROFILE</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=p>[,...]</span><span class=w> </span><span class=p>[</span><span class=k>ON</span><span class=w> </span><span class=k>CLUSTER</span><span class=w> </span><span class=n>cluster_name</span><span class=p>]</span><span class=w></span>
</code></pre></div> <h2 id=drop-view>DROP VIEW<a class=headerlink href=../amp/#drop-view title="Permanent link"> </a></h2> <p>删除视图。视图也可以通过 <code class=syntax>DROP TABLE</code> 删除，但是 <code class=syntax>DROP VIEW</code> 检查 <code class=syntax>[db.]name</code> 是视图。</p> <p>语法:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>DROP</span><span class=w> </span><span class=k>VIEW</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=n>name</span><span class=w> </span><span class=p>[</span><span class=k>ON</span><span class=w> </span><span class=k>CLUSTER</span><span class=w> </span><span class=k>cluster</span><span class=p>]</span><span class=w></span>
</code></pre></div> <h2 id=exists-statement>EXISTS<a class=headerlink href=../amp/#exists-statement title="Permanent link"> </a></h2> <div class=codehilite><pre><span></span><code class=syntax><span class=k>EXISTS</span><span class=w> </span><span class=p>[</span><span class=k>TEMPORARY</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=k>TABLE</span><span class=o>|</span><span class=k>DICTIONARY</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=n>name</span><span class=w> </span><span class=p>[</span><span class=k>INTO</span><span class=w> </span><span class=n>OUTFILE</span><span class=w> </span><span class=n>filename</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>FORMAT</span><span class=w> </span><span class=n>format</span><span class=p>]</span><span class=w></span>
</code></pre></div> <p>返回单个 <code class=syntax>UInt8</code> 类型的列，其中包含单个值 <code class=syntax>0</code> 如果表或数据库不存在，或 <code class=syntax>1</code> 如果该表存在于指定的数据库中。</p> <h2 id=kill-query-statement>KILL QUERY<a class=headerlink href=../amp/#kill-query-statement title="Permanent link"> </a></h2> <div class=codehilite><pre><span></span><code class=syntax><span class=n>KILL</span><span class=w> </span><span class=n>QUERY</span><span class=w> </span><span class=p>[</span><span class=k>ON</span><span class=w> </span><span class=k>CLUSTER</span><span class=w> </span><span class=k>cluster</span><span class=p>]</span><span class=w></span>
<span class=w>  </span><span class=k>WHERE</span><span class=w> </span><span class=o>&lt;</span><span class=k>where</span><span class=w> </span><span class=n>expression</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>system</span><span class=p>.</span><span class=n>processes</span><span class=w> </span><span class=n>query</span><span class=o>&gt;</span><span class=w></span>
<span class=w>  </span><span class=p>[</span><span class=n>SYNC</span><span class=o>|</span><span class=n>ASYNC</span><span class=o>|</span><span class=n>TEST</span><span class=p>]</span><span class=w></span>
<span class=w>  </span><span class=p>[</span><span class=n>FORMAT</span><span class=w> </span><span class=n>format</span><span class=p>]</span><span class=w></span>
</code></pre></div> <p>尝试强制终止当前正在运行的查询。<br> 要终止的查询是使用 <code class=syntax>KILL</code> 查询的 <code class=syntax>WHERE</code> 子句定义的标准从system.processes表中选择的。</p> <p>例:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=c1>-- Forcibly terminates all queries with the specified query_id:</span>
<span class=n>KILL</span><span class=w> </span><span class=n>QUERY</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>query_id</span><span class=o>=</span><span class=s1>'2-857d-4a57-9ee0-327da5d60a90'</span><span class=w></span>

<span class=c1>-- Synchronously terminates all queries run by 'username':</span>
<span class=n>KILL</span><span class=w> </span><span class=n>QUERY</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=k>user</span><span class=o>=</span><span class=s1>'username'</span><span class=w> </span><span class=n>SYNC</span><span class=w></span>
</code></pre></div> <p>只读用户只能停止自己提交的查询。</p> <p>默认情况下，使用异步版本的查询 (<code class=syntax>ASYNC</code>），不需要等待确认查询已停止。</p> <p>而相对的，终止同步版本 (<code class=syntax>SYNC</code>）的查询会显示每步停止时间。</p> <p>返回信息包含 <code class=syntax>kill_status</code> 列，该列可以采用以下值:</p> <ol> <li>‘finished’ – 查询已成功终止。</li> <li>‘waiting’ – 发送查询信号终止后，等待查询结束。</li> <li>其他值，会解释为什么查询不能停止。</li> </ol> <p>测试查询 (<code class=syntax>TEST</code>）仅检查用户的权限，并显示要停止的查询列表。</p> <h2 id=kill-mutation>KILL MUTATION<a class=headerlink href=../amp/#kill-mutation title="Permanent link"> </a></h2> <div class=codehilite><pre><span></span><code class=syntax><span class=n>KILL</span><span class=w> </span><span class=n>MUTATION</span><span class=w> </span><span class=p>[</span><span class=k>ON</span><span class=w> </span><span class=k>CLUSTER</span><span class=w> </span><span class=k>cluster</span><span class=p>]</span><span class=w></span>
<span class=w>  </span><span class=k>WHERE</span><span class=w> </span><span class=o>&lt;</span><span class=k>where</span><span class=w> </span><span class=n>expression</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>system</span><span class=p>.</span><span class=n>mutations</span><span class=w> </span><span class=n>query</span><span class=o>&gt;</span><span class=w></span>
<span class=w>  </span><span class=p>[</span><span class=n>TEST</span><span class=p>]</span><span class=w></span>
<span class=w>  </span><span class=p>[</span><span class=n>FORMAT</span><span class=w> </span><span class=n>format</span><span class=p>]</span><span class=w></span>
</code></pre></div> <p>尝试取消和删除当前正在执行的 <a href=../../alter/amp/#alter-mutations>mutations</a> 。 要取消的mutation是使用 <code class=syntax>KILL</code> 查询的WHERE子句指定的过滤器从<a href=../../../../operations/system-tables/mutations/amp/#system_tables-mutations><code class=syntax>system.mutations</code></a> 表中选择的。</p> <p>测试查询 (<code class=syntax>TEST</code>）仅检查用户的权限并显示要停止的mutations列表。</p> <p>例:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=c1>-- Cancel and remove all mutations of the single table:</span>
<span class=n>KILL</span><span class=w> </span><span class=n>MUTATION</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=k>database</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>'default'</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>'table'</span><span class=w></span>

<span class=c1>-- Cancel the specific mutation:</span>
<span class=n>KILL</span><span class=w> </span><span class=n>MUTATION</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=k>database</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>'default'</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>'table'</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>mutation_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>'mutation_3.txt'</span><span class=w></span>
</code></pre></div> <p>当mutation卡住且无法完成时，该查询是有用的(例如，当mutation查询中的某些函数在应用于表中包含的数据时抛出异常)。</p> <p>Mutation已经做出的更改不会回滚。</p> <h2 id=misc_operations-optimize>OPTIMIZE<a class=headerlink href=../amp/#misc_operations-optimize title="Permanent link"> </a></h2> <div class=codehilite><pre><span></span><code class=syntax><span class=n>OPTIMIZE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=n>name</span><span class=w> </span><span class=p>[</span><span class=k>ON</span><span class=w> </span><span class=k>CLUSTER</span><span class=w> </span><span class=k>cluster</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>PARTITION</span><span class=w> </span><span class=n>partition</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=n>ID</span><span class=w> </span><span class=s1>'partition_id'</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=k>FINAL</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>DEDUPLICATE</span><span class=p>]</span><span class=w></span>
</code></pre></div> <p>此查询尝试初始化 <a href=../../../../engines/table-engines/mergetree-family/mergetree/amp/ >MergeTree</a>家族的表引擎的表中未计划合并数据部分。</p> <p>该 <code class=syntax>OPTMIZE</code> 查询也支持 <a href=../../../../engines/table-engines/special/materializedview/amp/ >MaterializedView</a> 和 <a href=../../../../engines/table-engines/special/buffer/amp/ >Buffer</a> 引擎。 不支持其他表引擎。</p> <p>当 <code class=syntax>OPTIMIZE</code> 与 <a href=../../../../engines/table-engines/mergetree-family/replication/amp/ >ReplicatedMergeTree</a> 家族的表引擎一起使用时，ClickHouse将创建一个合并任务，并等待所有节点上的执行（如果 <code class=syntax>replication_alter_partitions_sync</code> 设置已启用）。</p> <ul> <li>如果 <code class=syntax>OPTIMIZE</code> 出于任何原因不执行合并，它不通知客户端。 要启用通知，请使用 <a href=../../../../operations/settings/settings/amp/#setting-optimize_throw_if_noop>optimize_throw_if_noop</a> 设置。</li> <li>如果您指定 <code class=syntax>PARTITION</code>，仅优化指定的分区。 <a href=../../alter/amp/#alter-how-to-specify-part-expr>如何设置分区表达式</a>.</li> <li>如果您指定 <code class=syntax>FINAL</code>，即使所有数据已经在一个部分中，也会执行优化。</li> <li>如果您指定 <code class=syntax>DEDUPLICATE</code>，则将对完全相同的行进行重复数据删除（所有列进行比较），这仅适用于MergeTree引擎。</li> </ul> <div class="admonition warning alert pb-0 mb-4 alert-warning" role=alert> <p class="admonition-title alert-heading display-4 text-reset mb-2">警告</p> <p><code class=syntax>OPTIMIZE</code> 无法修复 “Too many parts” 错误。</p> </div> <h2 id=misc_operations-rename>RENAME<a class=headerlink href=../amp/#misc_operations-rename title="Permanent link"> </a></h2> <p>重命名一个或多个表。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>RENAME</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=p>[</span><span class=n>db11</span><span class=p>.]</span><span class=n>name11</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=p>[</span><span class=n>db12</span><span class=p>.]</span><span class=n>name12</span><span class=p>,</span><span class=w> </span><span class=p>[</span><span class=n>db21</span><span class=p>.]</span><span class=n>name21</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=p>[</span><span class=n>db22</span><span class=p>.]</span><span class=n>name22</span><span class=p>,</span><span class=w> </span><span class=p>...</span><span class=w> </span><span class=p>[</span><span class=k>ON</span><span class=w> </span><span class=k>CLUSTER</span><span class=w> </span><span class=k>cluster</span><span class=p>]</span><span class=w></span>
</code></pre></div> <p>所有表都在全局锁定下重命名。 重命名表是一个轻型操作。 如果您在TO之后指定了另一个数据库，则表将被移动到此数据库。 但是，包含数据库的目录必须位于同一文件系统中（否则，将返回错误）。<br> 如果您在一个查询中重命名多个表，这是一个非原子操作，它可能被部分执行，其他会话中的查询可能会接收错误 Table ... doesn't exist ...。</p> <h2 id=query-set>SET<a class=headerlink href=../amp/#query-set title="Permanent link"> </a></h2> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SET</span><span class=w> </span><span class=n>param</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>value</span><span class=w></span>
</code></pre></div> <p>为当前会话的 <a href=../../../../operations/settings/amp/ >设置</a> <code class=syntax>param</code> 分配值 <code class=syntax>value</code>。 您不能以这种方式更改 <a href=../../../../operations/server-configuration-parameters/amp/ >服务器设置</a>。</p> <p>您还可以在单个查询中从指定的设置配置文件中设置所有值。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SET</span><span class=w> </span><span class=n>profile</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>'profile-name-from-the-settings-file'</span><span class=w></span>
</code></pre></div> <p>有关详细信息，请参阅 <a href=../../../../operations/settings/settings/amp/ >设置</a>.</p> <h2 id=set-role-statement>SET ROLE<a class=headerlink href=../amp/#set-role-statement title="Permanent link"> </a></h2> <p>激活当前用户的角色。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SET</span><span class=w> </span><span class=k>ROLE</span><span class=w> </span><span class=err>{</span><span class=k>DEFAULT</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>NONE</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>role</span><span class=w> </span><span class=p>[,...]</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>ALL</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>ALL</span><span class=w> </span><span class=k>EXCEPT</span><span class=w> </span><span class=k>role</span><span class=w> </span><span class=p>[,...]</span><span class=err>}</span><span class=w></span>
</code></pre></div> <h2 id=set-default-role-statement>SET DEFAULT ROLE<a class=headerlink href=../amp/#set-default-role-statement title="Permanent link"> </a></h2> <p>将默认角色设置为用户。</p> <p>默认角色在用户登录时自动激活。 您只能将以前授予的角色设置为默认值。 如果角色没有授予用户，ClickHouse会抛出异常。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SET</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>ROLE</span><span class=w> </span><span class=err>{</span><span class=k>NONE</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>role</span><span class=w> </span><span class=p>[,...]</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>ALL</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>ALL</span><span class=w> </span><span class=k>EXCEPT</span><span class=w> </span><span class=k>role</span><span class=w> </span><span class=p>[,...]</span><span class=err>}</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=err>{</span><span class=k>user</span><span class=o>|</span><span class=k>CURRENT_USER</span><span class=err>}</span><span class=w> </span><span class=p>[,...]</span><span class=w></span>
</code></pre></div> <h3 id=set-default-role-examples>示例<a class=headerlink href=../amp/#set-default-role-examples title="Permanent link"> </a></h3> <p>为用户设置多个默认角色:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SET</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>ROLE</span><span class=w> </span><span class=n>role1</span><span class=p>,</span><span class=w> </span><span class=n>role2</span><span class=p>,</span><span class=w> </span><span class=p>...</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=k>user</span><span class=w></span>
</code></pre></div> <p>将所有授予的角色设置为用户的默认角色:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SET</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>ROLE</span><span class=w> </span><span class=k>ALL</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=k>user</span><span class=w></span>
</code></pre></div> <p>清除用户的默认角色:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SET</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>ROLE</span><span class=w> </span><span class=k>NONE</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=k>user</span><span class=w></span>
</code></pre></div> <p>将所有授予的角色设置为默认角色，但其中一些角色除外:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SET</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>ROLE</span><span class=w> </span><span class=k>ALL</span><span class=w> </span><span class=k>EXCEPT</span><span class=w> </span><span class=n>role1</span><span class=p>,</span><span class=w> </span><span class=n>role2</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=k>user</span><span class=w></span>
</code></pre></div> <h2 id=truncate-statement>TRUNCATE<a class=headerlink href=../amp/#truncate-statement title="Permanent link"> </a></h2> <div class=codehilite><pre><span></span><code class=syntax><span class=k>TRUNCATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=n>name</span><span class=w> </span><span class=p>[</span><span class=k>ON</span><span class=w> </span><span class=k>CLUSTER</span><span class=w> </span><span class=k>cluster</span><span class=p>]</span><span class=w></span>
</code></pre></div> <p>从表中删除所有数据。 当省略 <code class=syntax>IF EXISTS</code>子句时，如果该表不存在，则查询返回错误。</p> <p>该 <code class=syntax>TRUNCATE</code> 查询不支持 <a href=../../../../engines/table-engines/special/view/amp/ >View</a>, <a href=../../../../engines/table-engines/special/file/amp/ >File</a>, <a href=../../../../engines/table-engines/special/url/amp/ >URL</a> 和 <a href=../../../../engines/table-engines/special/null/amp/ >Null</a> 表引擎.</p> <h2 id=use>USE<a class=headerlink href=../amp/#use title="Permanent link"> </a></h2> <div class=codehilite><pre><span></span><code class=syntax><span class=n>USE</span><span class=w> </span><span class=n>db</span><span class=w></span>
</code></pre></div> <p>用于设置会话的当前数据库。<br> 当前数据库用于搜索表，如果数据库没有在查询中明确定义与表名之前的点。<br> 使用HTTP协议时无法进行此查询，因为没有会话的概念。</p>
        </div>
      </div>
      <div class="row">
        <div class="col">
          
<div class="alert alert-light my-3">
  <p class="float-right mb-0">Rating: RATING_VALUE - RATING_COUNT votes</p>
  <span class="alert-heading display-6">Article Rating</span>
  <div id="rating-stars" class="display-6 mb-0"
     
  >RATING_STARS</div>
</div>

<div id="content-footer" class="text-muted pt-3 mb-5">
    <div class="float-md-right">©2016–2022 ClickHouse, Inc.</div>
    <div>Built from <a href="https://github.com/ClickHouse/ClickHouse/commit/38993f215f9186c1ac3505b1e09697cd9a468b5d" rel="external nofollow noreferrer" target="_blank" class="text-reset">38993f21</a>
    
    </div>
</div>

        </div>
      </div>
      <div id="to-full-website" class="row fixed-bottom text-center bg-white py-3">
        <div class="col">
          <a class="btn btn-lg btn-outline-orange" href="https://clickhouse.com/docs/zh/sql-reference/statements/misc/">To full website</a>
        </div>
      </div>
    </div>
    <amp-analytics type="metrika">
      <script type="application/json">{
"vars": {
  "counterId": "18343495",
  "triggers": {
    "notBounce": {
      "on": "timer",
      "timerSpec": {
        "immediate": false,
        "interval": 15,
        "maxTimerLength": 16
      },
      "request": "notBounce"
    }
  }
}
}</script>
  </amp-analytics>
  </body>
</html>
