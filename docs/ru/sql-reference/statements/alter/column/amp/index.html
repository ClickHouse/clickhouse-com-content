










    



    



    



    
    






    <!doctype html>
<html ⚡ lang="ru">
  <head>
    <meta charset="utf-8">
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    <title>Манипуляции со столбцами | Документация ClickHouse</title>
    <link rel="canonical" href="https://clickhouse.com/docs/ru/sql-reference/statements/alter/column/" />
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    
<script type="application/ld+json">[{
"@context": "http://schema.org",
"@type": "TechArticle",
"headline": "Манипуляции со столбцами | Документация ClickHouse",
"mainEntityOfPage": "https://clickhouse.com/docs/ru/sql-reference/statements/alter/column/",




"image": "https://clickhouse.com/images/clickhouse-209x60.png",
"author": {
  "@type": "Project",
  "name": "ClickHouse"
},
"publisher": {
  "@type": "Organization",
  "name": "ClickHouse, Inc.",
  "logo": {
    "@type": "ImageObject",
    "url": "https://clickhouse.com/images/logo-400x240.png",
    "width": 400,
    "height": 240
  }
}}, {
"@context": "http://schema.org",
"@type": "Episode",
"name": "Манипуляции со столбцами | Документация ClickHouse",
"aggregateRating": {
  "@type": "AggregateRating",
  "ratingValue": RATING_VALUE,
  "ratingCount": RATING_COUNT
}
}]</script>

    
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <style amp-custom>:root{--blue:#007bff;--indigo:#6610f2;--purple:#6f42c1;--pink:#e83e8c;--red:#dc3545;--orange:#fd7e14;--yellow:#ffc107;--green:#28a745;--teal:#20c997;--cyan:#17a2b8;--gray:#6c757d;--gray-dark:#343a40;--brand-primary:#fc0;--brand-secondary:#ff3939;--primary-accent-yellow:#fc0;--primary-accent-light-yellow:#fffaf0;--primary-accent-blue:#257af4;--primary-accent-light-blue:#e3f1fe;--secondary-accent-orange:#ff8c00;--secondary-accent-light-orange:#ffe4b5;--secondary-accent-red:#ff3939;--secondary-accent-light-red:#ffe4e1;--primary:#fc0;--secondary:#212529;--success:#28a745;--info:#17a2b8;--warning:#ffc107;--danger:#dc3545;--light:#f1f6f9;--dark:#495057;--primary-light:#fffaf0;--secondary-light:#fff;--tertiary:#257af4;--tertiary-light:#e3f1fe;--white:#fff;--black:#212529;--blue:#257af4;--light-blue:#e3f1fe;--yellow:#fc0;--light-yellow:#fffaf0;--orange:#ff8c00;--light-orange:#ffe4b5;--red:#ff3939;--light-red:#ffe4e1;--medium:#d6dbdf;--breakpoint-xxs:0;--breakpoint-xs:400px;--breakpoint-sm:616px;--breakpoint-md:768px;--breakpoint-lg:980px;--breakpoint-xl:1240px;--font-family-sans-serif:"Noto Sans",sans-serif;--font-family-monospace:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}*,:after,:before{box-sizing:border-box}html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:rgba(33,37,41,0)}article,footer{display:block}body{margin:0;font-family:Noto Sans,sans-serif;font-size:1rem;font-weight:400;line-height:1.5;color:#212529;text-align:left;background-color:#fff}[tabindex="-1"]:focus:not(:focus-visible){outline:0}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:16px}p{margin-top:0;margin-bottom:1rem}ul{margin-bottom:1rem}ul{margin-top:0}ul ul{margin-bottom:0}b,strong{font-weight:bolder}a{text-decoration:none;background-color:transparent}a,a:hover{color:#ff8c00}a:hover{text-decoration:underline}a:not([href]),a:not([href]):hover{color:inherit;text-decoration:none}code,pre{font-family:SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em}pre{margin-top:0;margin-bottom:1rem;overflow:auto}img{border-style:none}img,svg{vertical-align:middle}svg{overflow:hidden}table{border-collapse:collapse}select{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}select{text-transform:none}select{word-wrap:normal}[type=button],[type=reset],[type=submit]{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled){cursor:pointer}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{padding:0;border-style:none}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:none}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}[hidden]{display:none}.h1,.h2,.h3,.h4,.h5,.h6,h1,h2,h3,h4,h5,h6{margin-bottom:16px;font-family:Hind Siliguri,sans-serif;font-weight:500;line-height:1.125}.h1,h1{font-size:2.5rem}@media(max-width:1200px){.h1,h1{font-size:calc(1.375rem+1.5vw)}}.h2,h2{font-size:2rem}@media(max-width:1200px){.h2,h2{font-size:calc(1.325rem+.9vw)}}.h3,h3{font-size:1.75rem}@media(max-width:1200px){.h3,h3{font-size:calc(1.3rem+.6vw)}}.h4,h4{font-size:1.5rem}@media(max-width:1200px){.h4,h4{font-size:calc(1.275rem+.3vw)}}.h5,h5{font-size:1.125rem}.h6,h6{font-size:.875rem}.display-1{font-size:4rem;font-weight:600;line-height:1.125}@media(max-width:1200px){.display-1{font-size:calc(1.525rem+3.3vw)}}.display-2{font-size:2.5rem;font-weight:600;line-height:1.125}@media(max-width:1200px){.display-2{font-size:calc(1.375rem+1.5vw)}}.display-3{font-size:2rem;font-weight:500;line-height:1.125}@media(max-width:1200px){.display-3{font-size:calc(1.325rem+.9vw)}}.display-4{font-size:1.75rem;font-weight:500;line-height:1.125}@media(max-width:1200px){.display-4{font-size:calc(1.3rem+.6vw)}}.img-fluid{max-width:100%;height:auto}code{font-size:87.5%;color:#e83e8c;word-wrap:break-word}a>code{color:inherit}pre{display:block;font-size:87.5%;color:#495057}pre code{font-size:inherit;color:inherit;word-break:normal}.container{width:100%;padding-right:20px;padding-left:20px;margin-right:auto;margin-left:auto}@media(min-width:400px){.container{max-width:576px}}@media(min-width:616px){.container{max-width:576px}}@media(min-width:768px){.container{max-width:958px}}@media(min-width:980px){.container{max-width:1008px}}@media(min-width:1240px){.container{max-width:1118px}}.container-fluid,.container-lg,.container-md{width:100%;padding-right:20px;padding-left:20px;margin-right:auto;margin-left:auto}@media(min-width:400px){.container{max-width:576px}}@media(min-width:616px){.container{max-width:576px}}@media(min-width:768px){.container,.container-md{max-width:958px}}@media(min-width:980px){.container,.container-lg,.container-md{max-width:1008px}}@media(min-width:1240px){.container,.container-lg,.container-md{max-width:1118px}}.row{display:flex;flex-wrap:wrap;margin-right:-20px;margin-left:-20px}.col,.col-1,.col-10,.col-11,.col-12,.col-2,.col-3,.col-4,.col-5,.col-6,.col-7,.col-8,.col-9,.col-lg,.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-md,.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9{position:relative;width:100%;padding-right:20px;padding-left:20px}.col{flex-basis:0;flex-grow:1;max-width:100%}.col-1{flex:0 0 8.3333333333%;max-width:8.3333333333%}.col-2{flex:0 0 16.6666666667%;max-width:16.6666666667%}.col-3{flex:0 0 25%;max-width:25%}.col-4{flex:0 0 33.3333333333%;max-width:33.3333333333%}.col-5{flex:0 0 41.6666666667%;max-width:41.6666666667%}.col-6{flex:0 0 50%;max-width:50%}.col-7{flex:0 0 58.3333333333%;max-width:58.3333333333%}.col-8{flex:0 0 66.6666666667%;max-width:66.6666666667%}.col-9{flex:0 0 75%;max-width:75%}.col-10{flex:0 0 83.3333333333%;max-width:83.3333333333%}.col-11{flex:0 0 91.6666666667%;max-width:91.6666666667%}.col-12{flex:0 0 100%;max-width:100%}.order-first{order:-1}.order-0{order:0}.order-1{order:1}.order-2{order:2}.order-3{order:3}.order-4{order:4}.order-5{order:5}.order-6{order:6}.order-7{order:7}.order-8{order:8}.order-9{order:9}.order-10{order:10}.order-11{order:11}.order-12{order:12}@media(min-width:768px){.col-md{flex-basis:0;flex-grow:1;max-width:100%}.col-md-1{flex:0 0 8.3333333333%;max-width:8.3333333333%}.col-md-2{flex:0 0 16.6666666667%;max-width:16.6666666667%}.col-md-3{flex:0 0 25%;max-width:25%}.col-md-4{flex:0 0 33.3333333333%;max-width:33.3333333333%}.col-md-5{flex:0 0 41.6666666667%;max-width:41.6666666667%}.col-md-6{flex:0 0 50%;max-width:50%}.col-md-7{flex:0 0 58.3333333333%;max-width:58.3333333333%}.col-md-8{flex:0 0 66.6666666667%;max-width:66.6666666667%}.col-md-9{flex:0 0 75%;max-width:75%}.col-md-10{flex:0 0 83.3333333333%;max-width:83.3333333333%}.col-md-11{flex:0 0 91.6666666667%;max-width:91.6666666667%}.col-md-12{flex:0 0 100%;max-width:100%}.order-md-first{order:-1}.order-md-0{order:0}.order-md-1{order:1}.order-md-2{order:2}.order-md-3{order:3}.order-md-4{order:4}.order-md-5{order:5}.order-md-6{order:6}.order-md-7{order:7}.order-md-8{order:8}.order-md-9{order:9}.order-md-10{order:10}.order-md-11{order:11}.order-md-12{order:12}}@media(min-width:980px){.col-lg{flex-basis:0;flex-grow:1;max-width:100%}.col-lg-1{flex:0 0 8.3333333333%;max-width:8.3333333333%}.col-lg-2{flex:0 0 16.6666666667%;max-width:16.6666666667%}.col-lg-3{flex:0 0 25%;max-width:25%}.col-lg-4{flex:0 0 33.3333333333%;max-width:33.3333333333%}.col-lg-5{flex:0 0 41.6666666667%;max-width:41.6666666667%}.col-lg-6{flex:0 0 50%;max-width:50%}.col-lg-7{flex:0 0 58.3333333333%;max-width:58.3333333333%}.col-lg-8{flex:0 0 66.6666666667%;max-width:66.6666666667%}.col-lg-9{flex:0 0 75%;max-width:75%}.col-lg-10{flex:0 0 83.3333333333%;max-width:83.3333333333%}.col-lg-11{flex:0 0 91.6666666667%;max-width:91.6666666667%}.col-lg-12{flex:0 0 100%;max-width:100%}.order-lg-first{order:-1}.order-lg-0{order:0}.order-lg-1{order:1}.order-lg-2{order:2}.order-lg-3{order:3}.order-lg-4{order:4}.order-lg-5{order:5}.order-lg-6{order:6}.order-lg-7{order:7}.order-lg-8{order:8}.order-lg-9{order:9}.order-lg-10{order:10}.order-lg-11{order:11}.order-lg-12{order:12}}.table{width:100%;margin-bottom:8px;color:#212529}.table-primary{background-color:#fff1b8}.table-warning{background-color:#ffeeba}.table-light{background-color:#fbfcfd}.table-dark{background-color:#ccced0}.table-primary-light{background-color:#fffefb}.table-white{background-color:#fff}.table-black{background-color:#c1c2c3}.table-orange{background-color:#ffdfb8}.table-light-orange{background-color:#fff7ea}.table-dark{color:#fff;background-color:#343a40}.btn{display:inline-block;font-family:inherit;font-weight:700;color:#212529;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;padding:12px 32px;font-size:.875rem;line-height:20px;border-radius:8px;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media(prefers-reduced-motion:reduce){.btn{transition:none}}.btn:hover{color:#212529;text-decoration:none}.btn:focus{outline:0;box-shadow:none}.btn:disabled{opacity:.65}.btn-primary{color:#495057;background-color:#fc0;border-color:#fc0}.btn-primary:focus,.btn-primary:hover{color:#495057;background-color:#d9ad00;border-color:#cca300}.btn-primary:focus{box-shadow:0 0 0 0 rgba(228,185,13,.5)}.btn-primary:disabled{color:#495057;background-color:#fc0;border-color:#fc0}.btn-warning{color:#495057;background-color:#ffc107;border-color:#ffc107}.btn-warning:focus,.btn-warning:hover{color:#495057;background-color:#e0a800;border-color:#d39e00}.btn-warning:focus{box-shadow:0 0 0 0 rgba(228,176,19,.5)}.btn-warning:disabled{color:#495057;background-color:#ffc107;border-color:#ffc107}.btn-light{color:#495057;background-color:#f1f6f9;border-color:#f1f6f9}.btn-light:focus,.btn-light:hover{color:#495057;background-color:#d6e5ee;border-color:#cddfea}.btn-light:focus{box-shadow:0 0 0 0 rgba(216,221,225,.5)}.btn-light:disabled{color:#495057;background-color:#f1f6f9;border-color:#f1f6f9}.btn-dark{color:#fff;background-color:#495057;border-color:#495057}.btn-dark:focus,.btn-dark:hover{color:#fff;background-color:#383d42;border-color:#32373b}.btn-dark:focus{box-shadow:0 0 0 0 rgba(100,106,112,.5)}.btn-dark:disabled{color:#fff;background-color:#495057;border-color:#495057}.btn-primary-light{color:#495057;background-color:#fffaf0;border-color:#fffaf0}.btn-primary-light:focus,.btn-primary-light:hover{color:#495057;background-color:#ffedca;border-color:#ffe9bd}.btn-primary-light:focus{box-shadow:0 0 0 0 rgba(228,225,217,.5)}.btn-primary-light:disabled{color:#495057;background-color:#fffaf0;border-color:#fffaf0}.btn-white{color:#495057;background-color:#fff;border-color:#fff}.btn-white:focus,.btn-white:hover{color:#495057;background-color:#ececec;border-color:#e6e6e6}.btn-white:focus{box-shadow:0 0 0 0 rgba(228,229,230,.5)}.btn-white:disabled{color:#495057;background-color:#fff;border-color:#fff}.btn-black{color:#fff;background-color:#212529;border-color:#212529}.btn-black:focus,.btn-black:hover{color:#fff;background-color:#101214;border-color:#0a0c0d}.btn-black:focus{box-shadow:0 0 0 0 rgba(66,70,73,.5)}.btn-black:disabled{color:#fff;background-color:#212529;border-color:#212529}.btn-orange{color:#495057;background-color:#ff8c00;border-color:#ff8c00}.btn-orange:focus,.btn-orange:hover{color:#fff;background-color:#d97700;border-color:#cc7000}.btn-orange:focus{box-shadow:0 0 0 0 rgba(228,131,13,.5)}.btn-orange:disabled{color:#495057;background-color:#ff8c00;border-color:#ff8c00}.btn-light-orange{color:#495057;background-color:#ffe4b5;border-color:#ffe4b5}.btn-light-orange:focus,.btn-light-orange:hover{color:#495057;background-color:#ffd68f;border-color:#ffd182}.btn-light-orange:focus{box-shadow:0 0 0 0 rgba(228,206,167,.5)}.btn-light-orange:disabled{color:#495057;background-color:#ffe4b5;border-color:#ffe4b5}.btn-outline-primary{color:#fc0;border-color:#fc0}.btn-outline-primary:hover{color:#495057;background-color:#fc0;border-color:#fc0}.btn-outline-primary:focus{box-shadow:0 0 0 0 rgba(255,204,0,.5)}.btn-outline-primary:disabled{color:#fc0;background-color:transparent}.btn-outline-warning{color:#ffc107;border-color:#ffc107}.btn-outline-warning:hover{color:#495057;background-color:#ffc107;border-color:#ffc107}.btn-outline-warning:focus{box-shadow:0 0 0 0 rgba(255,193,7,.5)}.btn-outline-warning:disabled{color:#ffc107;background-color:transparent}.btn-outline-light{color:#f1f6f9;border-color:#f1f6f9}.btn-outline-light:hover{color:#495057;background-color:#f1f6f9;border-color:#f1f6f9}.btn-outline-light:focus{box-shadow:0 0 0 0 rgba(241,246,249,.5)}.btn-outline-light:disabled{color:#f1f6f9;background-color:transparent}.btn-outline-dark{color:#495057;border-color:#495057}.btn-outline-dark:hover{color:#fff;background-color:#495057;border-color:#495057}.btn-outline-dark:focus{box-shadow:0 0 0 0 rgba(73,80,87,.5)}.btn-outline-dark:disabled{color:#495057;background-color:transparent}.btn-outline-primary-light{color:#fffaf0;border-color:#fffaf0}.btn-outline-primary-light:hover{color:#495057;background-color:#fffaf0;border-color:#fffaf0}.btn-outline-primary-light:focus{box-shadow:0 0 0 0 rgba(255,250,240,.5)}.btn-outline-primary-light:disabled{color:#fffaf0;background-color:transparent}.btn-outline-white{color:#fff;border-color:#fff}.btn-outline-white:hover{color:#495057;background-color:#fff;border-color:#fff}.btn-outline-white:focus{box-shadow:0 0 0 0 hsla(0,0%,100%,.5)}.btn-outline-white:disabled{color:#fff;background-color:transparent}.btn-outline-black{color:#212529;border-color:#212529}.btn-outline-black:hover{color:#fff;background-color:#212529;border-color:#212529}.btn-outline-black:focus{box-shadow:0 0 0 0 rgba(33,37,41,.5)}.btn-outline-black:disabled{color:#212529;background-color:transparent}.btn-outline-orange{color:#ff8c00;border-color:#ff8c00}.btn-outline-orange:hover{color:#495057;background-color:#ff8c00;border-color:#ff8c00}.btn-outline-orange:focus{box-shadow:0 0 0 0 rgba(255,140,0,.5)}.btn-outline-orange:disabled{color:#ff8c00;background-color:transparent}.btn-outline-light-orange{color:#ffe4b5;border-color:#ffe4b5}.btn-outline-light-orange:hover{color:#495057;background-color:#ffe4b5;border-color:#ffe4b5}.btn-outline-light-orange:focus{box-shadow:0 0 0 0 rgba(255,228,181,.5)}.btn-outline-light-orange:disabled{color:#ffe4b5;background-color:transparent}.btn-link{font-weight:400;color:#ff8c00;text-decoration:none}.btn-link:hover{color:#ff8c00;text-decoration:underline}.btn-link:focus{text-decoration:underline;box-shadow:none}.btn-link:disabled{color:#d6dbdf;pointer-events:none}.btn-lg{padding:16px 32px;font-size:1.125rem;line-height:26px;border-radius:8px}.btn-block{display:block;width:100%}.btn-block+.btn-block{margin-top:24px}.custom-select{display:inline-block;width:100%;height:calc(1.5em+.75rem+2px);padding:.375rem 1.75rem .375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#6c757d;vertical-align:middle;background:#fff url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='4' height='5'%3E%3Cpath fill='%23343a40' d='M2 0L0 2h4zm0 5L0 3h4z'/%3E%3C/svg%3E") no-repeat right .75rem center/8px 10px;border:1px solid #ced4da;border-radius:8px;-webkit-appearance:none;-moz-appearance:none;appearance:none}.custom-select:focus{border-color:#ffe680;outline:0;box-shadow:0 0 0 .2rem rgba(255,204,0,.25)}.custom-select:focus::-ms-value{color:#6c757d;background-color:#fff}.custom-select[multiple],.custom-select[size]:not([size="1"]){height:auto;padding-right:.75rem;background-image:none}.custom-select:disabled{color:#6c757d;background-color:#e9ecef}.custom-select::-ms-expand{display:none}.custom-select:-moz-focusring{color:transparent;text-shadow:0 0 0 #6c757d}.custom-select-lg{height:calc(1.5em+1rem+2px);padding-top:.5rem;padding-bottom:.5rem;padding-left:1rem;font-size:1.125rem}.custom-select{transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media(prefers-reduced-motion:reduce){.custom-select{transition:none}}pre{white-space:pre-wrap}pre{border:1px solid #d6dbdf;page-break-inside:avoid}img{page-break-inside:avoid}h2,h3,p{orphans:3;widows:3}h2,h3{page-break-after:avoid}@page{size:a3}.container,body{min-width:980px}.table{border-collapse:collapse}.table-dark{color:inherit}</style>
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    <script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>
  </head>
  <body class="amp" dir="ltr">
    <div class="container-fluid container-lg pb-5">
      <div class="row pt-3 mb-3">
        <div class="col">
          <a href="/" class="text-decoration-none">
            <amp-img class="d-inline-block mr-3" layout="fixed" width="40" height="36" src="/images/logo.svg" alt="ClickHouse logo" title="ClickHouse logo"></amp-img><amp-img class="invert-dark d-inline-block" layout="fixed" width="238" height="36" src="/images/clickhouse-black.svg" alt="ClickHouse" title="ClickHouse"></amp-img>
          </a>
        </div>
      </div>
      <div class="row">
        <div id="content" class="col">
          
          <h1 id=manipuliatsii-so-stolbtsami>Манипуляции со столбцами<a class=headerlink href=../amp/#manipuliatsii-so-stolbtsami title="Permanent link"> </a></h1> <p>Набор действий, позволяющих изменять структуру таблицы.</p> <p>Синтаксис:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=p>[</span><span class=n>db</span><span class=p>].</span><span class=n>name</span><span class=w> </span><span class=p>[</span><span class=k>ON</span><span class=w> </span><span class=k>CLUSTER</span><span class=w> </span><span class=k>cluster</span><span class=p>]</span><span class=w> </span><span class=k>ADD</span><span class=o>|</span><span class=k>DROP</span><span class=o>|</span><span class=k>RENAME</span><span class=o>|</span><span class=n>CLEAR</span><span class=o>|</span><span class=k>COMMENT</span><span class=o>|</span><span class=err>{</span><span class=k>MODIFY</span><span class=o>|</span><span class=k>ALTER</span><span class=err>}</span><span class=o>|</span><span class=n>MATERIALIZE</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=p>...</span><span class=w></span>
</code></pre></div> <p>В запросе можно указать сразу несколько действий над одной таблицей через запятую.<br> Каждое действие — это манипуляция над столбцом.</p> <p>Существуют следующие действия:</p> <ul> <li><a href=../amp/#alter_add-column>ADD COLUMN</a> — добавляет столбец в таблицу;</li> <li><a href=../amp/#alter_drop-column>DROP COLUMN</a> — удаляет столбец;</li> <li><a href=../amp/#alter_rename-column>RENAME COLUMN</a> — переименовывает существующий столбец;</li> <li><a href=../amp/#alter_clear-column>CLEAR COLUMN</a> — сбрасывает все значения в столбце для заданной партиции;</li> <li><a href=../amp/#alter_comment-column>COMMENT COLUMN</a> — добавляет комментарий к столбцу;</li> <li><a href=../amp/#alter_modify-column>MODIFY COLUMN</a> — изменяет тип столбца, выражение для значения по умолчанию и TTL;</li> <li><a href=../amp/#modify-remove>MODIFY COLUMN REMOVE</a> — удаляет какое-либо из свойств столбца;</li> <li><a href=../amp/#materialize-column>MATERIALIZE COLUMN</a> — делает столбец материализованным (<code class=syntax>MATERIALIZED</code>) в кусках, в которых отсутствуют значения.</li> </ul> <p>Подробное описание для каждого действия приведено ниже.</p> <h2 id=alter_add-column>ADD COLUMN<a class=headerlink href=../amp/#alter_add-column title="Permanent link"> </a></h2> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ADD</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=p>[</span><span class=k>type</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>default_expr</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>codec</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=k>AFTER</span><span class=w> </span><span class=n>name_after</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>FIRST</span><span class=p>]</span><span class=w></span>
</code></pre></div> <p>Добавляет в таблицу новый столбец с именем <code class=syntax>name</code>, типом <code class=syntax>type</code>, <a href=../../../create/table/amp/#codecs>кодеком</a> <code class=syntax>codec</code> и выражением для умолчания <code class=syntax>default_expr</code> (смотрите раздел <a href=../../../create/amp/#create-default-values>Значения по умолчанию</a>).</p> <p>Если указано <code class=syntax>IF NOT EXISTS</code>, запрос не будет возвращать ошибку, если столбец уже существует. Если указано <code class=syntax>AFTER name_after</code> (имя другого столбца), то столбец добавляется (в список столбцов таблицы) после указанного. Если вы хотите добавить столбец в начало таблицы, используйте <code class=syntax>FIRST</code>. Иначе столбец добавляется в конец таблицы. Для цепочки действий <code class=syntax>name_after</code> может быть именем столбца, который добавляется в одном из предыдущих действий.</p> <p>Добавление столбца всего лишь меняет структуру таблицы, и не производит никаких действий с данными - соответствующие данные не появляются на диске после ALTER-а. При чтении из таблицы, если для какого-либо столбца отсутствуют данные, то он заполняется значениями по умолчанию (выполняя выражение по умолчанию, если такое есть, или нулями, пустыми строками). Также, столбец появляется на диске при слиянии кусков данных (см. <a href=../../amp/ >MergeTree</a>).</p> <p>Такая схема позволяет добиться мгновенной работы запроса <code class=syntax>ALTER</code> и отсутствия необходимости увеличивать объём старых данных.</p> <p>Пример:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>alter_test</span><span class=w> </span><span class=k>ADD</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=n>Added1</span><span class=w> </span><span class=n>UInt32</span><span class=w> </span><span class=k>FIRST</span><span class=p>;</span><span class=w></span>
<span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>alter_test</span><span class=w> </span><span class=k>ADD</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=n>Added2</span><span class=w> </span><span class=n>UInt32</span><span class=w> </span><span class=k>AFTER</span><span class=w> </span><span class=n>NestedColumn</span><span class=p>;</span><span class=w></span>
<span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>alter_test</span><span class=w> </span><span class=k>ADD</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=n>Added3</span><span class=w> </span><span class=n>UInt32</span><span class=w> </span><span class=k>AFTER</span><span class=w> </span><span class=n>ToDrop</span><span class=p>;</span><span class=w></span>
<span class=k>DESC</span><span class=w> </span><span class=n>alter_test</span><span class=w> </span><span class=n>FORMAT</span><span class=w> </span><span class=n>TSV</span><span class=p>;</span><span class=w></span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>Added1  UInt32
CounterID       UInt32
StartDate       Date
UserID  UInt32
VisitID UInt32
NestedColumn.A  Array(UInt8)
NestedColumn.S  Array(String)
Added2  UInt32
ToDrop  UInt32
Added3  UInt32
</code></pre></div> <h2 id=alter_drop-column>DROP COLUMN<a class=headerlink href=../amp/#alter_drop-column title="Permanent link"> </a></h2> <div class=codehilite><pre><span></span><code class=syntax><span class=k>DROP</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=n>name</span><span class=w></span>
</code></pre></div> <p>Удаляет столбец с именем <code class=syntax>name</code>. Если указано <code class=syntax>IF EXISTS</code>, запрос не будет возвращать ошибку, если столбца не существует.</p> <p>Запрос удаляет данные из файловой системы. Так как это представляет собой удаление целых файлов, запрос выполняется почти мгновенно.</p> <div class="admonition warning alert pb-0 mb-4 alert-warning" role=alert> <p class="admonition-title alert-heading display-4 text-reset mb-2">Предупреждение</p> <p>Вы не можете удалить столбец, используемый в <a class=alert-link href=../../../create/view/amp/#materialized>материализованном представлениии</a>. В противном случае будет ошибка.</p> </div> <p>Пример:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>visits</span><span class=w> </span><span class=k>DROP</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=n>browser</span><span class=w></span>
</code></pre></div> <h2 id=alter_rename-column>RENAME COLUMN<a class=headerlink href=../amp/#alter_rename-column title="Permanent link"> </a></h2> <div class=codehilite><pre><span></span><code class=syntax><span class=k>RENAME</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>new_name</span><span class=w></span>
</code></pre></div> <p>Переименовывает столбец <code class=syntax>name</code> в <code class=syntax>new_name</code>. Если указано выражение <code class=syntax>IF EXISTS</code>, то запрос не будет возвращать ошибку при условии, что столбец <code class=syntax>name</code> не существует. Поскольку переименование не затрагивает физические данные колонки, запрос выполняется практически мгновенно.</p> <p><strong>ЗАМЕЧЕНИЕ</strong>: Столбцы, являющиеся частью основного ключа или ключа сортировки (заданные с помощью <code class=syntax>ORDER BY</code> или <code class=syntax>PRIMARY KEY</code>), не могут быть переименованы. Попытка переименовать эти слобцы приведет к <code class=syntax>SQL Error [524]</code>. </p> <p>Пример:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>visits</span><span class=w> </span><span class=k>RENAME</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=n>webBrowser</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=n>browser</span><span class=w></span>
</code></pre></div> <h2 id=alter_clear-column>CLEAR COLUMN<a class=headerlink href=../amp/#alter_clear-column title="Permanent link"> </a></h2> <div class=codehilite><pre><span></span><code class=syntax><span class=n>CLEAR</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=n>partition_name</span><span class=w></span>
</code></pre></div> <p>Сбрасывает все значения в столбце для заданной партиции. Если указано <code class=syntax>IF EXISTS</code>, запрос не будет возвращать ошибку, если столбца не существует.</p> <p>Как корректно задать имя партиции, см. в разделе <a href=../amp/#alter-how-to-specify-part-expr>Как задавать имя партиции в запросах ALTER</a>.</p> <p>Пример:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>visits</span><span class=w> </span><span class=n>CLEAR</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=n>browser</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=n>tuple</span><span class=p>()</span><span class=w></span>
</code></pre></div> <h2 id=alter_comment-column>COMMENT COLUMN<a class=headerlink href=../amp/#alter_comment-column title="Permanent link"> </a></h2> <div class=codehilite><pre><span></span><code class=syntax><span class=k>COMMENT</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=s1>'Text comment'</span><span class=w></span>
</code></pre></div> <p>Добавляет комментарий к таблице. Если указано <code class=syntax>IF EXISTS</code>, запрос не будет возвращать ошибку, если столбца не существует.</p> <p>Каждый столбец может содержать только один комментарий. При выполнении запроса существующий комментарий заменяется на новый.</p> <p>Посмотреть комментарии можно в столбце <code class=syntax>comment_expression</code> из запроса <a href=../../../misc/amp/#misc-describe-table>DESCRIBE TABLE</a>.</p> <p>Пример:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>visits</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=n>browser</span><span class=w> </span><span class=s1>'Столбец показывает, из каких браузеров пользователи заходили на сайт.'</span><span class=w></span>
</code></pre></div> <h2 id=alter_modify-column>MODIFY COLUMN<a class=headerlink href=../amp/#alter_modify-column title="Permanent link"> </a></h2> <div class=codehilite><pre><span></span><code class=syntax><span class=k>MODIFY</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=p>[</span><span class=k>type</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>default_expr</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>codec</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>TTL</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=k>AFTER</span><span class=w> </span><span class=n>name_after</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>FIRST</span><span class=p>]</span><span class=w></span>
<span class=k>ALTER</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>TYPE</span><span class=w> </span><span class=p>[</span><span class=k>type</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>default_expr</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>codec</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>TTL</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=k>AFTER</span><span class=w> </span><span class=n>name_after</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>FIRST</span><span class=p>]</span><span class=w></span>
</code></pre></div> <p>Запрос изменяет следующие свойства столбца <code class=syntax>name</code>:</p> <ul> <li> <p>Тип</p> </li> <li> <p>Значение по умолчанию</p> </li> <li> <p>Кодеки сжатия</p> </li> <li> <p>TTL</p> </li> </ul> <p>Примеры изменения кодеков сжатия смотрите в разделе <a href=../../../create/table/amp/#codecs>Кодеки сжатия столбцов</a>.</p> <p>Примеры изменения TTL столбца смотрите в разделе <a href=../../../../../engines/table-engines/mergetree-family/mergetree/amp/#mergetree-column-ttl>TTL столбца</a>.</p> <p>Если указано <code class=syntax>IF EXISTS</code>, запрос не возвращает ошибку при условии, что столбец не существует.</p> <p>Запрос также может изменять порядок столбцов при помощи <code class=syntax>FIRST | AFTER</code>, смотрите описание <a href=../amp/#alter_add-column>ADD COLUMN</a>.</p> <p>При изменении типа, значения преобразуются так, как если бы к ним была применена функция <a href=../../amp/ >toType</a>. Если изменяется только выражение для умолчания, запрос не делает никакой сложной работы и выполняется мгновенно.</p> <p>Пример запроса:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>visits</span><span class=w> </span><span class=k>MODIFY</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=n>browser</span><span class=w> </span><span class=nb>Array</span><span class=p>(</span><span class=n>String</span><span class=p>)</span><span class=w></span>
</code></pre></div> <p>Изменение типа столбца - это единственное действие, которое выполняет сложную работу - меняет содержимое файлов с данными. Для больших таблиц, выполнение может занять длительное время.</p> <p>Выполнение запроса ALTER атомарно.</p> <p>Запрос <code class=syntax>ALTER</code> на изменение столбцов реплицируется. Соответствующие инструкции сохраняются в ZooKeeper, и затем каждая реплика их применяет. Все запросы <code class=syntax>ALTER</code> выполняются в одном и том же порядке. Запрос ждёт выполнения соответствующих действий на всех репликах. Но при этом, запрос на изменение столбцов в реплицируемой таблице можно прервать, и все действия будут осуществлены асинхронно.</p> <h2 id=modify-remove>MODIFY COLUMN REMOVE<a class=headerlink href=../amp/#modify-remove title="Permanent link"> </a></h2> <p>Удаляет какое-либо из свойств столбца: <code class=syntax>DEFAULT</code>, <code class=syntax>ALIAS</code>, <code class=syntax>MATERIALIZED</code>, <code class=syntax>CODEC</code>, <code class=syntax>COMMENT</code>, <code class=syntax>TTL</code>.</p> <p>Синтаксис:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=k>MODIFY</span><span class=w> </span><span class=k>column_name</span><span class=w> </span><span class=n>REMOVE</span><span class=w> </span><span class=n>property</span><span class=p>;</span><span class=w></span>
</code></pre></div> <p><strong>Пример</strong></p> <p>Удаление свойства TTL:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>table_with_ttl</span><span class=w> </span><span class=k>MODIFY</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=n>column_ttl</span><span class=w> </span><span class=n>REMOVE</span><span class=w> </span><span class=n>TTL</span><span class=p>;</span><span class=w></span>
</code></pre></div> <p><strong>Смотрите также</strong></p> <ul> <li><a href=../../ttl/amp/ >REMOVE TTL</a>.</li> </ul> <h2 id=materialize-column>MATERIALIZE COLUMN<a class=headerlink href=../amp/#materialize-column title="Permanent link"> </a></h2> <p>Материализует столбец таблицы в кусках, в которых отсутствуют значения. Используется, если необходимо создать новый столбец со сложным материализованным выражением или выражением для заполнения по умолчанию (<code class=syntax>DEFAULT</code>), потому как вычисление такого столбца прямо во время выполнения запроса <code class=syntax>SELECT</code> оказывается ощутимо затратным. Чтобы совершить ту же операцию для существующего столбца, используйте модификатор <code class=syntax>FINAL</code>.</p> <p>Синтаксис:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=n>MATERIALIZE</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=n>col</span><span class=w> </span><span class=p>[</span><span class=k>FINAL</span><span class=p>];</span><span class=w></span>
</code></pre></div> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>DROP</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=w> </span><span class=n>tmp</span><span class=p>;</span><span class=w></span>
<span class=k>SET</span><span class=w> </span><span class=n>mutations_sync</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2</span><span class=p>;</span><span class=w></span>
<span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>tmp</span><span class=w> </span><span class=p>(</span><span class=n>x</span><span class=w> </span><span class=n>Int64</span><span class=p>)</span><span class=w> </span><span class=n>ENGINE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>MergeTree</span><span class=p>()</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>tuple</span><span class=p>()</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>tuple</span><span class=p>();</span><span class=w></span>
<span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>tmp</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>system</span><span class=p>.</span><span class=n>numbers</span><span class=w> </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>10</span><span class=p>;</span><span class=w></span>
<span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>tmp</span><span class=w> </span><span class=k>ADD</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>MATERIALIZED</span><span class=w> </span><span class=n>toString</span><span class=p>(</span><span class=n>x</span><span class=p>);</span><span class=w></span>

<span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>tmp</span><span class=w> </span><span class=n>MATERIALIZE</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=n>s</span><span class=p>;</span><span class=w></span>

<span class=k>SELECT</span><span class=w> </span><span class=n>groupArray</span><span class=p>(</span><span class=n>x</span><span class=p>),</span><span class=w> </span><span class=n>groupArray</span><span class=p>(</span><span class=n>s</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>tmp</span><span class=p>;</span><span class=w></span>
</code></pre></div> <p><strong>Результат:</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=err>┌─</span><span class=n>groupArray</span><span class=p>(</span><span class=n>x</span><span class=p>)</span><span class=err>─────────┬─</span><span class=n>groupArray</span><span class=p>(</span><span class=n>s</span><span class=p>)</span><span class=err>─────────────────────────────┐</span><span class=w></span>
<span class=err>│</span><span class=w> </span><span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>5</span><span class=p>,</span><span class=mi>6</span><span class=p>,</span><span class=mi>7</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>9</span><span class=p>]</span><span class=w> </span><span class=err>│</span><span class=w> </span><span class=p>[</span><span class=s1>'0'</span><span class=p>,</span><span class=s1>'1'</span><span class=p>,</span><span class=s1>'2'</span><span class=p>,</span><span class=s1>'3'</span><span class=p>,</span><span class=s1>'4'</span><span class=p>,</span><span class=s1>'5'</span><span class=p>,</span><span class=s1>'6'</span><span class=p>,</span><span class=s1>'7'</span><span class=p>,</span><span class=s1>'8'</span><span class=p>,</span><span class=s1>'9'</span><span class=p>]</span><span class=w> </span><span class=err>│</span><span class=w></span>
<span class=err>└───────────────────────┴───────────────────────────────────────────┘</span><span class=w></span>
</code></pre></div> <h2 id=ogranicheniia-zaprosa-alter>Ограничения запроса ALTER<a class=headerlink href=../amp/#ogranicheniia-zaprosa-alter title="Permanent link"> </a></h2> <p>Запрос <code class=syntax>ALTER</code> позволяет создавать и удалять отдельные элементы (столбцы) вложенных структур данных, но не вложенные структуры данных целиком. Для добавления вложенной структуры данных, вы можете добавить столбцы с именем вида <code class=syntax>name.nested_name</code> и типом <code class=syntax>Array(T)</code> - вложенная структура данных полностью эквивалентна нескольким столбцам-массивам с именем, имеющим одинаковый префикс до точки.</p> <p>Отсутствует возможность удалять столбцы, входящие в первичный ключ или ключ для сэмплирования (в общем, входящие в выражение <code class=syntax>ENGINE</code>). Изменение типа у столбцов, входящих в первичный ключ возможно только в том случае, если это изменение не приводит к изменению данных (например, разрешено добавление значения в Enum или изменение типа с <code class=syntax>DateTime</code> на <code class=syntax>UInt32</code>).</p> <p>Если возможностей запроса <code class=syntax>ALTER</code> не хватает для нужного изменения таблицы, вы можете создать новую таблицу, скопировать туда данные с помощью запроса <a href=../../../insert-into/amp/#insert_query_insert-select>INSERT SELECT</a>, затем поменять таблицы местами с помощью запроса <a href=../../../misc/amp/#misc_operations-rename>RENAME</a>, и удалить старую таблицу. В качестве альтернативы для запроса <code class=syntax>INSERT SELECT</code>, можно использовать инструмент <a href=../../amp/ >clickhouse-copier</a>.</p> <p>Запрос <code class=syntax>ALTER</code> блокирует все чтения и записи для таблицы. То есть если на момент запроса <code class=syntax>ALTER</code> выполнялся долгий <code class=syntax>SELECT</code>, то запрос <code class=syntax>ALTER</code> сначала дождётся его выполнения. И в это время все новые запросы к той же таблице будут ждать, пока завершится этот <code class=syntax>ALTER</code>.</p> <p>Для таблиц, которые не хранят данные самостоятельно (типа <a href=../../amp/ >Merge</a> и <a href=../../amp/ >Distributed</a>), <code class=syntax>ALTER</code> всего лишь меняет структуру таблицы, но не меняет структуру подчинённых таблиц. Для примера, при ALTER-е таблицы типа <code class=syntax>Distributed</code>, вам также потребуется выполнить запрос <code class=syntax>ALTER</code> для таблиц на всех удалённых серверах.</p>
        </div>
      </div>
      <div class="row">
        <div class="col">
          
<div class="alert alert-light my-3">
  <p class="float-right mb-0">Rating: RATING_VALUE - RATING_COUNT votes</p>
  <span class="alert-heading display-6">Article Rating</span>
  <div id="rating-stars" class="display-6 mb-0"
     
  >RATING_STARS</div>
</div>

<div id="content-footer" class="text-muted pt-3 mb-5">
    <div class="float-md-right">©2016–2022 ClickHouse, Inc.</div>
    <div>Built from <a href="https://github.com/ClickHouse/ClickHouse/commit/c60fd44c5b70c56ff0f9c7fc538e58c6c8186aea" rel="external nofollow noreferrer" target="_blank" class="text-reset">c60fd44c</a>
    
    </div>
</div>

        </div>
      </div>
      <div id="to-full-website" class="row fixed-bottom text-center bg-white py-3">
        <div class="col">
          <a class="btn btn-lg btn-outline-orange" href="https://clickhouse.com/docs/ru/sql-reference/statements/alter/column/">To full website</a>
        </div>
      </div>
    </div>
    <amp-analytics type="metrika">
      <script type="application/json">{
"vars": {
  "counterId": "18343495",
  "triggers": {
    "notBounce": {
      "on": "timer",
      "timerSpec": {
        "immediate": false,
        "interval": 15,
        "maxTimerLength": 16
      },
      "request": "notBounce"
    }
  }
}
}</script>
  </amp-analytics>
  </body>
</html>
