










    



    



    



    
    






    <!doctype html>
<html ⚡ lang="ru">
  <head>
    <meta charset="utf-8">
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    <title>Конфигурационные параметры сервера | Документация ClickHouse</title>
    <link rel="canonical" href="https://clickhouse.com/docs/ru/operations/server-configuration-parameters/settings/" />
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    
<script type="application/ld+json">[{
"@context": "http://schema.org",
"@type": "TechArticle",
"headline": "Конфигурационные параметры сервера | Документация ClickHouse",
"mainEntityOfPage": "https://clickhouse.com/docs/ru/operations/server-configuration-parameters/settings/",




"image": "https://clickhouse.com/images/clickhouse-209x60.png",
"author": {
  "@type": "Project",
  "name": "ClickHouse"
},
"publisher": {
  "@type": "Organization",
  "name": "ClickHouse, Inc.",
  "logo": {
    "@type": "ImageObject",
    "url": "https://clickhouse.com/images/logo-400x240.png",
    "width": 400,
    "height": 240
  }
}}, {
"@context": "http://schema.org",
"@type": "Episode",
"name": "Конфигурационные параметры сервера | Документация ClickHouse",
"aggregateRating": {
  "@type": "AggregateRating",
  "ratingValue": RATING_VALUE,
  "ratingCount": RATING_COUNT
}
}]</script>

    
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <style amp-custom>:root{--blue:#007bff;--indigo:#6610f2;--purple:#6f42c1;--pink:#e83e8c;--red:#dc3545;--orange:#fd7e14;--yellow:#ffc107;--green:#28a745;--teal:#20c997;--cyan:#17a2b8;--gray:#6c757d;--gray-dark:#343a40;--brand-primary:#fc0;--brand-secondary:#ff3939;--primary-accent-yellow:#fc0;--primary-accent-light-yellow:#fffaf0;--primary-accent-blue:#257af4;--primary-accent-light-blue:#e3f1fe;--secondary-accent-orange:#ff8c00;--secondary-accent-light-orange:#ffe4b5;--secondary-accent-red:#ff3939;--secondary-accent-light-red:#ffe4e1;--primary:#fc0;--secondary:#212529;--success:#28a745;--info:#17a2b8;--warning:#ffc107;--danger:#dc3545;--light:#f1f6f9;--dark:#495057;--primary-light:#fffaf0;--secondary-light:#fff;--tertiary:#257af4;--tertiary-light:#e3f1fe;--white:#fff;--black:#212529;--blue:#257af4;--light-blue:#e3f1fe;--yellow:#fc0;--light-yellow:#fffaf0;--orange:#ff8c00;--light-orange:#ffe4b5;--red:#ff3939;--light-red:#ffe4e1;--medium:#d6dbdf;--breakpoint-xxs:0;--breakpoint-xs:400px;--breakpoint-sm:616px;--breakpoint-md:768px;--breakpoint-lg:980px;--breakpoint-xl:1240px;--font-family-sans-serif:"Noto Sans",sans-serif;--font-family-monospace:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}*,:after,:before{box-sizing:border-box}html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:rgba(33,37,41,0)}article,footer,header{display:block}body{margin:0;font-family:Noto Sans,sans-serif;font-size:1rem;font-weight:400;line-height:1.5;color:#212529;text-align:left;background-color:#fff}[tabindex="-1"]:focus:not(:focus-visible){outline:0}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:16px}p{margin-top:0;margin-bottom:1rem}address{font-style:normal;line-height:inherit}address,ul{margin-bottom:1rem}ul{margin-top:0}ul ul{margin-bottom:0}b,strong{font-weight:bolder}a{text-decoration:none;background-color:transparent}a,a:hover{color:#ff8c00}a:hover{text-decoration:underline}a:not([href]),a:not([href]):hover{color:inherit;text-decoration:none}code,pre{font-family:SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em}pre{margin-top:0;margin-bottom:1rem;overflow:auto}img{border-style:none}img,svg{vertical-align:middle}svg{overflow:hidden}table{border-collapse:collapse}input,select{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}input{overflow:visible}select{text-transform:none}select{word-wrap:normal}[type=button],[type=reset],[type=submit]{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled){cursor:pointer}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{padding:0;border-style:none}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=date],input[type=datetime-local],input[type=month],input[type=time]{-webkit-appearance:listbox}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:none}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}[hidden]{display:none}.h1,.h2,.h3,.h4,.h5,.h6,h1,h2,h3,h4,h5,h6{margin-bottom:16px;font-family:Hind Siliguri,sans-serif;font-weight:500;line-height:1.125}.h1,h1{font-size:2.5rem}@media(max-width:1200px){.h1,h1{font-size:calc(1.375rem+1.5vw)}}.h2,h2{font-size:2rem}@media(max-width:1200px){.h2,h2{font-size:calc(1.325rem+.9vw)}}.h3,h3{font-size:1.75rem}@media(max-width:1200px){.h3,h3{font-size:calc(1.3rem+.6vw)}}.h4,h4{font-size:1.5rem}@media(max-width:1200px){.h4,h4{font-size:calc(1.275rem+.3vw)}}.h5,h5{font-size:1.125rem}.h6,h6{font-size:.875rem}.display-1{font-size:4rem;font-weight:600;line-height:1.125}@media(max-width:1200px){.display-1{font-size:calc(1.525rem+3.3vw)}}.display-2{font-size:2.5rem;font-weight:600;line-height:1.125}@media(max-width:1200px){.display-2{font-size:calc(1.375rem+1.5vw)}}.display-3{font-size:2rem;font-weight:500;line-height:1.125}@media(max-width:1200px){.display-3{font-size:calc(1.325rem+.9vw)}}.display-4{font-size:1.75rem;font-weight:500;line-height:1.125}@media(max-width:1200px){.display-4{font-size:calc(1.3rem+.6vw)}}.mark,mark{padding:.2em;background-color:#fcf8e3}.img-fluid{max-width:100%;height:auto}code{font-size:87.5%;color:#e83e8c;word-wrap:break-word}a>code{color:inherit}pre{display:block;font-size:87.5%;color:#495057}pre code{font-size:inherit;color:inherit;word-break:normal}.container{width:100%;padding-right:20px;padding-left:20px;margin-right:auto;margin-left:auto}@media(min-width:400px){.container{max-width:576px}}@media(min-width:616px){.container{max-width:576px}}@media(min-width:768px){.container{max-width:958px}}@media(min-width:980px){.container{max-width:1008px}}@media(min-width:1240px){.container{max-width:1118px}}.container-fluid,.container-lg,.container-md{width:100%;padding-right:20px;padding-left:20px;margin-right:auto;margin-left:auto}@media(min-width:400px){.container{max-width:576px}}@media(min-width:616px){.container{max-width:576px}}@media(min-width:768px){.container,.container-md{max-width:958px}}@media(min-width:980px){.container,.container-lg,.container-md{max-width:1008px}}@media(min-width:1240px){.container,.container-lg,.container-md{max-width:1118px}}.row{display:flex;flex-wrap:wrap;margin-right:-20px;margin-left:-20px}.col,.col-1,.col-10,.col-11,.col-12,.col-2,.col-3,.col-4,.col-5,.col-6,.col-7,.col-8,.col-9,.col-lg,.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-md,.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9{position:relative;width:100%;padding-right:20px;padding-left:20px}.col{flex-basis:0;flex-grow:1;max-width:100%}.col-1{flex:0 0 8.3333333333%;max-width:8.3333333333%}.col-2{flex:0 0 16.6666666667%;max-width:16.6666666667%}.col-3{flex:0 0 25%;max-width:25%}.col-4{flex:0 0 33.3333333333%;max-width:33.3333333333%}.col-5{flex:0 0 41.6666666667%;max-width:41.6666666667%}.col-6{flex:0 0 50%;max-width:50%}.col-7{flex:0 0 58.3333333333%;max-width:58.3333333333%}.col-8{flex:0 0 66.6666666667%;max-width:66.6666666667%}.col-9{flex:0 0 75%;max-width:75%}.col-10{flex:0 0 83.3333333333%;max-width:83.3333333333%}.col-11{flex:0 0 91.6666666667%;max-width:91.6666666667%}.col-12{flex:0 0 100%;max-width:100%}.order-0{order:0}.order-1{order:1}.order-2{order:2}.order-3{order:3}.order-4{order:4}.order-5{order:5}.order-6{order:6}.order-7{order:7}.order-8{order:8}.order-9{order:9}.order-10{order:10}.order-11{order:11}.order-12{order:12}@media(min-width:768px){.col-md{flex-basis:0;flex-grow:1;max-width:100%}.col-md-1{flex:0 0 8.3333333333%;max-width:8.3333333333%}.col-md-2{flex:0 0 16.6666666667%;max-width:16.6666666667%}.col-md-3{flex:0 0 25%;max-width:25%}.col-md-4{flex:0 0 33.3333333333%;max-width:33.3333333333%}.col-md-5{flex:0 0 41.6666666667%;max-width:41.6666666667%}.col-md-6{flex:0 0 50%;max-width:50%}.col-md-7{flex:0 0 58.3333333333%;max-width:58.3333333333%}.col-md-8{flex:0 0 66.6666666667%;max-width:66.6666666667%}.col-md-9{flex:0 0 75%;max-width:75%}.col-md-10{flex:0 0 83.3333333333%;max-width:83.3333333333%}.col-md-11{flex:0 0 91.6666666667%;max-width:91.6666666667%}.col-md-12{flex:0 0 100%;max-width:100%}.order-md-0{order:0}.order-md-1{order:1}.order-md-2{order:2}.order-md-3{order:3}.order-md-4{order:4}.order-md-5{order:5}.order-md-6{order:6}.order-md-7{order:7}.order-md-8{order:8}.order-md-9{order:9}.order-md-10{order:10}.order-md-11{order:11}.order-md-12{order:12}}@media(min-width:980px){.col-lg{flex-basis:0;flex-grow:1;max-width:100%}.col-lg-1{flex:0 0 8.3333333333%;max-width:8.3333333333%}.col-lg-2{flex:0 0 16.6666666667%;max-width:16.6666666667%}.col-lg-3{flex:0 0 25%;max-width:25%}.col-lg-4{flex:0 0 33.3333333333%;max-width:33.3333333333%}.col-lg-5{flex:0 0 41.6666666667%;max-width:41.6666666667%}.col-lg-6{flex:0 0 50%;max-width:50%}.col-lg-7{flex:0 0 58.3333333333%;max-width:58.3333333333%}.col-lg-8{flex:0 0 66.6666666667%;max-width:66.6666666667%}.col-lg-9{flex:0 0 75%;max-width:75%}.col-lg-10{flex:0 0 83.3333333333%;max-width:83.3333333333%}.col-lg-11{flex:0 0 91.6666666667%;max-width:91.6666666667%}.col-lg-12{flex:0 0 100%;max-width:100%}.order-lg-0{order:0}.order-lg-1{order:1}.order-lg-2{order:2}.order-lg-3{order:3}.order-lg-4{order:4}.order-lg-5{order:5}.order-lg-6{order:6}.order-lg-7{order:7}.order-lg-8{order:8}.order-lg-9{order:9}.order-lg-10{order:10}.order-lg-11{order:11}.order-lg-12{order:12}}.table{width:100%;margin-bottom:8px;color:#212529}.table-primary{background-color:#fff1b8}.table-info{background-color:#bee5eb}.table-warning{background-color:#ffeeba}.table-light{background-color:#fbfcfd}.table-dark{background-color:#ccced0}.table-primary-light{background-color:#fffefb}.table-white{background-color:#fff}.table-black{background-color:#c1c2c3}.table-orange{background-color:#ffdfb8}.table-light-orange{background-color:#fff7ea}.table-dark{color:#fff;background-color:#343a40}.btn{display:inline-block;font-family:inherit;font-weight:700;color:#212529;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;padding:12px 32px;font-size:.875rem;line-height:20px;border-radius:8px;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media(prefers-reduced-motion:reduce){.btn{transition:none}}.btn:hover{color:#212529;text-decoration:none}.btn:focus{outline:0;box-shadow:none}.btn:disabled{opacity:.65}.btn-primary{color:#495057;background-color:#fc0;border-color:#fc0}.btn-primary:focus,.btn-primary:hover{color:#495057;background-color:#d9ad00;border-color:#cca300}.btn-primary:focus{box-shadow:0 0 0 0 rgba(228,185,13,.5)}.btn-primary:disabled{color:#495057;background-color:#fc0;border-color:#fc0}.btn-info{color:#fff;background-color:#17a2b8;border-color:#17a2b8}.btn-info:focus,.btn-info:hover{color:#fff;background-color:#138496;border-color:#117a8b}.btn-info:focus{box-shadow:0 0 0 0 rgba(58,176,195,.5)}.btn-info:disabled{color:#fff;background-color:#17a2b8;border-color:#17a2b8}.btn-warning{color:#495057;background-color:#ffc107;border-color:#ffc107}.btn-warning:focus,.btn-warning:hover{color:#495057;background-color:#e0a800;border-color:#d39e00}.btn-warning:focus{box-shadow:0 0 0 0 rgba(228,176,19,.5)}.btn-warning:disabled{color:#495057;background-color:#ffc107;border-color:#ffc107}.btn-light{color:#495057;background-color:#f1f6f9;border-color:#f1f6f9}.btn-light:focus,.btn-light:hover{color:#495057;background-color:#d6e5ee;border-color:#cddfea}.btn-light:focus{box-shadow:0 0 0 0 rgba(216,221,225,.5)}.btn-light:disabled{color:#495057;background-color:#f1f6f9;border-color:#f1f6f9}.btn-dark{color:#fff;background-color:#495057;border-color:#495057}.btn-dark:focus,.btn-dark:hover{color:#fff;background-color:#383d42;border-color:#32373b}.btn-dark:focus{box-shadow:0 0 0 0 rgba(100,106,112,.5)}.btn-dark:disabled{color:#fff;background-color:#495057;border-color:#495057}.btn-primary-light{color:#495057;background-color:#fffaf0;border-color:#fffaf0}.btn-primary-light:focus,.btn-primary-light:hover{color:#495057;background-color:#ffedca;border-color:#ffe9bd}.btn-primary-light:focus{box-shadow:0 0 0 0 rgba(228,225,217,.5)}.btn-primary-light:disabled{color:#495057;background-color:#fffaf0;border-color:#fffaf0}.btn-white{color:#495057;background-color:#fff;border-color:#fff}.btn-white:focus,.btn-white:hover{color:#495057;background-color:#ececec;border-color:#e6e6e6}.btn-white:focus{box-shadow:0 0 0 0 rgba(228,229,230,.5)}.btn-white:disabled{color:#495057;background-color:#fff;border-color:#fff}.btn-black{color:#fff;background-color:#212529;border-color:#212529}.btn-black:focus,.btn-black:hover{color:#fff;background-color:#101214;border-color:#0a0c0d}.btn-black:focus{box-shadow:0 0 0 0 rgba(66,70,73,.5)}.btn-black:disabled{color:#fff;background-color:#212529;border-color:#212529}.btn-orange{color:#495057;background-color:#ff8c00;border-color:#ff8c00}.btn-orange:focus,.btn-orange:hover{color:#fff;background-color:#d97700;border-color:#cc7000}.btn-orange:focus{box-shadow:0 0 0 0 rgba(228,131,13,.5)}.btn-orange:disabled{color:#495057;background-color:#ff8c00;border-color:#ff8c00}.btn-light-orange{color:#495057;background-color:#ffe4b5;border-color:#ffe4b5}.btn-light-orange:focus,.btn-light-orange:hover{color:#495057;background-color:#ffd68f;border-color:#ffd182}.btn-light-orange:focus{box-shadow:0 0 0 0 rgba(228,206,167,.5)}.btn-light-orange:disabled{color:#495057;background-color:#ffe4b5;border-color:#ffe4b5}.btn-outline-primary{color:#fc0;border-color:#fc0}.btn-outline-primary:hover{color:#495057;background-color:#fc0;border-color:#fc0}.btn-outline-primary:focus{box-shadow:0 0 0 0 rgba(255,204,0,.5)}.btn-outline-primary:disabled{color:#fc0;background-color:transparent}.btn-outline-info{color:#17a2b8;border-color:#17a2b8}.btn-outline-info:hover{color:#fff;background-color:#17a2b8;border-color:#17a2b8}.btn-outline-info:focus{box-shadow:0 0 0 0 rgba(23,162,184,.5)}.btn-outline-info:disabled{color:#17a2b8;background-color:transparent}.btn-outline-warning{color:#ffc107;border-color:#ffc107}.btn-outline-warning:hover{color:#495057;background-color:#ffc107;border-color:#ffc107}.btn-outline-warning:focus{box-shadow:0 0 0 0 rgba(255,193,7,.5)}.btn-outline-warning:disabled{color:#ffc107;background-color:transparent}.btn-outline-light{color:#f1f6f9;border-color:#f1f6f9}.btn-outline-light:hover{color:#495057;background-color:#f1f6f9;border-color:#f1f6f9}.btn-outline-light:focus{box-shadow:0 0 0 0 rgba(241,246,249,.5)}.btn-outline-light:disabled{color:#f1f6f9;background-color:transparent}.btn-outline-dark{color:#495057;border-color:#495057}.btn-outline-dark:hover{color:#fff;background-color:#495057;border-color:#495057}.btn-outline-dark:focus{box-shadow:0 0 0 0 rgba(73,80,87,.5)}.btn-outline-dark:disabled{color:#495057;background-color:transparent}.btn-outline-primary-light{color:#fffaf0;border-color:#fffaf0}.btn-outline-primary-light:hover{color:#495057;background-color:#fffaf0;border-color:#fffaf0}.btn-outline-primary-light:focus{box-shadow:0 0 0 0 rgba(255,250,240,.5)}.btn-outline-primary-light:disabled{color:#fffaf0;background-color:transparent}.btn-outline-white{color:#fff;border-color:#fff}.btn-outline-white:hover{color:#495057;background-color:#fff;border-color:#fff}.btn-outline-white:focus{box-shadow:0 0 0 0 hsla(0,0%,100%,.5)}.btn-outline-white:disabled{color:#fff;background-color:transparent}.btn-outline-black{color:#212529;border-color:#212529}.btn-outline-black:hover{color:#fff;background-color:#212529;border-color:#212529}.btn-outline-black:focus{box-shadow:0 0 0 0 rgba(33,37,41,.5)}.btn-outline-black:disabled{color:#212529;background-color:transparent}.btn-outline-orange{color:#ff8c00;border-color:#ff8c00}.btn-outline-orange:hover{color:#495057;background-color:#ff8c00;border-color:#ff8c00}.btn-outline-orange:focus{box-shadow:0 0 0 0 rgba(255,140,0,.5)}.btn-outline-orange:disabled{color:#ff8c00;background-color:transparent}.btn-outline-light-orange{color:#ffe4b5;border-color:#ffe4b5}.btn-outline-light-orange:hover{color:#495057;background-color:#ffe4b5;border-color:#ffe4b5}.btn-outline-light-orange:focus{box-shadow:0 0 0 0 rgba(255,228,181,.5)}.btn-outline-light-orange:disabled{color:#ffe4b5;background-color:transparent}.btn-link{font-weight:400;color:#ff8c00;text-decoration:none}.btn-link:hover{color:#ff8c00;text-decoration:underline}.btn-link:focus{text-decoration:underline;box-shadow:none}.btn-link:disabled{color:#d6dbdf;pointer-events:none}.btn-lg{padding:16px 32px;font-size:1.125rem;line-height:26px;border-radius:8px}.btn-block{display:block;width:100%}.btn-block+.btn-block{margin-top:24px}input[type=button].btn-block,input[type=reset].btn-block,input[type=submit].btn-block{width:100%}.custom-control{position:relative;display:block;min-height:1.5rem;padding-left:1.5rem}.custom-control-inline{display:inline-flex;margin-right:1rem}.custom-control-input{position:absolute;left:0;z-index:-1;width:1rem;height:1.25rem;opacity:0}.custom-select{display:inline-block;width:100%;height:calc(1.5em+.75rem+2px);padding:.375rem 1.75rem .375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#6c757d;vertical-align:middle;background:#fff url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='4' height='5'%3E%3Cpath fill='%23343a40' d='M2 0L0 2h4zm0 5L0 3h4z'/%3E%3C/svg%3E") no-repeat right .75rem center/8px 10px;border:1px solid #ced4da;border-radius:8px;-webkit-appearance:none;-moz-appearance:none;appearance:none}.custom-select:focus{border-color:#ffe680;outline:0;box-shadow:0 0 0 .2rem rgba(255,204,0,.25)}.custom-select:focus::-ms-value{color:#6c757d;background-color:#fff}.custom-select[multiple],.custom-select[size]:not([size="1"]){height:auto;padding-right:.75rem;background-image:none}.custom-select:disabled{color:#6c757d;background-color:#e9ecef}.custom-select::-ms-expand{display:none}.custom-select:-moz-focusring{color:transparent;text-shadow:0 0 0 #6c757d}.custom-select-lg{height:calc(1.5em+1rem+2px);padding-top:.5rem;padding-bottom:.5rem;padding-left:1rem;font-size:1.125rem}.custom-file{display:inline-block;margin-bottom:0}.custom-file,.custom-file-input{position:relative;width:100%;height:calc(1.5em+.75rem+2px)}.custom-file-input{z-index:2;margin:0;opacity:0}.custom-select{transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media(prefers-reduced-motion:reduce){.custom-select{transition:none}}pre{white-space:pre-wrap}pre{border:1px solid #d6dbdf;page-break-inside:avoid}img{page-break-inside:avoid}h2,h3,p{orphans:3;widows:3}h2,h3{page-break-after:avoid}@page{size:a3}.container,body{min-width:980px}.table{border-collapse:collapse}.table-dark{color:inherit}</style>
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    <script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>
  </head>
  <body class="amp" dir="ltr">
    <div class="container-fluid container-lg pb-5">
      <div class="row pt-3 mb-3">
        <div class="col">
          <a href="/" class="text-decoration-none">
            <amp-img class="d-inline-block mr-3" layout="fixed" width="40" height="36" src="/docs/images/logo.svg" alt="ClickHouse logo" title="ClickHouse logo"></amp-img><amp-img class="invert-dark d-inline-block" layout="fixed" width="238" height="36" src="/docs/images/clickhouse-black.svg" alt="ClickHouse" title="ClickHouse"></amp-img>
          </a>
        </div>
      </div>
      <div class="row">
        <div id="content" class="col">
          
          <h1 id=server-configuration-parameters-reference>Конфигурационные параметры сервера<a class=headerlink href=../amp/#server-configuration-parameters-reference title="Permanent link"> </a></h1> <h2 id=builtin-dictionaries-reload-interval>builtin_dictionaries_reload_interval<a class=headerlink href=../amp/#builtin-dictionaries-reload-interval title="Permanent link"> </a></h2> <p>Интервал (в секундах) перезагрузки встроенных словарей.</p> <p>ClickHouse перезагружает встроенные словари с заданным интервалом. Это позволяет править словари «на лету» без перезапуска сервера.</p> <p>Значение по умолчанию - 3600.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;builtin_dictionaries_reload_interval&gt;</span>3600<span class=nt>&lt;/builtin_dictionaries_reload_interval&gt;</span>
</code></pre></div> <h2 id=compression>compression<a class=headerlink href=../amp/#compression title="Permanent link"> </a></h2> <p>Настройки компрессии данных.</p> <div class="admonition warning alert pb-0 mb-4 alert-warning" role=alert> <p class="admonition-title alert-heading display-4 text-reset mb-2">Внимание</p> <p>Лучше не использовать, если вы только начали работать с ClickHouse.</p> </div> <p>Общий вид конфигурации:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;compression&gt;</span>
    <span class=nt>&lt;case&gt;</span>
      <span class=nt>&lt;min_part_size&gt;</span>...<span class=nt>&lt;/min_part_size&gt;</span>
      <span class=nt>&lt;min_part_size_ratio&gt;</span>...<span class=nt>&lt;/min_part_size_ratio&gt;</span>
      <span class=nt>&lt;method&gt;</span>...<span class=nt>&lt;/method&gt;</span>
      <span class=nt>&lt;level&gt;</span>...<span class=nt>&lt;/level&gt;</span>
    <span class=nt>&lt;/case&gt;</span>
    ...
<span class=nt>&lt;/compression&gt;</span>
</code></pre></div> <p>Поля блока <code class=syntax>&lt;case&gt;</code>:</p> <ul> <li><code class=syntax>min_part_size</code> - Минимальный размер части таблицы.</li> <li><code class=syntax>min_part_size_ratio</code> - Отношение размера минимальной части таблицы к полному размеру таблицы.</li> <li><code class=syntax>method</code> - Метод сжатия. Возможные значения: <code class=syntax>lz4</code>, <code class=syntax>lz4hc</code>, <code class=syntax>zstd</code>.</li> <li><code class=syntax>level</code> – Уровень сжатия. См. <a href=../../../sql-reference/statements/create/table/amp/#create-query-common-purpose-codecs>Кодеки</a>.</li> </ul> <p>Можно сконфигурировать несколько разделов <code class=syntax>&lt;case&gt;</code>.</p> <p>ClickHouse проверяет условия для <code class=syntax>min_part_size</code> и <code class=syntax>min_part_size_ratio</code> и выполнит те блоки <code class=syntax>case</code>, для которых условия совпали.</p> <ul> <li>Если кусок данных совпадает с условиями, ClickHouse использует указанные метод сжатия.</li> <li>Если кусок данных совпадает с несколькими блоками <code class=syntax>case</code>, ClickHouse использует первый совпавший блок условий.</li> </ul> <p>Если ни один <code class=syntax>&lt;case&gt;</code> не подходит, то ClickHouse применит алгоритм сжатия <code class=syntax>lz4</code>.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;compression</span> <span class=na>incl=</span><span class=s>"clickhouse_compression"</span><span class=nt>&gt;</span>
    <span class=nt>&lt;case&gt;</span>
        <span class=nt>&lt;min_part_size&gt;</span>10000000000<span class=nt>&lt;/min_part_size&gt;</span>
        <span class=nt>&lt;min_part_size_ratio&gt;</span>0.01<span class=nt>&lt;/min_part_size_ratio&gt;</span>
        <span class=nt>&lt;method&gt;</span>zstd<span class=nt>&lt;/method&gt;</span>
        <span class=nt>&lt;level&gt;</span>1<span class=nt>&lt;/level&gt;</span>
    <span class=nt>&lt;/case&gt;</span>
<span class=nt>&lt;/compression&gt;</span>
</code></pre></div> <h2 id=server-settings-encryption>encryption<a class=headerlink href=../amp/#server-settings-encryption title="Permanent link"> </a></h2> <p>Настраивает команду для получения ключа, используемого <a href=../../../../sql-reference/statements/create/table/amp/#create-query-encryption-codecs>кодеками шифрования</a>. Ключ (или несколько ключей) должен быть записан в переменные окружения или установлен в конфигурационном файле.</p> <p>Ключи могут быть представлены в шестнадцатеричной или строковой форме. Их длина должна быть равна 16 байтам.</p> <p><strong>Пример</strong></p> <p>Загрузка из файла конфигурации:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;encryption_codecs&gt;</span>
    <span class=nt>&lt;aes_128_gcm_siv&gt;</span>
        <span class=nt>&lt;key&gt;</span>12345567812345678<span class=nt>&lt;/key&gt;</span>
    <span class=nt>&lt;/aes_128_gcm_siv&gt;</span>
<span class=nt>&lt;/encryption_codecs&gt;</span>
</code></pre></div> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-4 text-reset mb-2">Примечание</p> <p>Хранение ключей в конфигурационном файле не рекомендовано. Это не безопасно. Вы можете переместить ключи в отдельный файл на секретном диске и сделать symlink к этому конфигурационному файлу в папке <code class=syntax>config.d/</code>.</p> </div> <p>Загрузка из файла конфигурации, когда ключ представлен в шестнадцатеричной форме:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;encryption_codecs&gt;</span>
    <span class=nt>&lt;aes_128_gcm_siv&gt;</span>
        <span class=nt>&lt;key_hex&gt;</span>00112233445566778899aabbccddeeff<span class=nt>&lt;/key_hex&gt;</span>
    <span class=nt>&lt;/aes_128_gcm_siv&gt;</span>
<span class=nt>&lt;/encryption_codecs&gt;</span>
</code></pre></div> <p>Загрузка ключа из переменной окружения:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;encryption_codecs&gt;</span>
    <span class=nt>&lt;aes_128_gcm_siv&gt;</span>
        <span class=nt>&lt;key_hex</span> <span class=na>from_env=</span><span class=s>"ENVVAR"</span><span class=nt>&gt;&lt;/key_hex&gt;</span>
    <span class=nt>&lt;/aes_128_gcm_siv&gt;</span>
<span class=nt>&lt;/encryption_codecs&gt;</span>
</code></pre></div> <p>Параметр <code class=syntax>current_key_id</code> устанавливает текущий ключ для шифрования, и все указанные ключи можно использовать для расшифровки.</p> <p>Все эти методы могут быть применены для нескольких ключей:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;encryption_codecs&gt;</span>
    <span class=nt>&lt;aes_128_gcm_siv&gt;</span>
        <span class=nt>&lt;key_hex</span> <span class=na>id=</span><span class=s>"0"</span><span class=nt>&gt;</span>00112233445566778899aabbccddeeff<span class=nt>&lt;/key_hex&gt;</span>
        <span class=nt>&lt;key_hex</span> <span class=na>id=</span><span class=s>"1"</span> <span class=na>from_env=</span><span class=s>"ENVVAR"</span><span class=nt>&gt;&lt;/key_hex&gt;</span>
        <span class=nt>&lt;current_key_id&gt;</span>1<span class=nt>&lt;/current_key_id&gt;</span>
    <span class=nt>&lt;/aes_128_gcm_siv&gt;</span>
<span class=nt>&lt;/encryption_codecs&gt;</span>
</code></pre></div> <p>Параметр <code class=syntax>current_key_id</code> указывает текущий ключ для шифрования.</p> <p>Также пользователь может добавить одноразовое случайное число длинной 12 байт (по умолчанию шифрование и дешифровка будут использовать одноразовое число длинной 12 байт, заполненное нулями):</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;encryption_codecs&gt;</span>
    <span class=nt>&lt;aes_128_gcm_siv&gt;</span>
        <span class=nt>&lt;nonce&gt;</span>012345678910<span class=nt>&lt;/nonce&gt;</span>
    <span class=nt>&lt;/aes_128_gcm_siv&gt;</span>
<span class=nt>&lt;/encryption_codecs&gt;</span>
</code></pre></div> <p>Одноразовое число также может быть представлено в шестнадцатеричной форме:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;encryption_codecs&gt;</span>
    <span class=nt>&lt;aes_128_gcm_siv&gt;</span>
        <span class=nt>&lt;nonce_hex&gt;</span>abcdefabcdef<span class=nt>&lt;/nonce_hex&gt;</span>
    <span class=nt>&lt;/aes_128_gcm_siv&gt;</span>
<span class=nt>&lt;/encryption_codecs&gt;</span>
</code></pre></div> <p>Всё вышеперечисленное также применимо для алгоритма <code class=syntax>aes_256_gcm_siv</code> (но ключ должен быть длиной 32 байта).</p> <h2 id=custom_settings_prefixes>custom_settings_prefixes<a class=headerlink href=../amp/#custom_settings_prefixes title="Permanent link"> </a></h2> <p>Список префиксов для <a href=../../../settings/amp/#custom_settings>пользовательских настроек</a>. Префиксы должны перечисляться через запятую.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;custom_settings_prefixes&gt;</span>custom_<span class=nt>&lt;/custom_settings_prefixes&gt;</span>
</code></pre></div> <p><strong>См. также</strong></p> <ul> <li><a href=../../../settings/amp/#custom_settings>Пользовательские настройки</a></li> </ul> <h2 id=server_configuration_parameters-core_dump>core_dump<a class=headerlink href=../amp/#server_configuration_parameters-core_dump title="Permanent link"> </a></h2> <p>Задает мягкое ограничение для размера файла дампа памяти.</p> <p>Возможные значения:</p> <ul> <li>положительное целое число.</li> </ul> <p>Значение по умолчанию: <code class=syntax>1073741824</code> (1 ГБ).</p> <div class="admonition info alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-4 text-reset mb-2">Примечание</p> <p>Жесткое ограничение настраивается с помощью системных инструментов.</p> </div> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;core_dump&gt;</span>
    <span class=nt>&lt;size_limit&gt;</span>1073741824<span class=nt>&lt;/size_limit&gt;</span>
<span class=nt>&lt;/core_dump&gt;</span>
</code></pre></div> <h2 id=database_atomic_delay_before_drop_table_sec>database_atomic_delay_before_drop_table_sec<a class=headerlink href=../amp/#database_atomic_delay_before_drop_table_sec title="Permanent link"> </a></h2> <p>Устанавливает задержку перед удалением табличных данных, в секундах. Если запрос имеет идентификатор <code class=syntax>SYNC</code>, эта настройка игнорируется.</p> <p>Значение по умолчанию: <code class=syntax>480</code> (8 минут).</p> <h2 id=default-database>default_database<a class=headerlink href=../amp/#default-database title="Permanent link"> </a></h2> <p>База данных по умолчанию.</p> <p>Перечень баз данных можно получить запросом <a href=.././amp/#show-databases>SHOW DATABASES</a>.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;default_database&gt;</span>default<span class=nt>&lt;/default_database&gt;</span>
</code></pre></div> <h2 id=default-profile>default_profile<a class=headerlink href=../amp/#default-profile title="Permanent link"> </a></h2> <p>Профиль настроек по умолчанию.</p> <p>Профили настроек находятся в файле, указанном в параметре <code class=syntax>user_config</code>.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;default_profile&gt;</span>default<span class=nt>&lt;/default_profile&gt;</span>
</code></pre></div> <h2 id=default_replica_path>default_replica_path<a class=headerlink href=../amp/#default_replica_path title="Permanent link"> </a></h2> <p>Путь к таблице в ZooKeeper.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;default_replica_path&gt;</span>/clickhouse/tables/{uuid}/{shard}<span class=nt>&lt;/default_replica_path&gt;</span>
</code></pre></div> <h2 id=default_replica_name>default_replica_name<a class=headerlink href=../amp/#default_replica_name title="Permanent link"> </a></h2> <p>Имя реплики в ZooKeeper.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;default_replica_name&gt;</span>{replica}<span class=nt>&lt;/default_replica_name&gt;</span>
</code></pre></div> <h2 id=server_configuration_parameters-dictionaries_config>dictionaries_config<a class=headerlink href=../amp/#server_configuration_parameters-dictionaries_config title="Permanent link"> </a></h2> <p>Путь к конфигурации внешних словарей.</p> <p>Путь:</p> <ul> <li>Указывается абсолютным или относительно конфигурационного файла сервера.</li> <li>Может содержать wildcard-ы * и ?.</li> </ul> <p>Смотрите также «<a href=.././amp/ >Внешние словари</a>».</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;dictionaries_config&gt;</span>*_dictionary.xml<span class=nt>&lt;/dictionaries_config&gt;</span>
</code></pre></div> <h2 id=server_configuration_parameters-dictionaries_lazy_load>dictionaries_lazy_load<a class=headerlink href=../amp/#server_configuration_parameters-dictionaries_lazy_load title="Permanent link"> </a></h2> <p>Отложенная загрузка словарей.</p> <p>Если <code class=syntax>true</code>, то каждый словарь создаётся при первом использовании. Если словарь не удалось создать, то вызов функции, использующей словарь, сгенерирует исключение.</p> <p>Если <code class=syntax>false</code>, то все словари создаются при старте сервера, если словарь или словари создаются слишком долго или создаются с ошибкой, то сервер загружается без<br> этих словарей и продолжает попытки создать эти словари.</p> <p>По умолчанию - <code class=syntax>true</code>.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;dictionaries_lazy_load&gt;</span>true<span class=nt>&lt;/dictionaries_lazy_load&gt;</span>
</code></pre></div> <h2 id=server_configuration_parameters-format_schema_path>format_schema_path<a class=headerlink href=../amp/#server_configuration_parameters-format_schema_path title="Permanent link"> </a></h2> <p>Путь к каталогу со схемами для входных данных. Например со схемами для формата <a href=../../../../interfaces/formats/amp/#capnproto>CapnProto</a>.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax>  <span class=cm>&lt;!-- Directory containing schema files for various input formats. --&gt;</span>
  <span class=nt>&lt;format_schema_path&gt;</span>format_schemas/<span class=nt>&lt;/format_schema_path&gt;</span>
</code></pre></div> <h2 id=server_configuration_parameters-graphite>graphite<a class=headerlink href=../amp/#server_configuration_parameters-graphite title="Permanent link"> </a></h2> <p>Отправка данных в <a href=https://github.com/graphite-project rel="external nofollow noreferrer" target=_blank>Graphite</a>.</p> <p>Настройки:</p> <ul> <li>host – Сервер Graphite.</li> <li>port – Порт сервера Graphite.</li> <li>interval – Период отправки в секундах.</li> <li>timeout – Таймаут отправки данных в секундах.</li> <li>root_path – Префикс для ключей.</li> <li>metrics – Отправка данных из таблицы <a href=.././amp/#system_tables-metrics>system.metrics</a>.</li> <li>events – Отправка дельты данных, накопленной за промежуток времени из таблицы <a href=.././amp/#system_tables-events>system.events</a>.</li> <li>events_cumulative – Отправка суммарных данных из таблицы <a href=.././amp/#system_tables-events>system.events</a>.</li> <li>asynchronous_metrics – Отправка данных из таблицы <a href=.././amp/#system_tables-asynchronous_metrics>system.asynchronous_metrics</a>.</li> </ul> <p>Можно определить несколько секций <code class=syntax>&lt;graphite&gt;</code>, например, для передачи различных данных с различной частотой.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;graphite&gt;</span>
    <span class=nt>&lt;host&gt;</span>localhost<span class=nt>&lt;/host&gt;</span>
    <span class=nt>&lt;port&gt;</span>42000<span class=nt>&lt;/port&gt;</span>
    <span class=nt>&lt;timeout&gt;</span>0.1<span class=nt>&lt;/timeout&gt;</span>
    <span class=nt>&lt;interval&gt;</span>60<span class=nt>&lt;/interval&gt;</span>
    <span class=nt>&lt;root_path&gt;</span>one_min<span class=nt>&lt;/root_path&gt;</span>
    <span class=nt>&lt;metrics&gt;</span>true<span class=nt>&lt;/metrics&gt;</span>
    <span class=nt>&lt;events&gt;</span>true<span class=nt>&lt;/events&gt;</span>
    <span class=nt>&lt;events_cumulative&gt;</span>false<span class=nt>&lt;/events_cumulative&gt;</span>
    <span class=nt>&lt;asynchronous_metrics&gt;</span>true<span class=nt>&lt;/asynchronous_metrics&gt;</span>
<span class=nt>&lt;/graphite&gt;</span>
</code></pre></div> <h2 id=server_configuration_parameters-graphite-rollup>graphite_rollup<a class=headerlink href=../amp/#server_configuration_parameters-graphite-rollup title="Permanent link"> </a></h2> <p>Настройка прореживания данных для Graphite.</p> <p>Подробнее читайте в разделе <a href=.././amp/ >GraphiteMergeTree</a>.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;graphite_rollup_example&gt;</span>
    <span class=nt>&lt;default&gt;</span>
        <span class=nt>&lt;function&gt;</span>max<span class=nt>&lt;/function&gt;</span>
        <span class=nt>&lt;retention&gt;</span>
            <span class=nt>&lt;age&gt;</span>0<span class=nt>&lt;/age&gt;</span>
            <span class=nt>&lt;precision&gt;</span>60<span class=nt>&lt;/precision&gt;</span>
        <span class=nt>&lt;/retention&gt;</span>
        <span class=nt>&lt;retention&gt;</span>
            <span class=nt>&lt;age&gt;</span>3600<span class=nt>&lt;/age&gt;</span>
            <span class=nt>&lt;precision&gt;</span>300<span class=nt>&lt;/precision&gt;</span>
        <span class=nt>&lt;/retention&gt;</span>
        <span class=nt>&lt;retention&gt;</span>
            <span class=nt>&lt;age&gt;</span>86400<span class=nt>&lt;/age&gt;</span>
            <span class=nt>&lt;precision&gt;</span>3600<span class=nt>&lt;/precision&gt;</span>
        <span class=nt>&lt;/retention&gt;</span>
    <span class=nt>&lt;/default&gt;</span>
<span class=nt>&lt;/graphite_rollup_example&gt;</span>
</code></pre></div> <h2 id=http-porthttps-port>http_port/https_port<a class=headerlink href=../amp/#http-porthttps-port title="Permanent link"> </a></h2> <p>Порт для обращений к серверу по протоколу HTTP(s).</p> <p>Если указан <code class=syntax>https_port</code>, то требуется конфигурирование <a href=../amp/#server_configuration_parameters-openssl>openSSL</a>.</p> <p>Если указан <code class=syntax>http_port</code>, то настройка openSSL игнорируется, даже если она задана.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;https_port&gt;</span>9999<span class=nt>&lt;/https_port&gt;</span>
</code></pre></div> <h2 id=server_configuration_parameters-http_server_default_response>http_server_default_response<a class=headerlink href=../amp/#server_configuration_parameters-http_server_default_response title="Permanent link"> </a></h2> <p>Страница, показываемая по умолчанию, при обращении к HTTP(s) серверу ClickHouse.<br> Значение по умолчанию «Ok.» (с переводом строки на конце).</p> <p><strong>Пример</strong></p> <p>Показывает <code class=syntax>https://tabix.io/</code> при обращении к <code class=syntax>http://localhost:http_port</code>.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;http_server_default_response&gt;</span>
  <span class=cp>&lt;![CDATA[&lt;html ng-app="SMI2"&gt;&lt;head&gt;&lt;base href="http://ui.tabix.io/"&gt;&lt;/head&gt;&lt;body&gt;&lt;div ui-view="" class="content-ui"&gt;&lt;/div&gt;&lt;script src="http://loader.tabix.io/master.js"&gt;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;]]&gt;</span>
<span class=nt>&lt;/http_server_default_response&gt;</span>
</code></pre></div> <h2 id=hsts-max-age>hsts_max_age<a class=headerlink href=../amp/#hsts-max-age title="Permanent link"> </a></h2> <p>Срок действия HSTS в секундах. Значение по умолчанию <code class=syntax>0</code> (HSTS выключен). Для включения HSTS задайте положительное число. Срок действия HSTS будет равен введенному числу. </p> <p><strong>Пример</strong> </p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;hsts_max_age&gt;</span>600000<span class=nt>&lt;/hsts_max_age&gt;</span>
</code></pre></div> <h2 id=server_configuration_parameters-include_from>include_from<a class=headerlink href=../amp/#server_configuration_parameters-include_from title="Permanent link"> </a></h2> <p>Путь к файлу с подстановками.</p> <p>Подробности смотрите в разделе «<a href=../../../configuration-files/amp/#configuration_files>Конфигурационные файлы</a>».</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;include_from&gt;</span>/etc/metrica.xml<span class=nt>&lt;/include_from&gt;</span>
</code></pre></div> <h2 id=interserver-http-port>interserver_http_port<a class=headerlink href=../amp/#interserver-http-port title="Permanent link"> </a></h2> <p>Порт для обмена между серверами ClickHouse.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;interserver_http_port&gt;</span>9009<span class=nt>&lt;/interserver_http_port&gt;</span>
</code></pre></div> <h2 id=interserver-http-host>interserver_http_host<a class=headerlink href=../amp/#interserver-http-host title="Permanent link"> </a></h2> <p>Имя хоста, которое могут использовать другие серверы для обращения к этому хосту.</p> <p>Если не указано, то определяется аналогично команде <code class=syntax>hostname -f</code>.</p> <p>Удобно использовать, чтобы отвязаться от конкретного сетевого интерфейса.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;interserver_http_host&gt;</span>example.yandex.ru<span class=nt>&lt;/interserver_http_host&gt;</span>
</code></pre></div> <h2 id=interserver-https-port>interserver_https_port<a class=headerlink href=../amp/#interserver-https-port title="Permanent link"> </a></h2> <p>Порт для обмена данными между репликами ClickHouse по протоколу <code class=syntax>HTTPS</code>.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;interserver_https_port&gt;</span>9010<span class=nt>&lt;/interserver_https_port&gt;</span>
</code></pre></div> <h2 id=interserver-https-host>interserver_https_host<a class=headerlink href=../amp/#interserver-https-host title="Permanent link"> </a></h2> <p>Имя хоста, которое могут использовать другие реплики для обращения к нему по протоколу <code class=syntax>HTTPS</code>.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;interserver_https_host&gt;</span>example.yandex.ru<span class=nt>&lt;/interserver_https_host&gt;</span>
</code></pre></div> <h2 id=server-settings-interserver-http-credentials>interserver_http_credentials<a class=headerlink href=../amp/#server-settings-interserver-http-credentials title="Permanent link"> </a></h2> <p>Имя пользователя и пароль, использующиеся для подключения к другим серверам при <a href=../../../../engines/table-engines/mergetree-family/replication/amp/ >репликации</a> движками Replicated*. Сервер использует эти же учетные данные при аутентификации других реплик. Поэтому настройки <code class=syntax>interserver_http_credentials</code> должны быть заданы одинаковыми для всех реплик кластера.</p> <p>По умолчанию, если секция <code class=syntax>interserver_http_credentials</code> не задана в конфигурации, аутентификация при репликации не используется.</p> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-4 text-reset mb-2">Примечание</p> <p>Настройки <code class=syntax>interserver_http_credentials</code> не относятся к <a class=alert-link href=../../../../interfaces/cli/amp/#configuration_files>конфигурации</a> учетных данных клиента ClickHouse.</p> </div> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-4 text-reset mb-2">Примечание</p> <p>Учетные данные в <code class=syntax>interserver_http_credentials</code> являются общими для репликации по <code class=syntax>HTTP</code> и <code class=syntax>HTTPS</code>.</p> </div> <p>Раздел содержит следующие параметры:</p> <ul> <li><code class=syntax>user</code> — имя пользователя.</li> <li><code class=syntax>password</code> — пароль.</li> <li><code class=syntax>allow_empty</code> — если <code class=syntax>true</code>, то другие реплики могут подключаться без аутентификации, даже если учетные данные заданы. Если <code class=syntax>false</code>, то подключение без аутентификации не допускается. Значение по умолчанию: <code class=syntax>false</code>.</li> <li><code class=syntax>old</code> — секция содержит старые значения <code class=syntax>user</code> и <code class=syntax>password</code>, которые используются в процессе изменения учетных данных. Можно указывать несколько секций <code class=syntax>old</code>.</li> </ul> <p><strong>Изменение учетных данных</strong></p> <p>ClickHouse поддерживает динамическое изменение учетных данных. При этом не требуется одновременно останавливать все реплики, чтобы обновить конфигурацию. Изменение учетных данных выполняется за несколько шагов.</p> <p>Чтобы включить аутентификацию, установите <code class=syntax>interserver_http_credentials.allow_empty</code> в значение <code class=syntax>true</code> и задайте учетные данные. С такой конфигурацией разрешены подключения как с аутентификацией, так и без нее.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;interserver_http_credentials&gt;</span>
    <span class=nt>&lt;user&gt;</span>admin<span class=nt>&lt;/user&gt;</span>
    <span class=nt>&lt;password&gt;</span>111<span class=nt>&lt;/password&gt;</span>
    <span class=nt>&lt;allow_empty&gt;</span>true<span class=nt>&lt;/allow_empty&gt;</span>
<span class=nt>&lt;/interserver_http_credentials&gt;</span>
</code></pre></div> <p>После конфигурации всех реплик установите <code class=syntax>allow_empty</code> в значение <code class=syntax>false</code> или удалите эту настройку. Это сделает аутентификацию с новыми учетными данными обязательной.</p> <p>Чтобы изменить учетные данные, перенесите имя пользователя и пароль в секцию <code class=syntax>interserver_http_credentials.old</code> и укажите новые значения для <code class=syntax>user</code> и <code class=syntax>password</code>. Сервер будет использовать новые учетные данные при подключении к другим репликам и при этом будет разрешать подключения как с новыми, так и со старыми учетными данными.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;interserver_http_credentials&gt;</span>
    <span class=nt>&lt;user&gt;</span>admin<span class=nt>&lt;/user&gt;</span>
    <span class=nt>&lt;password&gt;</span>222<span class=nt>&lt;/password&gt;</span>
    <span class=nt>&lt;old&gt;</span>
        <span class=nt>&lt;user&gt;</span>admin<span class=nt>&lt;/user&gt;</span>
        <span class=nt>&lt;password&gt;</span>111<span class=nt>&lt;/password&gt;</span>
    <span class=nt>&lt;/old&gt;</span>
    <span class=nt>&lt;old&gt;</span>
        <span class=nt>&lt;user&gt;</span>temp<span class=nt>&lt;/user&gt;</span>
        <span class=nt>&lt;password&gt;</span>000<span class=nt>&lt;/password&gt;</span>
    <span class=nt>&lt;/old&gt;</span>
<span class=nt>&lt;/interserver_http_credentials&gt;</span>
</code></pre></div> <p>Когда новые учетные данные обновятся на всех репликах, старые учетные данные можно удалить из конфигурации.</p> <h2 id=keep-alive-timeout>keep_alive_timeout<a class=headerlink href=../amp/#keep-alive-timeout title="Permanent link"> </a></h2> <p>Время в секундах, в течение которого ClickHouse ожидает входящих запросов прежде чем закрыть соединение. Значение по умолчанию: 10 секунд.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;keep_alive_timeout&gt;</span>10<span class=nt>&lt;/keep_alive_timeout&gt;</span>
</code></pre></div> <h2 id=server_configuration_parameters-listen_host>listen_host<a class=headerlink href=../amp/#server_configuration_parameters-listen_host title="Permanent link"> </a></h2> <p>Ограничение по хостам, с которых может прийти запрос. Если необходимо, чтобы сервер отвечал всем, то надо указать <code class=syntax>::</code>.</p> <p>Примеры:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;listen_host&gt;</span>::1<span class=nt>&lt;/listen_host&gt;</span>
<span class=nt>&lt;listen_host&gt;</span>127.0.0.1<span class=nt>&lt;/listen_host&gt;</span>
</code></pre></div> <h2 id=server_configuration_parameters-listen_backlog>listen_backlog<a class=headerlink href=../amp/#server_configuration_parameters-listen_backlog title="Permanent link"> </a></h2> <p>Бэклог (размер очереди соединений, ожидающих принятия) прослушивающего сокета.</p> <p>Значение по умолчанию: <code class=syntax>4096</code> (как в linux <a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=19f92a030ca6d772ab44b22ee6a01378a8cb32d4" rel="external nofollow noreferrer" target=_blank>5.4+</a>).</p> <p>Обычно это значение незачем менять по следующим причинам:<br> - значение по умолчанию достаточно велико,<br> - для принятия соединения клиента у сервера есть отдельный поток.</p> <p>Так что даже если у вас <code class=syntax>TcpExtListenOverflows</code> (из <code class=syntax>nstat</code>) ненулевой и растет для сервера ClickHouse, это не повод увеличивать значение по умолчанию, поскольку:<br> - обычно если 4096 недостаточно, это говорит о внутренних проблемах ClickHouse с масштабированием, так что лучше сообщить о проблеме,<br> - и это не значит, что сервер сможет принять еще больше подключений в дальнейшем (а если и сможет, клиенты, вероятно, уже отсоединятся).</p> <p>Примеры:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;listen_backlog&gt;</span>4096<span class=nt>&lt;/listen_backlog&gt;</span>
</code></pre></div> <h2 id=server_configuration_parameters-logger>logger<a class=headerlink href=../amp/#server_configuration_parameters-logger title="Permanent link"> </a></h2> <p>Настройки логирования.</p> <p>Ключи:</p> <ul> <li><code class=syntax>level</code> - Уровень логирования. Допустимые значения: <code class=syntax>trace</code>, <code class=syntax>debug</code>, <code class=syntax>information</code>, <code class=syntax>warning</code>, <code class=syntax>error</code>.</li> <li><code class=syntax>log</code> - Файл лога. Содержит все записи согласно <code class=syntax>level</code>.</li> <li><code class=syntax>errorlog</code> - Файл лога ошибок.</li> <li><code class=syntax>size</code> - Размер файла. Действует для <code class=syntax>log</code> и <code class=syntax>errorlog</code>. Как только файл достиг размера <code class=syntax>size</code>, ClickHouse архивирует и переименовывает его, а на его месте создает новый файл лога.</li> <li><code class=syntax>count</code> - Количество заархивированных файлов логов, которые сохраняет ClickHouse.</li> </ul> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;logger&gt;</span>
    <span class=nt>&lt;level&gt;</span>trace<span class=nt>&lt;/level&gt;</span>
    <span class=nt>&lt;log&gt;</span>/var/log/clickhouse-server/clickhouse-server.log<span class=nt>&lt;/log&gt;</span>
    <span class=nt>&lt;errorlog&gt;</span>/var/log/clickhouse-server/clickhouse-server.err.log<span class=nt>&lt;/errorlog&gt;</span>
    <span class=nt>&lt;size&gt;</span>1000M<span class=nt>&lt;/size&gt;</span>
    <span class=nt>&lt;count&gt;</span>10<span class=nt>&lt;/count&gt;</span>
<span class=nt>&lt;/logger&gt;</span>
</code></pre></div> <p>Также, существует поддержка записи в syslog. Пример настроек:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;logger&gt;</span>
    <span class=nt>&lt;use_syslog&gt;</span>1<span class=nt>&lt;/use_syslog&gt;</span>
    <span class=nt>&lt;syslog&gt;</span>
        <span class=nt>&lt;address&gt;</span>syslog.remote:10514<span class=nt>&lt;/address&gt;</span>
        <span class=nt>&lt;hostname&gt;</span>myhost.local<span class=nt>&lt;/hostname&gt;</span>
        <span class=nt>&lt;facility&gt;</span>LOG_LOCAL6<span class=nt>&lt;/facility&gt;</span>
        <span class=nt>&lt;format&gt;</span>syslog<span class=nt>&lt;/format&gt;</span>
    <span class=nt>&lt;/syslog&gt;</span>
<span class=nt>&lt;/logger&gt;</span>
</code></pre></div> <p>Ключи для syslog:</p> <ul> <li>use_syslog - обязательная настройка, если требуется запись в syslog</li> <li>address - хост[:порт] демона syslogd. Если не указан, используется локальный</li> <li>hostname - опционально, имя хоста, с которого отсылаются логи</li> <li>facility - <a href=https://en.wikipedia.org/wiki/Syslog#Facility rel="external nofollow noreferrer" target=_blank>категория syslog</a>, записанная в верхнем регистре, с префиксом «LOG_»: (<code class=syntax>LOG_USER</code>, <code class=syntax>LOG_DAEMON</code>, <code class=syntax>LOG_LOCAL3</code> и прочие).<br> Значения по умолчанию: при указанном <code class=syntax>address</code> - <code class=syntax>LOG_USER</code>, иначе - <code class=syntax>LOG_DAEMON</code></li> <li>format - формат сообщений. Возможные значения - <code class=syntax>bsd</code> и <code class=syntax>syslog</code></li> </ul> <h2 id=server_configuration_parameters-send_crash_reports>send_crash_reports<a class=headerlink href=../amp/#server_configuration_parameters-send_crash_reports title="Permanent link"> </a></h2> <p>Настройки для отправки сообщений о сбоях в команду разработчиков ядра ClickHouse через <a href=https://sentry.io rel="external nofollow noreferrer" target=_blank>Sentry</a>.<br> Включение этих настроек, особенно в pre-production среде, может дать очень ценную информацию и поможет развитию ClickHouse.</p> <p>Сервер на котором включены данные настройки должен иметь доступ в Интернет по протоколу IPv4 (на момент написания документации IPv6 не поддерживается публичным облаком Sentry) для правильной работы данной функциональности.</p> <p>Ключи:</p> <ul> <li><code class=syntax>enabled</code> – Булевый флаг чтобы включить функциональность, по умолчанию <code class=syntax>false</code>. Установите <code class=syntax>true</code> чтобы разрешить отправку отчетов о сбоях.</li> <li><code class=syntax>endpoint</code> – Вы можете переопределить URL на который будут отсылаться отчеты об ошибках и использовать собственную инсталляцию Sentry. Используйте URL синтаксис <a href="https://docs.sentry.io/error-reporting/quickstart/?platform=native#configure-the-sdk" rel="external nofollow noreferrer" target=_blank>Sentry DSN</a>.</li> <li><code class=syntax>anonymize</code> - Запретить отсылку имени хоста сервера в отчете о сбое.</li> <li><code class=syntax>http_proxy</code> - Настройка HTTP proxy для отсылки отчетов о сбоях.</li> <li><code class=syntax>debug</code> - Настроить клиентскую библиотеку Sentry в debug режим.</li> <li><code class=syntax>tmp_path</code> - Путь в файловой системе для временного хранения состояния отчетов о сбоях перед отправкой на сервер Sentry.</li> </ul> <p><strong>Рекомендованные настройки</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;send_crash_reports&gt;</span>
    <span class=nt>&lt;enabled&gt;</span>true<span class=nt>&lt;/enabled&gt;</span>
<span class=nt>&lt;/send_crash_reports&gt;</span>
</code></pre></div> <h2 id=macros>macros<a class=headerlink href=../amp/#macros title="Permanent link"> </a></h2> <p>Подстановки параметров реплицируемых таблиц.</p> <p>Можно не указывать, если реплицируемые таблицы не используются.</p> <p>Подробнее смотрите в разделе <a href=../../../../engines/table-engines/mergetree-family/replication/amp/#creating-replicated-tables>Создание реплицируемых таблиц</a>.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;macros</span> <span class=na>incl=</span><span class=s>"macros"</span> <span class=na>optional=</span><span class=s>"true"</span> <span class=nt>/&gt;</span>
</code></pre></div> <h2 id=server-mark-cache-size>mark_cache_size<a class=headerlink href=../amp/#server-mark-cache-size title="Permanent link"> </a></h2> <p>Приблизительный размер (в байтах) кэша засечек, используемых движками таблиц семейства <a href=.././amp/ >MergeTree</a>.</p> <p>Кэш общий для сервера, память выделяется по мере необходимости.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;mark_cache_size&gt;</span>5368709120<span class=nt>&lt;/mark_cache_size&gt;</span>
</code></pre></div> <h2 id=max_server_memory_usage>max_server_memory_usage<a class=headerlink href=../amp/#max_server_memory_usage title="Permanent link"> </a></h2> <p>Ограничивает объём оперативной памяти, используемой сервером ClickHouse. Настройка может быть задана только для профиля <code class=syntax>default</code>.</p> <p>Возможные значения:</p> <ul> <li>Положительное целое число.</li> <li>0 — автоматически.</li> </ul> <p>Значение по умолчанию: <code class=syntax>0</code>.</p> <p><strong>Дополнительная информация</strong></p> <p>Значение по умолчанию для <code class=syntax>max_server_memory_usage</code> рассчитывается как <code class=syntax>memory_amount * max_server_memory_usage_to_ram_ratio</code>.</p> <p><strong>См. также</strong></p> <ul> <li><a href=../../../settings/query-complexity/amp/#settings_max_memory_usage>max_memory_usage</a></li> <li><a href=../amp/#max_server_memory_usage_to_ram_ratio>max_server_memory_usage_to_ram_ratio</a></li> </ul> <h2 id=max_server_memory_usage_to_ram_ratio>max_server_memory_usage_to_ram_ratio<a class=headerlink href=../amp/#max_server_memory_usage_to_ram_ratio title="Permanent link"> </a></h2> <p>Определяет долю оперативной памяти, доступную для использования сервером Clickhouse. Если сервер попытается использовать больше, предоставляемый ему объём памяти будет ограничен до расчётного значения.</p> <p>Возможные значения:</p> <ul> <li>Положительное число с плавающей запятой.</li> <li>0 — сервер Clickhouse может использовать всю оперативную память.</li> </ul> <p>Значение по умолчанию: <code class=syntax>0.9</code>.</p> <p><strong>Использование</strong></p> <p>На серверах с небольшим объёмом оперативной памяти и файла подкачки может потребоваться установить настройку <code class=syntax>max_server_memory_usage_to_ram_ratio</code> в значение, большее 1.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;max_server_memory_usage_to_ram_ratio&gt;</span>0.9<span class=nt>&lt;/max_server_memory_usage_to_ram_ratio&gt;</span>
</code></pre></div> <p><strong>См. также</strong></p> <ul> <li><a href=../amp/#max_server_memory_usage>max_server_memory_usage</a></li> </ul> <h2 id=max-concurrent-queries>max_concurrent_queries<a class=headerlink href=../amp/#max-concurrent-queries title="Permanent link"> </a></h2> <p>Определяет максимальное количество одновременно обрабатываемых запросов, связанных с таблицей семейства <code class=syntax>MergeTree</code>. Запросы также могут быть ограничены настройками: <a href=../amp/#max-concurrent-insert-queries>max_concurrent_insert_queries</a>, <a href=../amp/#max-concurrent-select-queries>max_concurrent_select_queries</a>, <a href=../amp/#max-concurrent-queries-for-user>max_concurrent_queries_for_user</a>, <a href=../amp/#max-concurrent-queries-for-all-users>max_concurrent_queries_for_all_users</a>, <a href=../amp/#min-marks-to-honor-max-concurrent-queries>min_marks_to_honor_max_concurrent_queries</a>.</p> <div class="admonition info alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-4 text-reset mb-2">Примечание</p> <p>Параметры этих настроек могут быть изменены во время выполнения запросов и вступят в силу немедленно. Запросы, которые уже запущены, выполнятся без изменений.</p> </div> <p>Возможные значения:</p> <ul> <li>Положительное целое число.</li> <li>0 — нет лимита.</li> </ul> <p>Значение по умолчанию: <code class=syntax>100</code>.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;max_concurrent_queries&gt;</span>100<span class=nt>&lt;/max_concurrent_queries&gt;</span>
</code></pre></div> <h2 id=max-concurrent-insert-queries>max_concurrent_insert_queries<a class=headerlink href=../amp/#max-concurrent-insert-queries title="Permanent link"> </a></h2> <p>Определяет максимальное количество одновременных <code class=syntax>INSERT</code> запросов.</p> <div class="admonition info alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-4 text-reset mb-2">Примечание</p> <p>Параметры этих настроек могут быть изменены во время выполнения запросов и вступят в силу немедленно. Запросы, которые уже запущены, выполнятся без изменений.</p> </div> <p>Возможные значения:</p> <ul> <li>Положительное целое число.</li> <li>0 — нет лимита.</li> </ul> <p>Значение по умолчанию: <code class=syntax>0</code>.</p> <p><strong>Example</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;max_concurrent_insert_queries&gt;</span>100<span class=nt>&lt;/max_concurrent_insert_queries&gt;</span>
</code></pre></div> <h2 id=max-concurrent-select-queries>max_concurrent_select_queries<a class=headerlink href=../amp/#max-concurrent-select-queries title="Permanent link"> </a></h2> <p>Определяет максимальное количество одновременных <code class=syntax>SELECT</code> запросов.</p> <div class="admonition info alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-4 text-reset mb-2">Примечание</p> <p>Параметры этих настроек могут быть изменены во время выполнения запросов и вступят в силу немедленно. Запросы, которые уже запущены, выполнятся без изменений.</p> </div> <p>Возможные значения:</p> <ul> <li>Положительное целое число.</li> <li>0 — нет лимита.</li> </ul> <p>Значение по умолчанию: <code class=syntax>0</code>.</p> <p><strong>Example</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;max_concurrent_select_queries&gt;</span>100<span class=nt>&lt;/max_concurrent_select_queries&gt;</span>
</code></pre></div> <h2 id=max-concurrent-queries-for-user>max_concurrent_queries_for_user<a class=headerlink href=../amp/#max-concurrent-queries-for-user title="Permanent link"> </a></h2> <p>Определяет максимальное количество одновременно обрабатываемых запросов, связанных с таблицей семейства <code class=syntax>MergeTree</code>, для пользователя.</p> <p>Возможные значения:</p> <ul> <li>Положительное целое число.</li> <li>0 — нет лимита.</li> </ul> <p>Значение по умолчанию: <code class=syntax>0</code>.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;max_concurrent_queries_for_user&gt;</span>5<span class=nt>&lt;/max_concurrent_queries_for_user&gt;</span>
</code></pre></div> <h2 id=max-concurrent-queries-for-all-users>max_concurrent_queries_for_all_users<a class=headerlink href=../amp/#max-concurrent-queries-for-all-users title="Permanent link"> </a></h2> <p>Если значение этой настройки меньше или равно текущему количеству одновременно обрабатываемых запросов, то будет сгенерировано исключение.</p> <p>Пример: <code class=syntax>max_concurrent_queries_for_all_users</code> установлен на 99 для всех пользователей. Чтобы выполнять запросы даже когда сервер перегружен, администратор баз данных устанавливает для себя значение настройки на 100.</p> <p>Изменение настройки для одного запроса или пользователя не влияет на другие запросы.</p> <p>Возможные значения:</p> <ul> <li>Положительное целое число.</li> <li>0 — нет лимита.</li> </ul> <p>Значение по умолчанию: <code class=syntax>0</code>.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;max_concurrent_queries_for_all_users&gt;</span>99<span class=nt>&lt;/max_concurrent_queries_for_all_users&gt;</span>
</code></pre></div> <p><strong>Смотрите также</strong></p> <ul> <li><a href=../amp/#max-concurrent-queries>max_concurrent_queries</a></li> </ul> <h2 id=min-marks-to-honor-max-concurrent-queries>min_marks_to_honor_max_concurrent_queries<a class=headerlink href=../amp/#min-marks-to-honor-max-concurrent-queries title="Permanent link"> </a></h2> <p>Определяет минимальное количество засечек, считываемых запросом для применения настройки <a href=../amp/#max-concurrent-queries>max_concurrent_queries</a>.</p> <p>Возможные значения:</p> <ul> <li>Положительное целое число.</li> <li>0 — выключена.</li> </ul> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;min_marks_to_honor_max_concurrent_queries&gt;</span>10<span class=nt>&lt;/min_marks_to_honor_max_concurrent_queries&gt;</span>
</code></pre></div> <h2 id=max-connections>max_connections<a class=headerlink href=../amp/#max-connections title="Permanent link"> </a></h2> <p>Максимальное количество входящих соединений.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;max_connections&gt;</span>4096<span class=nt>&lt;/max_connections&gt;</span>
</code></pre></div> <h2 id=max-open-files>max_open_files<a class=headerlink href=../amp/#max-open-files title="Permanent link"> </a></h2> <p>Максимальное количество открытых файлов.</p> <p>По умолчанию - <code class=syntax>maximum</code>.</p> <p>Рекомендуется использовать в Mac OS X, поскольку функция <code class=syntax>getrlimit()</code> возвращает некорректное значение.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;max_open_files&gt;</span>262144<span class=nt>&lt;/max_open_files&gt;</span>
</code></pre></div> <h2 id=max-table-size-to-drop>max_table_size_to_drop<a class=headerlink href=../amp/#max-table-size-to-drop title="Permanent link"> </a></h2> <p>Ограничение на удаление таблиц.</p> <p>Если размер таблицы семейства <a href=.././amp/ >MergeTree</a> превышает <code class=syntax>max_table_size_to_drop</code> (в байтах), то ее нельзя удалить запросом DROP.</p> <p>Если таблицу все же необходимо удалить, не перезапуская при этом сервер ClickHouse, то необходимо создать файл <code class=syntax>&lt;clickhouse-path&gt;/flags/force_drop_table</code> и выполнить запрос DROP.</p> <p>Значение по умолчанию - 50GB.</p> <p>Значение 0 означает, что можно удалять все таблицы без ограничений.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;max_table_size_to_drop&gt;</span>0<span class=nt>&lt;/max_table_size_to_drop&gt;</span>
</code></pre></div> <h2 id=max-thread-pool-size>max_thread_pool_size<a class=headerlink href=../amp/#max-thread-pool-size title="Permanent link"> </a></h2> <p>ClickHouse использует потоки из глобального пула потоков для обработки запросов. Если в пуле нет свободных потоков, то в нем создается еще один. Параметр <code class=syntax>max_thread_pool_size</code> ограничивает максимальное количество потоков в пуле.</p> <p>Возможные значения: </p> <ul> <li>Положительное целое число.</li> </ul> <p>Значение по умолчанию: <code class=syntax>10000</code>.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;max_thread_pool_size&gt;</span>12000<span class=nt>&lt;/max_thread_pool_size&gt;</span>
</code></pre></div> <h2 id=max-thread-pool-free-size>max_thread_pool_free_size<a class=headerlink href=../amp/#max-thread-pool-free-size title="Permanent link"> </a></h2> <p>Если в глобальном пуле потоков количество <strong>свободных</strong> потоков больше, чем задано параметром <code class=syntax>max_thread_pool_free_size</code>, то ClickHouse освобождает ресурсы, занятые некоторыми потоками. В таком случае размер пула уменьшается. При необходимости потоки будут созданы заново.</p> <p>Возможные значения: </p> <ul> <li>Положительное целое число.</li> </ul> <p>Значение по умолчанию: <code class=syntax>1000</code>.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;max_thread_pool_free_size&gt;</span>1200<span class=nt>&lt;/max_thread_pool_free_size&gt;</span>
</code></pre></div> <h2 id=thread-pool-queue-size>thread_pool_queue_size<a class=headerlink href=../amp/#thread-pool-queue-size title="Permanent link"> </a></h2> <p>Максимальное количество задач, которые запланированы для выполнения в глобальном пуле потоков. При увеличении этого параметра возрастает использование памяти. Рекомендуется, чтобы значение этого параметра совпадало со значением параметра <a href=../amp/#max-thread-pool-size>max_thread_pool_size</a>.</p> <p>Возможные значения: </p> <ul> <li>Положительное целое число.</li> </ul> <p>Значение по умолчанию: <code class=syntax>10000</code>.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;thread_pool_queue_size&gt;</span>12000<span class=nt>&lt;/thread_pool_queue_size&gt;</span>
</code></pre></div> <h2 id=server_configuration_parameters-merge_tree>merge_tree<a class=headerlink href=../amp/#server_configuration_parameters-merge_tree title="Permanent link"> </a></h2> <p>Тонкая настройка таблиц семейства <a href=.././amp/ >MergeTree</a>.</p> <p>Подробнее смотрите в заголовочном файле MergeTreeSettings.h.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;merge_tree&gt;</span>
    <span class=nt>&lt;max_suspicious_broken_parts&gt;</span>5<span class=nt>&lt;/max_suspicious_broken_parts&gt;</span>
<span class=nt>&lt;/merge_tree&gt;</span>
</code></pre></div> <h2 id=metric_log>metric_log<a class=headerlink href=../amp/#metric_log title="Permanent link"> </a></h2> <p>Эта настройка включена по умолчанию. Если это не так, вы можете включить ее сами.</p> <p><strong>Включение</strong></p> <p>Чтобы вручную включить сбор истории метрик в таблице <a href=../../../system-tables/metric_log/amp/ ><code class=syntax>system.metric_log</code></a>, создайте <code class=syntax>/etc/clickhouse-server/config.d/metric_log.xml</code> следующего содержания:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;clickhouse&gt;</span>
    <span class=nt>&lt;metric_log&gt;</span>
        <span class=nt>&lt;database&gt;</span>system<span class=nt>&lt;/database&gt;</span>
        <span class=nt>&lt;table&gt;</span>metric_log<span class=nt>&lt;/table&gt;</span>
        <span class=nt>&lt;flush_interval_milliseconds&gt;</span>7500<span class=nt>&lt;/flush_interval_milliseconds&gt;</span>
        <span class=nt>&lt;collect_interval_milliseconds&gt;</span>1000<span class=nt>&lt;/collect_interval_milliseconds&gt;</span>
    <span class=nt>&lt;/metric_log&gt;</span>
<span class=nt>&lt;/clickhouse&gt;</span>
</code></pre></div> <p><strong>Выключение</strong></p> <p>Чтобы отключить настройку <code class=syntax>metric_log</code> , создайте файл <code class=syntax>/etc/clickhouse-server/config.d/disable_metric_log.xml</code> следующего содержания:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;clickhouse&gt;</span>
<span class=nt>&lt;metric_log</span> <span class=na>remove=</span><span class=s>"1"</span> <span class=nt>/&gt;</span>
<span class=nt>&lt;/clickhouse&gt;</span>
</code></pre></div> <h2 id=server_configuration_parameters-replicated_merge_tree>replicated_merge_tree<a class=headerlink href=../amp/#server_configuration_parameters-replicated_merge_tree title="Permanent link"> </a></h2> <p>Тонкая настройка таблиц в <a href=../../../../engines/table-engines/mergetree-family/mergetree/amp/ >ReplicatedMergeTree</a>.</p> <p>Эта настройка имеет более высокий приоритет.</p> <p>Подробнее смотрите в заголовочном файле MergeTreeSettings.h.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;replicated_merge_tree&gt;</span>
    <span class=nt>&lt;max_suspicious_broken_parts&gt;</span>5<span class=nt>&lt;/max_suspicious_broken_parts&gt;</span>
<span class=nt>&lt;/replicated_merge_tree&gt;</span>
</code></pre></div> <h2 id=server_configuration_parameters-openssl>openSSL<a class=headerlink href=../amp/#server_configuration_parameters-openssl title="Permanent link"> </a></h2> <p>Настройки клиента/сервера SSL.</p> <p>Поддержку SSL обеспечивает библиотека <code class=syntax>libpoco</code>. Описание интерфейса находится в файле <a href=https://github.com/ClickHouse-Extras/poco/blob/master/NetSSL_OpenSSL/include/Poco/Net/SSLManager.h rel="external nofollow noreferrer" target=_blank>SSLManager.h</a></p> <p>Ключи настроек сервера/клиента:</p> <ul> <li>privateKeyFile - Путь к файлу с секретным ключом сертификата в формате PEM. Файл может содержать ключ и сертификат одновременно.</li> <li>certificateFile - Путь к файлу сертификата клиента/сервера в формате PEM. Можно не указывать, если <code class=syntax>privateKeyFile</code> содержит сертификат.</li> <li>caConfig - Путь к файлу или каталогу, которые содержат доверенные корневые сертификаты.</li> <li>verificationMode - Способ проверки сертификатов узла. Подробности находятся в описании класса <a href=https://github.com/ClickHouse-Extras/poco/blob/master/NetSSL_OpenSSL/include/Poco/Net/Context.h rel="external nofollow noreferrer" target=_blank>Context</a>. Допустимые значения: <code class=syntax>none</code>, <code class=syntax>relaxed</code>, <code class=syntax>strict</code>, <code class=syntax>once</code>.</li> <li>verificationDepth - Максимальная длина верификационной цепи. Верификация завершится ошибкой, если длина цепи сертификатов превысит установленное значение.</li> <li>loadDefaultCAFile - Признак того, что будут использоваться встроенные CA-сертификаты для OpenSSL. Допустимые значения: <code class=syntax>true</code>, <code class=syntax>false</code>. |</li> <li>cipherList - Поддерживаемые OpenSSL-шифры. Например, <code class=syntax>ALL:!ADH:!LOW:!EXP:!MD5:@STRENGTH</code>.</li> <li>cacheSessions - Включение/выключение кеширования сессии. Использовать обязательно вместе с <code class=syntax>sessionIdContext</code>. Допустимые значения: <code class=syntax>true</code>, <code class=syntax>false</code>.</li> <li>sessionIdContext - Уникальный набор произвольных символов, которые сервер добавляет к каждому сгенерированному идентификатору. Длина строки не должна превышать <code class=syntax>SSL_MAX_SSL_SESSION_ID_LENGTH</code>. Рекомендуется к использованию всегда, поскольку позволяет избежать проблем как в случае, если сервер кеширует сессию, так и если клиент затребовал кеширование. По умолчанию <code class=syntax>${application.name}</code>.</li> <li>sessionCacheSize - Максимальное количество сессий, которые кэширует сервер. По умолчанию - 1024*20. 0 - неограниченное количество сессий.</li> <li>sessionTimeout - Время кеширования сессии на сервере.</li> <li>extendedVerification - Автоматическая расширенная проверка сертификатов после завершении сессии. Допустимые значения: <code class=syntax>true</code>, <code class=syntax>false</code>.</li> <li>requireTLSv1 - Требование соединения TLSv1. Допустимые значения: <code class=syntax>true</code>, <code class=syntax>false</code>.</li> <li>requireTLSv1_1 - Требование соединения TLSv1.1. Допустимые значения: <code class=syntax>true</code>, <code class=syntax>false</code>.</li> <li>requireTLSv1_2 - Требование соединения TLSv1.2. Допустимые значения: <code class=syntax>true</code>, <code class=syntax>false</code>.</li> <li>fips - Активация режима OpenSSL FIPS. Поддерживается, если версия OpenSSL, с которой собрана библиотека поддерживает fips.</li> <li>privateKeyPassphraseHandler - Класс (подкласс PrivateKeyPassphraseHandler)запрашивающий кодовую фразу доступа к секретному ключу. Например, <code class=syntax>&lt;privateKeyPassphraseHandler&gt;</code>, <code class=syntax>&lt;name&gt;KeyFileHandler&lt;/name&gt;</code>, <code class=syntax>&lt;options&gt;&lt;password&gt;test&lt;/password&gt;&lt;/options&gt;</code>, <code class=syntax>&lt;/privateKeyPassphraseHandler&gt;</code>.</li> <li>invalidCertificateHandler - Класс (подкласс CertificateHandler) для подтверждения не валидных сертификатов. Например, <code class=syntax>&lt;invalidCertificateHandler&gt; &lt;name&gt;ConsoleCertificateHandler&lt;/name&gt; &lt;/invalidCertificateHandler&gt;</code>.</li> <li>disableProtocols - Запрещенные к использованию протоколы.</li> <li>preferServerCiphers - Предпочтение серверных шифров на клиенте.</li> </ul> <p><strong>Пример настройки:</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;openSSL&gt;</span>
    <span class=nt>&lt;server&gt;</span>
        <span class=cm>&lt;!-- openssl req -subj "/CN=localhost" -new -newkey rsa:2048 -days 365 -nodes -x509 -keyout /etc/clickhouse-server/server.key -out /etc/clickhouse-server/server.crt --&gt;</span>
        <span class=nt>&lt;certificateFile&gt;</span>/etc/clickhouse-server/server.crt<span class=nt>&lt;/certificateFile&gt;</span>
        <span class=nt>&lt;privateKeyFile&gt;</span>/etc/clickhouse-server/server.key<span class=nt>&lt;/privateKeyFile&gt;</span>
        <span class=cm>&lt;!-- openssl dhparam -out /etc/clickhouse-server/dhparam.pem 4096 --&gt;</span>
        <span class=nt>&lt;dhParamsFile&gt;</span>/etc/clickhouse-server/dhparam.pem<span class=nt>&lt;/dhParamsFile&gt;</span>
        <span class=nt>&lt;verificationMode&gt;</span>none<span class=nt>&lt;/verificationMode&gt;</span>
        <span class=nt>&lt;loadDefaultCAFile&gt;</span>true<span class=nt>&lt;/loadDefaultCAFile&gt;</span>
        <span class=nt>&lt;cacheSessions&gt;</span>true<span class=nt>&lt;/cacheSessions&gt;</span>
        <span class=nt>&lt;disableProtocols&gt;</span>sslv2,sslv3<span class=nt>&lt;/disableProtocols&gt;</span>
        <span class=nt>&lt;preferServerCiphers&gt;</span>true<span class=nt>&lt;/preferServerCiphers&gt;</span>
    <span class=nt>&lt;/server&gt;</span>
    <span class=nt>&lt;client&gt;</span>
        <span class=nt>&lt;loadDefaultCAFile&gt;</span>true<span class=nt>&lt;/loadDefaultCAFile&gt;</span>
        <span class=nt>&lt;cacheSessions&gt;</span>true<span class=nt>&lt;/cacheSessions&gt;</span>
        <span class=nt>&lt;disableProtocols&gt;</span>sslv2,sslv3<span class=nt>&lt;/disableProtocols&gt;</span>
        <span class=nt>&lt;preferServerCiphers&gt;</span>true<span class=nt>&lt;/preferServerCiphers&gt;</span>
        <span class=cm>&lt;!-- Use for self-signed: &lt;verificationMode&gt;none&lt;/verificationMode&gt; --&gt;</span>
        <span class=nt>&lt;invalidCertificateHandler&gt;</span>
            <span class=cm>&lt;!-- Use for self-signed: &lt;name&gt;AcceptCertificateHandler&lt;/name&gt; --&gt;</span>
            <span class=nt>&lt;name&gt;</span>RejectCertificateHandler<span class=nt>&lt;/name&gt;</span>
        <span class=nt>&lt;/invalidCertificateHandler&gt;</span>
    <span class=nt>&lt;/client&gt;</span>
<span class=nt>&lt;/openSSL&gt;</span>
</code></pre></div> <h2 id=server_configuration_parameters-part-log>part_log<a class=headerlink href=../amp/#server_configuration_parameters-part-log title="Permanent link"> </a></h2> <p>Логирование событий, связанных с данными типа <a href=../../../../engines/table-engines/mergetree-family/mergetree/amp/ >MergeTree</a>. Например, события добавления или мержа данных. Лог можно использовать для симуляции алгоритмов слияния, чтобы сравнивать их характеристики. Также, можно визуализировать процесс слияния.</p> <p>Запросы логируются не в отдельный файл, а в таблицу <a href=../../../system-tables/part_log/amp/#system_tables-part-log>system.part_log</a>. Вы можете изменить название этой таблицы в параметре <code class=syntax>table</code> (см. ниже).</p> <p>При настройке логирования используются следующие параметры:</p> <ul> <li><code class=syntax>database</code> — имя базы данных;</li> <li><code class=syntax>table</code> — имя таблицы;</li> <li><code class=syntax>partition_by</code> — устанавливает <a href=.././amp/ >произвольный ключ партиционирования</a>. Нельзя использовать если используется <code class=syntax>engine</code></li> <li><code class=syntax>engine</code> - устанавливает <a href=../../../../engines/table-engines/mergetree-family/mergetree/amp/#table_engine-mergetree-creating-a-table>настройки MergeTree Engine</a> для системной таблицы. Нельзя использовать если используется <code class=syntax>partition_by</code>.</li> <li><code class=syntax>flush_interval_milliseconds</code> — период сброса данных из буфера в памяти в таблицу.</li> </ul> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;part_log&gt;</span>
    <span class=nt>&lt;database&gt;</span>system<span class=nt>&lt;/database&gt;</span>
    <span class=nt>&lt;table&gt;</span>part_log<span class=nt>&lt;/table&gt;</span>
    <span class=nt>&lt;partition_by&gt;</span>toMonday(event_date)<span class=nt>&lt;/partition_by&gt;</span>
    <span class=nt>&lt;flush_interval_milliseconds&gt;</span>7500<span class=nt>&lt;/flush_interval_milliseconds&gt;</span>
<span class=nt>&lt;/part_log&gt;</span>
</code></pre></div> <h2 id=server_configuration_parameters-path>path<a class=headerlink href=../amp/#server_configuration_parameters-path title="Permanent link"> </a></h2> <p>Путь к каталогу с данными.</p> <div class="admonition warning alert pb-0 mb-4 alert-warning" role=alert> <p class="admonition-title alert-heading display-4 text-reset mb-2">Обратите внимание</p> <p>Завершающий слеш обязателен.</p> </div> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;path&gt;</span>/var/lib/clickhouse/<span class=nt>&lt;/path&gt;</span>
</code></pre></div> <h2 id=server_configuration_parameters-prometheus>prometheus<a class=headerlink href=../amp/#server_configuration_parameters-prometheus title="Permanent link"> </a></h2> <p>Опубликовать данные о метриках, для сбора с помощью системы мониторинга <a href=https://prometheus.io rel="external nofollow noreferrer" target=_blank>Prometheus</a>.</p> <p>Настройки:</p> <ul> <li><code class=syntax>endpoint</code> – путь по которому будет осуществляться экспорт данных метрик по HTTP протоколу для сбора с помощью prometheus. Должен начинаться с ‘/’.</li> <li><code class=syntax>port</code> – порт по которому будет доступен endpoint для сбора метрик.</li> <li><code class=syntax>metrics</code> – флаг для экспорта текущих значений метрик из таблицы <a href=../../../system-tables/metrics/amp/#system_tables-metrics>system.metrics</a>.</li> <li><code class=syntax>events</code> – флаг для экспорта текущих значений метрик из таблицы <a href=../../../system-tables/events/amp/#system_tables-events>system.events</a>.</li> <li><code class=syntax>asynchronous_metrics</code> – флаг для экспорта текущих значений значения метрик из таблицы <a href=../../../system-tables/asynchronous_metrics/amp/#system_tables-asynchronous_metrics>system.asynchronous_metrics</a>.</li> </ul> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax> <span class=nt>&lt;prometheus&gt;</span>
        <span class=nt>&lt;endpoint&gt;</span>/metrics<span class=nt>&lt;/endpoint&gt;</span>
        <span class=nt>&lt;port&gt;</span>8001<span class=nt>&lt;/port&gt;</span>
        <span class=nt>&lt;metrics&gt;</span>true<span class=nt>&lt;/metrics&gt;</span>
        <span class=nt>&lt;events&gt;</span>true<span class=nt>&lt;/events&gt;</span>
        <span class=nt>&lt;asynchronous_metrics&gt;</span>true<span class=nt>&lt;/asynchronous_metrics&gt;</span>
    <span class=nt>&lt;/prometheus&gt;</span>
</code></pre></div> <h2 id=server_configuration_parameters-query-log>query_log<a class=headerlink href=../amp/#server_configuration_parameters-query-log title="Permanent link"> </a></h2> <p>Настройка логирования запросов, принятых с настройкой <a href=../../../settings/settings/amp/ >log_queries=1</a>.</p> <p>Запросы логируются не в отдельный файл, а в системную таблицу <a href=../../../system-tables/query_log/amp/#system_tables-query_log>system.query_log</a>. Вы можете изменить название этой таблицы в параметре <code class=syntax>table</code> (см. ниже).</p> <p>При настройке логирования используются следующие параметры:</p> <ul> <li><code class=syntax>database</code> — имя базы данных;</li> <li><code class=syntax>table</code> — имя таблицы, куда будет записываться лог;</li> <li><code class=syntax>partition_by</code> — устанавливает <a href=.././amp/ >произвольный ключ партиционирования</a>. Нельзя использовать если используется <code class=syntax>engine</code></li> <li><code class=syntax>engine</code> - устанавливает <a href=../../../../engines/table-engines/mergetree-family/mergetree/amp/#table_engine-mergetree-creating-a-table>настройки MergeTree Engine</a> для системной таблицы. Нельзя использовать если используется <code class=syntax>partition_by</code>.</li> <li><code class=syntax>flush_interval_milliseconds</code> — период сброса данных из буфера в памяти в таблицу.</li> </ul> <p>Если таблица не существует, то ClickHouse создаст её. Если структура журнала запросов изменилась при обновлении сервера ClickHouse, то таблица со старой структурой переименовывается, а новая таблица создается автоматически.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;query_log&gt;</span>
    <span class=nt>&lt;database&gt;</span>system<span class=nt>&lt;/database&gt;</span>
    <span class=nt>&lt;table&gt;</span>query_log<span class=nt>&lt;/table&gt;</span>
    <span class=nt>&lt;engine&gt;</span>Engine = MergeTree PARTITION BY event_date ORDER BY event_time TTL event_date + INTERVAL 30 day<span class=nt>&lt;/engine&gt;</span>
    <span class=nt>&lt;flush_interval_milliseconds&gt;</span>7500<span class=nt>&lt;/flush_interval_milliseconds&gt;</span>
<span class=nt>&lt;/query_log&gt;</span>
</code></pre></div> <h2 id=server_configuration_parameters-query_thread_log>query_thread_log<a class=headerlink href=../amp/#server_configuration_parameters-query_thread_log title="Permanent link"> </a></h2> <p>Настройка логирования потоков выполнения запросов, принятых с настройкой <a href=../../../settings/settings/amp/#settings-log-query-threads>log_query_threads=1</a>.</p> <p>Запросы логируются не в отдельный файл, а в системную таблицу <a href=../../../system-tables/query_thread_log/amp/#system_tables-query_thread_log>system.query_thread_log</a>. Вы можете изменить название этой таблицы в параметре <code class=syntax>table</code> (см. ниже).</p> <p>При настройке логирования используются следующие параметры:</p> <ul> <li><code class=syntax>database</code> — имя базы данных;</li> <li><code class=syntax>table</code> — имя таблицы, куда будет записываться лог;</li> <li><code class=syntax>partition_by</code> — устанавливает <a href=.././amp/ >произвольный ключ партиционирования</a>. Нельзя использовать если используется <code class=syntax>engine</code></li> <li><code class=syntax>engine</code> - устанавливает <a href=../../../../engines/table-engines/mergetree-family/mergetree/amp/#table_engine-mergetree-creating-a-table>настройки MergeTree Engine</a> для системной таблицы. Нельзя использовать если используется <code class=syntax>partition_by</code>.</li> <li><code class=syntax>flush_interval_milliseconds</code> — период сброса данных из буфера в памяти в таблицу.</li> </ul> <p>Если таблица не существует, то ClickHouse создаст её. Если структура журнала запросов изменилась при обновлении сервера ClickHouse, то таблица со старой структурой переименовывается, а новая таблица создается автоматически.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;query_thread_log&gt;</span>
    <span class=nt>&lt;database&gt;</span>system<span class=nt>&lt;/database&gt;</span>
    <span class=nt>&lt;table&gt;</span>query_thread_log<span class=nt>&lt;/table&gt;</span>
    <span class=nt>&lt;partition_by&gt;</span>toMonday(event_date)<span class=nt>&lt;/partition_by&gt;</span>
    <span class=nt>&lt;flush_interval_milliseconds&gt;</span>7500<span class=nt>&lt;/flush_interval_milliseconds&gt;</span>
<span class=nt>&lt;/query_thread_log&gt;</span>
</code></pre></div> <h2 id=server_configuration_parameters-query_views_log>query_views_log<a class=headerlink href=../amp/#server_configuration_parameters-query_views_log title="Permanent link"> </a></h2> <p>Настройки логирования информации о зависимых представлениях (materialized, live и т.п.) в запросах принятых с настройкой <a href=../../../settings/settings/amp/#settings-log-query-views>log_query_views=1</a>.</p> <p>Запросы логируются в таблице <a href=../../../system-tables/query_views_log/amp/#system_tables-query_views_log>system.query_views_log</a>. Вы можете изменить название этой таблицы в параметре <code class=syntax>table</code> (см. ниже).</p> <p>При настройке логирования используются следующие параметры:</p> <ul> <li><code class=syntax>database</code> – имя базы данных.</li> <li><code class=syntax>table</code> – имя системной таблицы, где будут логироваться запросы.</li> <li><code class=syntax>partition_by</code> — устанавливает <a href=../../../../engines/table-engines/mergetree-family/custom-partitioning-key/amp/ >произвольный ключ партиционирования</a>. Нельзя использовать, если задан параметр <code class=syntax>engine</code>.</li> <li><code class=syntax>engine</code> — устанавливает <a href=../../../../engines/table-engines/mergetree-family/mergetree/amp/#table_engine-mergetree-creating-a-table>настройки MergeTree Engine</a> для системной таблицы. Нельзя использовать, если задан параметр <code class=syntax>partition_by</code>.</li> <li><code class=syntax>flush_interval_milliseconds</code> — период сброса данных из буфера в памяти в таблицу.</li> </ul> <p>Если таблица не существует, то ClickHouse создаст её. Если структура журнала запросов изменилась при обновлении сервера ClickHouse, то таблица со старой структурой переименовывается, а новая таблица создается автоматически.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;query_views_log&gt;</span>
    <span class=nt>&lt;database&gt;</span>system<span class=nt>&lt;/database&gt;</span>
    <span class=nt>&lt;table&gt;</span>query_views_log<span class=nt>&lt;/table&gt;</span>
    <span class=nt>&lt;partition_by&gt;</span>toYYYYMM(event_date)<span class=nt>&lt;/partition_by&gt;</span>
    <span class=nt>&lt;flush_interval_milliseconds&gt;</span>7500<span class=nt>&lt;/flush_interval_milliseconds&gt;</span>
<span class=nt>&lt;/query_views_log&gt;</span>
</code></pre></div> <h2 id=server_configuration_parameters-text_log>text_log<a class=headerlink href=../amp/#server_configuration_parameters-text_log title="Permanent link"> </a></h2> <p>Настройка логирования текстовых сообщений в системную таблицу <a href=../../../system-tables/text_log/amp/#system_tables-text_log>text_log</a>.</p> <p>Параметры:</p> <ul> <li><code class=syntax>level</code> — Максимальный уровень сообщения (по умолчанию <code class=syntax>Trace</code>) которое будет сохранено в таблице.</li> <li><code class=syntax>database</code> — имя базы данных для хранения таблицы.</li> <li><code class=syntax>table</code> — имя таблицы, куда будут записываться текстовые сообщения.</li> <li><code class=syntax>partition_by</code> — устанавливает <a href=../../../../engines/table-engines/mergetree-family/custom-partitioning-key/amp/ >произвольный ключ партиционирования</a>. Нельзя использовать если используется <code class=syntax>engine</code></li> <li><code class=syntax>engine</code> - устанавливает <a href=../../../../engines/table-engines/mergetree-family/mergetree/amp/#table_engine-mergetree-creating-a-table>настройки MergeTree Engine</a> для системной таблицы. Нельзя использовать если используется <code class=syntax>partition_by</code>.</li> <li><code class=syntax>flush_interval_milliseconds</code> — период сброса данных из буфера в памяти в таблицу.</li> </ul> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;clickhouse&gt;</span>
    <span class=nt>&lt;text_log&gt;</span>
        <span class=nt>&lt;level&gt;</span>notice<span class=nt>&lt;/level&gt;</span>
        <span class=nt>&lt;database&gt;</span>system<span class=nt>&lt;/database&gt;</span>
        <span class=nt>&lt;table&gt;</span>text_log<span class=nt>&lt;/table&gt;</span>
        <span class=nt>&lt;flush_interval_milliseconds&gt;</span>7500<span class=nt>&lt;/flush_interval_milliseconds&gt;</span>
        <span class=cm>&lt;!-- &lt;partition_by&gt;event_date&lt;/partition_by&gt; --&gt;</span>
        <span class=nt>&lt;engine&gt;</span>Engine = MergeTree PARTITION BY event_date ORDER BY event_time TTL event_date + INTERVAL 30 day<span class=nt>&lt;/engine&gt;</span>
    <span class=nt>&lt;/text_log&gt;</span>
<span class=nt>&lt;/clickhouse&gt;</span>
</code></pre></div> <h2 id=server_configuration_parameters-trace_log>trace_log<a class=headerlink href=../amp/#server_configuration_parameters-trace_log title="Permanent link"> </a></h2> <p>Настройки для <a href=../../../system-tables/trace_log/amp/#system_tables-trace_log>trace_log</a> system table operation.</p> <p>Parameters:</p> <ul> <li><code class=syntax>database</code> — Database for storing a table.</li> <li><code class=syntax>table</code> — Table name.</li> <li><code class=syntax>partition_by</code> — устанавливает <a href=.././amp/ >произвольный ключ партиционирования</a>. Нельзя использовать если используется <code class=syntax>engine</code></li> <li><code class=syntax>engine</code> - устанавливает <a href=../../../../engines/table-engines/mergetree-family/mergetree/amp/#table_engine-mergetree-creating-a-table>настройки MergeTree Engine</a> для системной таблицы. Нельзя использовать если используется <code class=syntax>partition_by</code>.</li> <li><code class=syntax>flush_interval_milliseconds</code> — Interval for flushing data from the buffer in memory to the table.</li> </ul> <p>По умолчанию файл настроек сервера <code class=syntax>config.xml</code> содержит следующие настройки:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;trace_log&gt;</span>
    <span class=nt>&lt;database&gt;</span>system<span class=nt>&lt;/database&gt;</span>
    <span class=nt>&lt;table&gt;</span>trace_log<span class=nt>&lt;/table&gt;</span>
    <span class=nt>&lt;partition_by&gt;</span>toYYYYMM(event_date)<span class=nt>&lt;/partition_by&gt;</span>
    <span class=nt>&lt;flush_interval_milliseconds&gt;</span>7500<span class=nt>&lt;/flush_interval_milliseconds&gt;</span>
<span class=nt>&lt;/trace_log&gt;</span>
</code></pre></div> <h2 id=query-masking-rules>query_masking_rules<a class=headerlink href=../amp/#query-masking-rules title="Permanent link"> </a></h2> <p>Правила, основанные на регулярных выражениях, которые будут применены для всех запросов, а также для всех сообщений перед сохранением их в лог на сервере,<br> <code class=syntax>system.query_log</code>, <code class=syntax>system.text_log</code>, <code class=syntax>system.processes</code> таблицы, а также в логах, отсылаемых клиенту. Это позволяет предотвратить утечку конфиденциальных данных из SQL запросов (такие как имена, электронные письма, личные идентификаторы или номера кредитных карт) в логи.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;query_masking_rules&gt;</span>
    <span class=nt>&lt;rule&gt;</span>
        <span class=nt>&lt;name&gt;</span>hide SSN<span class=nt>&lt;/name&gt;</span>
        <span class=nt>&lt;regexp&gt;</span>(^|\D)\d{3}-\d{2}-\d{4}($|\D)<span class=nt>&lt;/regexp&gt;</span>
        <span class=nt>&lt;replace&gt;</span>000-00-0000<span class=nt>&lt;/replace&gt;</span>
    <span class=nt>&lt;/rule&gt;</span>
<span class=nt>&lt;/query_masking_rules&gt;</span>
</code></pre></div> <p>Параметры конфигурации:<br> - <code class=syntax>name</code> - имя правила (необязательно)<br> - <code class=syntax>regexp</code> - совместимое с RE2 регулярное выражение (обязательное)<br> - <code class=syntax>replace</code> - строка замены для конфиденциальных данных (опционально, по умолчанию - шесть звездочек)</p> <p>Правила маскировки применяются ко всему запросу (для предотвращения утечки конфиденциальных данных из неправильно оформленных / не интерпретируемых запросов).</p> <p><code class=syntax>system.events</code> таблица содержит счетчик <code class=syntax>QueryMaskingRulesMatch</code> который считает общее кол-во совпадений правил маскировки.</p> <p>Для распределенных запросов каждый сервер должен быть сконфигурирован отдельно, иначе, подзапросы,<br> переданные на другие узлы, будут сохраняться без маскировки.</p> <h2 id=server-settings-remote-servers>remote_servers<a class=headerlink href=../amp/#server-settings-remote-servers title="Permanent link"> </a></h2> <p>Конфигурация кластеров, которые использует движок таблиц <a href=.././amp/ >Distributed</a> и табличная функция <code class=syntax>cluster</code>.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;remote_servers</span> <span class=na>incl=</span><span class=s>"clickhouse_remote_servers"</span> <span class=nt>/&gt;</span>
</code></pre></div> <p>Значение атрибута <code class=syntax>incl</code> смотрите в разделе «<a href=../../../configuration-files/amp/#configuration_files>Конфигурационные файлы</a>».</p> <p><strong>Смотрите также</strong></p> <ul> <li><a href=../../../settings/settings/amp/#settings-skip_unavailable_shards>skip_unavailable_shards</a></li> </ul> <h2 id=server_configuration_parameters-timezone>timezone<a class=headerlink href=../amp/#server_configuration_parameters-timezone title="Permanent link"> </a></h2> <p>Временная зона сервера.</p> <p>Указывается идентификатором IANA в виде часового пояса UTC или географического положения (например, Africa/Abidjan).</p> <p>Временная зона необходима при преобразованиях между форматами String и DateTime, которые возникают при выводе полей DateTime в текстовый формат (на экран или в файл) и при получении DateTime из строки. Также, временная зона используется в функциях, которые работают со временем и датой, если они не получили временную зону в параметрах вызова.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;timezone&gt;</span>Europe/Moscow<span class=nt>&lt;/timezone&gt;</span>
</code></pre></div> <h2 id=server_configuration_parameters-tcp_port>tcp_port<a class=headerlink href=../amp/#server_configuration_parameters-tcp_port title="Permanent link"> </a></h2> <p>Порт для взаимодействия с клиентами по протоколу TCP.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;tcp_port&gt;</span>9000<span class=nt>&lt;/tcp_port&gt;</span>
</code></pre></div> <h2 id=server_configuration_parameters-tcp_port_secure>tcp_port_secure<a class=headerlink href=../amp/#server_configuration_parameters-tcp_port_secure title="Permanent link"> </a></h2> <p>TCP порт для защищённого обмена данными с клиентами. Используйте с настройкой <a href=../amp/#server_configuration_parameters-openssl>OpenSSL</a>.</p> <p><strong>Возможные значения</strong></p> <p>Положительное целое число.</p> <p><strong>Значение по умолчанию</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;tcp_port_secure&gt;</span>9440<span class=nt>&lt;/tcp_port_secure&gt;</span>
</code></pre></div> <h2 id=server_configuration_parameters-mysql_port>mysql_port<a class=headerlink href=../amp/#server_configuration_parameters-mysql_port title="Permanent link"> </a></h2> <p>Порт для взаимодействия с клиентами по протоколу MySQL.</p> <p><strong>Возможные значения</strong></p> <p>Положительное целое.</p> <p>Пример</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;mysql_port&gt;</span>9004<span class=nt>&lt;/mysql_port&gt;</span>
</code></pre></div> <h2 id=tmp-path>tmp_path<a class=headerlink href=../amp/#tmp-path title="Permanent link"> </a></h2> <p>Путь ко временным данным для обработки больших запросов.</p> <div class="admonition warning alert pb-0 mb-4 alert-warning" role=alert> <p class="admonition-title alert-heading display-4 text-reset mb-2">Обратите внимание</p> <p>Завершающий слеш обязателен.</p> </div> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;tmp_path&gt;</span>/var/lib/clickhouse/tmp/<span class=nt>&lt;/tmp_path&gt;</span>
</code></pre></div> <h2 id=tmp-policy>tmp_policy<a class=headerlink href=../amp/#tmp-policy title="Permanent link"> </a></h2> <p>Политика из <a href=../../../../engines/table-engines/mergetree-family/mergetree/amp/#table_engine-mergetree-multiple-volumes>storage_configuration</a> для хранения временных файлов.</p> <p>Если политика не задана, используется <a href=../amp/#tmp-path>tmp_path</a>. В противном случае <code class=syntax>tmp_path</code> игнорируется.</p> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-4 text-reset mb-2">Примечание</p> <ul> <li><code class=syntax>move_factor</code> игнорируется.</li> <li><code class=syntax>keep_free_space_bytes</code> игнорируется.</li> <li><code class=syntax>max_data_part_size_bytes</code> игнорируется.</li> <li>В данной политике у вас должен быть ровно один том.</li> </ul> </div> <h2 id=server-settings-uncompressed_cache_size>uncompressed_cache_size<a class=headerlink href=../amp/#server-settings-uncompressed_cache_size title="Permanent link"> </a></h2> <p>Размер кеша (в байтах) для несжатых данных, используемых движками таблиц семейства <a href=.././amp/ >MergeTree</a>.</p> <p>Кеш единый для сервера. Память выделяется по требованию. Кеш используется в том случае, если включена опция <a href=../../../settings/settings/amp/ >use_uncompressed_cache</a>.</p> <p>Несжатый кеш выгодно использовать для очень коротких запросов в отдельных случаях.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;uncompressed_cache_size&gt;</span>8589934592<span class=nt>&lt;/uncompressed_cache_size&gt;</span>
</code></pre></div> <h2 id=server_configuration_parameters-user_files_path>user_files_path<a class=headerlink href=../amp/#server_configuration_parameters-user_files_path title="Permanent link"> </a></h2> <p>Каталог с пользовательскими файлами. Используется в табличной функции <a href=.././amp/ >file()</a>.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;user_files_path&gt;</span>/var/lib/clickhouse/user_files/<span class=nt>&lt;/user_files_path&gt;</span>
</code></pre></div> <h2 id=users-config>users_config<a class=headerlink href=../amp/#users-config title="Permanent link"> </a></h2> <p>Путь к файлу, который содержит:</p> <ul> <li>Конфигурации пользователей.</li> <li>Права доступа.</li> <li>Профили настроек.</li> <li>Настройки квот.</li> </ul> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;users_config&gt;</span>users.xml<span class=nt>&lt;/users_config&gt;</span>
</code></pre></div> <h2 id=server-settings_zookeeper>zookeeper<a class=headerlink href=../amp/#server-settings_zookeeper title="Permanent link"> </a></h2> <p>Содержит параметры, позволяющие ClickHouse взаимодействовать с кластером <a href=http://zookeeper.apache.org/ rel="external nofollow noreferrer" target=_blank>ZooKeeper</a>.</p> <p>ClickHouse использует ZooKeeper для хранения метаданных о репликах при использовании реплицированных таблиц. Если реплицированные таблицы не используются, этот раздел параметров может отсутствовать.</p> <p>Раздел содержит следующие параметры:</p> <ul> <li> <p><code class=syntax>node</code> — адрес ноды (сервера) ZooKeeper. Можно сконфигурировать несколько нод.</p> <p>Например:</p> </li> </ul> <!-- --> <div class=codehilite><pre><span></span><code class=syntax>    <span class=nt>&lt;node</span> <span class=na>index=</span><span class=s>"1"</span><span class=nt>&gt;</span>
        <span class=nt>&lt;host&gt;</span>example_host<span class=nt>&lt;/host&gt;</span>
        <span class=nt>&lt;port&gt;</span>2181<span class=nt>&lt;/port&gt;</span>
    <span class=nt>&lt;/node&gt;</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=w>  </span><span class=n>Атрибут</span><span class=w> </span><span class="n n-Quoted">`index`</span><span class=w> </span><span class=n>задает</span><span class=w> </span><span class=n>порядок</span><span class=w> </span><span class=n>опроса</span><span class=w> </span><span class=n>нод</span><span class=w> </span><span class=n>при</span><span class=w> </span><span class=n>попытках</span><span class=w> </span><span class=n>подключиться</span><span class=w> </span><span class=n>к</span><span class=w> </span><span class=n>кластеру</span><span class=w> </span><span class=n>ZooKeeper</span><span class=p>.</span><span class=w></span>
</code></pre></div> <ul> <li><code class=syntax>session_timeout_ms</code> — максимальный таймаут клиентской сессии в миллисекундах.</li> <li><code class=syntax>operation_timeout_ms</code> — максимальный таймаут для одной операции в миллисекундах.</li> <li><code class=syntax>root</code> — <a href=http://zookeeper.apache.org/doc/r3.5.5/zookeeperOver.html#Nodes+and+ephemeral+nodes rel="external nofollow noreferrer" target=_blank>znode</a>, который используется как корневой для всех znode, которые использует сервер ClickHouse. Необязательный.</li> <li><code class=syntax>identity</code> — пользователь и пароль, которые может потребовать ZooKeeper для доступа к запрошенным znode. Необязательный.</li> </ul> <p><strong>Пример конфигурации</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;zookeeper&gt;</span>
    <span class=nt>&lt;node&gt;</span>
        <span class=nt>&lt;host&gt;</span>example1<span class=nt>&lt;/host&gt;</span>
        <span class=nt>&lt;port&gt;</span>2181<span class=nt>&lt;/port&gt;</span>
    <span class=nt>&lt;/node&gt;</span>
    <span class=nt>&lt;node&gt;</span>
        <span class=nt>&lt;host&gt;</span>example2<span class=nt>&lt;/host&gt;</span>
        <span class=nt>&lt;port&gt;</span>2181<span class=nt>&lt;/port&gt;</span>
    <span class=nt>&lt;/node&gt;</span>
    <span class=nt>&lt;session_timeout_ms&gt;</span>30000<span class=nt>&lt;/session_timeout_ms&gt;</span>
    <span class=nt>&lt;operation_timeout_ms&gt;</span>10000<span class=nt>&lt;/operation_timeout_ms&gt;</span>
    <span class=cm>&lt;!-- Optional. Chroot suffix. Should exist. --&gt;</span>
    <span class=nt>&lt;root&gt;</span>/path/to/zookeeper/node<span class=nt>&lt;/root&gt;</span>
    <span class=cm>&lt;!-- Optional. Zookeeper digest ACL string. --&gt;</span>
    <span class=nt>&lt;identity&gt;</span>user:password<span class=nt>&lt;/identity&gt;</span>
<span class=nt>&lt;/zookeeper&gt;</span>
</code></pre></div> <p><strong>Смотрите также</strong></p> <ul> <li><a href=../../../../engines/table-engines/mergetree-family/replication/amp/ >Репликация</a></li> <li><a href=http://zookeeper.apache.org/doc/current/zookeeperProgrammers.html rel="external nofollow noreferrer" target=_blank>ZooKeeper Programmer’s Guide</a></li> </ul> <h2 id=server-settings-use_minimalistic_part_header_in_zookeeper>use_minimalistic_part_header_in_zookeeper<a class=headerlink href=../amp/#server-settings-use_minimalistic_part_header_in_zookeeper title="Permanent link"> </a></h2> <p>Способ хранения заголовков кусков данных в ZooKeeper.</p> <p>Параметр применяется только к семейству таблиц <code class=syntax>MergeTree</code>. Его можно установить:</p> <ul> <li> <p>Глобально в разделе <a href=../amp/#server_configuration_parameters-merge_tree>merge_tree</a> файла <code class=syntax>config.xml</code>.</p> <p>ClickHouse использует этот параметр для всех таблиц на сервере. Вы можете изменить настройку в любое время. Существующие таблицы изменяют свое поведение при изменении параметра.</p> </li> <li> <p>Для каждой отдельной таблицы.</p> <p>При создании таблицы укажите соответствующую <a href=.././amp/#table_engine-mergetree-creating-a-table>настройку движка</a>. Поведение существующей таблицы с установленным параметром не изменяется даже при изменении глобального параметра.</p> </li> </ul> <p><strong>Возможные значения</strong></p> <ul> <li>0 — функциональность выключена.</li> <li>1 — функциональность включена.</li> </ul> <p>Если <code class=syntax>use_minimalistic_part_header_in_zookeeper = 1</code>, то <a href=.././amp/ >реплицированные</a> таблицы хранят заголовки кусков данных в компактном виде, используя только одну <code class=syntax>znode</code>. Если таблица содержит много столбцов, этот метод хранения значительно уменьшает объём данных, хранящихся в Zookeeper.</p> <div class="admonition attention alert pb-0 mb-4 alert-warning" role=alert> <p class="admonition-title alert-heading display-4 text-reset mb-2">Внимание</p> <p>После того как вы установили <code class=syntax>use_minimalistic_part_header_in_zookeeper = 1</code>, невозможно откатить ClickHouse до версии, которая не поддерживает этот параметр. Будьте осторожны при обновлении ClickHouse на серверах в кластере. Не обновляйте все серверы сразу. Безопаснее проверять новые версии ClickHouse в тестовой среде или только на некоторых серверах кластера.</p> <p>Заголовки частей данных, ранее сохранённые с этим параметром, не могут быть восстановлены в их предыдущем (некомпактном) представлении.</p> </div> <p><strong>Значение по умолчанию</strong>: 0.</p> <h2 id=server-settings-disable-internal-dns-cache>disable_internal_dns_cache<a class=headerlink href=../amp/#server-settings-disable-internal-dns-cache title="Permanent link"> </a></h2> <p>Отключает внутренний кеш DNS записей. Используется при эксплуатации ClickHouse в системах<br> с часто меняющейся инфраструктурой, таких как Kubernetes.</p> <p><strong>Значение по умолчанию</strong>: 0.</p> <h2 id=server-settings-dns-cache-update-period>dns_cache_update_period<a class=headerlink href=../amp/#server-settings-dns-cache-update-period title="Permanent link"> </a></h2> <p>Период обновления IP адресов у записей во внутреннем DNS кеше ClickHouse (в секундах).<br> Обновление выполняется асинхронно, отдельным системным потоком.</p> <p><strong>Значение по умолчанию</strong>: 15.</p> <p><strong>Смотрите также</strong></p> <ul> <li><a href=../../../settings/settings/amp/#background_schedule_pool_size>background_schedule_pool_size</a></li> </ul> <h2 id=server-settings-distributed_ddl>distributed_ddl<a class=headerlink href=../amp/#server-settings-distributed_ddl title="Permanent link"> </a></h2> <p>Управление запуском <a href=../../../../sql-reference/distributed-ddl/amp/ >распределенных ddl запросов</a> (CREATE, DROP, ALTER, RENAME) в кластере.<br> Работает только если разрешена <a href=../amp/#server-settings_zookeeper>работа с ZooKeeper</a>.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;distributed_ddl&gt;</span>
    <span class=cm>&lt;!-- Путь в ZooKeeper для очереди содержащей DDL запросы --&gt;</span>
    <span class=nt>&lt;path&gt;</span>/clickhouse/task_queue/ddl<span class=nt>&lt;/path&gt;</span>

    <span class=cm>&lt;!-- Настройки из этого профиля будут использованы для запуска DDL запросов --&gt;</span>
    <span class=nt>&lt;profile&gt;</span>default<span class=nt>&lt;/profile&gt;</span>

    <span class=cm>&lt;!-- Контроль того как много ON CLUSTER запросов могут исполняться одновременно. --&gt;</span>
    <span class=nt>&lt;pool_size&gt;</span>1<span class=nt>&lt;/pool_size&gt;</span>

    <span class=cm>&lt;!--</span>
<span class=cm>         Настройки очистки (активные задачи в очереди не будут удаляться)</span>
<span class=cm>    --&gt;</span>

    <span class=cm>&lt;!-- Время TTL для задач в секундах (по умолчанию 1 week) --&gt;</span>
    <span class=nt>&lt;task_max_lifetime&gt;</span>604800<span class=nt>&lt;/task_max_lifetime&gt;</span>

    <span class=cm>&lt;!-- Как часто будет запускаться очистка данных  (в секундах) --&gt;</span>
    <span class=nt>&lt;cleanup_delay_period&gt;</span>60<span class=nt>&lt;/cleanup_delay_period&gt;</span>

    <span class=cm>&lt;!-- Как много задач может быть в очереди --&gt;</span>
    <span class=nt>&lt;max_tasks_in_queue&gt;</span>1000<span class=nt>&lt;/max_tasks_in_queue&gt;</span>
<span class=nt>&lt;/distributed_ddl&gt;</span>
</code></pre></div> <h2 id=access_control_path>access_control_path<a class=headerlink href=../amp/#access_control_path title="Permanent link"> </a></h2> <p>Путь к каталогу, где сервер ClickHouse хранит конфигурации пользователей и ролей, созданные командами SQL.</p> <p>Значение по умолчанию: <code class=syntax>/var/lib/clickhouse/access/</code>.</p> <p><strong>Смотрите также</strong></p> <ul> <li><a href=../../../access-rights/amp/#access-control>Управление доступом</a></li> </ul> <h2 id=user_directories>user_directories<a class=headerlink href=../amp/#user_directories title="Permanent link"> </a></h2> <p>Секция конфигурационного файла,которая содержит настройки:<br> - Путь к конфигурационному файлу с предустановленными пользователями.<br> - Путь к файлу, в котором содержатся пользователи, созданные при помощи SQL команд.<br> - Путь к узлу ZooKeeper, где хранятся и реплицируются пользователи, созданные с помощью команд SQL (экспериментальная функциональность).</p> <p>Если эта секция определена, путь из <a href=.././amp/#users-config>users_config</a> и <a href=.././amp/#access_control_path>access_control_path</a> не используется.</p> <p>Секция <code class=syntax>user_directories</code> может содержать любое количество элементов, порядок расположения элементов обозначает их приоритет (чем выше элемент, тем выше приоритет).</p> <p><strong>Примеры</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;user_directories&gt;</span>
    <span class=nt>&lt;users_xml&gt;</span>
        <span class=nt>&lt;path&gt;</span>/etc/clickhouse-server/users.xml<span class=nt>&lt;/path&gt;</span>
    <span class=nt>&lt;/users_xml&gt;</span>
    <span class=nt>&lt;local_directory&gt;</span>
        <span class=nt>&lt;path&gt;</span>/var/lib/clickhouse/access/<span class=nt>&lt;/path&gt;</span>
    <span class=nt>&lt;/local_directory&gt;</span>
<span class=nt>&lt;/user_directories&gt;</span>
</code></pre></div> <p>Пользователи, роли, политики доступа к строкам, квоты и профили могут храниться в ZooKeeper:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;user_directories&gt;</span>
    <span class=nt>&lt;users_xml&gt;</span>
        <span class=nt>&lt;path&gt;</span>/etc/clickhouse-server/users.xml<span class=nt>&lt;/path&gt;</span>
    <span class=nt>&lt;/users_xml&gt;</span>
    <span class=nt>&lt;replicated&gt;</span>
        <span class=nt>&lt;zookeeper_path&gt;</span>/clickhouse/access/<span class=nt>&lt;/zookeeper_path&gt;</span>
    <span class=nt>&lt;/replicated&gt;</span>
<span class=nt>&lt;/user_directories&gt;</span>
</code></pre></div> <p>Также вы можете добавить секции <code class=syntax>memory</code> — означает хранение информации только в памяти, без записи на диск, и <code class=syntax>ldap</code> — означает хранения информации на <a href=https://en.wikipedia.org/wiki/Lightweight_Directory_Access_Protocol rel="external nofollow noreferrer" target=_blank>LDAP-сервере</a>.</p> <p>Чтобы добавить LDAP-сервер в качестве удаленного каталога пользователей, которые не определены локально, определите один раздел <code class=syntax>ldap</code> со следующими параметрами:<br> - <code class=syntax>server</code> — имя одного из LDAP-серверов, определенных в секции <code class=syntax>ldap_servers</code> конфигурационного файла. Этот параметр является необязательным и может быть пустым.<br> - <code class=syntax>roles</code> — раздел со списком локально определенных ролей, которые будут назначены каждому пользователю, полученному с LDAP-сервера. Если роли не заданы, пользователь не сможет выполнять никаких действий после аутентификации. Если какая-либо из перечисленных ролей не определена локально во время проверки подлинности, попытка проверки подлинности завершится неудачей, как если бы предоставленный пароль был неверным.</p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;ldap&gt;</span>
    <span class=nt>&lt;server&gt;</span>my_ldap_server<span class=nt>&lt;/server&gt;</span>
        <span class=nt>&lt;roles&gt;</span>
            <span class=nt>&lt;my_local_role1</span> <span class=nt>/&gt;</span>
            <span class=nt>&lt;my_local_role2</span> <span class=nt>/&gt;</span>
        <span class=nt>&lt;/roles&gt;</span>
<span class=nt>&lt;/ldap&gt;</span>
</code></pre></div> <h2 id=total-memory-profiler-step>total_memory_profiler_step<a class=headerlink href=../amp/#total-memory-profiler-step title="Permanent link"> </a></h2> <p>Задает размер памяти (в байтах) для трассировки стека на каждом шаге выделения максимума памяти. Данные хранятся в системной таблице <a href=../../../system-tables/trace_log/amp/ >system.trace_log</a> с <code class=syntax>query_id</code>, равным пустой строке.</p> <p>Возможные значения:</p> <ul> <li>Положительное целое число.</li> </ul> <p>Значение по умолчанию: <code class=syntax>4194304</code>.</p> <h2 id=total-memory-tracker-sample-probability>total_memory_tracker_sample_probability<a class=headerlink href=../amp/#total-memory-tracker-sample-probability title="Permanent link"> </a></h2> <p>Позволяет собирать случайные выделения и освобождения памяти и записывать их в системную таблицу <a href=../../../system-tables/trace_log/amp/ >system.trace_log</a> с <code class=syntax>trace_type</code>, равным <code class=syntax>MemorySample</code>, с указанной вероятностью. Вероятность касается каждого выделения или освобождения памяти, независимо от размера выделения. Обратите внимание, что выборка происходит только тогда, когда объем неотслеживаемой памяти превышает лимит неотслеживаемой памяти (значение по умолчанию: <code class=syntax>4</code> MiB). Значение настройки может быть уменьшено, если значение настройки <a href=../amp/#total-memory-profiler-step>total_memory_profiler_step</a> уменьшено. Вы можете установить значение настройки <code class=syntax>total_memory_profiler_step</code>, равным <code class=syntax>1</code>, для особой детализованной выборки.</p> <p>Возможные значения:</p> <ul> <li>Положительное целое число.</li> <li>0 — запись случайных выделений и освобождений памяти в системную таблицу <code class=syntax>system.trace_log</code> отключена.</li> </ul> <p>Значение по умолчанию: <code class=syntax>0</code>.</p> <h2 id=mmap-cache-size>mmap_cache_size<a class=headerlink href=../amp/#mmap-cache-size title="Permanent link"> </a></h2> <p>Задает размер кеша (в байтах) для сопоставленных файлов. Эта настройка позволяет избежать частых открытых/<a href=https://en.wikipedia.org/wiki/Mmap rel="external nofollow noreferrer" target=_blank>mmap/munmap</a>/закрытых вызовов (очень дорогостоящие из-за последующих ошибок страниц) и повторного использования сопоставления из нескольких потоков и запросов. Значение настройки — это количество сопоставленных областей (обычно равно количеству сопоставленных файлов). Объем данных в сопоставленных файлах можно отслеживать в системных таблицах <a href=../../../system-tables/metrics/amp/ >system.metrics</a>, <a href=../../../system-tables/metric_log/amp/ >system.metric_log</a> по метрикам <code class=syntax>MMappedFiles</code> и <code class=syntax>MMappedFileBytes</code>, в таблицах <a href=../../../system-tables/asynchronous_metrics/amp/ >system.asynchronous_metrics</a>, <a href=../../../system-tables/asynchronous_metric_log/amp/ >system.asynchronous_metrics_log</a> по метрике <code class=syntax>MMapCacheCells</code>, а также в <a href=../../../system-tables/events/amp/ >system.events</a>, <a href=../../../system-tables/processes/amp/ >system.processes</a>, <a href=../../../system-tables/query_log/amp/ >system.query_log</a>, <a href=../../../system-tables/query_thread_log/amp/ >system.query_thread_log</a>, <a href=../../../system-tables/query_views_log/amp/ >system.query_views_log</a> по событиям <code class=syntax>CreatedReadBufferMMap</code>, <code class=syntax>CreatedReadBufferMMapFailed</code>, <code class=syntax>MMappedFileCacheHits</code>, <code class=syntax>MMappedFileCacheMisses</code>. Обратите внимание, что объем данных в сопоставленных файлах не потребляет память напрямую и не учитывается в запросе или использовании памяти сервера, поскольку эта память может быть удалена аналогично кешу страниц ОС. Кеш удаляется (т.е. файлы закрываются) автоматически при удалении старых кусков в таблицах семейства <a href=../../../../engines/table-engines/mergetree-family/mergetree/amp/ >MergeTree</a>, также его можно удалить вручную с помощью запроса <code class=syntax>SYSTEM DROP MMAP CACHE</code>.</p> <p>Возможные значения:</p> <ul> <li>Положительное целое число.</li> </ul> <p>Значение по умолчанию: <code class=syntax>1000</code>.</p> <h2 id=compiled-expression-cache-size>compiled_expression_cache_size<a class=headerlink href=../amp/#compiled-expression-cache-size title="Permanent link"> </a></h2> <p>Задает размер кеша (в байтах) для <a href=../../../caches/amp/ >скомпилированных выражений</a>.</p> <p>Возможные значения:</p> <ul> <li>Положительное целое число.</li> </ul> <p>Значение по умолчанию: <code class=syntax>134217728</code>.</p> <h2 id=compiled_expression_cache_elements_size>compiled_expression_cache_elements_size<a class=headerlink href=../amp/#compiled_expression_cache_elements_size title="Permanent link"> </a></h2> <p>Задает размер кеша (в элементах) для <a href=../../../caches/amp/ >скомпилированных выражений</a>.</p> <p>Возможные значения:</p> <ul> <li>Положительное целое число.</li> </ul> <p>Значение по умолчанию: <code class=syntax>10000</code>.</p>
        </div>
      </div>
      <div class="row">
        <div class="col">
          
<div class="alert alert-light my-3">
  <p class="float-right mb-0">Rating: RATING_VALUE - RATING_COUNT votes</p>
  <span class="alert-heading display-6">Article Rating</span>
  <div id="rating-stars" class="display-6 mb-0"
     
  >RATING_STARS</div>
</div>

<div id="content-footer" class="text-muted pt-3 mb-5">
    <div class="float-md-right">©2016–2022 ClickHouse, Inc.</div>
    <div>Built from <a href="https://github.com/ClickHouse/ClickHouse/commit/38993f215f9186c1ac3505b1e09697cd9a468b5d" rel="external nofollow noreferrer" target="_blank" class="text-reset">38993f21</a>
    
    </div>
</div>

        </div>
      </div>
      <div id="to-full-website" class="row fixed-bottom text-center bg-white py-3">
        <div class="col">
          <a class="btn btn-lg btn-outline-orange" href="https://clickhouse.com/docs/ru/operations/server-configuration-parameters/settings/">To full website</a>
        </div>
      </div>
    </div>
    <amp-analytics type="metrika">
      <script type="application/json">{
"vars": {
  "counterId": "18343495",
  "triggers": {
    "notBounce": {
      "on": "timer",
      "timerSpec": {
        "immediate": false,
        "interval": 15,
        "maxTimerLength": 16
      },
      "request": "notBounce"
    }
  }
}
}</script>
  </amp-analytics>
  </body>
</html>
