










    



    



    



    
    






    <!doctype html>
<html ⚡ lang="ja">
  <head>
    <meta charset="utf-8">
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    <title>ALTER | ClickHouseドキュメント</title>
    <link rel="canonical" href="https://clickhouse.com/docs/ja/sql-reference/statements/alter/" />
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    
<script type="application/ld+json">[{
"@context": "http://schema.org",
"@type": "TechArticle",
"headline": "ALTER | ClickHouseドキュメント",
"mainEntityOfPage": "https://clickhouse.com/docs/ja/sql-reference/statements/alter/",




"image": "https://clickhouse.com/images/clickhouse-209x60.png",
"author": {
  "@type": "Project",
  "name": "ClickHouse"
},
"publisher": {
  "@type": "Organization",
  "name": "ClickHouse, Inc.",
  "logo": {
    "@type": "ImageObject",
    "url": "https://clickhouse.com/images/logo-400x240.png",
    "width": 400,
    "height": 240
  }
}}, {
"@context": "http://schema.org",
"@type": "Episode",
"name": "ALTER | ClickHouseドキュメント",
"aggregateRating": {
  "@type": "AggregateRating",
  "ratingValue": RATING_VALUE,
  "ratingCount": RATING_COUNT
}
}]</script>

    
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <style amp-custom>:root{--blue:#007bff;--indigo:#6610f2;--purple:#6f42c1;--pink:#e83e8c;--red:#dc3545;--orange:#fd7e14;--yellow:#ffc107;--green:#28a745;--teal:#20c997;--cyan:#17a2b8;--gray:#6c757d;--gray-dark:#343a40;--brand-primary:#fc0;--brand-secondary:#ff3939;--primary-accent-yellow:#fc0;--primary-accent-light-yellow:#fffaf0;--primary-accent-blue:#257af4;--primary-accent-light-blue:#e3f1fe;--secondary-accent-orange:#ff8c00;--secondary-accent-light-orange:#ffe4b5;--secondary-accent-red:#ff3939;--secondary-accent-light-red:#ffe4e1;--primary:#fc0;--secondary:#212529;--success:#28a745;--info:#17a2b8;--warning:#ffc107;--danger:#dc3545;--light:#f1f6f9;--dark:#495057;--primary-light:#fffaf0;--secondary-light:#fff;--tertiary:#257af4;--tertiary-light:#e3f1fe;--white:#fff;--black:#212529;--blue:#257af4;--light-blue:#e3f1fe;--yellow:#fc0;--light-yellow:#fffaf0;--orange:#ff8c00;--light-orange:#ffe4b5;--red:#ff3939;--light-red:#ffe4e1;--medium:#d6dbdf;--breakpoint-xxs:0;--breakpoint-xs:400px;--breakpoint-sm:616px;--breakpoint-md:768px;--breakpoint-lg:980px;--breakpoint-xl:1240px;--font-family-sans-serif:"Noto Sans",sans-serif;--font-family-monospace:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}*,:after,:before{box-sizing:border-box}html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:rgba(33,37,41,0)}article,footer,main{display:block}body{margin:0;font-family:Noto Sans,sans-serif;font-size:1rem;font-weight:400;line-height:1.5;color:#212529;text-align:left;background-color:#fff}[tabindex="-1"]:focus:not(:focus-visible){outline:0}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:16px}p{margin-top:0;margin-bottom:1rem}address{font-style:normal;line-height:inherit}address,ol,ul{margin-bottom:1rem}ol,ul{margin-top:0}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}b{font-weight:bolder}a{text-decoration:none;background-color:transparent}a,a:hover{color:#ff8c00}a:hover{text-decoration:underline}a:not([href]),a:not([href]):hover{color:inherit;text-decoration:none}code,pre{font-family:SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em}pre{margin-top:0;margin-bottom:1rem;overflow:auto}img{border-style:none}img,svg{vertical-align:middle}svg{overflow:hidden}table{border-collapse:collapse}select{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}select{text-transform:none}select{word-wrap:normal}[type=button],[type=reset],[type=submit]{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled){cursor:pointer}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{padding:0;border-style:none}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:none}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}[hidden]{display:none}.h1,.h2,.h3,.h4,.h5,.h6,h1,h2,h3,h4,h5,h6{margin-bottom:16px;font-family:Hind Siliguri,sans-serif;font-weight:500;line-height:1.125}.h1,h1{font-size:2.5rem}@media(max-width:1200px){.h1,h1{font-size:calc(1.375rem+1.5vw)}}.h2,h2{font-size:2rem}@media(max-width:1200px){.h2,h2{font-size:calc(1.325rem+.9vw)}}.h3,h3{font-size:1.75rem}@media(max-width:1200px){.h3,h3{font-size:calc(1.3rem+.6vw)}}.h4,h4{font-size:1.5rem}@media(max-width:1200px){.h4,h4{font-size:calc(1.275rem+.3vw)}}.h5,h5{font-size:1.125rem}.h6,h6{font-size:.875rem}.lead{font-size:1.375rem;font-weight:400}@media(max-width:1200px){.lead{font-size:calc(1.2625rem+.15vw)}}.display-1{font-size:4rem;font-weight:600;line-height:1.125}@media(max-width:1200px){.display-1{font-size:calc(1.525rem+3.3vw)}}.display-2{font-size:2.5rem;font-weight:600;line-height:1.125}@media(max-width:1200px){.display-2{font-size:calc(1.375rem+1.5vw)}}.display-3{font-size:2rem;font-weight:500;line-height:1.125}@media(max-width:1200px){.display-3{font-size:calc(1.325rem+.9vw)}}.display-4{font-size:1.75rem;font-weight:500;line-height:1.125}@media(max-width:1200px){.display-4{font-size:calc(1.3rem+.6vw)}}.img-fluid{max-width:100%;height:auto}code{font-size:87.5%;color:#e83e8c;word-wrap:break-word}a>code{color:inherit}pre{display:block;font-size:87.5%;color:#495057}pre code{font-size:inherit;color:inherit;word-break:normal}.container{width:100%;padding-right:20px;padding-left:20px;margin-right:auto;margin-left:auto}@media(min-width:400px){.container{max-width:576px}}@media(min-width:616px){.container{max-width:576px}}@media(min-width:768px){.container{max-width:958px}}@media(min-width:980px){.container{max-width:1008px}}@media(min-width:1240px){.container{max-width:1118px}}.container-fluid,.container-lg,.container-md{width:100%;padding-right:20px;padding-left:20px;margin-right:auto;margin-left:auto}@media(min-width:400px){.container{max-width:576px}}@media(min-width:616px){.container{max-width:576px}}@media(min-width:768px){.container,.container-md{max-width:958px}}@media(min-width:980px){.container,.container-lg,.container-md{max-width:1008px}}@media(min-width:1240px){.container,.container-lg,.container-md{max-width:1118px}}.row{display:flex;flex-wrap:wrap;margin-right:-20px;margin-left:-20px}.col,.col-1,.col-10,.col-11,.col-12,.col-2,.col-3,.col-4,.col-5,.col-6,.col-7,.col-8,.col-9,.col-lg,.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-md,.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9{position:relative;width:100%;padding-right:20px;padding-left:20px}.col{flex-basis:0;flex-grow:1;max-width:100%}.col-1{flex:0 0 8.3333333333%;max-width:8.3333333333%}.col-2{flex:0 0 16.6666666667%;max-width:16.6666666667%}.col-3{flex:0 0 25%;max-width:25%}.col-4{flex:0 0 33.3333333333%;max-width:33.3333333333%}.col-5{flex:0 0 41.6666666667%;max-width:41.6666666667%}.col-6{flex:0 0 50%;max-width:50%}.col-7{flex:0 0 58.3333333333%;max-width:58.3333333333%}.col-8{flex:0 0 66.6666666667%;max-width:66.6666666667%}.col-9{flex:0 0 75%;max-width:75%}.col-10{flex:0 0 83.3333333333%;max-width:83.3333333333%}.col-11{flex:0 0 91.6666666667%;max-width:91.6666666667%}.col-12{flex:0 0 100%;max-width:100%}.order-first{order:-1}.order-0{order:0}.order-1{order:1}.order-2{order:2}.order-3{order:3}.order-4{order:4}.order-5{order:5}.order-6{order:6}.order-7{order:7}.order-8{order:8}.order-9{order:9}.order-10{order:10}.order-11{order:11}.order-12{order:12}@media(min-width:768px){.col-md{flex-basis:0;flex-grow:1;max-width:100%}.col-md-1{flex:0 0 8.3333333333%;max-width:8.3333333333%}.col-md-2{flex:0 0 16.6666666667%;max-width:16.6666666667%}.col-md-3{flex:0 0 25%;max-width:25%}.col-md-4{flex:0 0 33.3333333333%;max-width:33.3333333333%}.col-md-5{flex:0 0 41.6666666667%;max-width:41.6666666667%}.col-md-6{flex:0 0 50%;max-width:50%}.col-md-7{flex:0 0 58.3333333333%;max-width:58.3333333333%}.col-md-8{flex:0 0 66.6666666667%;max-width:66.6666666667%}.col-md-9{flex:0 0 75%;max-width:75%}.col-md-10{flex:0 0 83.3333333333%;max-width:83.3333333333%}.col-md-11{flex:0 0 91.6666666667%;max-width:91.6666666667%}.col-md-12{flex:0 0 100%;max-width:100%}.order-md-first{order:-1}.order-md-0{order:0}.order-md-1{order:1}.order-md-2{order:2}.order-md-3{order:3}.order-md-4{order:4}.order-md-5{order:5}.order-md-6{order:6}.order-md-7{order:7}.order-md-8{order:8}.order-md-9{order:9}.order-md-10{order:10}.order-md-11{order:11}.order-md-12{order:12}}@media(min-width:980px){.col-lg{flex-basis:0;flex-grow:1;max-width:100%}.col-lg-1{flex:0 0 8.3333333333%;max-width:8.3333333333%}.col-lg-2{flex:0 0 16.6666666667%;max-width:16.6666666667%}.col-lg-3{flex:0 0 25%;max-width:25%}.col-lg-4{flex:0 0 33.3333333333%;max-width:33.3333333333%}.col-lg-5{flex:0 0 41.6666666667%;max-width:41.6666666667%}.col-lg-6{flex:0 0 50%;max-width:50%}.col-lg-7{flex:0 0 58.3333333333%;max-width:58.3333333333%}.col-lg-8{flex:0 0 66.6666666667%;max-width:66.6666666667%}.col-lg-9{flex:0 0 75%;max-width:75%}.col-lg-10{flex:0 0 83.3333333333%;max-width:83.3333333333%}.col-lg-11{flex:0 0 91.6666666667%;max-width:91.6666666667%}.col-lg-12{flex:0 0 100%;max-width:100%}.order-lg-first{order:-1}.order-lg-0{order:0}.order-lg-1{order:1}.order-lg-2{order:2}.order-lg-3{order:3}.order-lg-4{order:4}.order-lg-5{order:5}.order-lg-6{order:6}.order-lg-7{order:7}.order-lg-8{order:8}.order-lg-9{order:9}.order-lg-10{order:10}.order-lg-11{order:11}.order-lg-12{order:12}}.table{width:100%;margin-bottom:8px;color:#212529}.table-primary{background-color:#fff1b8}.table-light{background-color:#fbfcfd}.table-dark{background-color:#ccced0}.table-primary-light{background-color:#fffefb}.table-white{background-color:#fff}.table-black{background-color:#c1c2c3}.table-orange{background-color:#ffdfb8}.table-light-orange{background-color:#fff7ea}.table-dark{color:#fff;background-color:#343a40}.btn{display:inline-block;font-family:inherit;font-weight:700;color:#212529;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;padding:12px 32px;font-size:.875rem;line-height:20px;border-radius:8px;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media(prefers-reduced-motion:reduce){.btn{transition:none}}.btn:hover{color:#212529;text-decoration:none}.btn:focus{outline:0;box-shadow:none}.btn:disabled{opacity:.65}.btn-primary{color:#495057;background-color:#fc0;border-color:#fc0}.btn-primary:focus,.btn-primary:hover{color:#495057;background-color:#d9ad00;border-color:#cca300}.btn-primary:focus{box-shadow:0 0 0 0 rgba(228,185,13,.5)}.btn-primary:disabled{color:#495057;background-color:#fc0;border-color:#fc0}.btn-light{color:#495057;background-color:#f1f6f9;border-color:#f1f6f9}.btn-light:focus,.btn-light:hover{color:#495057;background-color:#d6e5ee;border-color:#cddfea}.btn-light:focus{box-shadow:0 0 0 0 rgba(216,221,225,.5)}.btn-light:disabled{color:#495057;background-color:#f1f6f9;border-color:#f1f6f9}.btn-dark{color:#fff;background-color:#495057;border-color:#495057}.btn-dark:focus,.btn-dark:hover{color:#fff;background-color:#383d42;border-color:#32373b}.btn-dark:focus{box-shadow:0 0 0 0 rgba(100,106,112,.5)}.btn-dark:disabled{color:#fff;background-color:#495057;border-color:#495057}.btn-primary-light{color:#495057;background-color:#fffaf0;border-color:#fffaf0}.btn-primary-light:focus,.btn-primary-light:hover{color:#495057;background-color:#ffedca;border-color:#ffe9bd}.btn-primary-light:focus{box-shadow:0 0 0 0 rgba(228,225,217,.5)}.btn-primary-light:disabled{color:#495057;background-color:#fffaf0;border-color:#fffaf0}.btn-white{color:#495057;background-color:#fff;border-color:#fff}.btn-white:focus,.btn-white:hover{color:#495057;background-color:#ececec;border-color:#e6e6e6}.btn-white:focus{box-shadow:0 0 0 0 rgba(228,229,230,.5)}.btn-white:disabled{color:#495057;background-color:#fff;border-color:#fff}.btn-black{color:#fff;background-color:#212529;border-color:#212529}.btn-black:focus,.btn-black:hover{color:#fff;background-color:#101214;border-color:#0a0c0d}.btn-black:focus{box-shadow:0 0 0 0 rgba(66,70,73,.5)}.btn-black:disabled{color:#fff;background-color:#212529;border-color:#212529}.btn-orange{color:#495057;background-color:#ff8c00;border-color:#ff8c00}.btn-orange:focus,.btn-orange:hover{color:#fff;background-color:#d97700;border-color:#cc7000}.btn-orange:focus{box-shadow:0 0 0 0 rgba(228,131,13,.5)}.btn-orange:disabled{color:#495057;background-color:#ff8c00;border-color:#ff8c00}.btn-light-orange{color:#495057;background-color:#ffe4b5;border-color:#ffe4b5}.btn-light-orange:focus,.btn-light-orange:hover{color:#495057;background-color:#ffd68f;border-color:#ffd182}.btn-light-orange:focus{box-shadow:0 0 0 0 rgba(228,206,167,.5)}.btn-light-orange:disabled{color:#495057;background-color:#ffe4b5;border-color:#ffe4b5}.btn-outline-primary{color:#fc0;border-color:#fc0}.btn-outline-primary:hover{color:#495057;background-color:#fc0;border-color:#fc0}.btn-outline-primary:focus{box-shadow:0 0 0 0 rgba(255,204,0,.5)}.btn-outline-primary:disabled{color:#fc0;background-color:transparent}.btn-outline-light{color:#f1f6f9;border-color:#f1f6f9}.btn-outline-light:hover{color:#495057;background-color:#f1f6f9;border-color:#f1f6f9}.btn-outline-light:focus{box-shadow:0 0 0 0 rgba(241,246,249,.5)}.btn-outline-light:disabled{color:#f1f6f9;background-color:transparent}.btn-outline-dark{color:#495057;border-color:#495057}.btn-outline-dark:hover{color:#fff;background-color:#495057;border-color:#495057}.btn-outline-dark:focus{box-shadow:0 0 0 0 rgba(73,80,87,.5)}.btn-outline-dark:disabled{color:#495057;background-color:transparent}.btn-outline-primary-light{color:#fffaf0;border-color:#fffaf0}.btn-outline-primary-light:hover{color:#495057;background-color:#fffaf0;border-color:#fffaf0}.btn-outline-primary-light:focus{box-shadow:0 0 0 0 rgba(255,250,240,.5)}.btn-outline-primary-light:disabled{color:#fffaf0;background-color:transparent}.btn-outline-white{color:#fff;border-color:#fff}.btn-outline-white:hover{color:#495057;background-color:#fff;border-color:#fff}.btn-outline-white:focus{box-shadow:0 0 0 0 hsla(0,0%,100%,.5)}.btn-outline-white:disabled{color:#fff;background-color:transparent}.btn-outline-black{color:#212529;border-color:#212529}.btn-outline-black:hover{color:#fff;background-color:#212529;border-color:#212529}.btn-outline-black:focus{box-shadow:0 0 0 0 rgba(33,37,41,.5)}.btn-outline-black:disabled{color:#212529;background-color:transparent}.btn-outline-orange{color:#ff8c00;border-color:#ff8c00}.btn-outline-orange:hover{color:#495057;background-color:#ff8c00;border-color:#ff8c00}.btn-outline-orange:focus{box-shadow:0 0 0 0 rgba(255,140,0,.5)}.btn-outline-orange:disabled{color:#ff8c00;background-color:transparent}.btn-outline-light-orange{color:#ffe4b5;border-color:#ffe4b5}.btn-outline-light-orange:hover{color:#495057;background-color:#ffe4b5;border-color:#ffe4b5}.btn-outline-light-orange:focus{box-shadow:0 0 0 0 rgba(255,228,181,.5)}.btn-outline-light-orange:disabled{color:#ffe4b5;background-color:transparent}.btn-link{font-weight:400;color:#ff8c00;text-decoration:none}.btn-link:hover{color:#ff8c00;text-decoration:underline}.btn-link:focus{text-decoration:underline;box-shadow:none}.btn-link:disabled{color:#d6dbdf;pointer-events:none}.btn-lg{padding:16px 32px;font-size:1.125rem;line-height:26px;border-radius:8px}.btn-block{display:block;width:100%}.btn-block+.btn-block{margin-top:24px}.custom-select{display:inline-block;width:100%;height:calc(1.5em+.75rem+2px);padding:.375rem 1.75rem .375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#6c757d;vertical-align:middle;background:#fff url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='4' height='5'%3E%3Cpath fill='%23343a40' d='M2 0L0 2h4zm0 5L0 3h4z'/%3E%3C/svg%3E") no-repeat right .75rem center/8px 10px;border:1px solid #ced4da;border-radius:8px;-webkit-appearance:none;-moz-appearance:none;appearance:none}.custom-select:focus{border-color:#ffe680;outline:0;box-shadow:0 0 0 .2rem rgba(255,204,0,.25)}.custom-select:focus::-ms-value{color:#6c757d;background-color:#fff}.custom-select[multiple],.custom-select[size]:not([size="1"]){height:auto;padding-right:.75rem;background-image:none}.custom-select:disabled{color:#6c757d;background-color:#e9ecef}.custom-select::-ms-expand{display:none}.custom-select:-moz-focusring{color:transparent;text-shadow:0 0 0 #6c757d}.custom-select-lg{height:calc(1.5em+1rem+2px);padding-top:.5rem;padding-bottom:.5rem;padding-left:1rem;font-size:1.125rem}.custom-file{display:inline-block;margin-bottom:0}.custom-file{position:relative;width:100%;height:calc(1.5em+.75rem+2px)}.custom-select{transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media(prefers-reduced-motion:reduce){.custom-select{transition:none}}pre{white-space:pre-wrap}pre{border:1px solid #d6dbdf;page-break-inside:avoid}img{page-break-inside:avoid}h2,h3,p{orphans:3;widows:3}h2,h3{page-break-after:avoid}@page{size:a3}.container,body{min-width:980px}.table{border-collapse:collapse}.table-dark{color:inherit}</style>
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    <script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>
  </head>
  <body class="amp" dir="ltr">
    <div class="container-fluid container-lg pb-5">
      <div class="row pt-3 mb-3">
        <div class="col">
          <a href="/" class="text-decoration-none">
            <amp-img class="d-inline-block mr-3" layout="fixed" width="40" height="36" src="/docs/images/logo.svg" alt="ClickHouse logo" title="ClickHouse logo"></amp-img><amp-img class="invert-dark d-inline-block" layout="fixed" width="238" height="36" src="/docs/images/clickhouse-black.svg" alt="ClickHouse" title="ClickHouse"></amp-img>
          </a>
        </div>
      </div>
      <div class="row">
        <div id="content" class="col">
          
    <div class="alert alert-primary" role="alert">
      <p class="display-5 mb-2">Help wanted!</p>
      <p class="lead">The following content of this documentation page has been machine-translated. But unlike other websites, it is not done on the fly. This translated text lives on GitHub repository alongside main ClickHouse codebase and waits for fellow native speakers to make it more human-readable. <a href="/docs/en/sql-reference/statements/alter/" class="alert-link">You can also use the original English version as a reference.</a></p>
      <p class="lead">
          <a class="btn btn-lg btn-primary text-white" href="https://github.com/ClickHouse/ClickHouse/edit/master/docs/ja/sql-reference/statements/alter.md" target="_blank" rel="external nofollow noreferrer">
              Help ClickHouse documentation by editing this page
          </a>
      </p>
    </div>

          <h2 id=query_language_queries_alter>ALTER<a class=headerlink href=../amp/#query_language_queries_alter title="Permanent link"> </a></h2> <p>その <code class=syntax>ALTER</code> クエリーのみ対応して <code class=syntax>*MergeTree</code> テーブルだけでなく、 <code class=syntax>Merge</code>と<code class=syntax>Distributed</code>. クエリに複数のバリエーションがあります。</p> <h3 id=column-manipulations>列の操作<a class=headerlink href=../amp/#column-manipulations title="Permanent link"> </a></h3> <p>テーブル構造の変更。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=p>[</span><span class=n>db</span><span class=p>].</span><span class=n>name</span><span class=w> </span><span class=p>[</span><span class=k>ON</span><span class=w> </span><span class=k>CLUSTER</span><span class=w> </span><span class=k>cluster</span><span class=p>]</span><span class=w> </span><span class=k>ADD</span><span class=o>|</span><span class=k>DROP</span><span class=o>|</span><span class=n>CLEAR</span><span class=o>|</span><span class=k>COMMENT</span><span class=o>|</span><span class=k>MODIFY</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=p>...</span><span class=w></span>
</code></pre></div> <p>クエリでは、コンマ区切りのアクションのリストを指定します。<br> 各アクションは、列に対する操作です。</p> <p>次の操作がサポートされます:</p> <ul> <li><a href=../amp/#alter_add-column>ADD COLUMN</a> — Adds a new column to the table.</li> <li><a href=../amp/#alter_drop-column>DROP COLUMN</a> — Deletes the column.</li> <li><a href=../amp/#alter_clear-column>CLEAR COLUMN</a> — Resets column values.</li> <li><a href=../amp/#alter_comment-column>COMMENT COLUMN</a> — Adds a text comment to the column.</li> <li><a href=../amp/#alter_modify-column>MODIFY COLUMN</a> — Changes column's type, default expression and TTL.</li> </ul> <p>これらの行動を詳細に説明します。</p> <h4 id=alter_add-column>ADD COLUMN<a class=headerlink href=../amp/#alter_add-column title="Permanent link"> </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ADD</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=p>[</span><span class=k>type</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>default_expr</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>codec</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=k>AFTER</span><span class=w> </span><span class=n>name_after</span><span class=p>]</span><span class=w></span>
</code></pre></div> <p>指定されたテーブルに新しい列を追加します <code class=syntax>name</code>, <code class=syntax>type</code>, <a href=../../create/amp/#codecs><code class=syntax>codec</code></a> と <code class=syntax>default_expr</code> （節を参照 <a href=../../create/amp/#create-default-values>既定の式</a>).</p> <p>もし <code class=syntax>IF NOT EXISTS</code> 列が既に存在する場合、クエリはエラーを返しません。 指定した場合 <code class=syntax>AFTER name_after</code> （別の列の名前）、列は表の列のリスト内で指定された列の後に追加されます。 それ以外の場合は、列がテーブルの最後に追加されます。 テーブルの先頭に列を追加する方法はないことに注意してください。 一連の行動のために, <code class=syntax>name_after</code> 前の操作のいずれかで追加された列の名前を指定できます。</p> <p>列を追加すると、データでアクションを実行せずにテーブル構造が変更されます。 その後、データはディスクに表示されません <code class=syntax>ALTER</code>. テーブルから読み取るときに列のデータがない場合は、デフォルト値が入力されます（デフォルトの式がある場合はデフォルトの式を実行するか、ゼロ 列の表示のディスクと統合データ部品（ <a href=../../../../engines/table-engines/mergetree-family/mergetree/amp/ >メルゲツリー</a>).</p> <p>このアプローチにより、 <code class=syntax>ALTER</code> 古いデータの量を増やすことなく、瞬時にクエリ。</p> <p>例:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>visits</span><span class=w> </span><span class=k>ADD</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=n>browser</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=k>AFTER</span><span class=w> </span><span class=n>user_id</span><span class=w></span>
</code></pre></div> <h4 id=alter_drop-column>DROP COLUMN<a class=headerlink href=../amp/#alter_drop-column title="Permanent link"> </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>DROP</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=n>name</span><span class=w></span>
</code></pre></div> <p>名前の列を削除します <code class=syntax>name</code>. もし <code class=syntax>IF EXISTS</code> 列が存在しない場合、クエリはエラーを返しません。</p> <p>コンピュータのデータを削除するファイルシステム。 この削除全ファイル、クエリーがほぼ完了します。</p> <p>例:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>visits</span><span class=w> </span><span class=k>DROP</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=n>browser</span><span class=w></span>
</code></pre></div> <h4 id=alter_clear-column>CLEAR COLUMN<a class=headerlink href=../amp/#alter_clear-column title="Permanent link"> </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=n>CLEAR</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=n>partition_name</span><span class=w></span>
</code></pre></div> <p>すべてリセットデータ列の指定されたパーティション セクションのパーティション名の設定の詳細を読む <a href=../amp/#alter-how-to-specify-part-expr>パーティション式の指定方法</a>.</p> <p>もし <code class=syntax>IF EXISTS</code> 列が存在しない場合、クエリはエラーを返しません。</p> <p>例:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>visits</span><span class=w> </span><span class=n>CLEAR</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=n>browser</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=n>tuple</span><span class=p>()</span><span class=w></span>
</code></pre></div> <h4 id=alter_comment-column>COMMENT COLUMN<a class=headerlink href=../amp/#alter_comment-column title="Permanent link"> </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>COMMENT</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=s1>'comment'</span><span class=w></span>
</code></pre></div> <p>列にコメントを追加します。 もし <code class=syntax>IF EXISTS</code> 列が存在しない場合、クエリはエラーを返しません。</p> <p>各列には一つのコメントがあります。 列にコメントが既に存在する場合、新しいコメントは前のコメントを上書きします。</p> <p>コメントは <code class=syntax>comment_expression</code> によって返される列 <a href=../../misc/amp/#misc-describe-table>DESCRIBE TABLE</a> クエリ。</p> <p>例:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>visits</span><span class=w> </span><span class=k>COMMENT</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=n>browser</span><span class=w> </span><span class=s1>'The table shows the browser used for accessing the site.'</span><span class=w></span>
</code></pre></div> <h4 id=alter_modify-column>MODIFY COLUMN<a class=headerlink href=../amp/#alter_modify-column title="Permanent link"> </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>MODIFY</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=p>[</span><span class=k>type</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>default_expr</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>TTL</span><span class=p>]</span><span class=w></span>
</code></pre></div> <p>このクエリは、 <code class=syntax>name</code> 列のプロパティ:</p> <ul> <li> <p>タイプ</p> </li> <li> <p>既定の式</p> </li> <li> <p>TTL</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>For</span><span class=w> </span><span class=n>examples</span><span class=w> </span><span class=n>of</span><span class=w> </span><span class=n>columns</span><span class=w> </span><span class=n>TTL</span><span class=w> </span><span class=n>modifying</span><span class=p>,</span><span class=w> </span><span class=n>see</span><span class=w> </span><span class=p>[</span><span class=n>Column</span><span class=w> </span><span class=n>TTL</span><span class=p>](..</span><span class=o>/</span><span class=n>engines</span><span class=o>/</span><span class=n>table_engines</span><span class=o>/</span><span class=n>mergetree_family</span><span class=o>/</span><span class=n>mergetree</span><span class=p>.</span><span class=n>md</span><span class=err>#</span><span class=n>mergetree</span><span class=o>-</span><span class=n>column</span><span class=o>-</span><span class=n>ttl</span><span class=p>).</span><span class=w></span>
</code></pre></div> </li> </ul> <p>もし <code class=syntax>IF EXISTS</code> 列が存在しない場合、クエリはエラーを返しません。</p> <p>型を変更するとき、値は次のように変換されます <a href=../../../functions/type-conversion-functions/amp/ >トタイプ</a> 機能をそれらに適用した。 既定の式のみが変更された場合、クエリは複雑な処理を行わず、ほぼ即座に完了します。</p> <p>例:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>visits</span><span class=w> </span><span class=k>MODIFY</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=n>browser</span><span class=w> </span><span class=nb>Array</span><span class=p>(</span><span class=n>String</span><span class=p>)</span><span class=w></span>
</code></pre></div> <p>Changing the column type is the only complex action – it changes the contents of files with data. For large tables, this may take a long time.</p> <p>いくつかの処理段階があります:</p> <ul> <li>準備一時(新しいファイルが修正データです。</li> <li>古いファイルの名前を変更する。</li> <li>一時(新しい)ファイルの名前を古い名前に変更します。</li> <li>古いファイルを削除します。</li> </ul> <p>最初の段階だけ時間がかかります。 この段階で障害が発生した場合、データは変更されません。<br> 連続するいずれかの段階で障害が発生した場合、データを手動で復元することができます。 例外は、古いファイルがファイルシステムから削除されたが、新しいファイルのデータがディスクに書き込まれず、失われた場合です。</p> <p>その <code class=syntax>ALTER</code> 列を変更するクエリが複製されます。 命令はZooKeeperに保存され、各レプリカはそれらを適用します。 すべて <code class=syntax>ALTER</code> クエリは同じ順序で実行されます。 クエリは、他のレプリカで適切なアクションが完了するのを待機します。 ただし、レプリケートされたテーブル内の列を変更するクエリは中断され、すべてのアクションが非同期に実行されます。</p> <h4 id=alter-query-limitations>クエリの制限の変更<a class=headerlink href=../amp/#alter-query-limitations title="Permanent link"> </a></h4> <p>その <code class=syntax>ALTER</code> クエリを作成および削除個別要素（カラム）をネストしたデータ構造が全体に入れ子データ構造です。 入れ子になったデータ構造を追加するには、次のような名前の列を追加できます <code class=syntax>name.nested_name</code> そしてタイプ <code class=syntax>Array(T)</code>. 入れ子になったデータ構造は、ドットの前に同じプレフィックスを持つ名前を持つ複数の配列列と同等です。</p> <p>主キーまたはサンプリングキーの列を削除することはサポートされていません。 <code class=syntax>ENGINE</code> 式）。 主キーに含まれる列の型を変更することは、この変更によってデータが変更されない場合にのみ可能です(たとえば、列挙型に値を追加したり、型を変更 <code class=syntax>DateTime</code> に <code class=syntax>UInt32</code>).</p> <p>もし <code class=syntax>ALTER</code> クエリでは、必要なテーブルの変更を行うのに十分ではありません。 <a href=../../insert-into/amp/#insert_query_insert-select>INSERT SELECT</a> を使用してテーブルを切り替えます <a href=../../misc/amp/#misc_operations-rename>RENAME</a> 古いテーブルを照会して削除します。 を使用することができます <a href=../../../../operations/utilities/clickhouse-copier/amp/ >クリックハウス-複写機</a> の代わりとして <code class=syntax>INSERT SELECT</code> クエリ。</p> <p>その <code class=syntax>ALTER</code> クエリーのブロックすべてを読み込みと書き込んでいます。 言い換えれば、 <code class=syntax>SELECT</code> の時に実行されている <code class=syntax>ALTER</code> クエリは、 <code class=syntax>ALTER</code> クエリは、それが完了するのを待ちます。 同時に、同じテーブルに対するすべての新しいクエリは、この間待機します <code class=syntax>ALTER</code> 走ってる</p> <p>データ自体を格納しないテーブルの場合(以下のように <code class=syntax>Merge</code> と <code class=syntax>Distributed</code>), <code class=syntax>ALTER</code> テーブル構造を変更するだけで、下位テーブルの構造は変更されません。 たとえば、 <code class=syntax>Distributed</code> テーブル、あなたも実行する必要があります <code class=syntax>ALTER</code> テーブルのすべてすることができます。</p> <h3 id=manipulations-with-key-expressions>キー式による操作<a class=headerlink href=../amp/#manipulations-with-key-expressions title="Permanent link"> </a></h3> <p>次のコマン:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>MODIFY</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>new_expression</span><span class=w></span>
</code></pre></div> <p>これは、 <a href=../../../../engines/table-engines/mergetree-family/mergetree/amp/ ><code class=syntax>MergeTree</code></a> 家族（含む<br> <a href=../../../../engines/table-engines/mergetree-family/replication/amp/ >複製</a> テーブル）。 このコマンドは<br> <a href=../../../../engines/table-engines/mergetree-family/mergetree/amp/ >ソートキー</a> テーブルの<br> に <code class=syntax>new_expression</code> (式または式のタプル)。 主キーは同じままです。</p> <p>このコマンドは、メタデータのみを変更するという意味で軽量です。 データ部分のプロパティを保持するには<br> 行は並べ替えキー式で並べ替えられます既存の列を含む式は追加できません<br> によって追加された列のみ <code class=syntax>ADD COLUMN</code> 同じコマンド <code class=syntax>ALTER</code> クエリ）。</p> <h3 id=manipulations-with-data-skipping-indices>操作データを飛指標<a class=headerlink href=../amp/#manipulations-with-data-skipping-indices title="Permanent link"> </a></h3> <p>これは、 <a href=../../../../engines/table-engines/mergetree-family/mergetree/amp/ ><code class=syntax>*MergeTree</code></a> 家族（含む<br> <a href=../../../../engines/table-engines/mergetree-family/replication/amp/ >複製</a> テーブル）。 次の操作<br> 利用できます:</p> <ul> <li> <p><code class=syntax>ALTER TABLE [db].name ADD INDEX name expression TYPE type GRANULARITY value [FIRST|AFTER name]</code> -付加価指数の説明をテーブルメタデータを指すものとします。</p> </li> <li> <p><code class=syntax>ALTER TABLE [db].name DROP INDEX name</code> -除去す指標の説明からテーブルメタデータを削除を行指数のファイルからディスク。</p> </li> </ul> <p>これらのコマンドは軽量でいるという意味においてのみ変化メタデータの削除ファイルです。<br> また、それらは複製されます（ZooKeeperを介して索引メタデータを同期）。</p> <h3 id=manipulations-with-constraints>制約による操作<a class=headerlink href=../amp/#manipulations-with-constraints title="Permanent link"> </a></h3> <p>詳細はこちら <a href=../../create/amp/#constraints>制約</a></p> <p>制約は、次の構文を使用して追加または削除できます:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=p>[</span><span class=n>db</span><span class=p>].</span><span class=n>name</span><span class=w> </span><span class=k>ADD</span><span class=w> </span><span class=k>CONSTRAINT</span><span class=w> </span><span class=k>constraint_name</span><span class=w> </span><span class=k>CHECK</span><span class=w> </span><span class=n>expression</span><span class=p>;</span><span class=w></span>
<span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=p>[</span><span class=n>db</span><span class=p>].</span><span class=n>name</span><span class=w> </span><span class=k>DROP</span><span class=w> </span><span class=k>CONSTRAINT</span><span class=w> </span><span class=k>constraint_name</span><span class=p>;</span><span class=w></span>
</code></pre></div> <p>クエリに追加または削除約メタデータの制約からテーブルで、速やかに処理します。</p> <p>制約チェック <em>実行されません</em> 既存のデータが追加された場合。</p> <p>変更後の内容の複製のテーブル放送への飼育係で適用されますその他のレプリカ.</p> <h3 id=alter_manipulations-with-partitions>パーティションとパーツの操作<a class=headerlink href=../amp/#alter_manipulations-with-partitions title="Permanent link"> </a></h3> <p>次の操作は <a href=../../../../engines/table-engines/mergetree-family/custom-partitioning-key/amp/ >仕切り</a> 利用できます:</p> <ul> <li><a href=../amp/#alter_detach-partition>DETACH PARTITION</a> – Moves a partition to the <code class=syntax>detached</code> ディレクトリとそれを忘れ。</li> <li><a href=../amp/#alter_drop-partition>DROP PARTITION</a> – Deletes a partition.</li> <li><a href=../amp/#alter_attach-partition>ATTACH PART|PARTITION</a> – Adds a part or partition from the <code class=syntax>detached</code> テーブルへのディレクトリ。</li> <li><a href=../amp/#alter_attach-partition-from>ATTACH PARTITION FROM</a> – Copies the data partition from one table to another and adds.</li> <li><a href=../amp/#alter_replace-partition>REPLACE PARTITION</a> -コピーするデータを仕切りからテーブルにも置き換え.</li> <li><a href=../amp/#alter_move_to_table-partition>MOVE PARTITION TO TABLE</a>(#alter_move_to_table-partition)-データ-パーティションをあるテーブルから別のテーブルに移動します。</li> <li><a href=../amp/#alter_clear-column-partition>CLEAR COLUMN IN PARTITION</a> -パーティション内の指定された列の値をリセットします。</li> <li><a href=../amp/#alter_clear-index-partition>CLEAR INDEX IN PARTITION</a> -リセットの指定された二次インデックス、パーティション</li> <li><a href=../amp/#alter_freeze-partition>FREEZE PARTITION</a> – Creates a backup of a partition.</li> <li><a href=../amp/#alter_fetch-partition>FETCH PARTITION</a> – Downloads a partition from another server.</li> <li><a href=../amp/#alter_move-partition>MOVE PARTITION|PART</a> – Move partition/data part to another disk or volume.</li> </ul> <!-- --> <h4 id=alter_detach-partition>DETACH PARTITION<a class=headerlink href=../amp/#alter_detach-partition title="Permanent link"> </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=n>DETACH</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=n>partition_expr</span><span class=w></span>
</code></pre></div> <p>指定されたパーティションのすべてのデータを <code class=syntax>detached</code> ディレクトリ。 サーバーのを忘れているのは、一戸建てのデータを分配していない場合は存在します。 サーバーはこのデータについて知りません。 <a href=../amp/#alter_attach-partition>ATTACH</a> クエリ。</p> <p>例:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>visits</span><span class=w> </span><span class=n>DETACH</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=mi>201901</span><span class=w></span>
</code></pre></div> <p>セクションでのパーティション式の設定について <a href=../amp/#alter-how-to-specify-part-expr>パーティション式の指定方法</a>.</p> <p>クエリが実行された後、データを使用して好きなことを行うことができます。 <code class=syntax>detached</code> directory — delete it from the file system, or just leave it.</p> <p>This query is replicated – it moves the data to the <code class=syntax>detached</code> すべてのレプリカ上の このクエリは、リーダーレプリカでのみ実行できます。 する場合は、レプリカは、オーソドックスなアプローチを行う <code class=syntax>SELECT</code> クエリを実行する <a href=../../../../operations/system-tables/amp/#system_tables-replicas>システムレプリカ</a> テーブル。 あるいは、 <code class=syntax>DETACH</code> クエリはすべてのレプリカ-すべてのレプリカ、例外をスロー以外のリーダーレプリカ.</p> <h4 id=alter_drop-partition>DROP PARTITION<a class=headerlink href=../amp/#alter_drop-partition title="Permanent link"> </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=k>DROP</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=n>partition_expr</span><span class=w></span>
</code></pre></div> <p>指定したパーティションを表から削除します。 このクエリのタグの仕切りとして休止または消去いたしますデータを完全に約10分です。</p> <p>セクションでのパーティション式の設定について <a href=../amp/#alter-how-to-specify-part-expr>パーティション式の指定方法</a>.</p> <p>The query is replicated – it deletes data on all replicas.</p> <h4 id=alter_drop-detached>DROP DETACHED PARTITION|PART<a class=headerlink href=../amp/#alter_drop-detached title="Permanent link"> </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=k>DROP</span><span class=w> </span><span class=n>DETACHED</span><span class=w> </span><span class=n>PARTITION</span><span class=o>|</span><span class=n>PART</span><span class=w> </span><span class=n>partition_expr</span><span class=w></span>
</code></pre></div> <p>指定された部分または指定されたパーティションのすべての部分を <code class=syntax>detached</code>.<br> セクションでのパーティション式の設定の詳細 <a href=../amp/#alter-how-to-specify-part-expr>パーティション式の指定方法</a>.</p> <h4 id=alter_attach-partition>ATTACH PARTITION|PART<a class=headerlink href=../amp/#alter_attach-partition title="Permanent link"> </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=n>ATTACH</span><span class=w> </span><span class=n>PARTITION</span><span class=o>|</span><span class=n>PART</span><span class=w> </span><span class=n>partition_expr</span><span class=w></span>
</code></pre></div> <p>テーブルにデータを追加します。 <code class=syntax>detached</code> ディレクトリ。 パーティション全体または別の部分のデータを追加することができます。 例:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>visits</span><span class=w> </span><span class=n>ATTACH</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=mi>201901</span><span class=p>;</span><span class=w></span>
<span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>visits</span><span class=w> </span><span class=n>ATTACH</span><span class=w> </span><span class=n>PART</span><span class=w> </span><span class=mi>201901</span><span class=n>_2_2_0</span><span class=p>;</span><span class=w></span>
</code></pre></div> <p>セクションでのパーティション式の設定の詳細 <a href=../amp/#alter-how-to-specify-part-expr>パーティション式の指定方法</a>.</p> <p>このクエリは複製されます。 のレプリカ-イニシエータチェックがあるか否かのデータを <code class=syntax>detached</code> ディレクトリ。 データが存在する場合、クエリはその整合性を確認します。 すべてが正しい場合、クエリはデータをテーブルに追加します。 他のすべてのレプリカをダウンロードからデータのレプリカ-イニシエータです。</p> <p>だから、データを置くことができます <code class=syntax>detached</code> ディレクトリを一つのレプリカ上に置き、 <code class=syntax>ALTER ... ATTACH</code> すべてのレプリカのテーブルに追加するクエリ。</p> <h4 id=alter_attach-partition-from>ATTACH PARTITION FROM<a class=headerlink href=../amp/#alter_attach-partition-from title="Permanent link"> </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>table2</span><span class=w> </span><span class=n>ATTACH</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=n>partition_expr</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table1</span><span class=w></span>
</code></pre></div> <p>このクエリは、データパーティションを <code class=syntax>table1</code> に <code class=syntax>table2</code> にデータを追加します。 <code class=syntax>table2</code>. データは削除されないことに注意してください <code class=syntax>table1</code>.</p> <p>クエリを正常に実行するには、次の条件を満たす必要があります:</p> <ul> <li>両方のテーブルを作成するときに必要となる構造です。</li> <li>両方のテーブルを作成するときに必要となる分割。</li> </ul> <h4 id=alter_replace-partition>REPLACE PARTITION<a class=headerlink href=../amp/#alter_replace-partition title="Permanent link"> </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>table2</span><span class=w> </span><span class=k>REPLACE</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=n>partition_expr</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table1</span><span class=w></span>
</code></pre></div> <p>このクエリは、データパーティションを <code class=syntax>table1</code> に <code class=syntax>table2</code> の既存のパーティションを置き換え <code class=syntax>table2</code>. データは削除されないことに注意してください <code class=syntax>table1</code>.</p> <p>クエリを正常に実行するには、次の条件を満たす必要があります:</p> <ul> <li>両方のテーブルを作成するときに必要となる構造です。</li> <li>両方のテーブルを作成するときに必要となる分割。</li> </ul> <h4 id=alter_move_to_table-partition>MOVE PARTITION TO TABLE<a class=headerlink href=../amp/#alter_move_to_table-partition title="Permanent link"> </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>table_source</span><span class=w> </span><span class=k>MOVE</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=n>partition_expr</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>table_dest</span><span class=w></span>
</code></pre></div> <p>このクエリは、データパーティションを <code class=syntax>table_source</code> に <code class=syntax>table_dest</code> からデータを削除すると <code class=syntax>table_source</code>.</p> <p>クエリを正常に実行するには、次の条件を満たす必要があります:</p> <ul> <li>両方のテーブルを作成するときに必要となる構造です。</li> <li>両方のテーブルを作成するときに必要となる分割。</li> <li>両方のテーブルと同じでなければならエンジンです。 （複製または非複製)</li> <li>両方のテーブルを作成するときに必要となる貯ます。</li> </ul> <h4 id=alter_clear-column-partition>CLEAR COLUMN IN PARTITION<a class=headerlink href=../amp/#alter_clear-column-partition title="Permanent link"> </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=n>CLEAR</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=k>column_name</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=n>partition_expr</span><span class=w></span>
</code></pre></div> <p>すべてリセット値で指定されたカラムがありました。 もし <code class=syntax>DEFAULT</code> 句が決定されたテーブルを作成するときに、このクエリは、指定された既定値に列の値を設定します。</p> <p>例:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>visits</span><span class=w> </span><span class=n>CLEAR</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=n>hour</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=mi>201902</span><span class=w></span>
</code></pre></div> <h4 id=alter_freeze-partition>FREEZE PARTITION<a class=headerlink href=../amp/#alter_freeze-partition title="Permanent link"> </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=k>FREEZE</span><span class=w> </span><span class=p>[</span><span class=n>PARTITION</span><span class=w> </span><span class=n>partition_expr</span><span class=p>]</span><span class=w></span>
</code></pre></div> <p>このクエリーを作成し、地元のバックアップの指定されたパーティション もし <code class=syntax>PARTITION</code> 条項を省略して、クエリーを作成し、バックアップの仕切ります。</p> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-4 text-reset mb-2">注</p> <p>バックアップ処理全体は、サーバーを停止せずに実行されます。</p> </div> <p>古いスタイルのテーブルの場合、パーティション名のプレフィックスを指定できます(例えば, ‘2019’)のクエリーを作成し、バックアップのためのすべてに対応する隔壁 セクションでのパーティション式の設定について <a href=../amp/#alter-how-to-specify-part-expr>パーティション式の指定方法</a>.</p> <p>実行時に、データスナップショットの場合、クエリはテーブルデータへのハードリンクを作成します。 Hardlinksに設置されているディレクトリ <code class=syntax>/var/lib/clickhouse/shadow/N/...</code>,ここで:</p> <ul> <li><code class=syntax>/var/lib/clickhouse/</code> 設定で指定された作業ClickHouseディレクトリです。</li> <li><code class=syntax>N</code> バックアップの増分数です。</li> </ul> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-4 text-reset mb-2">注</p> <p>を使用する場合 <a class=alert-link href=../../../../engines/table-engines/mergetree-family/mergetree/amp/#table_engine-mergetree-multiple-volumes>テーブル内のデータ格納用のディスクのセット</a> は、 <code class=syntax>shadow/N</code> ディレクトリが表示される毎にディスクデータを格納する部品と合わせによる <code class=syntax>PARTITION</code> 式。</p> </div> <p>バックアップの内部と同じディレクトリ構造が作成されます <code class=syntax>/var/lib/clickhouse/</code>. クエリの実行 ‘chmod’ すべてのファイルの禁止に対して書き込みます。</p> <p>バックアップの作成後、データをコピーするには <code class=syntax>/var/lib/clickhouse/shadow/</code> ローカルサーバーから削除します。 なお、 <code class=syntax>ALTER t FREEZE PARTITION</code> クエリは複製されません。 するための地元のバックアップ、現地サーバーです。</p> <p>クエリをバックアップトで最初のでお待ちしておりますので、現在のクエリーに対応するテーブルに仕上げた。</p> <p><code class=syntax>ALTER TABLE t FREEZE PARTITION</code> コピーのみのデータのないテーブルメタデータを指すものとします。 をバックアップテーブルメタデータ、コピー、ファイル <code class=syntax>/var/lib/clickhouse/metadata/database/table.sql</code></p> <p>バックアップからデータを復元するには:</p> <ol> <li>テーブルが存在しない場合はテーブルを作成します。 クエリを表示するには、を使用します。sqlファイル(置換 <code class=syntax>ATTACH</code> それで <code class=syntax>CREATE</code>).</li> <li>からデータをコピーします <code class=syntax>data/database/table/</code> バックアップ内のディレクトリ <code class=syntax>/var/lib/clickhouse/data/database/table/detached/</code> ディレクトリ。</li> <li>走れ。 <code class=syntax>ALTER TABLE t ATTACH PARTITION</code> テーブルにデータを追加するクエリ。</li> </ol> <p>復元からのバックアップを必要としないの停止、サーバーにコピーします。</p> <p>バックアップおよびデータの復元の詳細については、 <a href=../../../../operations/backup/amp/ >データバックア</a> セクション</p> <h4 id=alter_clear-index-partition>CLEAR INDEX IN PARTITION<a class=headerlink href=../amp/#alter_clear-index-partition title="Permanent link"> </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=n>CLEAR</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>index_name</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=n>partition_expr</span><span class=w></span>
</code></pre></div> <p>クエリは次のように動作します <code class=syntax>CLEAR COLUMN</code> しかし、列データではなくインデックスをリセットします。</p> <h4 id=alter_fetch-partition>FETCH PARTITION<a class=headerlink href=../amp/#alter_fetch-partition title="Permanent link"> </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=k>FETCH</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=n>partition_expr</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=s1>'path-in-zookeeper'</span><span class=w></span>
</code></pre></div> <p>ダウンロードパーティションから別のサーバーです。 このクエリーだけを再現します。</p> <p>クエリは、次の操作を実行します:</p> <ol> <li>ダウンロードパーティションから、指定されたザ-シャー. で ‘path-in-zookeeper’ ZooKeeperでシャードへのパスを指定する必要があります。</li> <li>次に、クエリはダウンロードしたデータを <code class=syntax>detached</code> のディレクトリ <code class=syntax>table_name</code> テーブル。 使用する <a href=../amp/#alter_attach-partition>ATTACH PARTITION|PART</a> テーブルにデータを追加するクエリ。</li> </ol> <p>例えば:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>FETCH</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=mi>201902</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=s1>'/clickhouse/tables/01-01/visits'</span><span class=p>;</span><span class=w></span>
<span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=n>ATTACH</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=mi>201902</span><span class=p>;</span><span class=w></span>
</code></pre></div> <p>なお:</p> <ul> <li>その <code class=syntax>ALTER ... FETCH PARTITION</code> クエリは複製されません。 それは仕切りをに置きます <code class=syntax>detached</code> ディレクトリの現地サーバーです。</li> <li>その <code class=syntax>ALTER TABLE ... ATTACH</code> クエリが複製されます。 すべてのレプリカにデータを追加します。 データはレプリカのいずれかに追加されます。 <code class=syntax>detached</code> ディレクトリ、および他の人に-隣接するレプリカから。</li> </ul> <p>ダウンロードする前に、システムかどうかをチェックすると、パーティションが存在するとテーブル構造。 最も適切なレプリカは、正常なレプリカから自動的に選択されます。</p> <p>クエリは呼び出されますが <code class=syntax>ALTER TABLE</code> テーブル構造を変更せず、テーブル内で使用可能なデータを直ちに変更することはありません。</p> <h4 id=alter_move-partition>MOVE PARTITION|PART<a class=headerlink href=../amp/#alter_move-partition title="Permanent link"> </a></h4> <p>パーティションまた <code class=syntax>MergeTree</code>-エンジンテーブル。 見る <a href=../../../../engines/table-engines/mergetree-family/mergetree/amp/#table_engine-mergetree-multiple-volumes>複数のブロックデバイスのためのデータ保存</a>.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=k>MOVE</span><span class=w> </span><span class=n>PARTITION</span><span class=o>|</span><span class=n>PART</span><span class=w> </span><span class=n>partition_expr</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=n>DISK</span><span class=o>|</span><span class=n>VOLUME</span><span class=w> </span><span class=s1>'disk_name'</span><span class=w></span>
</code></pre></div> <p>その <code class=syntax>ALTER TABLE t MOVE</code> クエリ:</p> <ul> <li>な再現が異なるレプリカで保管。</li> <li>指定されたディスクまたはボリュ ストレージポリシーで指定されたデータ移動の条件を適用できない場合、Queryはエラーを返します。</li> <li>復帰できるエラーの場合、データの移動に移行している背景には、同時 <code class=syntax>ALTER TABLE t MOVE</code> クエリまたはバックグラウンドデータマージの結果。 この場合、ユーザーは追加の操作を実行しないでください。</li> </ul> <p>例:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>hits</span><span class=w> </span><span class=k>MOVE</span><span class=w> </span><span class=n>PART</span><span class=w> </span><span class=s1>'20190301_14343_16206_438'</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=n>VOLUME</span><span class=w> </span><span class=s1>'slow'</span><span class=w></span>
<span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>hits</span><span class=w> </span><span class=k>MOVE</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=s1>'2019-09-01'</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=n>DISK</span><span class=w> </span><span class=s1>'fast_ssd'</span><span class=w></span>
</code></pre></div> <h4 id=alter-how-to-specify-part-expr>パーティション式の設定方法<a class=headerlink href=../amp/#alter-how-to-specify-part-expr title="Permanent link"> </a></h4> <p>パーティション式を指定するには <code class=syntax>ALTER ... PARTITION</code> 異なる方法でのクエリ:</p> <ul> <li>からの値として <code class=syntax>partition</code> の列 <code class=syntax>system.parts</code> テーブル。 例えば, <code class=syntax>ALTER TABLE visits DETACH PARTITION 201901</code>.</li> <li>テーブル列からの式として。 定数と定数式がサポートされています。 例えば, <code class=syntax>ALTER TABLE visits DETACH PARTITION toYYYYMM(toDate('2019-01-25'))</code>.</li> <li>パーティションIDの使用。 Partition IDは、ファイルシステムおよびZooKeeperのパーティションの名前として使用されるパーティションの文字列識別子(可能であれば人間が読める)です。 パーティションIDは、 <code class=syntax>PARTITION ID</code> 一重引quotesで囲まれた句。 例えば, <code class=syntax>ALTER TABLE visits DETACH PARTITION ID '201901'</code>.</li> <li>で <a href=../amp/#alter_attach-partition>ALTER ATTACH PART</a> と <a href=../amp/#alter_drop-detached>DROP DETACHED PART</a> パーツの名前を指定するには、文字列リテラルを使用します。 <code class=syntax>name</code> の列 <a href=../../../../operations/system-tables/amp/#system_tables-detached_parts>システムdetached_parts</a> テーブル。 例えば, <code class=syntax>ALTER TABLE visits ATTACH PART '201901_1_1_0'</code>.</li> </ul> <p>ご利用の引用符を指定する場合、パーティションのエントランスは目を引く壁面緑化を表現。 例えば、 <code class=syntax>String</code> その名前を引用符で指定する必要があります (<code class=syntax>'</code>). のために <code class=syntax>Date</code> と <code class=syntax>Int*</code> 型引用符は必要ありません。</p> <p>古いスタイルのテーブルの場合は、パーティションを数値として指定できます <code class=syntax>201901</code> または文字列 <code class=syntax>'201901'</code>. 新しいスタイルのテーブルの構文は、型によってより厳密になります（値の入力形式のパーサーと同様）。</p> <p>上記のすべてのルールは、 <a href=../../misc/amp/#misc_operations-optimize>OPTIMIZE</a> クエリ。 を指定する場合にのみ分配時の最適化、非仕切られたテーブルセットの表現 <code class=syntax>PARTITION tuple()</code>. 例えば:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>OPTIMIZE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>table_not_partitioned</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=n>tuple</span><span class=p>()</span><span class=w> </span><span class=k>FINAL</span><span class=p>;</span><span class=w></span>
</code></pre></div> <p>の例 <code class=syntax>ALTER ... PARTITION</code> クエリは、テストで示されます <a href=https://github.com/ClickHouse/ClickHouse/blob/master/tests/queries/0_stateless/00502_custom_partitioning_local.sql rel="external nofollow noreferrer" target=_blank><code class=syntax>00502_custom_partitioning_local</code></a> と <a href=https://github.com/ClickHouse/ClickHouse/blob/master/tests/queries/0_stateless/00502_custom_partitioning_replicated_zookeeper.sql rel="external nofollow noreferrer" target=_blank><code class=syntax>00502_custom_partitioning_replicated_zookeeper</code></a>.</p> <h3 id=manipulations-with-table-ttl>テーブルTTLによる操作<a class=headerlink href=../amp/#manipulations-with-table-ttl title="Permanent link"> </a></h3> <p>変更できます <a href=../../../../engines/table-engines/mergetree-family/mergetree/amp/#mergetree-table-ttl>テーブルTTL</a> 以下のフォームのリクエストで:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>table</span><span class=o>-</span><span class=n>name</span><span class=w> </span><span class=k>MODIFY</span><span class=w> </span><span class=n>TTL</span><span class=w> </span><span class=n>ttl</span><span class=o>-</span><span class=n>expression</span><span class=w></span>
</code></pre></div> <h3 id=synchronicity-of-alter-queries>ALTERクエリの同期性<a class=headerlink href=../amp/#synchronicity-of-alter-queries title="Permanent link"> </a></h3> <p>複製不可能なテーブルの場合、すべて <code class=syntax>ALTER</code> クエリは同期的に実行されます。 のためのreplicatableテーブル、クエリーだけで追加指示のための適切な行動を <code class=syntax>ZooKeeper</code> そして、アクション自体はできるだけ早く実行されます。 ただし、クエリは、すべてのレプリカでこれらの操作が完了するまで待機できます。</p> <p>のために <code class=syntax>ALTER ... ATTACH|DETACH|DROP</code> クエリを使用することができます <code class=syntax>replication_alter_partitions_sync</code> 待機を設定する設定。<br> 可能な値: <code class=syntax>0</code> – do not wait; <code class=syntax>1</code> – only wait for own execution (default); <code class=syntax>2</code> – wait for all.</p> <h3 id=alter-mutations>突然変異<a class=headerlink href=../amp/#alter-mutations title="Permanent link"> </a></h3> <p>突然変異は、テーブル内の行を変更または削除できるALTER query variantです。 標準とは対照的に <code class=syntax>UPDATE</code> と <code class=syntax>DELETE</code> ポイントデータの変更、突然変異を目的としたクエリは、テーブル内の多くの行を変更する重い操作を目的としています。 のために支えられる <code class=syntax>MergeTree</code> 家族のテーブルエンジンなどのエンジンの複製です。</p> <p>既存のテーブルはそのままで(変換は必要ありません)突然変異の準備ができていますが、最初の突然変異がテーブルに適用されると、そのメタデータ形式</p> <p>現在利用可能なコマンド:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=k>table</span><span class=w> </span><span class=k>DELETE</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>filter_expr</span><span class=w></span>
</code></pre></div> <p>その <code class=syntax>filter_expr</code> 型である必要があります <code class=syntax>UInt8</code>. このクエリは、この式がゼロ以外の値をとるテーブル内の行を削除します。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=k>table</span><span class=w> </span><span class=k>UPDATE</span><span class=w> </span><span class=n>column1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>expr1</span><span class=w> </span><span class=p>[,</span><span class=w> </span><span class=p>...]</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>filter_expr</span><span class=w></span>
</code></pre></div> <p>その <code class=syntax>filter_expr</code> 型である必要があります <code class=syntax>UInt8</code>. このクエリは、指定された列の値を、指定された列の行の対応する式の値に更新します。 <code class=syntax>filter_expr</code> ゼロ以外の値をとります。 値は、列型にキャストされます。 <code class=syntax>CAST</code> オペレーター プライマリキーまたはパーティションキーの計算で使用される列の更新はサポートされません。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=k>table</span><span class=w> </span><span class=n>MATERIALIZE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=n>partition_name</span><span class=w></span>
</code></pre></div> <p>クエリを再建の二次指数 <code class=syntax>name</code> パーティション内 <code class=syntax>partition_name</code>.</p> <p>一つのクエリを含むことができ複数のコマンドをカンマで区切られています。</p> <p>*MergeTree表の場合、突然変異はデータ部分全体を書き換えることによって実行されます。 原子性がない-部品は準備ができているとすぐ変異させた部品のために置き換えられ、a <code class=syntax>SELECT</code> 突然変異中に実行を開始したクエリには、すでに変異している部分のデータと、まだ変異していない部分のデータが表示されます。</p> <p>突然変異は完全にそれらの作成順序によって順序付けられ、その順序で各部分に適用される。 突然変異が送信される前にテーブルに挿入されたデータは変異され、その後に挿入されたデータは変異されません。 突然変異は挿入を決してブロックしないことに注意してください。</p> <p>突然変異クエリは、突然変異エントリが追加された直後に返されます(複製されたテーブルがZooKeeperに、複製されていないテーブルがファイルシステムに)。 の突然変異体の執行を非同利用システムの概要を設定します。 あなたが使用することができ、突然変異の進行を追跡するために <a href=../../../../operations/system-tables/amp/#system_tables-mutations><code class=syntax>system.mutations</code></a> テーブル。 正常に送信された突然変異は、ClickHouseサーバーが再起動されても実行され続けます。 それが提出された後、突然変異をロールバックする方法はありませんが、突然変異が何らかの理由で立ち往生している場合、それは <a href=../../misc/amp/#kill-mutation><code class=syntax>KILL MUTATION</code></a> クエリ。</p> <p>完了した突然変異のエントリはすぐに削除されません（保存されたエントリの数は、 <code class=syntax>finished_mutations_to_keep</code> ストレージエンジ 古い突然変異エントリは削除されます。</p> <h2 id=alter-user-statement>ALTER USER<a class=headerlink href=../amp/#alter-user-statement title="Permanent link"> </a></h2> <p>ClickHouseユーザーアカウントの変更。</p> <h3 id=alter-user-syntax>構文<a class=headerlink href=../amp/#alter-user-syntax title="Permanent link"> </a></h3> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>USER</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=p>[</span><span class=k>ON</span><span class=w> </span><span class=k>CLUSTER</span><span class=w> </span><span class=n>cluster_name</span><span class=p>]</span><span class=w></span>
<span class=w>    </span><span class=p>[</span><span class=k>RENAME</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=n>new_name</span><span class=p>]</span><span class=w></span>
<span class=w>    </span><span class=p>[</span><span class=n>IDENTIFIED</span><span class=w> </span><span class=p>[</span><span class=k>WITH</span><span class=w> </span><span class=err>{</span><span class=n>PLAINTEXT_PASSWORD</span><span class=o>|</span><span class=n>SHA256_PASSWORD</span><span class=o>|</span><span class=n>DOUBLE_SHA1_PASSWORD</span><span class=err>}</span><span class=p>]</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=err>{</span><span class=s1>'password'</span><span class=o>|</span><span class=s1>'hash'</span><span class=err>}</span><span class=p>]</span><span class=w></span>
<span class=w>    </span><span class=p>[[</span><span class=k>ADD</span><span class=o>|</span><span class=k>DROP</span><span class=p>]</span><span class=w> </span><span class=k>HOST</span><span class=w> </span><span class=err>{</span><span class=k>LOCAL</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>NAME</span><span class=w> </span><span class=s1>'name'</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>REGEXP</span><span class=w> </span><span class=s1>'name_regexp'</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>IP</span><span class=w> </span><span class=s1>'address'</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>'pattern'</span><span class=err>}</span><span class=w> </span><span class=p>[,...]</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>ANY</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>NONE</span><span class=p>]</span><span class=w></span>
<span class=w>    </span><span class=p>[</span><span class=k>DEFAULT</span><span class=w> </span><span class=k>ROLE</span><span class=w> </span><span class=k>role</span><span class=w> </span><span class=p>[,...]</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>ALL</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>ALL</span><span class=w> </span><span class=k>EXCEPT</span><span class=w> </span><span class=k>role</span><span class=w> </span><span class=p>[,...]</span><span class=w> </span><span class=p>]</span><span class=w></span>
<span class=w>    </span><span class=p>[</span><span class=n>SETTINGS</span><span class=w> </span><span class=k>variable</span><span class=w> </span><span class=p>[</span><span class=o>=</span><span class=w> </span><span class=n>value</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=k>MIN</span><span class=w> </span><span class=p>[</span><span class=o>=</span><span class=p>]</span><span class=w> </span><span class=n>min_value</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=k>MAX</span><span class=w> </span><span class=p>[</span><span class=o>=</span><span class=p>]</span><span class=w> </span><span class=n>max_value</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>READONLY</span><span class=o>|</span><span class=n>WRITABLE</span><span class=p>]</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>PROFILE</span><span class=w> </span><span class=s1>'profile_name'</span><span class=p>]</span><span class=w> </span><span class=p>[,...]</span><span class=w></span>
</code></pre></div> <h3 id=alter-user-dscr>説明<a class=headerlink href=../amp/#alter-user-dscr title="Permanent link"> </a></h3> <p>使用するには <code class=syntax>ALTER USER</code> あなたは、 <a href=../../grant/amp/#grant-access-management>ALTER USER</a> 特権だ</p> <h3 id=alter-user-examples>例<a class=headerlink href=../amp/#alter-user-examples title="Permanent link"> </a></h3> <p>付与されたロールを既定に設定する:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>USER</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>ROLE</span><span class=w> </span><span class=n>role1</span><span class=p>,</span><span class=w> </span><span class=n>role2</span><span class=w></span>
</code></pre></div> <p>ロールが以前にユーザーに付与されていない場合、ClickHouseは例外をスローします。</p> <p>付与されたすべての役割をdefaultに設定します:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>USER</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>ROLE</span><span class=w> </span><span class=k>ALL</span><span class=w></span>
</code></pre></div> <p>将来ユーザーにロールが付与されると、自動的にデフォルトになります。</p> <p>セットの付与の役割をデフォルトを除く <code class=syntax>role1</code> と <code class=syntax>role2</code>:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>USER</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>ROLE</span><span class=w> </span><span class=k>ALL</span><span class=w> </span><span class=k>EXCEPT</span><span class=w> </span><span class=n>role1</span><span class=p>,</span><span class=w> </span><span class=n>role2</span><span class=w></span>
</code></pre></div> <h2 id=alter-role-statement>ALTER ROLE<a class=headerlink href=../amp/#alter-role-statement title="Permanent link"> </a></h2> <p>役割を変更します。</p> <h3 id=alter-role-syntax>構文<a class=headerlink href=../amp/#alter-role-syntax title="Permanent link"> </a></h3> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=k>ROLE</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=p>[</span><span class=k>ON</span><span class=w> </span><span class=k>CLUSTER</span><span class=w> </span><span class=n>cluster_name</span><span class=p>]</span><span class=w></span>
<span class=w>    </span><span class=p>[</span><span class=k>RENAME</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=n>new_name</span><span class=p>]</span><span class=w></span>
<span class=w>    </span><span class=p>[</span><span class=n>SETTINGS</span><span class=w> </span><span class=k>variable</span><span class=w> </span><span class=p>[</span><span class=o>=</span><span class=w> </span><span class=n>value</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=k>MIN</span><span class=w> </span><span class=p>[</span><span class=o>=</span><span class=p>]</span><span class=w> </span><span class=n>min_value</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=k>MAX</span><span class=w> </span><span class=p>[</span><span class=o>=</span><span class=p>]</span><span class=w> </span><span class=n>max_value</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>READONLY</span><span class=o>|</span><span class=n>WRITABLE</span><span class=p>]</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>PROFILE</span><span class=w> </span><span class=s1>'profile_name'</span><span class=p>]</span><span class=w> </span><span class=p>[,...]</span><span class=w></span>
</code></pre></div> <h2 id=alter-row-policy-statement>ALTER ROW POLICY<a class=headerlink href=../amp/#alter-row-policy-statement title="Permanent link"> </a></h2> <p>行ポリシーを変更します。</p> <h3 id=alter-row-policy-syntax>構文<a class=headerlink href=../amp/#alter-row-policy-syntax title="Permanent link"> </a></h3> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=p>[</span><span class=k>ROW</span><span class=p>]</span><span class=w> </span><span class=n>POLICY</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=p>[</span><span class=k>ON</span><span class=w> </span><span class=k>CLUSTER</span><span class=w> </span><span class=n>cluster_name</span><span class=p>]</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=p>[</span><span class=k>database</span><span class=p>.]</span><span class=k>table</span><span class=w></span>
<span class=w>    </span><span class=p>[</span><span class=k>RENAME</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=n>new_name</span><span class=p>]</span><span class=w></span>
<span class=w>    </span><span class=p>[</span><span class=k>AS</span><span class=w> </span><span class=err>{</span><span class=n>PERMISSIVE</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>RESTRICTIVE</span><span class=err>}</span><span class=p>]</span><span class=w></span>
<span class=w>    </span><span class=p>[</span><span class=k>FOR</span><span class=w> </span><span class=k>SELECT</span><span class=p>]</span><span class=w></span>
<span class=w>    </span><span class=p>[</span><span class=k>USING</span><span class=w> </span><span class=err>{</span><span class=n>condition</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>NONE</span><span class=err>}</span><span class=p>][,...]</span><span class=w></span>
<span class=w>    </span><span class=p>[</span><span class=k>TO</span><span class=w> </span><span class=err>{</span><span class=k>role</span><span class=w> </span><span class=p>[,...]</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>ALL</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>ALL</span><span class=w> </span><span class=k>EXCEPT</span><span class=w> </span><span class=k>role</span><span class=w> </span><span class=p>[,...]</span><span class=err>}</span><span class=p>]</span><span class=w></span>
</code></pre></div> <h2 id=alter-quota-statement>ALTER QUOTA<a class=headerlink href=../amp/#alter-quota-statement title="Permanent link"> </a></h2> <p>クォータを変更します。</p> <h3 id=alter-quota-syntax>構文<a class=headerlink href=../amp/#alter-quota-syntax title="Permanent link"> </a></h3> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=n>QUOTA</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=p>[</span><span class=k>ON</span><span class=w> </span><span class=k>CLUSTER</span><span class=w> </span><span class=n>cluster_name</span><span class=p>]</span><span class=w></span>
<span class=w>    </span><span class=p>[</span><span class=k>RENAME</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=n>new_name</span><span class=p>]</span><span class=w></span>
<span class=w>    </span><span class=p>[</span><span class=n>KEYED</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=err>{</span><span class=s1>'none'</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=s1>'user name'</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=s1>'ip address'</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=s1>'client key'</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=s1>'client key or user name'</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=s1>'client key or ip address'</span><span class=err>}</span><span class=p>]</span><span class=w></span>
<span class=w>    </span><span class=p>[</span><span class=k>FOR</span><span class=w> </span><span class=p>[</span><span class=n>RANDOMIZED</span><span class=p>]</span><span class=w> </span><span class=nb>INTERVAL</span><span class=w> </span><span class=nb>number</span><span class=w> </span><span class=err>{</span><span class=k>SECOND</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>MINUTE</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>HOUR</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>DAY</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>WEEK</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>MONTH</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>QUARTER</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>YEAR</span><span class=err>}</span><span class=w></span>
<span class=w>        </span><span class=err>{</span><span class=k>MAX</span><span class=w> </span><span class=err>{</span><span class=w> </span><span class=err>{</span><span class=n>QUERIES</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>ERRORS</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>RESULT</span><span class=w> </span><span class=k>ROWS</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>RESULT</span><span class=w> </span><span class=n>BYTES</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>READ</span><span class=w> </span><span class=k>ROWS</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>READ</span><span class=w> </span><span class=n>BYTES</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>EXECUTION</span><span class=w> </span><span class=k>TIME</span><span class=err>}</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>number</span><span class=w> </span><span class=err>}</span><span class=w> </span><span class=p>[,...]</span><span class=w> </span><span class=o>|</span><span class=w></span>
<span class=w>        </span><span class=k>NO</span><span class=w> </span><span class=n>LIMITS</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>TRACKING</span><span class=w> </span><span class=k>ONLY</span><span class=err>}</span><span class=w> </span><span class=p>[,...]]</span><span class=w></span>
<span class=w>    </span><span class=p>[</span><span class=k>TO</span><span class=w> </span><span class=err>{</span><span class=k>role</span><span class=w> </span><span class=p>[,...]</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>ALL</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>ALL</span><span class=w> </span><span class=k>EXCEPT</span><span class=w> </span><span class=k>role</span><span class=w> </span><span class=p>[,...]</span><span class=err>}</span><span class=p>]</span><span class=w></span>
</code></pre></div> <h2 id=alter-settings-profile-statement>ALTER SETTINGS PROFILE<a class=headerlink href=../amp/#alter-settings-profile-statement title="Permanent link"> </a></h2> <p>クォータを変更します。</p> <h3 id=alter-settings-profile-syntax>構文<a class=headerlink href=../amp/#alter-settings-profile-syntax title="Permanent link"> </a></h3> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span><span class=w> </span><span class=n>SETTINGS</span><span class=w> </span><span class=n>PROFILE</span><span class=w> </span><span class=p>[</span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=p>]</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=p>[</span><span class=k>ON</span><span class=w> </span><span class=k>CLUSTER</span><span class=w> </span><span class=n>cluster_name</span><span class=p>]</span><span class=w></span>
<span class=w>    </span><span class=p>[</span><span class=k>RENAME</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=n>new_name</span><span class=p>]</span><span class=w></span>
<span class=w>    </span><span class=p>[</span><span class=n>SETTINGS</span><span class=w> </span><span class=k>variable</span><span class=w> </span><span class=p>[</span><span class=o>=</span><span class=w> </span><span class=n>value</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=k>MIN</span><span class=w> </span><span class=p>[</span><span class=o>=</span><span class=p>]</span><span class=w> </span><span class=n>min_value</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=k>MAX</span><span class=w> </span><span class=p>[</span><span class=o>=</span><span class=p>]</span><span class=w> </span><span class=n>max_value</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=n>READONLY</span><span class=o>|</span><span class=n>WRITABLE</span><span class=p>]</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>INHERIT</span><span class=w> </span><span class=s1>'profile_name'</span><span class=p>]</span><span class=w> </span><span class=p>[,...]</span><span class=w></span>
</code></pre></div>
        </div>
      </div>
      <div class="row">
        <div class="col">
          
<div class="alert alert-light my-3">
  <p class="float-right mb-0">Rating: RATING_VALUE - RATING_COUNT votes</p>
  <span class="alert-heading display-6">Article Rating</span>
  <div id="rating-stars" class="display-6 mb-0"
     
  >RATING_STARS</div>
</div>

<div id="content-footer" class="text-muted pt-3 mb-5">
    <div class="float-md-right">©2016–2022 ClickHouse, Inc.</div>
    <div>Built from <a href="https://github.com/ClickHouse/ClickHouse/commit/38993f215f9186c1ac3505b1e09697cd9a468b5d" rel="external nofollow noreferrer" target="_blank" class="text-reset">38993f21</a>
    
    </div>
</div>

        </div>
      </div>
      <div id="to-full-website" class="row fixed-bottom text-center bg-white py-3">
        <div class="col">
          <a class="btn btn-lg btn-outline-orange" href="https://clickhouse.com/docs/ja/sql-reference/statements/alter/">To full website</a>
        </div>
      </div>
    </div>
    <amp-analytics type="metrika">
      <script type="application/json">{
"vars": {
  "counterId": "18343495",
  "triggers": {
    "notBounce": {
      "on": "timer",
      "timerSpec": {
        "immediate": false,
        "interval": 15,
        "maxTimerLength": 16
      },
      "request": "notBounce"
    }
  }
}
}</script>
  </amp-analytics>
  </body>
</html>
