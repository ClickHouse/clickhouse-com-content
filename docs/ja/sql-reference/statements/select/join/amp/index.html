










    



    



    



    
    






    <!doctype html>
<html ⚡ lang="ja">
  <head>
    <meta charset="utf-8">
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    <title>JOIN | ClickHouseドキュメント</title>
    <link rel="canonical" href="https://clickhouse.com/docs/en/sql-reference/statements/select/join/" />
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    
<script type="application/ld+json">[{
"@context": "http://schema.org",
"@type": "TechArticle",
"headline": "JOIN | ClickHouseドキュメント",
"mainEntityOfPage": "https://clickhouse.com/docs/ja/sql-reference/statements/select/join/",




"image": "https://clickhouse.com/images/clickhouse-209x60.png",
"author": {
  "@type": "Project",
  "name": "ClickHouse"
},
"publisher": {
  "@type": "Organization",
  "name": "ClickHouse, Inc.",
  "logo": {
    "@type": "ImageObject",
    "url": "https://clickhouse.com/images/logo-400x240.png",
    "width": 400,
    "height": 240
  }
}}, {
"@context": "http://schema.org",
"@type": "Episode",
"name": "JOIN | ClickHouseドキュメント",
"aggregateRating": {
  "@type": "AggregateRating",
  "ratingValue": RATING_VALUE,
  "ratingCount": RATING_COUNT
}
}]</script>

    
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <style amp-custom>:root{--blue:#007bff;--indigo:#6610f2;--purple:#6f42c1;--pink:#e83e8c;--red:#dc3545;--orange:#fd7e14;--yellow:#ffc107;--green:#28a745;--teal:#20c997;--cyan:#17a2b8;--gray:#6c757d;--gray-dark:#343a40;--brand-primary:#fc0;--brand-secondary:#ff3939;--primary-accent-yellow:#fc0;--primary-accent-light-yellow:#fffaf0;--primary-accent-blue:#257af4;--primary-accent-light-blue:#e3f1fe;--secondary-accent-orange:#ff8c00;--secondary-accent-light-orange:#ffe4b5;--secondary-accent-red:#ff3939;--secondary-accent-light-red:#ffe4e1;--primary:#fc0;--secondary:#212529;--success:#28a745;--info:#17a2b8;--warning:#ffc107;--danger:#dc3545;--light:#f1f6f9;--dark:#495057;--primary-light:#fffaf0;--secondary-light:#fff;--tertiary:#257af4;--tertiary-light:#e3f1fe;--white:#fff;--black:#212529;--blue:#257af4;--light-blue:#e3f1fe;--yellow:#fc0;--light-yellow:#fffaf0;--orange:#ff8c00;--light-orange:#ffe4b5;--red:#ff3939;--light-red:#ffe4e1;--medium:#d6dbdf;--breakpoint-xxs:0;--breakpoint-xs:400px;--breakpoint-sm:616px;--breakpoint-md:768px;--breakpoint-lg:980px;--breakpoint-xl:1240px;--font-family-sans-serif:"Noto Sans",sans-serif;--font-family-monospace:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}*,:after,:before{box-sizing:border-box}html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:rgba(33,37,41,0)}article,footer,section{display:block}body{margin:0;font-family:Noto Sans,sans-serif;font-size:1rem;font-weight:400;line-height:1.5;color:#212529;text-align:left;background-color:#fff}[tabindex="-1"]:focus:not(:focus-visible){outline:0}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:16px}p{margin-top:0;margin-bottom:1rem}ul{margin-bottom:1rem}ul{margin-top:0}ul ul{margin-bottom:0}b,strong{font-weight:bolder}small{font-size:80%}a{text-decoration:none;background-color:transparent}a,a:hover{color:#ff8c00}a:hover{text-decoration:underline}a:not([href]),a:not([href]):hover{color:inherit;text-decoration:none}code,pre{font-family:SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em}pre{margin-top:0;margin-bottom:1rem;overflow:auto}img{border-style:none}img,svg{vertical-align:middle}svg{overflow:hidden}table{border-collapse:collapse}select{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}select{text-transform:none}select{word-wrap:normal}[type=button],[type=reset],[type=submit]{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled){cursor:pointer}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{padding:0;border-style:none}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:none}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}[hidden]{display:none}.h1,.h2,.h3,.h4,.h5,.h6,h1,h2,h3,h4,h5,h6{margin-bottom:16px;font-family:Hind Siliguri,sans-serif;font-weight:500;line-height:1.125}.h1,h1{font-size:2.5rem}@media(max-width:1200px){.h1,h1{font-size:calc(1.375rem+1.5vw)}}.h2,h2{font-size:2rem}@media(max-width:1200px){.h2,h2{font-size:calc(1.325rem+.9vw)}}.h3,h3{font-size:1.75rem}@media(max-width:1200px){.h3,h3{font-size:calc(1.3rem+.6vw)}}.h4,h4{font-size:1.5rem}@media(max-width:1200px){.h4,h4{font-size:calc(1.275rem+.3vw)}}.h5,h5{font-size:1.125rem}.h6,h6{font-size:.875rem}.display-1{font-size:4rem;font-weight:600;line-height:1.125}@media(max-width:1200px){.display-1{font-size:calc(1.525rem+3.3vw)}}.display-2{font-size:2.5rem;font-weight:600;line-height:1.125}@media(max-width:1200px){.display-2{font-size:calc(1.375rem+1.5vw)}}.display-3{font-size:2rem;font-weight:500;line-height:1.125}@media(max-width:1200px){.display-3{font-size:calc(1.325rem+.9vw)}}.display-4{font-size:1.75rem;font-weight:500;line-height:1.125}@media(max-width:1200px){.display-4{font-size:calc(1.3rem+.6vw)}}.small,small{font-size:80%;font-weight:400}.list-inline{padding-left:0;list-style:none}.img-fluid{max-width:100%;height:auto}code{font-size:87.5%;color:#e83e8c;word-wrap:break-word}a>code{color:inherit}pre{display:block;font-size:87.5%;color:#495057}pre code{font-size:inherit;color:inherit;word-break:normal}.container{width:100%;padding-right:20px;padding-left:20px;margin-right:auto;margin-left:auto}@media(min-width:400px){.container{max-width:576px}}@media(min-width:616px){.container{max-width:576px}}@media(min-width:768px){.container{max-width:958px}}@media(min-width:980px){.container{max-width:1008px}}@media(min-width:1240px){.container{max-width:1118px}}.container-fluid,.container-lg,.container-md{width:100%;padding-right:20px;padding-left:20px;margin-right:auto;margin-left:auto}@media(min-width:400px){.container{max-width:576px}}@media(min-width:616px){.container{max-width:576px}}@media(min-width:768px){.container,.container-md{max-width:958px}}@media(min-width:980px){.container,.container-lg,.container-md{max-width:1008px}}@media(min-width:1240px){.container,.container-lg,.container-md{max-width:1118px}}.row{display:flex;flex-wrap:wrap;margin-right:-20px;margin-left:-20px}.col,.col-1,.col-10,.col-11,.col-12,.col-2,.col-3,.col-4,.col-5,.col-6,.col-7,.col-8,.col-9,.col-auto,.col-lg,.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-lg-auto,.col-md,.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9,.col-md-auto{position:relative;width:100%;padding-right:20px;padding-left:20px}.col{flex-basis:0;flex-grow:1;max-width:100%}.col-auto{flex:0 0 auto;width:auto;max-width:100%}.col-1{flex:0 0 8.3333333333%;max-width:8.3333333333%}.col-2{flex:0 0 16.6666666667%;max-width:16.6666666667%}.col-3{flex:0 0 25%;max-width:25%}.col-4{flex:0 0 33.3333333333%;max-width:33.3333333333%}.col-5{flex:0 0 41.6666666667%;max-width:41.6666666667%}.col-6{flex:0 0 50%;max-width:50%}.col-7{flex:0 0 58.3333333333%;max-width:58.3333333333%}.col-8{flex:0 0 66.6666666667%;max-width:66.6666666667%}.col-9{flex:0 0 75%;max-width:75%}.col-10{flex:0 0 83.3333333333%;max-width:83.3333333333%}.col-11{flex:0 0 91.6666666667%;max-width:91.6666666667%}.col-12{flex:0 0 100%;max-width:100%}.order-first{order:-1}.order-last{order:13}.order-0{order:0}.order-1{order:1}.order-2{order:2}.order-3{order:3}.order-4{order:4}.order-5{order:5}.order-6{order:6}.order-7{order:7}.order-8{order:8}.order-9{order:9}.order-10{order:10}.order-11{order:11}.order-12{order:12}@media(min-width:768px){.col-md{flex-basis:0;flex-grow:1;max-width:100%}.col-md-auto{flex:0 0 auto;width:auto;max-width:100%}.col-md-1{flex:0 0 8.3333333333%;max-width:8.3333333333%}.col-md-2{flex:0 0 16.6666666667%;max-width:16.6666666667%}.col-md-3{flex:0 0 25%;max-width:25%}.col-md-4{flex:0 0 33.3333333333%;max-width:33.3333333333%}.col-md-5{flex:0 0 41.6666666667%;max-width:41.6666666667%}.col-md-6{flex:0 0 50%;max-width:50%}.col-md-7{flex:0 0 58.3333333333%;max-width:58.3333333333%}.col-md-8{flex:0 0 66.6666666667%;max-width:66.6666666667%}.col-md-9{flex:0 0 75%;max-width:75%}.col-md-10{flex:0 0 83.3333333333%;max-width:83.3333333333%}.col-md-11{flex:0 0 91.6666666667%;max-width:91.6666666667%}.col-md-12{flex:0 0 100%;max-width:100%}.order-md-first{order:-1}.order-md-last{order:13}.order-md-0{order:0}.order-md-1{order:1}.order-md-2{order:2}.order-md-3{order:3}.order-md-4{order:4}.order-md-5{order:5}.order-md-6{order:6}.order-md-7{order:7}.order-md-8{order:8}.order-md-9{order:9}.order-md-10{order:10}.order-md-11{order:11}.order-md-12{order:12}}@media(min-width:980px){.col-lg{flex-basis:0;flex-grow:1;max-width:100%}.col-lg-auto{flex:0 0 auto;width:auto;max-width:100%}.col-lg-1{flex:0 0 8.3333333333%;max-width:8.3333333333%}.col-lg-2{flex:0 0 16.6666666667%;max-width:16.6666666667%}.col-lg-3{flex:0 0 25%;max-width:25%}.col-lg-4{flex:0 0 33.3333333333%;max-width:33.3333333333%}.col-lg-5{flex:0 0 41.6666666667%;max-width:41.6666666667%}.col-lg-6{flex:0 0 50%;max-width:50%}.col-lg-7{flex:0 0 58.3333333333%;max-width:58.3333333333%}.col-lg-8{flex:0 0 66.6666666667%;max-width:66.6666666667%}.col-lg-9{flex:0 0 75%;max-width:75%}.col-lg-10{flex:0 0 83.3333333333%;max-width:83.3333333333%}.col-lg-11{flex:0 0 91.6666666667%;max-width:91.6666666667%}.col-lg-12{flex:0 0 100%;max-width:100%}.order-lg-first{order:-1}.order-lg-last{order:13}.order-lg-0{order:0}.order-lg-1{order:1}.order-lg-2{order:2}.order-lg-3{order:3}.order-lg-4{order:4}.order-lg-5{order:5}.order-lg-6{order:6}.order-lg-7{order:7}.order-lg-8{order:8}.order-lg-9{order:9}.order-lg-10{order:10}.order-lg-11{order:11}.order-lg-12{order:12}}.table{width:100%;margin-bottom:8px;color:#212529}.table-primary{background-color:#fff1b8}.table-light{background-color:#fbfcfd}.table-dark{background-color:#ccced0}.table-primary-light{background-color:#fffefb}.table-white{background-color:#fff}.table-black{background-color:#c1c2c3}.table-orange{background-color:#ffdfb8}.table-light-orange{background-color:#fff7ea}.table-dark{color:#fff;background-color:#343a40}.btn{display:inline-block;font-family:inherit;font-weight:700;color:#212529;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;padding:12px 32px;font-size:.875rem;line-height:20px;border-radius:8px;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media(prefers-reduced-motion:reduce){.btn{transition:none}}.btn:hover{color:#212529;text-decoration:none}.btn:focus{outline:0;box-shadow:none}.btn:disabled{opacity:.65}.btn-primary{color:#495057;background-color:#fc0;border-color:#fc0}.btn-primary:focus,.btn-primary:hover{color:#495057;background-color:#d9ad00;border-color:#cca300}.btn-primary:focus{box-shadow:0 0 0 0 rgba(228,185,13,.5)}.btn-primary:disabled{color:#495057;background-color:#fc0;border-color:#fc0}.btn-light{color:#495057;background-color:#f1f6f9;border-color:#f1f6f9}.btn-light:focus,.btn-light:hover{color:#495057;background-color:#d6e5ee;border-color:#cddfea}.btn-light:focus{box-shadow:0 0 0 0 rgba(216,221,225,.5)}.btn-light:disabled{color:#495057;background-color:#f1f6f9;border-color:#f1f6f9}.btn-dark{color:#fff;background-color:#495057;border-color:#495057}.btn-dark:focus,.btn-dark:hover{color:#fff;background-color:#383d42;border-color:#32373b}.btn-dark:focus{box-shadow:0 0 0 0 rgba(100,106,112,.5)}.btn-dark:disabled{color:#fff;background-color:#495057;border-color:#495057}.btn-primary-light{color:#495057;background-color:#fffaf0;border-color:#fffaf0}.btn-primary-light:focus,.btn-primary-light:hover{color:#495057;background-color:#ffedca;border-color:#ffe9bd}.btn-primary-light:focus{box-shadow:0 0 0 0 rgba(228,225,217,.5)}.btn-primary-light:disabled{color:#495057;background-color:#fffaf0;border-color:#fffaf0}.btn-white{color:#495057;background-color:#fff;border-color:#fff}.btn-white:focus,.btn-white:hover{color:#495057;background-color:#ececec;border-color:#e6e6e6}.btn-white:focus{box-shadow:0 0 0 0 rgba(228,229,230,.5)}.btn-white:disabled{color:#495057;background-color:#fff;border-color:#fff}.btn-black{color:#fff;background-color:#212529;border-color:#212529}.btn-black:focus,.btn-black:hover{color:#fff;background-color:#101214;border-color:#0a0c0d}.btn-black:focus{box-shadow:0 0 0 0 rgba(66,70,73,.5)}.btn-black:disabled{color:#fff;background-color:#212529;border-color:#212529}.btn-orange{color:#495057;background-color:#ff8c00;border-color:#ff8c00}.btn-orange:focus,.btn-orange:hover{color:#fff;background-color:#d97700;border-color:#cc7000}.btn-orange:focus{box-shadow:0 0 0 0 rgba(228,131,13,.5)}.btn-orange:disabled{color:#495057;background-color:#ff8c00;border-color:#ff8c00}.btn-light-orange{color:#495057;background-color:#ffe4b5;border-color:#ffe4b5}.btn-light-orange:focus,.btn-light-orange:hover{color:#495057;background-color:#ffd68f;border-color:#ffd182}.btn-light-orange:focus{box-shadow:0 0 0 0 rgba(228,206,167,.5)}.btn-light-orange:disabled{color:#495057;background-color:#ffe4b5;border-color:#ffe4b5}.btn-outline-primary{color:#fc0;border-color:#fc0}.btn-outline-primary:hover{color:#495057;background-color:#fc0;border-color:#fc0}.btn-outline-primary:focus{box-shadow:0 0 0 0 rgba(255,204,0,.5)}.btn-outline-primary:disabled{color:#fc0;background-color:transparent}.btn-outline-light{color:#f1f6f9;border-color:#f1f6f9}.btn-outline-light:hover{color:#495057;background-color:#f1f6f9;border-color:#f1f6f9}.btn-outline-light:focus{box-shadow:0 0 0 0 rgba(241,246,249,.5)}.btn-outline-light:disabled{color:#f1f6f9;background-color:transparent}.btn-outline-dark{color:#495057;border-color:#495057}.btn-outline-dark:hover{color:#fff;background-color:#495057;border-color:#495057}.btn-outline-dark:focus{box-shadow:0 0 0 0 rgba(73,80,87,.5)}.btn-outline-dark:disabled{color:#495057;background-color:transparent}.btn-outline-primary-light{color:#fffaf0;border-color:#fffaf0}.btn-outline-primary-light:hover{color:#495057;background-color:#fffaf0;border-color:#fffaf0}.btn-outline-primary-light:focus{box-shadow:0 0 0 0 rgba(255,250,240,.5)}.btn-outline-primary-light:disabled{color:#fffaf0;background-color:transparent}.btn-outline-white{color:#fff;border-color:#fff}.btn-outline-white:hover{color:#495057;background-color:#fff;border-color:#fff}.btn-outline-white:focus{box-shadow:0 0 0 0 hsla(0,0%,100%,.5)}.btn-outline-white:disabled{color:#fff;background-color:transparent}.btn-outline-black{color:#212529;border-color:#212529}.btn-outline-black:hover{color:#fff;background-color:#212529;border-color:#212529}.btn-outline-black:focus{box-shadow:0 0 0 0 rgba(33,37,41,.5)}.btn-outline-black:disabled{color:#212529;background-color:transparent}.btn-outline-orange{color:#ff8c00;border-color:#ff8c00}.btn-outline-orange:hover{color:#495057;background-color:#ff8c00;border-color:#ff8c00}.btn-outline-orange:focus{box-shadow:0 0 0 0 rgba(255,140,0,.5)}.btn-outline-orange:disabled{color:#ff8c00;background-color:transparent}.btn-outline-light-orange{color:#ffe4b5;border-color:#ffe4b5}.btn-outline-light-orange:hover{color:#495057;background-color:#ffe4b5;border-color:#ffe4b5}.btn-outline-light-orange:focus{box-shadow:0 0 0 0 rgba(255,228,181,.5)}.btn-outline-light-orange:disabled{color:#ffe4b5;background-color:transparent}.btn-link{font-weight:400;color:#ff8c00;text-decoration:none}.btn-link:hover{color:#ff8c00;text-decoration:underline}.btn-link:focus{text-decoration:underline;box-shadow:none}.btn-link:disabled{color:#d6dbdf;pointer-events:none}.btn-group-lg>.btn,.btn-lg{padding:16px 32px;font-size:1.125rem;line-height:26px;border-radius:8px}.btn-block{display:block;width:100%}.btn-block+.btn-block{margin-top:24px}.btn-group{position:relative;display:inline-flex;vertical-align:middle}.btn-group>.btn{position:relative;flex:1 1 auto}.btn-group>.btn:active,.btn-group>.btn:focus,.btn-group>.btn:hover{z-index:1}.btn-group>.btn-group:not(:first-child),.btn-group>.btn:not(:first-child){margin-left:-1px}.btn-group>.btn-group:not(:last-child)>.btn{border-top-right-radius:0;border-bottom-right-radius:0}.btn-group>.btn-group:not(:first-child)>.btn,.btn-group>.btn:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.custom-select{display:inline-block;width:100%;height:calc(1.5em+.75rem+2px);padding:.375rem 1.75rem .375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#6c757d;vertical-align:middle;background:#fff url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='4' height='5'%3E%3Cpath fill='%23343a40' d='M2 0L0 2h4zm0 5L0 3h4z'/%3E%3C/svg%3E") no-repeat right .75rem center/8px 10px;border:1px solid #ced4da;border-radius:8px;-webkit-appearance:none;-moz-appearance:none;appearance:none}.custom-select:focus{border-color:#ffe680;outline:0;box-shadow:0 0 0 .2rem rgba(255,204,0,.25)}.custom-select:focus::-ms-value{color:#6c757d;background-color:#fff}.custom-select[multiple],.custom-select[size]:not([size="1"]){height:auto;padding-right:.75rem;background-image:none}.custom-select:disabled{color:#6c757d;background-color:#e9ecef}.custom-select::-ms-expand{display:none}.custom-select:-moz-focusring{color:transparent;text-shadow:0 0 0 #6c757d}.custom-select-lg{height:calc(1.5em+1rem+2px);padding-top:.5rem;padding-bottom:.5rem;padding-left:1rem;font-size:1.125rem}.custom-select{transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media(prefers-reduced-motion:reduce){.custom-select{transition:none}}pre{white-space:pre-wrap}pre{border:1px solid #d6dbdf;page-break-inside:avoid}img{page-break-inside:avoid}h2,h3,p{orphans:3;widows:3}h2,h3{page-break-after:avoid}@page{size:a3}.container,body{min-width:980px}.table{border-collapse:collapse}.table-dark{color:inherit}</style>
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    <script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>
  </head>
  <body class="amp" dir="ltr">
    <div class="container-fluid container-lg pb-5">
      <div class="row pt-3 mb-3">
        <div class="col">
          <a href="/" class="text-decoration-none">
            <amp-img class="d-inline-block mr-3" layout="fixed" width="40" height="36" src="/docs/images/logo.svg" alt="ClickHouse logo" title="ClickHouse logo"></amp-img><amp-img class="invert-dark d-inline-block" layout="fixed" width="238" height="36" src="/docs/images/clickhouse-black.svg" alt="ClickHouse" title="ClickHouse"></amp-img>
          </a>
        </div>
      </div>
      <div class="row">
        <div id="content" class="col">
          
          <h1 id=select-join>JOIN Clause<a class=headerlink href=../amp/#select-join title="Permanent link"> </a></h1> <p>Join produces a new table by combining columns from one or multiple tables by using values common to each. It is a common operation in databases with SQL support, which corresponds to <a href=https://en.wikipedia.org/wiki/Relational_algebra#Joins_and_join-like_operators rel="external nofollow noreferrer" target=_blank>relational algebra</a> join. The special case of one table join is often referred to as “self-join”.</p> <p><strong>Syntax</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span><span class=w> </span><span class=o>&lt;</span><span class=n>expr_list</span><span class=o>&gt;</span><span class=w></span>
<span class=k>FROM</span><span class=w> </span><span class=o>&lt;</span><span class=n>left_table</span><span class=o>&gt;</span><span class=w></span>
<span class=p>[</span><span class=k>GLOBAL</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=k>INNER</span><span class=o>|</span><span class=k>LEFT</span><span class=o>|</span><span class=k>RIGHT</span><span class=o>|</span><span class=k>FULL</span><span class=o>|</span><span class=k>CROSS</span><span class=p>]</span><span class=w> </span><span class=p>[</span><span class=k>OUTER</span><span class=o>|</span><span class=n>SEMI</span><span class=o>|</span><span class=n>ANTI</span><span class=o>|</span><span class=k>ANY</span><span class=o>|</span><span class=n>ASOF</span><span class=p>]</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=o>&lt;</span><span class=n>right_table</span><span class=o>&gt;</span><span class=w></span>
<span class=p>(</span><span class=k>ON</span><span class=w> </span><span class=o>&lt;</span><span class=n>expr_list</span><span class=o>&gt;</span><span class=p>)</span><span class=o>|</span><span class=p>(</span><span class=k>USING</span><span class=w> </span><span class=o>&lt;</span><span class=n>column_list</span><span class=o>&gt;</span><span class=p>)</span><span class=w> </span><span class=p>...</span><span class=w></span>
</code></pre></div> <p>Expressions from <code class=syntax>ON</code> clause and columns from <code class=syntax>USING</code> clause are called “join keys”. Unless otherwise stated, join produces a <a href=https://en.wikipedia.org/wiki/Cartesian_product rel="external nofollow noreferrer" target=_blank>Cartesian product</a> from rows with matching “join keys”, which might produce results with much more rows than the source tables.</p> <h2 id=select-join-types>Supported Types of JOIN<a class=headerlink href=../amp/#select-join-types title="Permanent link"> </a></h2> <p>All standard <a href=https://en.wikipedia.org/wiki/Join_(SQL) rel="external nofollow noreferrer" target=_blank>SQL JOIN</a> types are supported:</p> <ul> <li><code class=syntax>INNER JOIN</code>, only matching rows are returned.</li> <li><code class=syntax>LEFT OUTER JOIN</code>, non-matching rows from left table are returned in addition to matching rows.</li> <li><code class=syntax>RIGHT OUTER JOIN</code>, non-matching rows from right table are returned in addition to matching rows.</li> <li><code class=syntax>FULL OUTER JOIN</code>, non-matching rows from both tables are returned in addition to matching rows.</li> <li><code class=syntax>CROSS JOIN</code>, produces cartesian product of whole tables, “join keys” are <strong>not</strong> specified.</li> </ul> <p><code class=syntax>JOIN</code> without specified type implies <code class=syntax>INNER</code>. Keyword <code class=syntax>OUTER</code> can be safely omitted. Alternative syntax for <code class=syntax>CROSS JOIN</code> is specifying multiple tables in <a href=../../from/amp/ >FROM clause</a> separated by commas.</p> <p>Additional join types available in ClickHouse:</p> <ul> <li><code class=syntax>LEFT SEMI JOIN</code> and <code class=syntax>RIGHT SEMI JOIN</code>, a whitelist on “join keys”, without producing a cartesian product.</li> <li><code class=syntax>LEFT ANTI JOIN</code> and <code class=syntax>RIGHT ANTI JOIN</code>, a blacklist on “join keys”, without producing a cartesian product.</li> <li><code class=syntax>LEFT ANY JOIN</code>, <code class=syntax>RIGHT ANY JOIN</code> and <code class=syntax>INNER ANY JOIN</code>, partially (for opposite side of <code class=syntax>LEFT</code> and <code class=syntax>RIGHT</code>) or completely (for <code class=syntax>INNER</code> and <code class=syntax>FULL</code>) disables the cartesian product for standard <code class=syntax>JOIN</code> types.</li> <li><code class=syntax>ASOF JOIN</code> and <code class=syntax>LEFT ASOF JOIN</code>, joining sequences with a non-exact match. <code class=syntax>ASOF JOIN</code> usage is described below.</li> </ul> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-4 text-reset mb-2">Note</p> <p>When <a class=alert-link href=../../../../../operations/settings/settings/amp/#settings-join_algorithm>join_algorithm</a> is set to <code class=syntax>partial_merge</code>, <code class=syntax>RIGHT JOIN</code> and <code class=syntax>FULL JOIN</code> are supported only with <code class=syntax>ALL</code> strictness (<code class=syntax>SEMI</code>, <code class=syntax>ANTI</code>, <code class=syntax>ANY</code>, and <code class=syntax>ASOF</code> are not supported).</p> </div> <h2 id=join-settings>Settings<a class=headerlink href=../amp/#join-settings title="Permanent link"> </a></h2> <p>The default join type can be overridden using <a href=../../../../../operations/settings/settings/amp/#settings-join_default_strictness>join_default_strictness</a> setting.</p> <p>The behavior of ClickHouse server for <code class=syntax>ANY JOIN</code> operations depends on the <a href=../../../../../operations/settings/settings/amp/#any_join_distinct_right_table_keys>any_join_distinct_right_table_keys</a> setting.</p> <p><strong>See also</strong></p> <ul> <li><a href=../../../../../operations/settings/settings/amp/#settings-join_algorithm>join_algorithm</a></li> <li><a href=../../../../../operations/settings/settings/amp/#settings-join_any_take_last_row>join_any_take_last_row</a></li> <li><a href=../../../../../operations/settings/settings/amp/#join_use_nulls>join_use_nulls</a></li> <li><a href=../../../../../operations/settings/settings/amp/#partial_merge_join_optimizations>partial_merge_join_optimizations</a></li> <li><a href=../../../../../operations/settings/settings/amp/#partial_merge_join_rows_in_right_blocks>partial_merge_join_rows_in_right_blocks</a></li> <li><a href=../../../../../operations/settings/settings/amp/#join_on_disk_max_files_to_merge>join_on_disk_max_files_to_merge</a></li> <li><a href=../../../../../operations/settings/settings/amp/#any_join_distinct_right_table_keys>any_join_distinct_right_table_keys</a></li> </ul> <h2 id=on-section-conditions>ON Section Conditions<a class=headerlink href=../amp/#on-section-conditions title="Permanent link"> </a></h2> <p>An <code class=syntax>ON</code> section can contain several conditions combined using the <code class=syntax>AND</code> and <code class=syntax>OR</code> operators. Conditions specifying join keys must refer both left and right tables and must use the equality operator. Other conditions may use other logical operators but they must refer either the left or the right table of a query.</p> <p>Rows are joined if the whole complex condition is met. If the conditions are not met, still rows may be included in the result depending on the <code class=syntax>JOIN</code> type. Note that if the same conditions are placed in a <code class=syntax>WHERE</code> section and they are not met, then rows are always filtered out from the result.</p> <p>The <code class=syntax>OR</code> operator inside the <code class=syntax>ON</code> clause works using the hash join algorithm — for each <code class=syntax>OR</code> argument with join keys for <code class=syntax>JOIN</code>, a separate hash table is created, so memory consumption and query execution time grow linearly with an increase in the number of expressions <code class=syntax>OR</code> of the <code class=syntax>ON</code> clause.</p> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-4 text-reset mb-2">Note</p> <p>If a condition refers columns from different tables, then only the equality operator (<code class=syntax>=</code>) is supported so far.</p> </div> <p><strong>Example</strong></p> <p>Consider <code class=syntax>table_1</code> and <code class=syntax>table_2</code>:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─Id─┬─name─┐     ┌─Id─┬─text───────────┬─scores─┐
│  1 │ A    │     │  1 │ Text A         │     10 │
│  2 │ B    │     │  1 │ Another text A │     12 │
│  3 │ C    │     │  2 │ Text B         │     15 │
└────┴──────┘     └────┴────────────────┴────────┘
</code></pre></div> <p>Query with one join key condition and an additional condition for <code class=syntax>table_2</code>:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=nb>text</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table_1</span><span class=w> </span><span class=k>LEFT</span><span class=w> </span><span class=k>OUTER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>table_2</span><span class=w> </span>
<span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=n>table_1</span><span class=p>.</span><span class=n>Id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>table_2</span><span class=p>.</span><span class=n>Id</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>startsWith</span><span class=p>(</span><span class=n>table_2</span><span class=p>.</span><span class=nb>text</span><span class=p>,</span><span class=w> </span><span class=s1>'Text'</span><span class=p>);</span><span class=w></span>
</code></pre></div> <p>Note that the result contains the row with the name <code class=syntax>C</code> and the empty text column. It is included into the result because an <code class=syntax>OUTER</code> type of a join is used.</p> <div class=codehilite><pre><span></span><code class=syntax>┌─name─┬─text───┐
│ A    │ Text A │
│ B    │ Text B │
│ C    │        │
└──────┴────────┘
</code></pre></div> <p>Query with <code class=syntax>INNER</code> type of a join and multiple conditions:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=nb>text</span><span class=p>,</span><span class=w> </span><span class=n>scores</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table_1</span><span class=w> </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>table_2</span><span class=w> </span>
<span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=n>table_1</span><span class=p>.</span><span class=n>Id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>table_2</span><span class=p>.</span><span class=n>Id</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>table_2</span><span class=p>.</span><span class=n>scores</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>10</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>startsWith</span><span class=p>(</span><span class=n>table_2</span><span class=p>.</span><span class=nb>text</span><span class=p>,</span><span class=w> </span><span class=s1>'Text'</span><span class=p>);</span><span class=w></span>
</code></pre></div> <p>Result:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─name─┬─text───┬─scores─┐
│ B    │ Text B │     15 │
└──────┴────────┴────────┘
</code></pre></div> <p>Query with <code class=syntax>INNER</code> type of a join and condition with <code class=syntax>OR</code>:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>t1</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>a</span><span class=o>`</span><span class=w> </span><span class=n>Int64</span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>b</span><span class=o>`</span><span class=w> </span><span class=n>Int64</span><span class=p>)</span><span class=w> </span><span class=n>ENGINE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>MergeTree</span><span class=p>()</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>a</span><span class=p>;</span><span class=w></span>

<span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>t2</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=k>key</span><span class=o>`</span><span class=w> </span><span class=n>Int32</span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>val</span><span class=o>`</span><span class=w> </span><span class=n>Int64</span><span class=p>)</span><span class=w> </span><span class=n>ENGINE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>MergeTree</span><span class=p>()</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>key</span><span class=p>;</span><span class=w></span>

<span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>t1</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=nb>number</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=o>-</span><span class=n>a</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>numbers</span><span class=p>(</span><span class=mi>5</span><span class=p>);</span><span class=w></span>

<span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>t2</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=k>if</span><span class=p>(</span><span class=nb>number</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=n>toInt64</span><span class=p>(</span><span class=nb>number</span><span class=p>),</span><span class=w> </span><span class=o>-</span><span class=nb>number</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=k>key</span><span class=p>,</span><span class=w> </span><span class=nb>number</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>val</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>numbers</span><span class=p>(</span><span class=mi>5</span><span class=p>);</span><span class=w></span>

<span class=k>SELECT</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=n>val</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>t1</span><span class=w> </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>t2</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>t1</span><span class=p>.</span><span class=n>a</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>t2</span><span class=p>.</span><span class=k>key</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=n>t1</span><span class=p>.</span><span class=n>b</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>t2</span><span class=p>.</span><span class=k>key</span><span class=p>;</span><span class=w></span>
</code></pre></div> <p>Result:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─a─┬──b─┬─val─┐
│ 0 │  0 │   0 │
│ 1 │ -1 │   1 │
│ 2 │ -2 │   2 │
│ 3 │ -3 │   3 │
│ 4 │ -4 │   4 │
└───┴────┴─────┘
</code></pre></div> <p>Query with <code class=syntax>INNER</code> type of a join and conditions with <code class=syntax>OR</code> and <code class=syntax>AND</code>:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=n>val</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>t1</span><span class=w> </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>t2</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>t1</span><span class=p>.</span><span class=n>a</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>t2</span><span class=p>.</span><span class=k>key</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=n>t1</span><span class=p>.</span><span class=n>b</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>t2</span><span class=p>.</span><span class=k>key</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>t2</span><span class=p>.</span><span class=n>val</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>3</span><span class=p>;</span><span class=w></span>
</code></pre></div> <p>Result:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─a─┬──b─┬─val─┐
│ 0 │  0 │   0 │
│ 2 │ -2 │   2 │
│ 4 │ -4 │   4 │
└───┴────┴─────┘
</code></pre></div> <h2 id=asof-join-usage>ASOF JOIN Usage<a class=headerlink href=../amp/#asof-join-usage title="Permanent link"> </a></h2> <p><code class=syntax>ASOF JOIN</code> is useful when you need to join records that have no exact match.</p> <p>Algorithm requires the special column in tables. This column:</p> <ul> <li>Must contain an ordered sequence.</li> <li>Can be one of the following types: <a href=../../../../data-types/int-uint/amp/ >Int, UInt</a>, <a href=../../../../data-types/float/amp/ >Float</a>, <a href=../../../../data-types/date/amp/ >Date</a>, <a href=../../../../data-types/datetime/amp/ >DateTime</a>, <a href=../../../../data-types/decimal/amp/ >Decimal</a>.</li> <li>Can’t be the only column in the <code class=syntax>JOIN</code> clause.</li> </ul> <p>Syntax <code class=syntax>ASOF JOIN ... ON</code>:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span><span class=w> </span><span class=n>expressions_list</span><span class=w></span>
<span class=k>FROM</span><span class=w> </span><span class=n>table_1</span><span class=w></span>
<span class=n>ASOF</span><span class=w> </span><span class=k>LEFT</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>table_2</span><span class=w></span>
<span class=k>ON</span><span class=w> </span><span class=n>equi_cond</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>closest_match_cond</span><span class=w></span>
</code></pre></div> <p>You can use any number of equality conditions and exactly one closest match condition. For example, <code class=syntax>SELECT count() FROM table_1 ASOF LEFT JOIN table_2 ON table_1.a == table_2.b AND table_2.t &lt;= table_1.t</code>.</p> <p>Conditions supported for the closest match: <code class=syntax>&gt;</code>, <code class=syntax>&gt;=</code>, <code class=syntax>&lt;</code>, <code class=syntax>&lt;=</code>.</p> <p>Syntax <code class=syntax>ASOF JOIN ... USING</code>:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span><span class=w> </span><span class=n>expressions_list</span><span class=w></span>
<span class=k>FROM</span><span class=w> </span><span class=n>table_1</span><span class=w></span>
<span class=n>ASOF</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>table_2</span><span class=w></span>
<span class=k>USING</span><span class=w> </span><span class=p>(</span><span class=n>equi_column1</span><span class=p>,</span><span class=w> </span><span class=p>...</span><span class=w> </span><span class=n>equi_columnN</span><span class=p>,</span><span class=w> </span><span class=n>asof_column</span><span class=p>)</span><span class=w></span>
</code></pre></div> <p><code class=syntax>ASOF JOIN</code> uses <code class=syntax>equi_columnX</code> for joining on equality and <code class=syntax>asof_column</code> for joining on the closest match with the <code class=syntax>table_1.asof_column &gt;= table_2.asof_column</code> condition. The <code class=syntax>asof_column</code> column is always the last one in the <code class=syntax>USING</code> clause.</p> <p>For example, consider the following tables:</p> <div class=codehilite><pre><span></span><code class=syntax>     table_1                           table_2
  event   | ev_time | user_id       event   | ev_time | user_id
----------|---------|----------   ----------|---------|----------
              ...                               ...
event_1_1 |  12:00  |  42         event_2_1 |  11:59  |   42
              ...                 event_2_2 |  12:30  |   42
event_1_2 |  13:00  |  42         event_2_3 |  13:00  |   42
              ...                               ...
</code></pre></div> <p><code class=syntax>ASOF JOIN</code> can take the timestamp of a user event from <code class=syntax>table_1</code> and find an event in <code class=syntax>table_2</code> where the timestamp is closest to the timestamp of the event from <code class=syntax>table_1</code> corresponding to the closest match condition. Equal timestamp values are the closest if available. Here, the <code class=syntax>user_id</code> column can be used for joining on equality and the <code class=syntax>ev_time</code> column can be used for joining on the closest match. In our example, <code class=syntax>event_1_1</code> can be joined with <code class=syntax>event_2_1</code> and <code class=syntax>event_1_2</code> can be joined with <code class=syntax>event_2_3</code>, but <code class=syntax>event_2_2</code> can’t be joined.</p> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-4 text-reset mb-2">Note</p> <p><code class=syntax>ASOF</code> join is <strong>not</strong> supported in the <a href=../../../../../engines/table-engines/special/join/amp/ class=alert-link>Join</a> table engine.</p> </div> <h2 id=global-join>Distributed JOIN<a class=headerlink href=../amp/#global-join title="Permanent link"> </a></h2> <p>There are two ways to execute join involving distributed tables:</p> <ul> <li>When using a normal <code class=syntax>JOIN</code>, the query is sent to remote servers. Subqueries are run on each of them in order to make the right table, and the join is performed with this table. In other words, the right table is formed on each server separately.</li> <li>When using <code class=syntax>GLOBAL ... JOIN</code>, first the requestor server runs a subquery to calculate the right table. This temporary table is passed to each remote server, and queries are run on them using the temporary data that was transmitted.</li> </ul> <p>Be careful when using <code class=syntax>GLOBAL</code>. For more information, see the <a href=../../../../operators/in/amp/#select-distributed-subqueries>Distributed subqueries</a> section.</p> <h2 id=implicit-type-conversion>Implicit Type Conversion<a class=headerlink href=../amp/#implicit-type-conversion title="Permanent link"> </a></h2> <p><code class=syntax>INNER JOIN</code>, <code class=syntax>LEFT JOIN</code>, <code class=syntax>RIGHT JOIN</code>, and <code class=syntax>FULL JOIN</code> queries support the implicit type conversion for "join keys". However the query can not be executed, if join keys from the left and the right tables cannot be converted to a single type (for example, there is no data type that can hold all values from both <code class=syntax>UInt64</code> and <code class=syntax>Int64</code>, or <code class=syntax>String</code> and <code class=syntax>Int32</code>).</p> <p><strong>Example</strong></p> <p>Consider the table <code class=syntax>t_1</code>:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─a─┬─b─┬─toTypeName(a)─┬─toTypeName(b)─┐
│ 1 │ 1 │ UInt16        │ UInt8         │
│ 2 │ 2 │ UInt16        │ UInt8         │
└───┴───┴───────────────┴───────────────┘
</code></pre></div> <p>and the table <code class=syntax>t_2</code>:</p> <div class=codehilite><pre><span></span><code class=syntax>┌──a─┬────b─┬─toTypeName(a)─┬─toTypeName(b)───┐
│ -1 │    1 │ Int16         │ Nullable(Int64) │
│  1 │   -1 │ Int16         │ Nullable(Int64) │
│  1 │    1 │ Int16         │ Nullable(Int64) │
└────┴──────┴───────────────┴─────────────────┘
</code></pre></div> <p>The query</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=n>toTypeName</span><span class=p>(</span><span class=n>a</span><span class=p>),</span><span class=w> </span><span class=n>toTypeName</span><span class=p>(</span><span class=n>b</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>t_1</span><span class=w> </span><span class=k>FULL</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>t_2</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>);</span><span class=w></span>
</code></pre></div> <p>returns the set:</p> <div class=codehilite><pre><span></span><code class=syntax>┌──a─┬────b─┬─toTypeName(a)─┬─toTypeName(b)───┐
│  1 │    1 │ Int32         │ Nullable(Int64) │
│  2 │    2 │ Int32         │ Nullable(Int64) │
│ -1 │    1 │ Int32         │ Nullable(Int64) │
│  1 │   -1 │ Int32         │ Nullable(Int64) │
└────┴──────┴───────────────┴─────────────────┘
</code></pre></div> <h2 id=usage-recommendations>Usage Recommendations<a class=headerlink href=../amp/#usage-recommendations title="Permanent link"> </a></h2> <h3 id=processing-of-empty-or-null-cells>Processing of Empty or NULL Cells<a class=headerlink href=../amp/#processing-of-empty-or-null-cells title="Permanent link"> </a></h3> <p>While joining tables, the empty cells may appear. The setting <a href=../../../../../operations/settings/settings/amp/#join_use_nulls>join_use_nulls</a> define how ClickHouse fills these cells.</p> <p>If the <code class=syntax>JOIN</code> keys are <a href=../../../../data-types/nullable/amp/ >Nullable</a> fields, the rows where at least one of the keys has the value <a href=../../../../syntax/amp/#null-literal>NULL</a> are not joined.</p> <h3 id=syntax>Syntax<a class=headerlink href=../amp/#syntax title="Permanent link"> </a></h3> <p>The columns specified in <code class=syntax>USING</code> must have the same names in both subqueries, and the other columns must be named differently. You can use aliases to change the names of columns in subqueries.</p> <p>The <code class=syntax>USING</code> clause specifies one or more columns to join, which establishes the equality of these columns. The list of columns is set without brackets. More complex join conditions are not supported.</p> <h3 id=syntax-limitations>Syntax Limitations<a class=headerlink href=../amp/#syntax-limitations title="Permanent link"> </a></h3> <p>For multiple <code class=syntax>JOIN</code> clauses in a single <code class=syntax>SELECT</code> query:</p> <ul> <li>Taking all the columns via <code class=syntax>*</code> is available only if tables are joined, not subqueries.</li> <li>The <code class=syntax>PREWHERE</code> clause is not available.</li> </ul> <p>For <code class=syntax>ON</code>, <code class=syntax>WHERE</code>, and <code class=syntax>GROUP BY</code> clauses:</p> <ul> <li>Arbitrary expressions cannot be used in <code class=syntax>ON</code>, <code class=syntax>WHERE</code>, and <code class=syntax>GROUP BY</code> clauses, but you can define an expression in a <code class=syntax>SELECT</code> clause and then use it in these clauses via an alias.</li> </ul> <h3 id=performance>Performance<a class=headerlink href=../amp/#performance title="Permanent link"> </a></h3> <p>When running a <code class=syntax>JOIN</code>, there is no optimization of the order of execution in relation to other stages of the query. The join (a search in the right table) is run before filtering in <code class=syntax>WHERE</code> and before aggregation.</p> <p>Each time a query is run with the same <code class=syntax>JOIN</code>, the subquery is run again because the result is not cached. To avoid this, use the special <a href=../../../../../engines/table-engines/special/join/amp/ >Join</a> table engine, which is a prepared array for joining that is always in RAM.</p> <p>In some cases, it is more efficient to use <a href=../../../../operators/in/amp/ >IN</a> instead of <code class=syntax>JOIN</code>.</p> <p>If you need a <code class=syntax>JOIN</code> for joining with dimension tables (these are relatively small tables that contain dimension properties, such as names for advertising campaigns), a <code class=syntax>JOIN</code> might not be very convenient due to the fact that the right table is re-accessed for every query. For such cases, there is an “external dictionaries” feature that you should use instead of <code class=syntax>JOIN</code>. For more information, see the <a href=../../../../dictionaries/external-dictionaries/external-dicts/amp/ >External dictionaries</a> section.</p> <h3 id=memory-limitations>Memory Limitations<a class=headerlink href=../amp/#memory-limitations title="Permanent link"> </a></h3> <p>By default, ClickHouse uses the <a href=https://en.wikipedia.org/wiki/Hash_join rel="external nofollow noreferrer" target=_blank>hash join</a> algorithm. ClickHouse takes the right_table and creates a hash table for it in RAM. If <code class=syntax>join_algorithm = 'auto'</code> is enabled, then after some threshold of memory consumption, ClickHouse falls back to <a href=https://en.wikipedia.org/wiki/Sort-merge_join rel="external nofollow noreferrer" target=_blank>merge</a> join algorithm. For <code class=syntax>JOIN</code> algorithms description see the <a href=../../../../../operations/settings/settings/amp/#settings-join_algorithm>join_algorithm</a> setting.</p> <p>If you need to restrict <code class=syntax>JOIN</code> operation memory consumption use the following settings:</p> <ul> <li><a href=../../../../../operations/settings/query-complexity/amp/#settings-max_rows_in_join>max_rows_in_join</a> — Limits number of rows in the hash table.</li> <li><a href=../../../../../operations/settings/query-complexity/amp/#settings-max_bytes_in_join>max_bytes_in_join</a> — Limits size of the hash table.</li> </ul> <p>When any of these limits is reached, ClickHouse acts as the <a href=../../../../../operations/settings/query-complexity/amp/#settings-join_overflow_mode>join_overflow_mode</a> setting instructs.</p> <h2 id=examples>Examples<a class=headerlink href=../amp/#examples title="Permanent link"> </a></h2> <p>Example:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span><span class=w></span>
<span class=w>    </span><span class=n>CounterID</span><span class=p>,</span><span class=w></span>
<span class=w>    </span><span class=n>hits</span><span class=p>,</span><span class=w></span>
<span class=w>    </span><span class=n>visits</span><span class=w></span>
<span class=k>FROM</span><span class=w></span>
<span class=p>(</span><span class=w></span>
<span class=w>    </span><span class=k>SELECT</span><span class=w></span>
<span class=w>        </span><span class=n>CounterID</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=k>count</span><span class=p>()</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>hits</span><span class=w></span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>test</span><span class=p>.</span><span class=n>hits</span><span class=w></span>
<span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>CounterID</span><span class=w></span>
<span class=p>)</span><span class=w> </span><span class=k>ANY</span><span class=w> </span><span class=k>LEFT</span><span class=w> </span><span class=k>JOIN</span><span class=w></span>
<span class=p>(</span><span class=w></span>
<span class=w>    </span><span class=k>SELECT</span><span class=w></span>
<span class=w>        </span><span class=n>CounterID</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=k>sum</span><span class=p>(</span><span class=n>Sign</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>visits</span><span class=w></span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>test</span><span class=p>.</span><span class=n>visits</span><span class=w></span>
<span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>CounterID</span><span class=w></span>
<span class=p>)</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=n>CounterID</span><span class=w></span>
<span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>hits</span><span class=w> </span><span class=k>DESC</span><span class=w></span>
<span class=k>LIMIT</span><span class=w> </span><span class=mi>10</span><span class=w></span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─CounterID─┬───hits─┬─visits─┐
│   1143050 │ 523264 │  13665 │
│    731962 │ 475698 │ 102716 │
│    722545 │ 337212 │ 108187 │
│    722889 │ 252197 │  10547 │
│   2237260 │ 196036 │   9522 │
│  23057320 │ 147211 │   7689 │
│    722818 │  90109 │  17847 │
│     48221 │  85379 │   4652 │
│  19762435 │  77807 │   7026 │
│    722884 │  77492 │  11056 │
└───────────┴────────┴────────┘
</code></pre></div>
        </div>
      </div>
      <div class="row">
        <div class="col">
          
<div class="alert alert-light my-3">
  <p class="float-right mb-0">Rating: RATING_VALUE - RATING_COUNT votes</p>
  <span class="alert-heading display-6">Article Rating</span>
  <div id="rating-stars" class="display-6 mb-0"
     
  >RATING_STARS</div>
</div>

<div id="content-footer" class="text-muted pt-3 mb-5">
    <div class="float-md-right">©2016–2022 ClickHouse, Inc.</div>
    <div>Built from <a href="https://github.com/ClickHouse/ClickHouse/commit/38993f215f9186c1ac3505b1e09697cd9a468b5d" rel="external nofollow noreferrer" target="_blank" class="text-reset">38993f21</a>
    
    </div>
</div>

        </div>
      </div>
      <div id="to-full-website" class="row fixed-bottom text-center bg-white py-3">
        <div class="col">
          <a class="btn btn-lg btn-outline-orange" href="https://clickhouse.com/docs/ja/sql-reference/statements/select/join/">To full website</a>
        </div>
      </div>
    </div>
    <amp-analytics type="metrika">
      <script type="application/json">{
"vars": {
  "counterId": "18343495",
  "triggers": {
    "notBounce": {
      "on": "timer",
      "timerSpec": {
        "immediate": false,
        "interval": 15,
        "maxTimerLength": 16
      },
      "request": "notBounce"
    }
  }
}
}</script>
  </amp-analytics>
  </body>
</html>
