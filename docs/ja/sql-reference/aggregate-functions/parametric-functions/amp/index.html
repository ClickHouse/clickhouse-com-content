










    



    



    



    
    






    <!doctype html>
<html ⚡ lang="ja">
  <head>
    <meta charset="utf-8">
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    <title>パラメトリック | ClickHouseドキュメント</title>
    <link rel="canonical" href="https://clickhouse.com/docs/ja/sql-reference/aggregate-functions/parametric-functions/" />
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    
<script type="application/ld+json">[{
"@context": "http://schema.org",
"@type": "TechArticle",
"headline": "パラメトリック | ClickHouseドキュメント",
"mainEntityOfPage": "https://clickhouse.com/docs/ja/sql-reference/aggregate-functions/parametric-functions/",




"image": "https://clickhouse.com/images/clickhouse-209x60.png",
"author": {
  "@type": "Project",
  "name": "ClickHouse"
},
"publisher": {
  "@type": "Organization",
  "name": "ClickHouse, Inc.",
  "logo": {
    "@type": "ImageObject",
    "url": "https://clickhouse.com/images/logo-400x240.png",
    "width": 400,
    "height": 240
  }
}}, {
"@context": "http://schema.org",
"@type": "Episode",
"name": "パラメトリック | ClickHouseドキュメント",
"aggregateRating": {
  "@type": "AggregateRating",
  "ratingValue": RATING_VALUE,
  "ratingCount": RATING_COUNT
}
}]</script>

    
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <style amp-custom>:root{--blue:#007bff;--indigo:#6610f2;--purple:#6f42c1;--pink:#e83e8c;--red:#dc3545;--orange:#fd7e14;--yellow:#ffc107;--green:#28a745;--teal:#20c997;--cyan:#17a2b8;--gray:#6c757d;--gray-dark:#343a40;--brand-primary:#fc0;--brand-secondary:#ff3939;--primary-accent-yellow:#fc0;--primary-accent-light-yellow:#fffaf0;--primary-accent-blue:#257af4;--primary-accent-light-blue:#e3f1fe;--secondary-accent-orange:#ff8c00;--secondary-accent-light-orange:#ffe4b5;--secondary-accent-red:#ff3939;--secondary-accent-light-red:#ffe4e1;--primary:#fc0;--secondary:#212529;--success:#28a745;--info:#17a2b8;--warning:#ffc107;--danger:#dc3545;--light:#f1f6f9;--dark:#495057;--primary-light:#fffaf0;--secondary-light:#fff;--tertiary:#257af4;--tertiary-light:#e3f1fe;--white:#fff;--black:#212529;--blue:#257af4;--light-blue:#e3f1fe;--yellow:#fc0;--light-yellow:#fffaf0;--orange:#ff8c00;--light-orange:#ffe4b5;--red:#ff3939;--light-red:#ffe4e1;--medium:#d6dbdf;--breakpoint-xxs:0;--breakpoint-xs:400px;--breakpoint-sm:616px;--breakpoint-md:768px;--breakpoint-lg:980px;--breakpoint-xl:1240px;--font-family-sans-serif:"Noto Sans",sans-serif;--font-family-monospace:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}*,:after,:before{box-sizing:border-box}html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:rgba(33,37,41,0)}article,footer,main{display:block}body{margin:0;font-family:Noto Sans,sans-serif;font-size:1rem;font-weight:400;line-height:1.5;color:#212529;text-align:left;background-color:#fff}[tabindex="-1"]:focus:not(:focus-visible){outline:0}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:16px}p{margin-top:0;margin-bottom:1rem}ol,ul{margin-bottom:1rem}ol,ul{margin-top:0}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}b,strong{font-weight:bolder}a{text-decoration:none;background-color:transparent}a,a:hover{color:#ff8c00}a:hover{text-decoration:underline}a:not([href]),a:not([href]):hover{color:inherit;text-decoration:none}code,pre{font-family:SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em}pre{margin-top:0;margin-bottom:1rem;overflow:auto}img{border-style:none}img,svg{vertical-align:middle}svg{overflow:hidden}table{border-collapse:collapse}select{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}select{text-transform:none}select{word-wrap:normal}[type=button],[type=reset],[type=submit]{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled){cursor:pointer}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{padding:0;border-style:none}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:none}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}[hidden]{display:none}.h1,.h2,.h3,.h4,.h5,.h6,h1,h2,h3,h4,h5,h6{margin-bottom:16px;font-family:Hind Siliguri,sans-serif;font-weight:500;line-height:1.125}.h1,h1{font-size:2.5rem}@media(max-width:1200px){.h1,h1{font-size:calc(1.375rem+1.5vw)}}.h2,h2{font-size:2rem}@media(max-width:1200px){.h2,h2{font-size:calc(1.325rem+.9vw)}}.h3,h3{font-size:1.75rem}@media(max-width:1200px){.h3,h3{font-size:calc(1.3rem+.6vw)}}.h4,h4{font-size:1.5rem}@media(max-width:1200px){.h4,h4{font-size:calc(1.275rem+.3vw)}}.h5,h5{font-size:1.125rem}.h6,h6{font-size:.875rem}.lead{font-size:1.375rem;font-weight:400}@media(max-width:1200px){.lead{font-size:calc(1.2625rem+.15vw)}}.display-1{font-size:4rem;font-weight:600;line-height:1.125}@media(max-width:1200px){.display-1{font-size:calc(1.525rem+3.3vw)}}.display-2{font-size:2.5rem;font-weight:600;line-height:1.125}@media(max-width:1200px){.display-2{font-size:calc(1.375rem+1.5vw)}}.display-3{font-size:2rem;font-weight:500;line-height:1.125}@media(max-width:1200px){.display-3{font-size:calc(1.325rem+.9vw)}}.display-4{font-size:1.75rem;font-weight:500;line-height:1.125}@media(max-width:1200px){.display-4{font-size:calc(1.3rem+.6vw)}}.img-fluid{max-width:100%;height:auto}code{font-size:87.5%;color:#e83e8c;word-wrap:break-word}a>code{color:inherit}pre{display:block;font-size:87.5%;color:#495057}pre code{font-size:inherit;color:inherit;word-break:normal}.container{width:100%;padding-right:20px;padding-left:20px;margin-right:auto;margin-left:auto}@media(min-width:400px){.container{max-width:576px}}@media(min-width:616px){.container{max-width:576px}}@media(min-width:768px){.container{max-width:958px}}@media(min-width:980px){.container{max-width:1008px}}@media(min-width:1240px){.container{max-width:1118px}}.container-fluid,.container-lg,.container-md{width:100%;padding-right:20px;padding-left:20px;margin-right:auto;margin-left:auto}@media(min-width:400px){.container{max-width:576px}}@media(min-width:616px){.container{max-width:576px}}@media(min-width:768px){.container,.container-md{max-width:958px}}@media(min-width:980px){.container,.container-lg,.container-md{max-width:1008px}}@media(min-width:1240px){.container,.container-lg,.container-md{max-width:1118px}}.row{display:flex;flex-wrap:wrap;margin-right:-20px;margin-left:-20px}.col,.col-1,.col-10,.col-11,.col-12,.col-2,.col-3,.col-4,.col-5,.col-6,.col-7,.col-8,.col-9,.col-lg,.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-md,.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9{position:relative;width:100%;padding-right:20px;padding-left:20px}.col{flex-basis:0;flex-grow:1;max-width:100%}.col-1{flex:0 0 8.3333333333%;max-width:8.3333333333%}.col-2{flex:0 0 16.6666666667%;max-width:16.6666666667%}.col-3{flex:0 0 25%;max-width:25%}.col-4{flex:0 0 33.3333333333%;max-width:33.3333333333%}.col-5{flex:0 0 41.6666666667%;max-width:41.6666666667%}.col-6{flex:0 0 50%;max-width:50%}.col-7{flex:0 0 58.3333333333%;max-width:58.3333333333%}.col-8{flex:0 0 66.6666666667%;max-width:66.6666666667%}.col-9{flex:0 0 75%;max-width:75%}.col-10{flex:0 0 83.3333333333%;max-width:83.3333333333%}.col-11{flex:0 0 91.6666666667%;max-width:91.6666666667%}.col-12{flex:0 0 100%;max-width:100%}.order-first{order:-1}.order-0{order:0}.order-1{order:1}.order-2{order:2}.order-3{order:3}.order-4{order:4}.order-5{order:5}.order-6{order:6}.order-7{order:7}.order-8{order:8}.order-9{order:9}.order-10{order:10}.order-11{order:11}.order-12{order:12}@media(min-width:768px){.col-md{flex-basis:0;flex-grow:1;max-width:100%}.col-md-1{flex:0 0 8.3333333333%;max-width:8.3333333333%}.col-md-2{flex:0 0 16.6666666667%;max-width:16.6666666667%}.col-md-3{flex:0 0 25%;max-width:25%}.col-md-4{flex:0 0 33.3333333333%;max-width:33.3333333333%}.col-md-5{flex:0 0 41.6666666667%;max-width:41.6666666667%}.col-md-6{flex:0 0 50%;max-width:50%}.col-md-7{flex:0 0 58.3333333333%;max-width:58.3333333333%}.col-md-8{flex:0 0 66.6666666667%;max-width:66.6666666667%}.col-md-9{flex:0 0 75%;max-width:75%}.col-md-10{flex:0 0 83.3333333333%;max-width:83.3333333333%}.col-md-11{flex:0 0 91.6666666667%;max-width:91.6666666667%}.col-md-12{flex:0 0 100%;max-width:100%}.order-md-first{order:-1}.order-md-0{order:0}.order-md-1{order:1}.order-md-2{order:2}.order-md-3{order:3}.order-md-4{order:4}.order-md-5{order:5}.order-md-6{order:6}.order-md-7{order:7}.order-md-8{order:8}.order-md-9{order:9}.order-md-10{order:10}.order-md-11{order:11}.order-md-12{order:12}}@media(min-width:980px){.col-lg{flex-basis:0;flex-grow:1;max-width:100%}.col-lg-1{flex:0 0 8.3333333333%;max-width:8.3333333333%}.col-lg-2{flex:0 0 16.6666666667%;max-width:16.6666666667%}.col-lg-3{flex:0 0 25%;max-width:25%}.col-lg-4{flex:0 0 33.3333333333%;max-width:33.3333333333%}.col-lg-5{flex:0 0 41.6666666667%;max-width:41.6666666667%}.col-lg-6{flex:0 0 50%;max-width:50%}.col-lg-7{flex:0 0 58.3333333333%;max-width:58.3333333333%}.col-lg-8{flex:0 0 66.6666666667%;max-width:66.6666666667%}.col-lg-9{flex:0 0 75%;max-width:75%}.col-lg-10{flex:0 0 83.3333333333%;max-width:83.3333333333%}.col-lg-11{flex:0 0 91.6666666667%;max-width:91.6666666667%}.col-lg-12{flex:0 0 100%;max-width:100%}.order-lg-first{order:-1}.order-lg-0{order:0}.order-lg-1{order:1}.order-lg-2{order:2}.order-lg-3{order:3}.order-lg-4{order:4}.order-lg-5{order:5}.order-lg-6{order:6}.order-lg-7{order:7}.order-lg-8{order:8}.order-lg-9{order:9}.order-lg-10{order:10}.order-lg-11{order:11}.order-lg-12{order:12}}.table{width:100%;margin-bottom:8px;color:#212529}.table-primary{background-color:#fff1b8}.table-warning{background-color:#ffeeba}.table-light{background-color:#fbfcfd}.table-dark{background-color:#ccced0}.table-primary-light{background-color:#fffefb}.table-white{background-color:#fff}.table-black{background-color:#c1c2c3}.table-orange{background-color:#ffdfb8}.table-light-orange{background-color:#fff7ea}.table-dark{color:#fff;background-color:#343a40}.btn{display:inline-block;font-family:inherit;font-weight:700;color:#212529;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;padding:12px 32px;font-size:.875rem;line-height:20px;border-radius:8px;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media(prefers-reduced-motion:reduce){.btn{transition:none}}.btn:hover{color:#212529;text-decoration:none}.btn:focus{outline:0;box-shadow:none}.btn:disabled{opacity:.65}.btn-primary{color:#495057;background-color:#fc0;border-color:#fc0}.btn-primary:focus,.btn-primary:hover{color:#495057;background-color:#d9ad00;border-color:#cca300}.btn-primary:focus{box-shadow:0 0 0 0 rgba(228,185,13,.5)}.btn-primary:disabled{color:#495057;background-color:#fc0;border-color:#fc0}.btn-warning{color:#495057;background-color:#ffc107;border-color:#ffc107}.btn-warning:focus,.btn-warning:hover{color:#495057;background-color:#e0a800;border-color:#d39e00}.btn-warning:focus{box-shadow:0 0 0 0 rgba(228,176,19,.5)}.btn-warning:disabled{color:#495057;background-color:#ffc107;border-color:#ffc107}.btn-light{color:#495057;background-color:#f1f6f9;border-color:#f1f6f9}.btn-light:focus,.btn-light:hover{color:#495057;background-color:#d6e5ee;border-color:#cddfea}.btn-light:focus{box-shadow:0 0 0 0 rgba(216,221,225,.5)}.btn-light:disabled{color:#495057;background-color:#f1f6f9;border-color:#f1f6f9}.btn-dark{color:#fff;background-color:#495057;border-color:#495057}.btn-dark:focus,.btn-dark:hover{color:#fff;background-color:#383d42;border-color:#32373b}.btn-dark:focus{box-shadow:0 0 0 0 rgba(100,106,112,.5)}.btn-dark:disabled{color:#fff;background-color:#495057;border-color:#495057}.btn-primary-light{color:#495057;background-color:#fffaf0;border-color:#fffaf0}.btn-primary-light:focus,.btn-primary-light:hover{color:#495057;background-color:#ffedca;border-color:#ffe9bd}.btn-primary-light:focus{box-shadow:0 0 0 0 rgba(228,225,217,.5)}.btn-primary-light:disabled{color:#495057;background-color:#fffaf0;border-color:#fffaf0}.btn-white{color:#495057;background-color:#fff;border-color:#fff}.btn-white:focus,.btn-white:hover{color:#495057;background-color:#ececec;border-color:#e6e6e6}.btn-white:focus{box-shadow:0 0 0 0 rgba(228,229,230,.5)}.btn-white:disabled{color:#495057;background-color:#fff;border-color:#fff}.btn-black{color:#fff;background-color:#212529;border-color:#212529}.btn-black:focus,.btn-black:hover{color:#fff;background-color:#101214;border-color:#0a0c0d}.btn-black:focus{box-shadow:0 0 0 0 rgba(66,70,73,.5)}.btn-black:disabled{color:#fff;background-color:#212529;border-color:#212529}.btn-orange{color:#495057;background-color:#ff8c00;border-color:#ff8c00}.btn-orange:focus,.btn-orange:hover{color:#fff;background-color:#d97700;border-color:#cc7000}.btn-orange:focus{box-shadow:0 0 0 0 rgba(228,131,13,.5)}.btn-orange:disabled{color:#495057;background-color:#ff8c00;border-color:#ff8c00}.btn-light-orange{color:#495057;background-color:#ffe4b5;border-color:#ffe4b5}.btn-light-orange:focus,.btn-light-orange:hover{color:#495057;background-color:#ffd68f;border-color:#ffd182}.btn-light-orange:focus{box-shadow:0 0 0 0 rgba(228,206,167,.5)}.btn-light-orange:disabled{color:#495057;background-color:#ffe4b5;border-color:#ffe4b5}.btn-outline-primary{color:#fc0;border-color:#fc0}.btn-outline-primary:hover{color:#495057;background-color:#fc0;border-color:#fc0}.btn-outline-primary:focus{box-shadow:0 0 0 0 rgba(255,204,0,.5)}.btn-outline-primary:disabled{color:#fc0;background-color:transparent}.btn-outline-warning{color:#ffc107;border-color:#ffc107}.btn-outline-warning:hover{color:#495057;background-color:#ffc107;border-color:#ffc107}.btn-outline-warning:focus{box-shadow:0 0 0 0 rgba(255,193,7,.5)}.btn-outline-warning:disabled{color:#ffc107;background-color:transparent}.btn-outline-light{color:#f1f6f9;border-color:#f1f6f9}.btn-outline-light:hover{color:#495057;background-color:#f1f6f9;border-color:#f1f6f9}.btn-outline-light:focus{box-shadow:0 0 0 0 rgba(241,246,249,.5)}.btn-outline-light:disabled{color:#f1f6f9;background-color:transparent}.btn-outline-dark{color:#495057;border-color:#495057}.btn-outline-dark:hover{color:#fff;background-color:#495057;border-color:#495057}.btn-outline-dark:focus{box-shadow:0 0 0 0 rgba(73,80,87,.5)}.btn-outline-dark:disabled{color:#495057;background-color:transparent}.btn-outline-primary-light{color:#fffaf0;border-color:#fffaf0}.btn-outline-primary-light:hover{color:#495057;background-color:#fffaf0;border-color:#fffaf0}.btn-outline-primary-light:focus{box-shadow:0 0 0 0 rgba(255,250,240,.5)}.btn-outline-primary-light:disabled{color:#fffaf0;background-color:transparent}.btn-outline-white{color:#fff;border-color:#fff}.btn-outline-white:hover{color:#495057;background-color:#fff;border-color:#fff}.btn-outline-white:focus{box-shadow:0 0 0 0 hsla(0,0%,100%,.5)}.btn-outline-white:disabled{color:#fff;background-color:transparent}.btn-outline-black{color:#212529;border-color:#212529}.btn-outline-black:hover{color:#fff;background-color:#212529;border-color:#212529}.btn-outline-black:focus{box-shadow:0 0 0 0 rgba(33,37,41,.5)}.btn-outline-black:disabled{color:#212529;background-color:transparent}.btn-outline-orange{color:#ff8c00;border-color:#ff8c00}.btn-outline-orange:hover{color:#495057;background-color:#ff8c00;border-color:#ff8c00}.btn-outline-orange:focus{box-shadow:0 0 0 0 rgba(255,140,0,.5)}.btn-outline-orange:disabled{color:#ff8c00;background-color:transparent}.btn-outline-light-orange{color:#ffe4b5;border-color:#ffe4b5}.btn-outline-light-orange:hover{color:#495057;background-color:#ffe4b5;border-color:#ffe4b5}.btn-outline-light-orange:focus{box-shadow:0 0 0 0 rgba(255,228,181,.5)}.btn-outline-light-orange:disabled{color:#ffe4b5;background-color:transparent}.btn-link{font-weight:400;color:#ff8c00;text-decoration:none}.btn-link:hover{color:#ff8c00;text-decoration:underline}.btn-link:focus{text-decoration:underline;box-shadow:none}.btn-link:disabled{color:#d6dbdf;pointer-events:none}.btn-group-lg>.btn,.btn-lg{padding:16px 32px;font-size:1.125rem;line-height:26px;border-radius:8px}.btn-block{display:block;width:100%}.btn-block+.btn-block{margin-top:24px}.btn-group{position:relative;display:inline-flex;vertical-align:middle}.btn-group>.btn{position:relative;flex:1 1 auto}.btn-group>.btn:active,.btn-group>.btn:focus,.btn-group>.btn:hover{z-index:1}.btn-group>.btn-group:not(:first-child),.btn-group>.btn:not(:first-child){margin-left:-1px}.btn-group>.btn-group:not(:last-child)>.btn{border-top-right-radius:0;border-bottom-right-radius:0}.btn-group>.btn-group:not(:first-child)>.btn,.btn-group>.btn:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.custom-select{display:inline-block;width:100%;height:calc(1.5em+.75rem+2px);padding:.375rem 1.75rem .375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#6c757d;vertical-align:middle;background:#fff url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='4' height='5'%3E%3Cpath fill='%23343a40' d='M2 0L0 2h4zm0 5L0 3h4z'/%3E%3C/svg%3E") no-repeat right .75rem center/8px 10px;border:1px solid #ced4da;border-radius:8px;-webkit-appearance:none;-moz-appearance:none;appearance:none}.custom-select:focus{border-color:#ffe680;outline:0;box-shadow:0 0 0 .2rem rgba(255,204,0,.25)}.custom-select:focus::-ms-value{color:#6c757d;background-color:#fff}.custom-select[multiple],.custom-select[size]:not([size="1"]){height:auto;padding-right:.75rem;background-image:none}.custom-select:disabled{color:#6c757d;background-color:#e9ecef}.custom-select::-ms-expand{display:none}.custom-select:-moz-focusring{color:transparent;text-shadow:0 0 0 #6c757d}.custom-select-lg{height:calc(1.5em+1rem+2px);padding-top:.5rem;padding-bottom:.5rem;padding-left:1rem;font-size:1.125rem}.custom-select{transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media(prefers-reduced-motion:reduce){.custom-select{transition:none}}pre{white-space:pre-wrap}pre{border:1px solid #d6dbdf;page-break-inside:avoid}img{page-break-inside:avoid}h2,h3,p{orphans:3;widows:3}h2,h3{page-break-after:avoid}@page{size:a3}.container,body{min-width:980px}.table{border-collapse:collapse}.table-dark{color:inherit}</style>
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    <script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>
  </head>
  <body class="amp" dir="ltr">
    <div class="container-fluid container-lg pb-5">
      <div class="row pt-3 mb-3">
        <div class="col">
          <a href="/" class="text-decoration-none">
            <amp-img class="d-inline-block mr-3" layout="fixed" width="40" height="36" src="/docs/images/logo.svg" alt="ClickHouse logo" title="ClickHouse logo"></amp-img><amp-img class="invert-dark d-inline-block" layout="fixed" width="238" height="36" src="/docs/images/clickhouse-black.svg" alt="ClickHouse" title="ClickHouse"></amp-img>
          </a>
        </div>
      </div>
      <div class="row">
        <div id="content" class="col">
          
    <div class="alert alert-primary" role="alert">
      <p class="display-5 mb-2">Help wanted!</p>
      <p class="lead">The following content of this documentation page has been machine-translated. But unlike other websites, it is not done on the fly. This translated text lives on GitHub repository alongside main ClickHouse codebase and waits for fellow native speakers to make it more human-readable. <a href="/docs/en/sql-reference/aggregate-functions/parametric-functions/" class="alert-link">You can also use the original English version as a reference.</a></p>
      <p class="lead">
          <a class="btn btn-lg btn-primary text-white" href="https://github.com/ClickHouse/ClickHouse/edit/master/docs/ja/sql-reference/aggregate-functions/parametric-functions.md" target="_blank" rel="external nofollow noreferrer">
              Help ClickHouse documentation by editing this page
          </a>
      </p>
    </div>

          <h1 id=aggregate_functions_parametric>パラメトリック集計関数<a class=headerlink href=../amp/#aggregate_functions_parametric title="Permanent link"> </a></h1> <p>Some aggregate functions can accept not only argument columns (used for compression), but a set of parameters – constants for initialization. The syntax is two pairs of brackets instead of one. The first is for parameters, and the second is for arguments.</p> <h2 id=histogram>ヒス<a class=headerlink href=../amp/#histogram title="Permanent link"> </a></h2> <p>適応ヒストグラムを計算します。 正確な結果を保証するものではありません。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>histogram</span><span class=p>(</span><span class=n>number_of_bins</span><span class=p>)(</span><span class=k>values</span><span class=p>)</span><span class=w></span>
</code></pre></div> <p>関数は以下を使用します <a href=http://jmlr.org/papers/volume11/ben-haim10a/ben-haim10a.pdf rel="external nofollow noreferrer" target=_blank>ストリーミン</a>. ヒストグラムビンの境界は、新しいデータが関数に入ると調整されます。 一般的なケースでは、ビンの幅は等しくありません。</p> <p><strong>パラメータ</strong></p> <p><code class=syntax>number_of_bins</code> — Upper limit for the number of bins in the histogram. The function automatically calculates the number of bins. It tries to reach the specified number of bins, but if it fails, it uses fewer bins.<br> <code class=syntax>values</code> — <a href=../../../syntax/amp/#syntax-expressions>式</a> 結果として入力値が生成されます。</p> <p><strong>戻り値</strong></p> <ul> <li><a href=../../../data-types/array/amp/ >配列</a> の <a href=../../../data-types/tuple/amp/ >タプル</a> 次の形式の:<div class=codehilite><pre><span></span><code class=syntax><span class="n n-Quoted">`</span><span class="n n-Quoted n-Quoted-Escape">``</span><span class="n n-Quoted"></span>
<span class="n n-Quoted">[(lower_1, upper_1, height_1), ... (lower_N, upper_N, height_N)]</span>
<span class="n n-Quoted n-Quoted-Escape">``</span><span class="n n-Quoted">`</span><span class=w></span>

<span class=o>-</span><span class=w> </span><span class="n n-Quoted">`lower`</span><span class=w> </span><span class=n>—</span><span class=w> </span><span class=n>Lower</span><span class=w> </span><span class=n>bound</span><span class=w> </span><span class=k>of</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>bin</span><span class=p>.</span><span class=w></span>
<span class=o>-</span><span class=w> </span><span class="n n-Quoted">`upper`</span><span class=w> </span><span class=n>—</span><span class=w> </span><span class=n>Upper</span><span class=w> </span><span class=n>bound</span><span class=w> </span><span class=k>of</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>bin</span><span class=p>.</span><span class=w></span>
<span class=o>-</span><span class=w> </span><span class="n n-Quoted">`height`</span><span class=w> </span><span class=n>—</span><span class=w> </span><span class=n>Calculated</span><span class=w> </span><span class=n>height</span><span class=w> </span><span class=k>of</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>bin</span><span class=p>.</span><span class=w></span>
</code></pre></div> </li> </ul> <p><strong>例</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span><span class=w> </span><span class=n>histogram</span><span class=p>(</span><span class=mi>5</span><span class=p>)(</span><span class=nb>number</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w></span>
<span class=k>FROM</span><span class=w> </span><span class=p>(</span><span class=w></span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w></span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=k>system</span><span class=p>.</span><span class=n>numbers</span><span class=w></span>
<span class=w>    </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>20</span><span class=w></span>
<span class=p>)</span><span class=w></span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─histogram(5)(plus(number, 1))───────────────────────────────────────────┐
│ [(1,4.5,4),(4.5,8.5,4),(8.5,12.75,4.125),(12.75,17,4.625),(17,20,3.25)] │
└─────────────────────────────────────────────────────────────────────────┘
</code></pre></div> <p>ヒストグラムを視覚化するには <a href=../../../functions/other-functions/amp/#function-bar>バー</a> 関数、例えば:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>WITH</span><span class=w> </span><span class=n>histogram</span><span class=p>(</span><span class=mi>5</span><span class=p>)(</span><span class=n>rand</span><span class=p>()</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=mi>100</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>hist</span><span class=w></span>
<span class=k>SELECT</span><span class=w></span>
<span class=w>    </span><span class=n>arrayJoin</span><span class=p>(</span><span class=n>hist</span><span class=p>).</span><span class=mi>3</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>height</span><span class=p>,</span><span class=w></span>
<span class=w>    </span><span class=n>bar</span><span class=p>(</span><span class=n>height</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>6</span><span class=p>,</span><span class=w> </span><span class=mi>5</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>bar</span><span class=w></span>
<span class=k>FROM</span><span class=w></span>
<span class=p>(</span><span class=w></span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w></span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=k>system</span><span class=p>.</span><span class=n>numbers</span><span class=w></span>
<span class=w>    </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>20</span><span class=w></span>
<span class=p>)</span><span class=w></span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─height─┬─bar───┐
│  2.125 │ █▋    │
│   3.25 │ ██▌   │
│  5.625 │ ████▏ │
│  5.625 │ ████▏ │
│  3.375 │ ██▌   │
└────────┴───────┘
</code></pre></div> <p>この場合、ヒストグラムビンの境界線がわからないことを覚えておく必要があります。</p> <h2 id=function-sequencematch>sequenceMatch(pattern)(timestamp, cond1, cond2, …)<a class=headerlink href=../amp/#function-sequencematch title="Permanent link"> </a></h2> <p>かどうかをチェックします配列を含むイベントのチェーンに一致するパターンです。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>sequenceMatch</span><span class=p>(</span><span class=n>pattern</span><span class=p>)(</span><span class=k>timestamp</span><span class=p>,</span><span class=w> </span><span class=n>cond1</span><span class=p>,</span><span class=w> </span><span class=n>cond2</span><span class=p>,</span><span class=w> </span><span class=p>...)</span><span class=w></span>
</code></pre></div> <div class="admonition warning alert pb-0 mb-4 alert-warning" role=alert> <p class="admonition-title alert-heading display-4 text-reset mb-2">警告</p> <p>同じ秒で発生するイベントは、結果に影響を与える未定義の順序でシーケンス内に存在する可能性があります。</p> </div> <p><strong>パラメータ</strong></p> <ul> <li> <p><code class=syntax>pattern</code> — Pattern string. See <a href=../amp/#sequence-function-pattern-syntax>パターン構文</a>.</p> </li> <li> <p><code class=syntax>timestamp</code> — Column considered to contain time data. Typical data types are <code class=syntax>Date</code> と <code class=syntax>DateTime</code>. も利用できますの対応 <a href=../../../data-types/int-uint/amp/ >UInt</a> データ型。</p> </li> <li> <p><code class=syntax>cond1</code>, <code class=syntax>cond2</code> — Conditions that describe the chain of events. Data type: <code class=syntax>UInt8</code>. 最大32個の条件引数を渡すことができます。 この関数は、これらの条件で説明されているイベントのみを考慮します。 シーケンスに条件で記述されていないデータが含まれている場合、関数はそれらをスキップします。</p> </li> </ul> <p><strong>戻り値</strong></p> <ul> <li>パターンが一致する場合は、1。</li> <li>パターンが一致しない場合は0。</li> </ul> <p>タイプ: <code class=syntax>UInt8</code>.</p> <p><a name=sequence-function-pattern-syntax></a><br> <strong>パターン構文</strong></p> <ul> <li> <p><code class=syntax>(?N)</code> — Matches the condition argument at position <code class=syntax>N</code>. 条件は、 <code class=syntax>[1, 32]</code> 範囲 例えば, <code class=syntax>(?1)</code> に渡された引数と一致します。 <code class=syntax>cond1</code> パラメータ。</p> </li> <li> <p><code class=syntax>.*</code> — Matches any number of events. You don't need conditional arguments to match this element of the pattern.</p> </li> <li> <p><code class=syntax>(?t operator value)</code> — Sets the time in seconds that should separate two events. For example, pattern <code class=syntax>(?1)(?t&gt;1800)(?2)</code> お互いから1800秒以上発生するイベントと一致します。 これらのイベントの間に任意の数のイベントを配置できます。 を使用することができます <code class=syntax>&gt;=</code>, <code class=syntax>&gt;</code>, <code class=syntax>&lt;</code>, <code class=syntax>&lt;=</code>, <code class=syntax>==</code> 演算子。</p> </li> </ul> <p><strong>例</strong></p> <p>のデータを考慮する <code class=syntax>t</code> テーブル:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─time─┬─number─┐
│    1 │      1 │
│    2 │      3 │
│    3 │      2 │
└──────┴────────┘
</code></pre></div> <p>クエリの実行:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span><span class=w> </span><span class=n>sequenceMatch</span><span class=p>(</span><span class=s1>'(?1)(?2)'</span><span class=p>)(</span><span class=k>time</span><span class=p>,</span><span class=w> </span><span class=nb>number</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=nb>number</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>t</span><span class=w></span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─sequenceMatch('(?1)(?2)')(time, equals(number, 1), equals(number, 2))─┐
│                                                                     1 │
└───────────────────────────────────────────────────────────────────────┘
</code></pre></div> <p>関数は、番号2が番号1に続くイベントチェーンを見つけました。 番号はイベントとして記述されていないため、それらの間の番号3をスキップしました。 例で与えられたイベントチェーンを検索するときにこの番号を考慮に入れたい場合は、それに対する条件を作成する必要があります。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span><span class=w> </span><span class=n>sequenceMatch</span><span class=p>(</span><span class=s1>'(?1)(?2)'</span><span class=p>)(</span><span class=k>time</span><span class=p>,</span><span class=w> </span><span class=nb>number</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=nb>number</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=nb>number</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>3</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>t</span><span class=w></span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─sequenceMatch('(?1)(?2)')(time, equals(number, 1), equals(number, 2), equals(number, 3))─┐
│                                                                                        0 │
└──────────────────────────────────────────────────────────────────────────────────────────┘
</code></pre></div> <p>この場合、番号3のイベントが1と2の間で発生したため、関数はパターンに一致するイベントチェーンを見つけることができませんでした。 同じケースで4番の条件をチェックした場合、シーケンスはパターンと一致します。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span><span class=w> </span><span class=n>sequenceMatch</span><span class=p>(</span><span class=s1>'(?1)(?2)'</span><span class=p>)(</span><span class=k>time</span><span class=p>,</span><span class=w> </span><span class=nb>number</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=nb>number</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=nb>number</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>4</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>t</span><span class=w></span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─sequenceMatch('(?1)(?2)')(time, equals(number, 1), equals(number, 2), equals(number, 4))─┐
│                                                                                        1 │
└──────────────────────────────────────────────────────────────────────────────────────────┘
</code></pre></div> <p><strong>も参照。</strong></p> <ul> <li><a href=../amp/#function-sequencecount>シーケンスカウント</a></li> </ul> <h2 id=function-sequencecount>sequenceCount(pattern)(time, cond1, cond2, …)<a class=headerlink href=../amp/#function-sequencecount title="Permanent link"> </a></h2> <p>パターンに一致したイベントチェーンの数を数えます。 この関数は、重複しないイベントチェーンを検索します。 現在のチェーンが一致した後、次のチェーンの検索を開始します。</p> <div class="admonition warning alert pb-0 mb-4 alert-warning" role=alert> <p class="admonition-title alert-heading display-4 text-reset mb-2">警告</p> <p>同じ秒で発生するイベントは、結果に影響を与える未定義の順序でシーケンス内に存在する可能性があります。</p> </div> <div class=codehilite><pre><span></span><code class=syntax><span class=n>sequenceCount</span><span class=p>(</span><span class=n>pattern</span><span class=p>)(</span><span class=k>timestamp</span><span class=p>,</span><span class=w> </span><span class=n>cond1</span><span class=p>,</span><span class=w> </span><span class=n>cond2</span><span class=p>,</span><span class=w> </span><span class=p>...)</span><span class=w></span>
</code></pre></div> <p><strong>パラメータ</strong></p> <ul> <li> <p><code class=syntax>pattern</code> — Pattern string. See <a href=../amp/#sequence-function-pattern-syntax>パターン構文</a>.</p> </li> <li> <p><code class=syntax>timestamp</code> — Column considered to contain time data. Typical data types are <code class=syntax>Date</code> と <code class=syntax>DateTime</code>. も利用できますの対応 <a href=../../../data-types/int-uint/amp/ >UInt</a> データ型。</p> </li> <li> <p><code class=syntax>cond1</code>, <code class=syntax>cond2</code> — Conditions that describe the chain of events. Data type: <code class=syntax>UInt8</code>. 最大32個の条件引数を渡すことができます。 この関数は、これらの条件で説明されているイベントのみを考慮します。 シーケンスに条件で記述されていないデータが含まれている場合、関数はそれらをスキップします。</p> </li> </ul> <p><strong>戻り値</strong></p> <ul> <li>一致する重複しないイベントチェーンの数。</li> </ul> <p>タイプ: <code class=syntax>UInt64</code>.</p> <p><strong>例</strong></p> <p>のデータを考慮する <code class=syntax>t</code> テーブル:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─time─┬─number─┐
│    1 │      1 │
│    2 │      3 │
│    3 │      2 │
│    4 │      1 │
│    5 │      3 │
│    6 │      2 │
└──────┴────────┘
</code></pre></div> <p>数2が数1の後に何回発生するかを数えます。:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span><span class=w> </span><span class=n>sequenceCount</span><span class=p>(</span><span class=s1>'(?1).*(?2)'</span><span class=p>)(</span><span class=k>time</span><span class=p>,</span><span class=w> </span><span class=nb>number</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=nb>number</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>t</span><span class=w></span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─sequenceCount('(?1).*(?2)')(time, equals(number, 1), equals(number, 2))─┐
│                                                                       2 │
└─────────────────────────────────────────────────────────────────────────┘
</code></pre></div> <p><strong>も参照。</strong></p> <ul> <li><a href=../amp/#function-sequencematch>シーケンスマッチ</a></li> </ul> <h2 id=windowfunnel>ウィンドウファンネル<a class=headerlink href=../amp/#windowfunnel title="Permanent link"> </a></h2> <p>スライドタイムウィンドウ内のイベントチェーンを検索し、チェーンから発生したイベントの最大数を計算します。</p> <p>機能の動作に応じてアルゴリズム:</p> <ul> <li> <p>この関数は、チェーン内の最初の条件をトリガーし、イベントカウンターを1に設定するデータを検索します。 これはスライディングウィンドウが始まる瞬間です。</p> </li> <li> <p>だから、チェーンが順次内のウインドウのカウンタを増加されます。 シーケンスのイベントに障害が発生、カウンターな増加されます。</p> </li> <li> <p>さまざまな完了ポイントでデータに複数のイベントチェーンがある場合、関数は最も長いチェーンのサイズのみを出力します。</p> </li> </ul> <p><strong>構文</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>windowFunnel</span><span class=p>(</span><span class=n>window</span><span class=p>,</span><span class=w> </span><span class=p>[</span><span class=k>mode</span><span class=p>])(</span><span class=k>timestamp</span><span class=p>,</span><span class=w> </span><span class=n>cond1</span><span class=p>,</span><span class=w> </span><span class=n>cond2</span><span class=p>,</span><span class=w> </span><span class=p>...,</span><span class=w> </span><span class=n>condN</span><span class=p>)</span><span class=w></span>
</code></pre></div> <p><strong>パラメータ</strong></p> <ul> <li><code class=syntax>window</code> — Length of the sliding window in seconds.</li> <li><code class=syntax>mode</code> -これはオプションの引数です。<ul> <li><code class=syntax>'strict'</code> -とき <code class=syntax>'strict'</code> 設定されている場合、windowFunnel()は一意の値に対してのみ条件を適用します。</li> </ul> </li> <li><code class=syntax>timestamp</code> — Name of the column containing the timestamp. Data types supported: <a href=../../../data-types/date/amp/ >日付</a>, <a href=../../../data-types/datetime/amp/#data_type-datetime>DateTime</a> その他の符号なし整数型（timestampがサポートしているにもかかわらず <code class=syntax>UInt64</code> 値はInt64最大値を超えることはできません（2^63-1）。</li> <li><code class=syntax>cond</code> — Conditions or data describing the chain of events. <a href=../../../data-types/int-uint/amp/ >UInt8</a>.</li> </ul> <p><strong>戻り値</strong></p> <p>スライディングタイムウィンドウ内のチェーンからの連続したトリガ条件の最大数。<br> 選択内のすべてのチェーンが分析されます。</p> <p>タイプ: <code class=syntax>Integer</code>.</p> <p><strong>例</strong></p> <p>ユーザーが電話を選択してオンラインストアで二度購入するのに十分な時間があるかどうかを判断します。</p> <p>次の一連のイベントを設定します:</p> <ol> <li>ユーザーがストアのアカウントにログインした (<code class=syntax>eventID = 1003</code>).</li> <li>ユーザーが電話を検索する (<code class=syntax>eventID = 1007, product = 'phone'</code>).</li> <li>ユーザーが注文した (<code class=syntax>eventID = 1009</code>).</li> <li>ユーザーが再び注文しました (<code class=syntax>eventID = 1010</code>).</li> </ol> <p>入力テーブル:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─event_date─┬─user_id─┬───────────timestamp─┬─eventID─┬─product─┐
│ 2019-01-28 │       1 │ 2019-01-29 10:00:00 │    1003 │ phone   │
└────────────┴─────────┴─────────────────────┴─────────┴─────────┘
┌─event_date─┬─user_id─┬───────────timestamp─┬─eventID─┬─product─┐
│ 2019-01-31 │       1 │ 2019-01-31 09:00:00 │    1007 │ phone   │
└────────────┴─────────┴─────────────────────┴─────────┴─────────┘
┌─event_date─┬─user_id─┬───────────timestamp─┬─eventID─┬─product─┐
│ 2019-01-30 │       1 │ 2019-01-30 08:00:00 │    1009 │ phone   │
└────────────┴─────────┴─────────────────────┴─────────┴─────────┘
┌─event_date─┬─user_id─┬───────────timestamp─┬─eventID─┬─product─┐
│ 2019-02-01 │       1 │ 2019-02-01 08:00:00 │    1010 │ phone   │
└────────────┴─────────┴─────────────────────┴─────────┴─────────┘
</code></pre></div> <p>ユーザーの距離を調べる <code class=syntax>user_id</code> 2019年にチェーンを抜けることができた。</p> <p>クエリ:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span><span class=w></span>
<span class=w>    </span><span class=k>level</span><span class=p>,</span><span class=w></span>
<span class=w>    </span><span class=k>count</span><span class=p>()</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>c</span><span class=w></span>
<span class=k>FROM</span><span class=w></span>
<span class=p>(</span><span class=w></span>
<span class=w>    </span><span class=k>SELECT</span><span class=w></span>
<span class=w>        </span><span class=n>user_id</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=n>windowFunnel</span><span class=p>(</span><span class=mi>6048000000000000</span><span class=p>)(</span><span class=k>timestamp</span><span class=p>,</span><span class=w> </span><span class=n>eventID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1003</span><span class=p>,</span><span class=w> </span><span class=n>eventID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1009</span><span class=p>,</span><span class=w> </span><span class=n>eventID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1007</span><span class=p>,</span><span class=w> </span><span class=n>eventID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1010</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>level</span><span class=w></span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>trend</span><span class=w></span>
<span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=p>(</span><span class=n>event_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>'2019-01-01'</span><span class=p>)</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=p>(</span><span class=n>event_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>'2019-02-02'</span><span class=p>)</span><span class=w></span>
<span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>user_id</span><span class=w></span>
<span class=p>)</span><span class=w></span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>level</span><span class=w></span>
<span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>level</span><span class=w> </span><span class=k>ASC</span><span class=w></span>
</code></pre></div> <p>結果:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─level─┬─c─┐
│     4 │ 1 │
└───────┴───┘
</code></pre></div> <h2 id=retention>保持<a class=headerlink href=../amp/#retention title="Permanent link"> </a></h2> <p>この関数は、1から32までの型の引数の条件のセットを引数として受け取ります <code class=syntax>UInt8</code> るかどうかを示す一定の条件を満ためのイベントです。<br> 任意の条件を引数として指定することができます <a href=../../../statements/select/where/amp/#select-where>WHERE</a>).</p> <p>最初の条件を除く条件は、ペアで適用されます：最初と第二が真であれば第二の結果は真になり、最初とfirdが真であれば第三の結果は真になります。</p> <p><strong>構文</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>retention</span><span class=p>(</span><span class=n>cond1</span><span class=p>,</span><span class=w> </span><span class=n>cond2</span><span class=p>,</span><span class=w> </span><span class=p>...,</span><span class=w> </span><span class=n>cond32</span><span class=p>);</span><span class=w></span>
</code></pre></div> <p><strong>パラメータ</strong></p> <ul> <li><code class=syntax>cond</code> — an expression that returns a <code class=syntax>UInt8</code> 結果(1または0)。</li> </ul> <p><strong>戻り値</strong></p> <p>1または0の配列。</p> <ul> <li>1 — condition was met for the event.</li> <li>0 — condition wasn't met for the event.</li> </ul> <p>タイプ: <code class=syntax>UInt8</code>.</p> <p><strong>例</strong></p> <p>のは、計算の例を考えてみましょう <code class=syntax>retention</code> サイトトラフィックを決定する機能。</p> <p><strong>1.</strong> Сreate a table to illustrate an example.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>retention_test</span><span class=p>(</span><span class=nb>date</span><span class=w> </span><span class=nb>Date</span><span class=p>,</span><span class=w> </span><span class=n>uid</span><span class=w> </span><span class=n>Int32</span><span class=p>)</span><span class=w> </span><span class=n>ENGINE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Memory</span><span class=p>;</span><span class=w></span>

<span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>retention_test</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=s1>'2020-01-01'</span><span class=p>,</span><span class=w> </span><span class=nb>number</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>numbers</span><span class=p>(</span><span class=mi>5</span><span class=p>);</span><span class=w></span>
<span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>retention_test</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=s1>'2020-01-02'</span><span class=p>,</span><span class=w> </span><span class=nb>number</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>numbers</span><span class=p>(</span><span class=mi>10</span><span class=p>);</span><span class=w></span>
<span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>retention_test</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=s1>'2020-01-03'</span><span class=p>,</span><span class=w> </span><span class=nb>number</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>numbers</span><span class=p>(</span><span class=mi>15</span><span class=p>);</span><span class=w></span>
</code></pre></div> <p>入力テーブル:</p> <p>クエリ:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>retention_test</span><span class=w></span>
</code></pre></div> <p>結果:</p> <div class=codehilite><pre><span></span><code class=syntax>┌───────date─┬─uid─┐
│ 2020-01-01 │   0 │
│ 2020-01-01 │   1 │
│ 2020-01-01 │   2 │
│ 2020-01-01 │   3 │
│ 2020-01-01 │   4 │
└────────────┴─────┘
┌───────date─┬─uid─┐
│ 2020-01-02 │   0 │
│ 2020-01-02 │   1 │
│ 2020-01-02 │   2 │
│ 2020-01-02 │   3 │
│ 2020-01-02 │   4 │
│ 2020-01-02 │   5 │
│ 2020-01-02 │   6 │
│ 2020-01-02 │   7 │
│ 2020-01-02 │   8 │
│ 2020-01-02 │   9 │
└────────────┴─────┘
┌───────date─┬─uid─┐
│ 2020-01-03 │   0 │
│ 2020-01-03 │   1 │
│ 2020-01-03 │   2 │
│ 2020-01-03 │   3 │
│ 2020-01-03 │   4 │
│ 2020-01-03 │   5 │
│ 2020-01-03 │   6 │
│ 2020-01-03 │   7 │
│ 2020-01-03 │   8 │
│ 2020-01-03 │   9 │
│ 2020-01-03 │  10 │
│ 2020-01-03 │  11 │
│ 2020-01-03 │  12 │
│ 2020-01-03 │  13 │
│ 2020-01-03 │  14 │
└────────────┴─────┘
</code></pre></div> <p><strong>2.</strong> ユーザを一意のIDでグループ化 <code class=syntax>uid</code> を使用して <code class=syntax>retention</code> 機能。</p> <p>クエリ:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span><span class=w></span>
<span class=w>    </span><span class=n>uid</span><span class=p>,</span><span class=w></span>
<span class=w>    </span><span class=n>retention</span><span class=p>(</span><span class=nb>date</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>'2020-01-01'</span><span class=p>,</span><span class=w> </span><span class=nb>date</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>'2020-01-02'</span><span class=p>,</span><span class=w> </span><span class=nb>date</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>'2020-01-03'</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>r</span><span class=w></span>
<span class=k>FROM</span><span class=w> </span><span class=n>retention_test</span><span class=w></span>
<span class=k>WHERE</span><span class=w> </span><span class=nb>date</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=s1>'2020-01-01'</span><span class=p>,</span><span class=w> </span><span class=s1>'2020-01-02'</span><span class=p>,</span><span class=w> </span><span class=s1>'2020-01-03'</span><span class=p>)</span><span class=w></span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>uid</span><span class=w></span>
<span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>uid</span><span class=w> </span><span class=k>ASC</span><span class=w></span>
</code></pre></div> <p>結果:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─uid─┬─r───────┐
│   0 │ [1,1,1] │
│   1 │ [1,1,1] │
│   2 │ [1,1,1] │
│   3 │ [1,1,1] │
│   4 │ [1,1,1] │
│   5 │ [0,0,0] │
│   6 │ [0,0,0] │
│   7 │ [0,0,0] │
│   8 │ [0,0,0] │
│   9 │ [0,0,0] │
│  10 │ [0,0,0] │
│  11 │ [0,0,0] │
│  12 │ [0,0,0] │
│  13 │ [0,0,0] │
│  14 │ [0,0,0] │
└─────┴─────────┘
</code></pre></div> <p><strong>3.</strong> 一日あたりのサイト訪問の合計数を計算します。</p> <p>クエリ:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span><span class=w></span>
<span class=w>    </span><span class=k>sum</span><span class=p>(</span><span class=n>r</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>r1</span><span class=p>,</span><span class=w></span>
<span class=w>    </span><span class=k>sum</span><span class=p>(</span><span class=n>r</span><span class=p>[</span><span class=mi>2</span><span class=p>])</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>r2</span><span class=p>,</span><span class=w></span>
<span class=w>    </span><span class=k>sum</span><span class=p>(</span><span class=n>r</span><span class=p>[</span><span class=mi>3</span><span class=p>])</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>r3</span><span class=w></span>
<span class=k>FROM</span><span class=w></span>
<span class=p>(</span><span class=w></span>
<span class=w>    </span><span class=k>SELECT</span><span class=w></span>
<span class=w>        </span><span class=n>uid</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=n>retention</span><span class=p>(</span><span class=nb>date</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>'2020-01-01'</span><span class=p>,</span><span class=w> </span><span class=nb>date</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>'2020-01-02'</span><span class=p>,</span><span class=w> </span><span class=nb>date</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>'2020-01-03'</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>r</span><span class=w></span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>retention_test</span><span class=w></span>
<span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=nb>date</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=s1>'2020-01-01'</span><span class=p>,</span><span class=w> </span><span class=s1>'2020-01-02'</span><span class=p>,</span><span class=w> </span><span class=s1>'2020-01-03'</span><span class=p>)</span><span class=w></span>
<span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>uid</span><span class=w></span>
<span class=p>)</span><span class=w></span>
</code></pre></div> <p>結果:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─r1─┬─r2─┬─r3─┐
│  5 │  5 │  5 │
└────┴────┴────┘
</code></pre></div> <p>どこに:</p> <ul> <li><code class=syntax>r1</code>-2020-01-01中にサイトを訪問したユニークな訪問者の数（ <code class=syntax>cond1</code> 条件）。</li> <li><code class=syntax>r2</code>-2020-01-01から2020-01-02の間の特定の期間にサイトを訪問したユニーク訪問者の数 (<code class=syntax>cond1</code> と <code class=syntax>cond2</code> 条件）。</li> <li><code class=syntax>r3</code>-2020-01-01から2020-01-03の間の特定の期間にサイトを訪問したユニーク訪問者の数 (<code class=syntax>cond1</code> と <code class=syntax>cond3</code> 条件）。</li> </ul> <h2 id=uniquptonx>uniqUpTo(N)(x)<a class=headerlink href=../amp/#uniquptonx title="Permanent link"> </a></h2> <p>Calculates the number of different argument values ​​if it is less than or equal to N. If the number of different argument values is greater than N, it returns N + 1.</p> <p>小さいNsの使用のために推薦される、10まで。 Nの最大値は100です。</p> <p>集計関数の状態については、1+N*バイトの値のサイズに等しいメモリ量を使用します。<br> 文字列の場合、8バイトの非暗号化ハッシュを格納します。 つまり、計算は文字列に対して近似されます。</p> <p>この関数は、いくつかの引数でも機能します。</p> <p>大きなN値が使用され、一意の値の数がNよりわずかに小さい場合を除いて、できるだけ高速に動作します。</p> <p>使用例:</p> <div class=codehilite><pre><span></span><code class=syntax>Problem: Generate a report that shows only keywords that produced at least 5 unique users.
Solution: Write in the GROUP BY query SearchPhrase HAVING uniqUpTo(4)(UserID) &gt;= 5
</code></pre></div> <h2 id=summapfilteredkeys-to-keepkeys-values>sumMapFiltered(keys_to_keep)(キー,値)<a class=headerlink href=../amp/#summapfilteredkeys-to-keepkeys-values title="Permanent link"> </a></h2> <p>と同じ動作 <a href=../../reference/amp/#agg_functions-summap>サマップ</a> ただし、キーの配列はパラメータとして渡されます。 これは、キーの基数が高い場合に特に便利です。</p>
        </div>
      </div>
      <div class="row">
        <div class="col">
          
<div class="alert alert-light my-3">
  <p class="float-right mb-0">Rating: RATING_VALUE - RATING_COUNT votes</p>
  <span class="alert-heading display-6">Article Rating</span>
  <div id="rating-stars" class="display-6 mb-0"
     
  >RATING_STARS</div>
</div>

<div id="content-footer" class="text-muted pt-3 mb-5">
    <div class="float-md-right">©2016–2022 ClickHouse, Inc.</div>
    <div>Built from <a href="https://github.com/ClickHouse/ClickHouse/commit/38993f215f9186c1ac3505b1e09697cd9a468b5d" rel="external nofollow noreferrer" target="_blank" class="text-reset">38993f21</a>
    
    </div>
</div>

        </div>
      </div>
      <div id="to-full-website" class="row fixed-bottom text-center bg-white py-3">
        <div class="col">
          <a class="btn btn-lg btn-outline-orange" href="https://clickhouse.com/docs/ja/sql-reference/aggregate-functions/parametric-functions/">To full website</a>
        </div>
      </div>
    </div>
    <amp-analytics type="metrika">
      <script type="application/json">{
"vars": {
  "counterId": "18343495",
  "triggers": {
    "notBounce": {
      "on": "timer",
      "timerSpec": {
        "immediate": false,
        "interval": 15,
        "maxTimerLength": 16
      },
      "request": "notBounce"
    }
  }
}
}</script>
  </amp-analytics>
  </body>
</html>
